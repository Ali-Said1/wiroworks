let t,e,r;var n=globalThis;function i(t){return t&&t.__esModule?t.default:t}var a={},o={},s=n.parcelRequire94c2;null==s&&((s=function(t){if(t in a)return a[t].exports;if(t in o){var e=o[t];delete o[t];var r={id:t,exports:{}};return a[t]=r,e.call(r.exports,r,r.exports),r.exports}var n=Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,e){o[t]=e},n.parcelRequire94c2=s);var u=s.register;u("cmoHh",function(t,e){!function(t,e,r){function n(t){var e,r=this,n=(e=0xefc8249d,function(t){t=String(t);for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));e=n>>>0,n-=e,n*=e,e=n>>>0,n-=e,e+=0x100000000*n}return(e>>>0)*23283064365386963e-26});r.next=function(){var t=2091639*r.s0+23283064365386963e-26*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(t),r.s0<0&&(r.s0+=1),r.s1-=n(t),r.s1<0&&(r.s1+=1),r.s2-=n(t),r.s2<0&&(r.s2+=1)}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function a(t,e){var r=new n(t),a=e&&e.state,o=r.next;return o.int32=function(){return 0x100000000*r.next()|0},o.double=function(){return o()+(2097152*o()|0)*11102230246251565e-32},o.quick=o,a&&("object"==typeof a&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.alea=a}(0,t,"function"==typeof define&&define)}),u("euRi5",function(t,e){!function(t,e,r){function n(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function a(t,e){var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&("object"==typeof a&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a}(0,t,"function"==typeof define&&define)}),u("hDsEw",function(t,e){!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^(t^t<<1))|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function a(t,e){var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&("object"==typeof a&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a}(0,t,"function"==typeof define&&define)}),u("3J2Zm",function(t,e){!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.x,i=e.i;return t=n[i],t^=t>>>7,r=t^t<<24^((t=n[i+1&7])^t>>>10)^((t=n[i+3&7])^t>>>3)^((t=n[i+4&7])^t<<7),t=n[i+7&7],t^=t<<13,r^=t^t<<9,n[i]=r,e.i=i+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(r=0,e=""+e;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function a(t,e){null==t&&(t=+new Date);var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&(a.x&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a}(0,t,"function"==typeof define&&define)}),u("6Px8M",function(t,e){!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.w,i=e.X,a=e.i;return e.w=n=n+0x61c88647|0,r=i[a+34&127],t=i[a=a+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=i[a]=r^t,e.i=a,r+(n^n>>>16)|0},function(t,e){var r,n,i,a,o,s=[],u=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(n^=e.charCodeAt((a+32)%e.length)),0===a&&(o=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,a>=0&&(o=o+0x61c88647|0,i=0==(r=s[127&a]^=n+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)n=s[i+34&127],r=s[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,s[i]=n^r;t.w=o,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function a(t,e){null==t&&(t=+new Date);var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&(a.X&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a}(0,t,"function"==typeof define&&define)}),u("lDm0S",function(t,e){!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,i=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-0x61c88647,e.d=0x517cc1b7,t===Math.floor(t)?(e.a=t/0x100000000|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function a(t,e){var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&("object"==typeof a&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a}(0,t,"function"==typeof define&&define)}),u("bx1Nf",function(t,e){});var l={};Object.defineProperty(l,"__esModule",{value:!0});var h={};Object.defineProperty(h,"__esModule",{value:!0}),h.Konva=void 0;var c={};Object.defineProperty(c,"__esModule",{value:!0}),c.Konva=void 0;var f={};Object.defineProperty(f,"__esModule",{value:!0}),f._registerNode=f.Konva=f.glob=void 0;const d=Math.PI/180;f.glob=void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:{},f.Konva={_global:f.glob,version:"9.3.16",isBrowser:"undefined"!=typeof window&&("[object Window]"===({}).toString.call(window)||"[object global]"===({}).toString.call(window)),isUnminified:/param/.test((function(t){}).toString()),dblClickWindow:400,getAngle:t=>f.Konva.angleDeg?t*d:t,enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:()=>f.Konva.DD.isDragging,isTransforming(){var t;return null===(t=f.Konva.Transformer)||void 0===t?void 0:t.isTransforming()},isDragReady:()=>!!f.Konva.DD.node,releaseCanvasOnDestroy:!0,document:f.glob.document,_injectGlobal(t){f.glob.Konva=t}},f._registerNode=t=>{f.Konva[t.prototype.getClassName()]=t},f.Konva._injectGlobal(f.Konva);var p={};Object.defineProperty(p,"__esModule",{value:!0}),p.Util=p.Transform=void 0;class g{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new g(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){let e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){let e=Math.cos(t),r=Math.sin(t),n=this.m[0]*e+this.m[2]*r,i=this.m[1]*e+this.m[3]*r,a=-(this.m[0]*r)+this.m[2]*e,o=-(this.m[1]*r)+this.m[3]*e;return this.m[0]=n,this.m[1]=i,this.m[2]=a,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){let r=this.m[0]+this.m[2]*e,n=this.m[1]+this.m[3]*e,i=this.m[2]+this.m[0]*t,a=this.m[3]+this.m[1]*t;return this.m[0]=r,this.m[1]=n,this.m[2]=i,this.m[3]=a,this}multiply(t){let e=this.m[0]*t.m[0]+this.m[2]*t.m[1],r=this.m[1]*t.m[0]+this.m[3]*t.m[1],n=this.m[0]*t.m[2]+this.m[2]*t.m[3],i=this.m[1]*t.m[2]+this.m[3]*t.m[3],a=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=r,this.m[2]=n,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}invert(){let t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,r=-this.m[1]*t,n=-this.m[2]*t,i=this.m[0]*t,a=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=r,this.m[2]=n,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}getMatrix(){return this.m}decompose(){let t=this.m[0],e=this.m[1],r=this.m[2],n=this.m[3],i=this.m[4],a=this.m[5],o=t*n-e*r,s={x:i,y:a,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=t||0!=e){let i=Math.sqrt(t*t+e*e);s.rotation=e>0?Math.acos(t/i):-Math.acos(t/i),s.scaleX=i,s.scaleY=o/i,s.skewX=(t*r+e*n)/o,s.skewY=0}else if(0!=r||0!=n){let i=Math.sqrt(r*r+n*n);s.rotation=Math.PI/2-(n>0?Math.acos(-r/i):-Math.acos(r/i)),s.scaleX=o/i,s.scaleY=i,s.skewX=0,s.skewY=(t*r+e*n)/o}return s.rotation=p.Util._getRotation(s.rotation),s}}p.Transform=g;let m=Math.PI/180,y=180/Math.PI,v="Konva error: ",x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},D=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,b=[];const _="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||function(t){setTimeout(t,60)};p.Util={_isElement:t=>!!(t&&1==t.nodeType),_isFunction:t=>!!(t&&t.constructor&&t.call&&t.apply),_isPlainObject:t=>!!t&&t.constructor===Object,_isArray:t=>"[object Array]"===Object.prototype.toString.call(t),_isNumber:t=>"[object Number]"===Object.prototype.toString.call(t)&&!isNaN(t)&&isFinite(t),_isString:t=>"[object String]"===Object.prototype.toString.call(t),_isBoolean:t=>"[object Boolean]"===Object.prototype.toString.call(t),isObject:t=>t instanceof Object,isValidSelector(t){if("string"!=typeof t)return!1;let e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign:t=>0===t?1:t>0?1:-1,requestAnimFrame(t){b.push(t),1===b.length&&_(function(){let t=b;b=[],t.forEach(function(t){t()})})},createCanvasElement(){let t=document.createElement("canvas");try{t.style=t.style||{}}catch(t){}return t},createImageElement:()=>document.createElement("img"),_isInDocument(t){for(;t=t.parentNode;)if(t==document)return!0;return!1},_urlToImage(t,e){let r=p.Util.createImageElement();r.onload=function(){e(r)},r.src=t},_rgbToHex:(t,e,r)=>(0x1000000+(t<<16)+(e<<8)+r).toString(16).slice(1),_hexToRgb(t){let e=parseInt(t=t.replace("#",""),16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor(){let t=(0xffffff*Math.random()<<0).toString(16);for(;t.length<6;)t="0"+t;return"#"+t},getRGB(t){let e;return t in x?{r:(e=x[t])[0],g:e[1],b:e[2]}:"#"===t[0]?this._hexToRgb(t.substring(1)):"rgb("===t.substr(0,4)?{r:parseInt((e=D.exec(t.replace(/ /g,"")))[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}:{r:0,g:0,b:0}},colorToRGBA:t=>(t=t||"black",p.Util._namedColorToRBA(t)||p.Util._hex3ColorToRGBA(t)||p.Util._hex4ColorToRGBA(t)||p.Util._hex6ColorToRGBA(t)||p.Util._hex8ColorToRGBA(t)||p.Util._rgbColorToRGBA(t)||p.Util._rgbaColorToRGBA(t)||p.Util._hslColorToRGBA(t)),_namedColorToRBA(t){let e=x[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(t){if(0===t.indexOf("rgb(")){let e=(t=t.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(t){if(0===t.indexOf("rgba(")){let e=(t=t.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map((t,e)=>"%"===t.slice(-1)?3===e?parseInt(t)/100:parseInt(t)/100*255:Number(t));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(t){if("#"===t[0]&&9===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:parseInt(t.slice(7,9),16)/255}},_hex6ColorToRGBA(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex4ColorToRGBA(t){if("#"===t[0]&&5===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:parseInt(t[4]+t[4],16)/255}},_hex3ColorToRGBA(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){let e,r,n;let[i,...a]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),o=Number(a[0])/360,s=Number(a[1])/100,u=Number(a[2])/100;if(0===s)return{r:Math.round(n=255*u),g:Math.round(n),b:Math.round(n),a:1};e=u<.5?u*(1+s):u+s-u*s;let l=2*u-e,h=[0,0,0];for(let t=0;t<3;t++)(r=o+-(1/3*(t-1)))<0&&r++,r>1&&r--,n=6*r<1?l+(e-l)*6*r:2*r<1?e:3*r<2?l+(e-l)*(2/3-r)*6:l,h[t]=255*n;return{r:Math.round(h[0]),g:Math.round(h[1]),b:Math.round(h[2]),a:1}}},haveIntersection:(t,e)=>!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y),cloneObject(t){let e={};for(let r in t)this._isPlainObject(t[r])?e[r]=this.cloneObject(t[r]):this._isArray(t[r])?e[r]=this.cloneArray(t[r]):e[r]=t[r];return e},cloneArray:t=>t.slice(0),degToRad:t=>t*m,radToDeg:t=>t*y,_degToRad:t=>(p.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),p.Util.degToRad(t)),_radToDeg:t=>(p.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),p.Util.radToDeg(t)),_getRotation:t=>f.Konva.angleDeg?p.Util.radToDeg(t):t,_capitalize:t=>t.charAt(0).toUpperCase()+t.slice(1),throw(t){throw Error(v+t)},error(t){console.error(v+t)},warn(t){f.Konva.showWarnings&&console.warn("Konva warning: "+t)},each(t,e){for(let r in t)e(r,t[r])},_inRange:(t,e,r)=>e<=t&&t<r,_getProjectionToSegment(t,e,r,n,i,a){let o,s,u;let l=(t-r)*(t-r)+(e-n)*(e-n);if(0==l)o=t,s=e,u=(i-r)*(i-r)+(a-n)*(a-n);else{let h=((i-t)*(r-t)+(a-e)*(n-e))/l;h<0?(o=t,s=e,u=(t-i)*(t-i)+(e-a)*(e-a)):h>1?(o=r,s=n,u=(r-i)*(r-i)+(n-a)*(n-a)):u=((o=t+h*(r-t))-i)*(o-i)+((s=e+h*(n-e))-a)*(s-a)}return[o,s,u]},_getProjectionToLine(t,e,r){let n=p.Util.cloneObject(t),i=Number.MAX_VALUE;return e.forEach(function(a,o){if(!r&&o===e.length-1)return;let s=e[(o+1)%e.length],u=p.Util._getProjectionToSegment(a.x,a.y,s.x,s.y,t.x,t.y),l=u[0],h=u[1],c=u[2];c<i&&(n.x=l,n.y=h,i=c)}),n},_prepareArrayForTween(t,e,r){let n,i=[],a=[];if(t.length>e.length){let r=e;e=t,t=r}for(n=0;n<t.length;n+=2)i.push({x:t[n],y:t[n+1]});for(n=0;n<e.length;n+=2)a.push({x:e[n],y:e[n+1]});let o=[];return a.forEach(function(t){let e=p.Util._getProjectionToLine(t,i,r);o.push(e.x),o.push(e.y)}),o},_prepareToStringify(t){let e;for(let r in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(r)&&t[r]&&"object"==typeof t[r]){if(e=Object.getOwnPropertyDescriptor(t,r),t[r].visitedByCircularReferenceRemoval||p.Util._isElement(t[r])){if(!e.configurable)return null;delete t[r]}else if(null===p.Util._prepareToStringify(t[r])){if(!e.configurable)return null;delete t[r]}}return delete t.visitedByCircularReferenceRemoval,t},_assign(t,e){for(let r in e)t[r]=e[r];return t},_getFirstPointerId:t=>t.touches?t.changedTouches[0].identifier:t.pointerId||999,releaseCanvas(...t){f.Konva.releaseCanvasOnDestroy&&t.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(t,e,r,n){let i=0,a=0,o=0,s=0;"number"==typeof n?i=a=o=s=Math.min(n,e/2,r/2):(i=Math.min(n[0]||0,e/2,r/2),a=Math.min(n[1]||0,e/2,r/2),s=Math.min(n[2]||0,e/2,r/2),o=Math.min(n[3]||0,e/2,r/2)),t.moveTo(i,0),t.lineTo(e-a,0),t.arc(e-a,a,a,3*Math.PI/2,0,!1),t.lineTo(e,r-s),t.arc(e-s,r-s,s,0,Math.PI/2,!1),t.lineTo(o,r),t.arc(o,r-o,o,Math.PI/2,Math.PI,!1),t.lineTo(0,i),t.arc(i,i,i,Math.PI,3*Math.PI/2,!1)}};var w={};Object.defineProperty(w,"__esModule",{value:!0}),w.Node=void 0;var C={};Object.defineProperty(C,"__esModule",{value:!0}),C.Factory=void 0;var A={};function S(t){return p.Util._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)||p.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}Object.defineProperty(A,"__esModule",{value:!0}),A.RGBComponent=function(t){return t>255?255:t<0?0:Math.round(t)},A.alphaComponent=function(t){return t>1?1:t<1e-4?1e-4:t},A.getNumberValidator=function(){if(f.Konva.isUnminified)return function(t,e){return p.Util._isNumber(t)||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}},A.getNumberOrArrayOfNumbersValidator=function(t){if(f.Konva.isUnminified)return function(e,r){let n=p.Util._isNumber(e),i=p.Util._isArray(e)&&e.length==t;return n||i||p.Util.warn(S(e)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+t+")"),e}},A.getNumberOrAutoValidator=function(){if(f.Konva.isUnminified)return function(t,e){let r=p.Util._isNumber(t),n="auto"===t;return r||n||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}},A.getStringValidator=function(){if(f.Konva.isUnminified)return function(t,e){return p.Util._isString(t)||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}},A.getStringOrGradientValidator=function(){if(f.Konva.isUnminified)return function(t,e){let r=p.Util._isString(t),n="[object CanvasGradient]"===Object.prototype.toString.call(t)||t&&t.addColorStop;return r||n||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}},A.getFunctionValidator=function(){if(f.Konva.isUnminified)return function(t,e){return p.Util._isFunction(t)||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}},A.getNumberArrayValidator=function(){if(f.Konva.isUnminified)return function(t,e){let r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&t instanceof r||(p.Util._isArray(t)?t.forEach(function(t){p.Util._isNumber(t)||p.Util.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")}):p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}},A.getBooleanValidator=function(){if(f.Konva.isUnminified)return function(t,e){return!0===t||!1===t||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}},A.getComponentValidator=function(t){if(f.Konva.isUnminified)return function(e,r){return null==e||p.Util.isObject(e)||p.Util.warn(S(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}},C.Factory={addGetterSetter(t,e,r,n,i){C.Factory.addGetter(t,e,r),C.Factory.addSetter(t,e,n,i),C.Factory.addOverloadedGetterSetter(t,e)},addGetter(t,e,r){let n="get"+p.Util._capitalize(e);t.prototype[n]=t.prototype[n]||function(){let t=this.attrs[e];return void 0===t?r:t}},addSetter(t,e,r,n){let i="set"+p.Util._capitalize(e);t.prototype[i]||C.Factory.overWriteSetter(t,e,r,n)},overWriteSetter(t,e,r,n){let i="set"+p.Util._capitalize(e);t.prototype[i]=function(t){return r&&null!=t&&(t=r.call(this,t,e)),this._setAttr(e,t),n&&n.call(this),this}},addComponentsGetterSetter(t,e,r,n,i){let a=r.length,o=p.Util._capitalize,s="get"+o(e),u="set"+o(e),l,h;t.prototype[s]=function(){let t={};for(l=0;l<a;l++)t[h=r[l]]=this.getAttr(e+o(h));return t};let c=(0,A.getComponentValidator)(r);t.prototype[u]=function(t){let a=this.attrs[e],s;for(s in n&&(t=n.call(this,t)),c&&c.call(this,t,e),t)t.hasOwnProperty(s)&&this._setAttr(e+o(s),t[s]);return t||r.forEach(t=>{this._setAttr(e+o(t),void 0)}),this._fireChangeEvent(e,a,t),i&&i.call(this),this},C.Factory.addOverloadedGetterSetter(t,e)},addOverloadedGetterSetter(t,e){let r=p.Util._capitalize(e),n="set"+r,i="get"+r;t.prototype[e]=function(){return arguments.length?(this[n](arguments[0]),this):this[i]()}},addDeprecatedGetterSetter(t,e,r,n){p.Util.error("Adding deprecated "+e);let i="get"+p.Util._capitalize(e),a=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[i]=function(){p.Util.error(a);let t=this.attrs[e];return void 0===t?r:t},C.Factory.addSetter(t,e,n,function(){p.Util.error(a)}),C.Factory.addOverloadedGetterSetter(t,e)},backCompat(t,e){p.Util.each(e,function(e,r){let n=t.prototype[r],i="get"+p.Util._capitalize(e),a="set"+p.Util._capitalize(e);function o(){n.apply(this,arguments),p.Util.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+r+'" instead.')}t.prototype[e]=o,t.prototype[i]=o,t.prototype[a]=o})},afterSetFilter(){this._filterUpToDate=!1}};var F={};Object.defineProperty(F,"__esModule",{value:!0}),F.HitCanvas=F.SceneCanvas=F.Canvas=void 0;var E={};Object.defineProperty(E,"__esModule",{value:!0}),E.HitContext=E.SceneContext=E.Context=void 0;const M=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];class N{constructor(t){this.canvas=t,f.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){let r=this.traceArr,n=r.length,i="",a,o,s,u;for(a=0;a<n;a++)(s=(o=r[a]).method)?(u=o.args,i+=s,t?i+="()":p.Util._isArray(u[0])?i+="(["+u.join(",")+"])":(e&&(u=u.map(t=>"number"==typeof t?Math.floor(t):t)),i+="("+u.join(",")+")")):(i+=o.property,t||(i+="="+o.val)),i+=";";return i}clearTrace(){this.traceArr=[]}_trace(t){let e=this.traceArr;e.push(t),e.length>=100&&e.shift()}reset(){let t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){let e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){let e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){let e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){let e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,r,n,i,a){this._context.arc(t,e,r,n,i,a)}arcTo(t,e,r,n,i){this._context.arcTo(t,e,r,n,i)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,r,n,i,a){this._context.bezierCurveTo(t,e,r,n,i,a)}clearRect(t,e,r,n){this._context.clearRect(t,e,r,n)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){let r=arguments;return 2===r.length?this._context.createImageData(t,e):1===r.length?this._context.createImageData(t):void 0}createLinearGradient(t,e,r,n){return this._context.createLinearGradient(t,e,r,n)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,r,n,i,a){return this._context.createRadialGradient(t,e,r,n,i,a)}drawImage(t,e,r,n,i,a,o,s,u){let l=arguments,h=this._context;3===l.length?h.drawImage(t,e,r):5===l.length?h.drawImage(t,e,r,n,i):9===l.length&&h.drawImage(t,e,r,n,i,a,o,s,u)}ellipse(t,e,r,n,i,a,o,s){this._context.ellipse(t,e,r,n,i,a,o,s)}isPointInPath(t,e,r,n){return r?this._context.isPointInPath(r,t,e,n):this._context.isPointInPath(t,e,n)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,r,n){this._context.fillRect(t,e,r,n)}strokeRect(t,e,r,n){this._context.strokeRect(t,e,r,n)}fillText(t,e,r,n){n?this._context.fillText(t,e,r,n):this._context.fillText(t,e,r)}measureText(t){return this._context.measureText(t)}getImageData(t,e,r,n){return this._context.getImageData(t,e,r,n)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,r,n){this._context.rect(t,e,r,n)}roundRect(t,e,r,n,i){this._context.roundRect(t,e,r,n,i)}putImageData(t,e,r){this._context.putImageData(t,e,r)}quadraticCurveTo(t,e,r,n){this._context.quadraticCurveTo(t,e,r,n)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,r,n,i,a){this._context.setTransform(t,e,r,n,i,a)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,r,n){this._context.strokeText(t,e,r,n)}transform(t,e,r,n,i,a){this._context.transform(t,e,r,n,i,a)}translate(t,e){this._context.translate(t,e)}_enableTrace(){let t=this,e=M.length,r=this.setAttr,n,i,a=function(e){let r=t[e],n;t[e]=function(){return i=function(t){let e=[],r=t.length,n=p.Util,i,a;for(i=0;i<r;i++)a=t[i],n._isNumber(a)?a=Math.round(1e3*a)/1e3:n._isString(a)||(a+=""),e.push(a);return e}(Array.prototype.slice.call(arguments,0)),n=r.apply(t,arguments),t._trace({method:e,args:i}),n}};for(n=0;n<e;n++)a(M[n]);t.setAttr=function(){r.apply(t,arguments);let e=arguments[0],n=arguments[1];("shadowOffsetX"===e||"shadowOffsetY"===e||"shadowBlur"===e)&&(n/=this.canvas.getPixelRatio()),t._trace({property:e,val:n})}}_applyGlobalCompositeOperation(t){let e=t.attrs.globalCompositeOperation;e&&"source-over"!==e&&this.setAttr("globalCompositeOperation",e)}}E.Context=N,["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach(function(t){Object.defineProperty(N.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})}),E.SceneContext=class extends N{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){let e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){let e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){let e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){let e=t.fill(),r=t.getFillPriority();if(e&&"color"===r){this._fillColor(t);return}let n=t.getFillPatternImage();if(n&&"pattern"===r){this._fillPattern(t);return}let i=t.getFillLinearGradientColorStops();if(i&&"linear-gradient"===r){this._fillLinearGradient(t);return}let a=t.getFillRadialGradientColorStops();if(a&&"radial-gradient"===r){this._fillRadialGradient(t);return}e?this._fillColor(t):n?this._fillPattern(t):i?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)}_strokeLinearGradient(t){let e=t.getStrokeLinearGradientStartPoint(),r=t.getStrokeLinearGradientEndPoint(),n=t.getStrokeLinearGradientColorStops(),i=this.createLinearGradient(e.x,e.y,r.x,r.y);if(n){for(let t=0;t<n.length;t+=2)i.addColorStop(n[t],n[t+1]);this.setAttr("strokeStyle",i)}}_stroke(t){let e=t.dash(),r=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!r){this.save();let t=this.getCanvas().getPixelRatio();this.setTransform(t,0,0,t,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),r||this.restore()}}_applyShadow(t){var e,r,n;let i=null!==(e=t.getShadowRGBA())&&void 0!==e?e:"black",a=null!==(r=t.getShadowBlur())&&void 0!==r?r:5,o=null!==(n=t.getShadowOffset())&&void 0!==n?n:{x:0,y:0},s=t.getAbsoluteScale(),u=this.canvas.getPixelRatio(),l=s.x*u,h=s.y*u;this.setAttr("shadowColor",i),this.setAttr("shadowBlur",a*Math.min(Math.abs(l),Math.abs(h))),this.setAttr("shadowOffsetX",o.x*l),this.setAttr("shadowOffsetY",o.y*h)}},E.HitContext=class extends N{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){let e=t.getStrokeScaleEnabled();if(!e){this.save();let t=this.getCanvas().getPixelRatio();this.setTransform(t,0,0,t,0,0)}this._applyLineCap(t);let r=t.hitStrokeWidth(),n="auto"===r?t.strokeWidth():r;this.setAttr("lineWidth",n),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}};class B{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let r=(e||{}).pixelRatio||f.Konva.pixelRatio||function(){if(t)return t;let e=p.Util.createCanvasElement(),r=e.getContext("2d");return t=(f.Konva._global.devicePixelRatio||1)/(r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1),p.Util.releaseCanvas(e),t}();this.pixelRatio=r,this._canvas=p.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){let e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";let e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";let e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch(t){try{return this._canvas.toDataURL()}catch(t){return p.Util.error("Unable to get data URL. "+t.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}F.Canvas=B,C.Factory.addGetterSetter(B,"pixelRatio",void 0,(0,A.getNumberValidator)()),F.SceneCanvas=class extends B{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new E.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}},F.HitCanvas=class extends B{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new E.HitContext(this),this.setSize(t.width,t.height)}};var T={};Object.defineProperty(T,"__esModule",{value:!0}),T.DD=void 0,T.DD={get isDragging(){let t=!1;return T.DD._dragElements.forEach(e=>{"dragging"===e.dragStatus&&(t=!0)}),t},justDragged:!1,get node(){let t;return T.DD._dragElements.forEach(e=>{t=e.node}),t},_dragElements:new Map,_drag(t){let e=[];T.DD._dragElements.forEach((r,n)=>{let{node:i}=r,a=i.getStage();a.setPointersPositions(t),void 0===r.pointerId&&(r.pointerId=p.Util._getFirstPointerId(t));let o=a._changedPointerPositions.find(t=>t.id===r.pointerId);if(o){if("dragging"!==r.dragStatus){let e=i.dragDistance();if(Math.max(Math.abs(o.x-r.startPointerPos.x),Math.abs(o.y-r.startPointerPos.y))<e||(i.startDrag({evt:t}),!i.isDragging()))return}i._setDragPosition(t,r),e.push(i)}}),e.forEach(e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:t},!0)})},_endDragBefore(t){let e=[];T.DD._dragElements.forEach(r=>{let{node:n}=r,i=n.getStage();if(t&&i.setPointersPositions(t),!i._changedPointerPositions.find(t=>t.id===r.pointerId))return;("dragging"===r.dragStatus||"stopped"===r.dragStatus)&&(T.DD.justDragged=!0,f.Konva._mouseListenClick=!1,f.Konva._touchListenClick=!1,f.Konva._pointerListenClick=!1,r.dragStatus="stopped");let a=r.node.getLayer()||r.node instanceof f.Konva.Stage&&r.node;a&&-1===e.indexOf(a)&&e.push(a)}),e.forEach(t=>{t.draw()})},_endDragAfter(t){T.DD._dragElements.forEach((e,r)=>{"stopped"===e.dragStatus&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:t},!0),"dragging"!==e.dragStatus&&T.DD._dragElements.delete(r)})}},f.Konva.isBrowser&&(window.addEventListener("mouseup",T.DD._endDragBefore,!0),window.addEventListener("touchend",T.DD._endDragBefore,!0),window.addEventListener("touchcancel",T.DD._endDragBefore,!0),window.addEventListener("mousemove",T.DD._drag),window.addEventListener("touchmove",T.DD._drag),window.addEventListener("mouseup",T.DD._endDragAfter,!1),window.addEventListener("touchend",T.DD._endDragAfter,!1),window.addEventListener("touchcancel",T.DD._endDragAfter,!1));const k="absoluteOpacity",P="allEventListeners",O="absoluteTransform",I="absoluteScale",z="canvas",R="listening",U="mouseenter",L="mouseleave",G="Shape",j="stage",q="transform",V="visible";let H=1;class W{constructor(t){this._id=H++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===q||t===O)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){let r=this._cache.get(t),n=t===q||t===O;return(void 0===r||n&&!0===r.dirty)&&(r=e.call(this),this._cache.set(t,r)),r}_calculate(t,e,r){if(!this._attachedDepsListeners.get(t)){let r=e.map(t=>t+"Change.konva").join(" ");this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,r)}_getCanvasCache(){return this._cache.get(z)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===O&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(z)){let{scene:t,filter:e,hit:r}=this._cache.get(z);p.Util.releaseCanvas(t,e,r),this._cache.delete(z)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){let e=t||{},r={};(void 0===e.x||void 0===e.y||void 0===e.width||void 0===e.height)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let n=Math.ceil(e.width||r.width),i=Math.ceil(e.height||r.height),a=e.pixelRatio,o=void 0===e.x?Math.floor(r.x):e.x,s=void 0===e.y?Math.floor(r.y):e.y,u=e.offset||0,l=e.drawBorder||!1,h=e.hitCanvasPixelRatio||1;if(!n||!i){p.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}let c=Math.abs(Math.round(r.x)-o)>.5?1:0,f=Math.abs(Math.round(r.y)-s)>.5?1:0;n+=2*u+c,i+=2*u+f,o-=u,s-=u;let d=new F.SceneCanvas({pixelRatio:a,width:n,height:i}),g=new F.SceneCanvas({pixelRatio:a,width:0,height:0,willReadFrequently:!0}),m=new F.HitCanvas({pixelRatio:h,width:n,height:i}),y=d.getContext(),v=m.getContext();return m.isCache=!0,d.isCache=!0,this._cache.delete(z),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(d.getContext()._context.imageSmoothingEnabled=!1,g.getContext()._context.imageSmoothingEnabled=!1),y.save(),v.save(),y.translate(-o,-s),v.translate(-o,-s),this._isUnderCache=!0,this._clearSelfAndDescendantCache(k),this._clearSelfAndDescendantCache(I),this.drawScene(d,this),this.drawHit(m,this),this._isUnderCache=!1,y.restore(),v.restore(),l&&(y.save(),y.beginPath(),y.rect(0,0,n,i),y.closePath(),y.setAttr("strokeStyle","red"),y.setAttr("lineWidth",5),y.stroke(),y.restore()),this._cache.set(z,{scene:d,filter:g,hit:m,x:o,y:s}),this._requestDraw(),this}isCached(){return this._cache.has(z)}getClientRect(t){throw Error('abstract "getClientRect" method call')}_transformedRect(t,e){let r=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],n=1/0,i=1/0,a=-1/0,o=-1/0,s=this.getAbsoluteTransform(e);return r.forEach(function(t){let e=s.point(t);void 0===n&&(n=a=e.x,i=o=e.y),n=Math.min(n,e.x),i=Math.min(i,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y)}),{x:n,y:i,width:a-n,height:o-i}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);let e=this._getCanvasCache();t.translate(e.x,e.y);let r=this._getCachedSceneCanvas(),n=r.pixelRatio;t.drawImage(r._canvas,0,0,r.width/n,r.height/n),t.restore()}_drawCachedHitCanvas(t){let e=this._getCanvasCache(),r=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),e=this._getCanvasCache(),r=e.scene,n=e.filter,i=n.getContext(),a,o,s,u;if(t){if(!this._filterUpToDate){let e=r.pixelRatio;n.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(a=t.length,i.clear(),i.drawImage(r._canvas,0,0,r.getWidth()/e,r.getHeight()/e),o=i.getImageData(0,0,n.getWidth(),n.getHeight()),s=0;s<a;s++){if(u=t[s],"function"!=typeof u){p.Util.error("Filter should be type of function, but got "+typeof u+" instead. Please check correct filters");continue}u.call(this,o),i.putImageData(o,0,0)}}catch(t){p.Util.error("Unable to apply filter. "+t.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return n}return r}on(t,e){if(this._cache&&this._cache.delete(P),3==arguments.length)return this._delegate.apply(this,arguments);let r=t.split(" "),n=r.length,i,a,o,s;for(i=0;i<n;i++)o=(a=r[i].split("."))[0],s=a[1]||"",this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:s,handler:e});return this}off(t,e){let r=(t||"").split(" "),n=r.length,i,a,o,s,u;if(this._cache&&this._cache.delete(P),!t)for(a in this.eventListeners)this._off(a);for(i=0;i<n;i++)if(s=(o=r[i].split("."))[0],u=o[1],s)this.eventListeners[s]&&this._off(s,u,e);else for(a in this.eventListeners)this._off(a,u,e);return this}dispatchEvent(t){let e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(t){e.call(this,t.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,r){let n=this;this.on(t,function(t){let i=t.target.findAncestors(e,!0,n);for(let e=0;e<i.length;e++)(t=p.Util.cloneObject(t)).currentTarget=i[e],r.call(i[e],t)})}remove(){return this.isDragging()&&this.stopDrag(),T.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(O),this._clearSelfAndDescendantCache(k),this._clearSelfAndDescendantCache(I),this._clearSelfAndDescendantCache(j),this._clearSelfAndDescendantCache(V),this._clearSelfAndDescendantCache(R)}_remove(){this._clearCaches();let t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){let e="get"+p.Util._capitalize(t);return p.Util._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){let t=this.getParent(),e=[];for(;t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let e,r;if(!t)return this;for(e in t)"children"!==e&&(r="set"+p.Util._capitalize(e),p.Util._isFunction(this[r])?this[r](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(R,this._isListening)}_isListening(t){if(!this.listening())return!1;let e=this.getParent();return!e||e===t||this===t||e._isListening(t)}isVisible(){return this._getCache(V,this._isVisible)}_isVisible(t){if(!this.visible())return!1;let e=this.getParent();return!e||e===t||this===t||e._isVisible(t)}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);let r=this.getLayer(),n=!1;T.DD._dragElements.forEach(t=>{"dragging"===t.dragStatus&&("Stage"===t.node.nodeType?n=!0:t.node.getLayer()===r&&(n=!0))});let i=!e&&!f.Konva.hitOnDragEnabled&&(n||f.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!i}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),e=this,r=0,n,i,a,o,s=this.getStage();return"Stage"!==e.nodeType&&s&&function s(u){for(a=0,n=[],i=u.length;a<i;a++)o=u[a],r++,o.nodeType!==G&&(n=n.concat(o.getChildren().slice())),o._id===e._id&&(a=i);n.length>0&&n[0].getDepth()<=t&&s(n)}(s.getChildren()),r}getDepth(){let t=0,e=this.parent;for(;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(q),this._clearSelfAndDescendantCache(O)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let t=this.getStage();if(!t)return null;let e=t.getPointerPosition();if(!e)return null;let r=this.getAbsoluteTransform().copy();return r.invert(),r.point(e)}getAbsolutePosition(t){let e=!1,r=this.parent;for(;r;){if(r.isCached()){e=!0;break}r=r.parent}e&&!t&&(t=!0);let n=this.getAbsoluteTransform(t).getMatrix(),i=new p.Transform,a=this.offset();return i.m=n.slice(),i.translate(a.x,a.y),i.getTranslation()}setAbsolutePosition(t){let{x:e,y:r,...n}=this._clearTransform();this.attrs.x=e,this.attrs.y=r,this._clearCache(q);let i=this._getAbsoluteTransform().copy();return i.invert(),i.translate(t.x,t.y),t={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this._setTransform(n),this.setPosition({x:t.x,y:t.y}),this._clearCache(q),this._clearSelfAndDescendantCache(O),this}_setTransform(t){let e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){let t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let e=t.x,r=t.y,n=this.x(),i=this.y();return void 0!==e&&(n+=e),void 0!==r&&(i+=r),this.setPosition({x:n,y:i}),this}_eachAncestorReverse(t,e){let r=[],n=this.getParent(),i,a;if(!e||e._id!==this._id){for(r.unshift(this);n&&(!e||n._id!==e._id);)r.unshift(n),n=n.parent;for(a=0,i=r.length;a<i;a++)t(r[a])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return p.Util.warn("Node has no parent. moveToTop function is ignored."),!1;let t=this.index;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0)}moveUp(){if(!this.parent)return p.Util.warn("Node has no parent. moveUp function is ignored."),!1;let t=this.index;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return p.Util.warn("Node has no parent. moveDown function is ignored."),!1;let t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return p.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;let t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(t){if(!this.parent)return p.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&p.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");let e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(k,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),e,r,n,i,a={attrs:{},className:this.getClassName()};for(e in t)r=t[e],(!p.Util.isObject(r)||p.Util._isPlainObject(r)||p.Util._isArray(r))&&(n="function"==typeof this[e]&&this[e],delete t[e],i=n?n.call(this):null,t[e]=r,i!==r&&(a.attrs[e]=r));return p.Util._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,r){let n=[];e&&this._isMatch(t)&&n.push(this);let i=this.parent;for(;i&&i!==r;)i._isMatch(t)&&n.push(i),i=i.parent;return n}isAncestorOf(t){return!1}findAncestor(t,e,r){return this.findAncestors(t,e,r)[0]}_isMatch(t){if(!t)return!1;if("function"==typeof t)return t(this);let e=t.replace(/ /g,"").split(","),r=e.length,n,i;for(n=0;n<r;n++)if(i=e[n],p.Util.isValidSelector(i)||(p.Util.warn('Selector "'+i+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),p.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),p.Util.warn("Konva is awesome, right?")),"#"===i.charAt(0)){if(this.id()===i.slice(1))return!0}else if("."===i.charAt(0)){if(this.hasName(i.slice(1)))return!0}else if(this.className===i||this.nodeType===i)return!0;return!1}getLayer(){let t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(j,this._getStage)}_getStage(){let t=this.getParent();return t?t.getStage():null}fire(t,e={},r){return e.target=e.target||this,r?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(O,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let e;if(t)return e=new p.Transform,this._eachAncestorReverse(function(t){let r=t.transformsEnabled();"all"===r?e.multiply(t.getTransform()):"position"===r&&e.translate(t.x()-t.offsetX(),t.y()-t.offsetY())},t),e;{e=this._cache.get(O)||new p.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();let t=this.transformsEnabled();if("all"===t)e.multiply(this.getTransform());else if("position"===t){let t=this.attrs.x||0,r=this.attrs.y||0,n=this.attrs.offsetX||0,i=this.attrs.offsetY||0;e.translate(t-n,r-i)}return e.dirty=!1,e}}getAbsoluteScale(t){let e=this;for(;e;)e._isUnderCache&&(t=e),e=e.getParent();let r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(q,this._getTransform)}_getTransform(){var t,e;let r=this._cache.get(q)||new p.Transform;r.reset();let n=this.x(),i=this.y(),a=f.Konva.getAngle(this.rotation()),o=null!==(t=this.attrs.scaleX)&&void 0!==t?t:1,s=null!==(e=this.attrs.scaleY)&&void 0!==e?e:1,u=this.attrs.skewX||0,l=this.attrs.skewY||0,h=this.attrs.offsetX||0,c=this.attrs.offsetY||0;return(0!==n||0!==i)&&r.translate(n,i),0!==a&&r.rotate(a),(0!==u||0!==l)&&r.skew(u,l),(1!==o||1!==s)&&r.scale(o,s),(0!==h||0!==c)&&r.translate(-1*h,-1*c),r.dirty=!1,r}clone(t){let e=p.Util.cloneObject(this.attrs),r,n,i,a,o;for(r in t)e[r]=t[r];let s=new this.constructor(e);for(r in this.eventListeners)for(a=0,i=(n=this.eventListeners[r]).length;a<i;a++)0>(o=n[a]).name.indexOf("konva")&&(s.eventListeners[r]||(s.eventListeners[r]=[]),s.eventListeners[r].push(o));return s}_toKonvaCanvas(t){t=t||{};let e=this.getClientRect(),r=this.getStage(),n=void 0!==t.x?t.x:Math.floor(e.x),i=void 0!==t.y?t.y:Math.floor(e.y),a=t.pixelRatio||1,o=new F.SceneCanvas({width:t.width||Math.ceil(e.width)||(r?r.width():0),height:t.height||Math.ceil(e.height)||(r?r.height():0),pixelRatio:a}),s=o.getContext(),u=new F.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(n),height:o.height/o.pixelRatio+Math.abs(i),pixelRatio:o.pixelRatio});return!1===t.imageSmoothingEnabled&&(s._context.imageSmoothingEnabled=!1),s.save(),(n||i)&&s.translate(-1*n,-1*i),this.drawScene(o,void 0,u),s.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){let e=(t=t||{}).mimeType||null,r=t.quality||null,n=this._toKonvaCanvas(t).toDataURL(e,r);return t.callback&&t.callback(n),n}toImage(t){return new Promise((e,r)=>{try{let r=null==t?void 0:t.callback;r&&delete t.callback,p.Util._urlToImage(this.toDataURL(t),function(t){e(t),null==r||r(t)})}catch(t){r(t)}})}toBlob(t){return new Promise((e,r)=>{try{let r=null==t?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(t=>{e(t),null==r||r(t)},null==t?void 0:t.mimeType,null==t?void 0:t.quality)}catch(t){r(t)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():f.Konva.dragDistance}_off(t,e,r){let n=this.eventListeners[t],i,a,o;for(i=0;i<n.length;i++)if(a=n[i].name,o=n[i].handler,("konva"!==a||"konva"===e)&&(!e||a===e)&&(!r||r===o)){if(n.splice(i,1),0===n.length){delete this.eventListeners[t];break}i--}}_fireChangeEvent(t,e,r){this._fire(t+"Change",{oldVal:e,newVal:r})}addName(t){if(!this.hasName(t)){let e=this.name();this.name(e?e+" "+t:t)}return this}hasName(t){if(!t)return!1;let e=this.name();return!!e&&-1!==(e||"").split(/\s/g).indexOf(t)}removeName(t){let e=(this.name()||"").split(/\s/g),r=e.indexOf(t);return -1!==r&&(e.splice(r,1),this.name(e.join(" "))),this}setAttr(t,e){let r=this["set"+p.Util._capitalize(t)];return p.Util._isFunction(r)?r.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(f.Konva.autoDrawEnabled){let t=this.getLayer()||this.getStage();null==t||t.batchDraw()}}_setAttr(t,e){let r=this.attrs[t];(r!==e||p.Util.isObject(e))&&(null==e?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,r,e),this._requestDraw())}_setComponentAttr(t,e,r){let n;void 0!==r&&((n=this.attrs[t])||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=r,this._fireChangeEvent(t,n,r))}_fireAndBubble(t,e,r){if(e&&this.nodeType===G&&(e.target=this),!((t===U||t===L)&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||"Stage"===this.nodeType&&!r))){this._fire(t,e);let n=(t===U||t===L)&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!n&&(r&&r.parent?this._fireAndBubble.call(this.parent,t,e,r):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,r,n;let i=null!==(e=this._cache.get(P))&&void 0!==e?e:{},a=null==i?void 0:i[t];if(void 0===a){a=[];let e=Object.getPrototypeOf(this);for(;e;){let i=null!==(n=null===(r=e.eventListeners)||void 0===r?void 0:r[t])&&void 0!==n?n:[];a.push(...i),e=Object.getPrototypeOf(e)}i[t]=a,this._cache.set(P,i)}return a}_fire(t,e){(e=e||{}).currentTarget=this,e.type=t;let r=this._getProtoListeners(t);if(r)for(var n=0;n<r.length;n++)r[n].handler.call(this,e);let i=this.eventListeners[t];if(i)for(var n=0;n<i.length;n++)i[n].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){let e=t?t.pointerId:void 0,r=this.getStage(),n=this.getAbsolutePosition();if(!r)return;let i=r._getPointerById(e)||r._changedPointerPositions[0]||n;T.DD._dragElements.set(this._id,{node:this,startPointerPos:i,offset:{x:i.x-n.x,y:i.y-n.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){T.DD._dragElements.has(this._id)||this._createDragElement(t),T.DD._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){let r=this.getStage()._getPointerById(e.pointerId);if(!r)return;let n={x:r.x-e.offset.x,y:r.y-e.offset.y},i=this.dragBoundFunc();if(void 0!==i){let e=i.call(this,n,t);e?n=e:p.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===n.x&&this._lastPos.y===n.y||(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}stopDrag(t){let e=T.DD._dragElements.get(this._id);e&&(e.dragStatus="stopped"),T.DD._endDragBefore(t),T.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){let t=T.DD._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(void 0!==t.evt.button)||f.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let e=!1;T.DD._dragElements.forEach(t=>{this.isAncestorOf(t.node)&&(e=!0)}),e||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;let t=T.DD._dragElements.get(this._id),e=t&&"dragging"===t.dragStatus,r=t&&"ready"===t.dragStatus;e?this.stopDrag():r&&T.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){let e=this.getStage();if(!e)return!1;let r={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return p.Util.haveIntersection(r,this.getClientRect())}static create(t,e){return p.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){let r=W.prototype.getClassName.call(t),n=t.children,i,a,o;if(e&&(t.attrs.container=e),f.Konva[r]||(p.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape"),i=new f.Konva[r](t.attrs),n)for(o=0,a=n.length;o<a;o++)i.add(W._createNode(n[o]));return i}}w.Node=W,W.prototype.nodeType="Node",W.prototype._attrsAffectingSize=[],W.prototype.eventListeners={},W.prototype.on.call(W.prototype,"xChange.konva yChange.konva scaleXChange.konva scaleYChange.konva skewXChange.konva skewYChange.konva rotationChange.konva offsetXChange.konva offsetYChange.konva transformsEnabledChange.konva",function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(q),this._clearSelfAndDescendantCache(O)}),W.prototype.on.call(W.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(V)}),W.prototype.on.call(W.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(R)}),W.prototype.on.call(W.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(k)});const K=C.Factory.addGetterSetter;K(W,"zIndex"),K(W,"absolutePosition"),K(W,"position"),K(W,"x",0,(0,A.getNumberValidator)()),K(W,"y",0,(0,A.getNumberValidator)()),K(W,"globalCompositeOperation","source-over",(0,A.getStringValidator)()),K(W,"opacity",1,(0,A.getNumberValidator)()),K(W,"name","",(0,A.getStringValidator)()),K(W,"id","",(0,A.getStringValidator)()),K(W,"rotation",0,(0,A.getNumberValidator)()),C.Factory.addComponentsGetterSetter(W,"scale",["x","y"]),K(W,"scaleX",1,(0,A.getNumberValidator)()),K(W,"scaleY",1,(0,A.getNumberValidator)()),C.Factory.addComponentsGetterSetter(W,"skew",["x","y"]),K(W,"skewX",0,(0,A.getNumberValidator)()),K(W,"skewY",0,(0,A.getNumberValidator)()),C.Factory.addComponentsGetterSetter(W,"offset",["x","y"]),K(W,"offsetX",0,(0,A.getNumberValidator)()),K(W,"offsetY",0,(0,A.getNumberValidator)()),K(W,"dragDistance",null,(0,A.getNumberValidator)()),K(W,"width",0,(0,A.getNumberValidator)()),K(W,"height",0,(0,A.getNumberValidator)()),K(W,"listening",!0,(0,A.getBooleanValidator)()),K(W,"preventDefault",!0,(0,A.getBooleanValidator)()),K(W,"filters",null,function(t){return this._filterUpToDate=!1,t}),K(W,"visible",!0,(0,A.getBooleanValidator)()),K(W,"transformsEnabled","all",(0,A.getStringValidator)()),K(W,"size"),K(W,"dragBoundFunc"),K(W,"draggable",!1,(0,A.getBooleanValidator)()),C.Factory.backCompat(W,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Y={};Object.defineProperty(Y,"__esModule",{value:!0}),Y.Container=void 0;class X extends w.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];let e=this.children||[],r=[];return e.forEach(function(e){t(e)&&r.push(e)}),r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(0===t.length)return this;if(t.length>1){for(let e=0;e<t.length;e++)this.add(t[e]);return this}let e=t[0];return e.getParent()?e.moveTo(this):(this._validateAdd(e),e.index=this.getChildren().length,e.parent=this,e._clearCaches(),this.getChildren().push(e),this._fire("add",{child:e}),this._requestDraw()),this}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){let e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){let r=[];return this._descendants(n=>{let i=n._isMatch(t);return i&&r.push(n),!!i&&!!e}),r}_descendants(t){for(let e of this.getChildren())if(t(e)||e.hasChildren()&&e._descendants(t))return!0;return!1}toObject(){let t=w.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){let e=t.getParent();for(;e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){let e=w.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(t){e.add(t.clone())}),e}getAllIntersections(t){let e=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(t)&&e.push(r)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),this.isCached()||null===(e=this.children)||void 0===e||e.forEach(function(e){e._clearSelfAndDescendantCache(t)})}_setChildrenIndices(){var t;null===(t=this.children)||void 0===t||t.forEach(function(t,e){t.index=e}),this._requestDraw()}drawScene(t,e,r){let n=this.getLayer(),i=t||n&&n.getCanvas(),a=i&&i.getContext(),o=this._getCanvasCache(),s=o&&o.scene,u=i&&i.isCache;if(!this.isVisible()&&!u)return this;if(s){a.save();let t=this.getAbsoluteTransform(e).getMatrix();a.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this._drawCachedSceneCanvas(a),a.restore()}else this._drawChildren("drawScene",i,e,r);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;let r=this.getLayer(),n=t||r&&r.hitCanvas,i=n&&n.getContext(),a=this._getCanvasCache();if(a&&a.hit){i.save();let t=this.getAbsoluteTransform(e).getMatrix();i.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this._drawCachedHitCanvas(i),i.restore()}else this._drawChildren("drawHit",n,e);return this}_drawChildren(t,e,r,n){var i;let a=e&&e.getContext(),o=this.clipWidth(),s=this.clipHeight(),u=this.clipFunc(),l="number"==typeof o&&"number"==typeof s||u,h=r===this;if(l){let t;a.save();let e=this.getAbsoluteTransform(r),n=e.getMatrix();if(a.transform(n[0],n[1],n[2],n[3],n[4],n[5]),a.beginPath(),u)t=u.call(this,a,this);else{let t=this.clipX(),e=this.clipY();a.rect(t||0,e||0,o,s)}a.clip.apply(a,t),n=e.copy().invert().getMatrix(),a.transform(n[0],n[1],n[2],n[3],n[4],n[5])}let c=!h&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===t;c&&(a.save(),a._applyGlobalCompositeOperation(this)),null===(i=this.children)||void 0===i||i.forEach(function(i){i[t](e,r,n)}),c&&a.restore(),l&&a.restore()}getClientRect(t={}){var e;let r,n,i,a;let o=t.skipTransform,s=t.relativeTo,u={x:1/0,y:1/0,width:0,height:0},l=this;null===(e=this.children)||void 0===e||e.forEach(function(e){if(!e.visible())return;let o=e.getClientRect({relativeTo:l,skipShadow:t.skipShadow,skipStroke:t.skipStroke});(0!==o.width||0!==o.height)&&(void 0===r?(r=o.x,n=o.y,i=o.x+o.width,a=o.y+o.height):(r=Math.min(r,o.x),n=Math.min(n,o.y),i=Math.max(i,o.x+o.width),a=Math.max(a,o.y+o.height)))});let h=this.find("Shape"),c=!1;for(let t=0;t<h.length;t++)if(h[t]._isVisible(this)){c=!0;break}return(u=c&&void 0!==r?{x:r,y:n,width:i-r,height:a-n}:{x:0,y:0,width:0,height:0},o)?u:this._transformedRect(u,s)}}Y.Container=X,C.Factory.addComponentsGetterSetter(X,"clip",["x","y","width","height"]),C.Factory.addGetterSetter(X,"clipX",void 0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(X,"clipY",void 0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(X,"clipWidth",void 0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(X,"clipHeight",void 0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(X,"clipFunc");var $={};Object.defineProperty($,"__esModule",{value:!0}),$.Stage=$.stages=void 0;var Z={};Object.defineProperty(Z,"__esModule",{value:!0}),Z.getCapturedShape=function(t){return J.get(t)},Z.createEvent=tt,Z.hasPointerCapture=function(t,e){return J.get(t)===e},Z.setPointerCapture=function(t,e){te(t),e.getStage()&&(J.set(t,e),Q&&e._fire("gotpointercapture",tt(new PointerEvent("gotpointercapture"))))},Z.releaseCapture=te;const J=new Map,Q=void 0!==f.Konva._global.PointerEvent;function tt(t){return{evt:t,pointerId:t.pointerId}}function te(t,e){let r=J.get(t);if(!r)return;let n=r.getStage();n&&n.content,J.delete(t),Q&&r._fire("lostpointercapture",tt(new PointerEvent("lostpointercapture")))}const tr="mouseleave",tn="mouseover",ti="mouseenter",ta="mousemove",to="mousedown",ts="mouseup",tu="pointermove",tl="pointerdown",th="pointerup",tc="pointercancel",tf="pointerout",td="pointerleave",tp="pointerover",tg="pointerenter",tm="contextmenu",ty="touchstart",tv="touchend",tx="touchmove",tD="touchcancel",tb="wheel",t_=[[ti,"_pointerenter"],[to,"_pointerdown"],[ta,"_pointermove"],[ts,"_pointerup"],[tr,"_pointerleave"],[ty,"_pointerdown"],[tx,"_pointermove"],[tv,"_pointerup"],[tD,"_pointercancel"],[tn,"_pointerover"],[tb,"_wheel"],[tm,"_contextmenu"],[tl,"_pointerdown"],[tu,"_pointermove"],[th,"_pointerup"],[tc,"_pointercancel"],["lostpointercapture","_lostpointercapture"]],tw={mouse:{[tf]:"mouseout",[td]:tr,[tp]:tn,[tg]:ti,[tu]:ta,[tl]:to,[th]:ts,[tc]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[tf]:"touchout",[td]:"touchleave",[tp]:"touchover",[tg]:"touchenter",[tu]:tx,[tl]:ty,[th]:tv,[tc]:tD,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[tf]:tf,[td]:td,[tp]:tp,[tg]:tg,[tu]:tu,[tl]:tl,[th]:th,[tc]:tc,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},tC=t=>t.indexOf("pointer")>=0?"pointer":t.indexOf("touch")>=0?"touch":"mouse",tA=t=>{let e=tC(t);return"pointer"===e?f.Konva.pointerEventsEnabled&&tw.pointer:"touch"===e?tw.touch:"mouse"===e?tw.mouse:void 0};function tS(t={}){return(t.clipFunc||t.clipWidth||t.clipHeight)&&p.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}$.stages=[];class tF extends Y.Container{constructor(t){super(tS(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),$.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{tS(this.attrs)}),this._checkVisibility()}_validateAdd(t){let e="Layer"===t.getType(),r="FastLayer"===t.getType();e||r||p.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;let t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if("string"==typeof t){if("."===t.charAt(0)){let e=t.slice(1);t=document.getElementsByClassName(e)[0]}else{var e;e="#"!==t.charAt(0)?t:t.slice(1),t=document.getElementById(e)}if(!t)throw"Can not find container in document with id "+e}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let t=this.children,e=t.length,r;for(r=0;r<e;r++)t[r].clear();return this}clone(t){return t||(t={}),t.container="undefined"!=typeof document&&document.createElement("div"),Y.Container.prototype.clone.call(this,t)}destroy(){super.destroy();let t=this.content;t&&p.Util._isInDocument(t)&&this.container().removeChild(t);let e=$.stages.indexOf(this);return e>-1&&$.stages.splice(e,1),p.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(p.Util.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)}_getPointerById(t){return this._pointerPositions.find(e=>e.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){(t=t||{}).x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();let e=new F.SceneCanvas({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),r=e.getContext()._context,n=this.children;return(t.x||t.y)&&r.translate(-1*t.x,-1*t.y),n.forEach(function(e){if(!e.isVisible())return;let n=e._toKonvaCanvas(t);r.drawImage(n._canvas,t.x,t.y,n.getWidth()/n.getPixelRatio(),n.getHeight()/n.getPixelRatio())}),e}getIntersection(t){if(!t)return null;let e=this.children,r;for(r=e.length-1;r>=0;r--){let n=e[r].getIntersection(t);if(n)return n}return null}_resizeDOM(){let t=this.width(),e=this.height();this.content&&(this.content.style.width=t+"px",this.content.style.height=e+"px"),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach(r=>{r.setSize({width:t,height:e}),r.draw()})}add(t,...e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}super.add(t);let r=this.children.length;return r>5&&p.Util.warn("The stage has "+r+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),f.Konva.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Z.hasPointerCapture(t,this)}setPointerCapture(t){Z.setPointerCapture(t,this)}releaseCapture(t){Z.releaseCapture(t,this)}getLayers(){return this.children}_bindContentEvents(){f.Konva.isBrowser&&t_.forEach(([t,e])=>{this.content.addEventListener(t,t=>{this[e](t)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);let e=tA(t.type);e&&this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);let e=tA(t.type);e&&this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){let e=tA(t.type),r=tC(t.type);if(!e)return;this.setPointersPositions(t);let n=this._getTargetShape(r),i=!(f.Konva.isDragging()||f.Konva.isTransforming())||f.Konva.hitOnDragEnabled;n&&i?(n._fireAndBubble(e.pointerout,{evt:t}),n._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[r+"targetShape"]=null):i&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){let e=tA(t.type),r=tC(t.type);if(!e)return;this.setPointersPositions(t);let n=!1;this._changedPointerPositions.forEach(i=>{let a=this.getIntersection(i);if(T.DD.justDragged=!1,f.Konva["_"+r+"ListenClick"]=!0,!a||!a.isListening()){this[r+"ClickStartShape"]=void 0;return}f.Konva.capturePointerEventsEnabled&&a.setPointerCapture(i.id),this[r+"ClickStartShape"]=a,a._fireAndBubble(e.pointerdown,{evt:t,pointerId:i.id}),n=!0;let o=t.type.indexOf("touch")>=0;a.preventDefault()&&t.cancelable&&o&&t.preventDefault()}),n||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){let e=tA(t.type),r=tC(t.type);if(!e||(f.Konva.isDragging()&&T.DD.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t),!(!(f.Konva.isDragging()||f.Konva.isTransforming())||f.Konva.hitOnDragEnabled)))return;let n={},i=!1,a=this._getTargetShape(r);this._changedPointerPositions.forEach(o=>{let s=Z.getCapturedShape(o.id)||this.getIntersection(o),u=o.id,l={evt:t,pointerId:u},h=a!==s;if(h&&a&&(a._fireAndBubble(e.pointerout,{...l},s),a._fireAndBubble(e.pointerleave,{...l},s)),s){if(n[s._id])return;n[s._id]=!0}s&&s.isListening()?(i=!0,h&&(s._fireAndBubble(e.pointerover,{...l},a),s._fireAndBubble(e.pointerenter,{...l},a),this[r+"targetShape"]=s),s._fireAndBubble(e.pointermove,{...l})):a&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:u}),this[r+"targetShape"]=null)}),i||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){let e=tA(t.type),r=tC(t.type);if(!e)return;this.setPointersPositions(t);let n=this[r+"ClickStartShape"],i=this[r+"ClickEndShape"],a={},o=!1;this._changedPointerPositions.forEach(s=>{let u=Z.getCapturedShape(s.id)||this.getIntersection(s);if(u){if(u.releaseCapture(s.id),a[u._id])return;a[u._id]=!0}let l=s.id,h={evt:t,pointerId:l},c=!1;f.Konva["_"+r+"InDblClickWindow"]?(c=!0,clearTimeout(this[r+"DblTimeout"])):T.DD.justDragged||(f.Konva["_"+r+"InDblClickWindow"]=!0,clearTimeout(this[r+"DblTimeout"])),this[r+"DblTimeout"]=setTimeout(function(){f.Konva["_"+r+"InDblClickWindow"]=!1},f.Konva.dblClickWindow),u&&u.isListening()?(o=!0,this[r+"ClickEndShape"]=u,u._fireAndBubble(e.pointerup,{...h}),f.Konva["_"+r+"ListenClick"]&&n&&n===u&&(u._fireAndBubble(e.pointerclick,{...h}),c&&i&&i===u&&u._fireAndBubble(e.pointerdblclick,{...h}))):(this[r+"ClickEndShape"]=null,f.Konva["_"+r+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:l}),c&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:l}))}),o||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),f.Konva["_"+r+"ListenClick"]=!1,t.cancelable&&"touch"!==r&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);let e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(tm,{evt:t}):this._fire(tm,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);let e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(tb,{evt:t}):this._fire(tb,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);let e=Z.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(th,Z.createEvent(t)),Z.releaseCapture(t.pointerId)}_lostpointercapture(t){Z.releaseCapture(t.pointerId)}setPointersPositions(t){let e=this._getContentPosition(),r=null,n=null;void 0!==(t=t||window.event).touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,t=>{this._pointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,t=>{this._changedPointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})})):(r=(t.clientX-e.left)/e.scaleX,n=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:r,y:n},this._pointerPositions=[{x:r,y:n,id:p.Util._getFirstPointerId(t)}],this._changedPointerPositions=[{x:r,y:n,id:p.Util._getFirstPointerId(t)}])}_setPointerPosition(t){p.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new F.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new F.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!f.Konva.isBrowser)return;let t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return p.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}}$.Stage=tF,tF.prototype.nodeType="Stage",(0,f._registerNode)(tF),C.Factory.addGetterSetter(tF,"container"),f.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{$.stages.forEach(t=>{t.batchDraw()})});var tE={};Object.defineProperty(tE,"__esModule",{value:!0}),tE.Layer=void 0;var tM={};Object.defineProperty(tM,"__esModule",{value:!0}),tM.Shape=tM.shapes=void 0;const tN="hasShadow",tB="shadowRGBA",tT="patternImage",tk="linearGradient",tP="radialGradient";function tO(){return e||(e=p.Util.createCanvasElement().getContext("2d"))}tM.shapes={};class tI extends w.Node{constructor(t){let e;for(super(t);!(e=p.Util.getRandomColor())||e in tM.shapes;);this.colorKey=e,tM.shapes[e]=this}getContext(){return p.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return p.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(tN,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(tT,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let t=tO().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(t&&t.setTransform){let e=new p.Transform;e.translate(this.fillPatternX(),this.fillPatternY()),e.rotate(f.Konva.getAngle(this.fillPatternRotation())),e.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),e.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let r=e.getMatrix(),n="undefined"==typeof DOMMatrix?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);t.setTransform(n)}return t}}_getLinearGradient(){return this._getCache(tk,this.__getLinearGradient)}__getLinearGradient(){let t=this.fillLinearGradientColorStops();if(t){let e=tO(),r=this.fillLinearGradientStartPoint(),n=this.fillLinearGradientEndPoint(),i=e.createLinearGradient(r.x,r.y,n.x,n.y);for(let e=0;e<t.length;e+=2)i.addColorStop(t[e],t[e+1]);return i}}_getRadialGradient(){return this._getCache(tP,this.__getRadialGradient)}__getRadialGradient(){let t=this.fillRadialGradientColorStops();if(t){let e=tO(),r=this.fillRadialGradientStartPoint(),n=this.fillRadialGradientEndPoint(),i=e.createRadialGradient(r.x,r.y,this.fillRadialGradientStartRadius(),n.x,n.y,this.fillRadialGradientEndRadius());for(let e=0;e<t.length;e+=2)i.addColorStop(t[e],t[e+1]);return i}}getShadowRGBA(){return this._getCache(tB,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let t=p.Util.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let t=this.hitStrokeWidth();return"auto"===t?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){let e=this.getStage();if(!e)return!1;let r=e.bufferHitCanvas;return r.getContext().clear(),this.drawHit(r,void 0,!0),r.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return w.Node.prototype.destroy.call(this),delete tM.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!(null===(e=this.attrs.perfectDrawEnabled)||void 0===e||e))return!1;let r=t||this.hasFill(),n=this.hasStroke(),i=1!==this.getAbsoluteOpacity();if(r&&n&&i)return!0;let a=this.hasShadow(),o=this.shadowForStrokeEnabled();return!!r&&!!n&&!!a&&!!o}setStrokeHitEnabled(t){p.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){let t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let e=!1,r=this.getParent();for(;r;){if(r.isCached()){e=!0;break}r=r.getParent()}let n=t.skipTransform,i=t.relativeTo||e&&this.getStage()||void 0,a=this.getSelfRect(),o=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,s=a.width+o,u=a.height+o,l=!t.skipShadow&&this.hasShadow(),h=l?this.shadowOffsetX():0,c=l?this.shadowOffsetY():0,f=s+Math.abs(h),d=u+Math.abs(c),p=l&&this.shadowBlur()||0,g={width:f+2*p,height:d+2*p,x:-(o/2+p)+Math.min(h,0)+a.x,y:-(o/2+p)+Math.min(c,0)+a.y};return n?g:this._transformedRect(g,i)}drawScene(t,e,r){let n=this.getLayer(),i=t||n.getCanvas(),a=i.getContext(),o=this._getCanvasCache(),s=this.getSceneFunc(),u=this.hasShadow(),l,h,c=i.isCache,f=e===this;if(!this.isVisible()&&!f)return this;if(o){a.save();let t=this.getAbsoluteTransform(e).getMatrix();return a.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this._drawCachedSceneCanvas(a),a.restore(),this}if(!s)return this;if(a.save(),this._useBufferCanvas()&&!c){l=this.getStage();let t=r||l.bufferCanvas;(h=t.getContext()).clear(),h.save(),h._applyLineJoin(this);var d=this.getAbsoluteTransform(e).getMatrix();h.transform(d[0],d[1],d[2],d[3],d[4],d[5]),s.call(this,h,this),h.restore();let n=t.pixelRatio;u&&a._applyShadow(this),a._applyOpacity(this),a._applyGlobalCompositeOperation(this),a.drawImage(t._canvas,0,0,t.width/n,t.height/n)}else{if(a._applyLineJoin(this),!f){var d=this.getAbsoluteTransform(e).getMatrix();a.transform(d[0],d[1],d[2],d[3],d[4],d[5]),a._applyOpacity(this),a._applyGlobalCompositeOperation(this)}u&&a._applyShadow(this),s.call(this,a,this)}return a.restore(),this}drawHit(t,e,r=!1){if(!this.shouldDrawHit(e,r))return this;let n=this.getLayer(),i=t||n.hitCanvas,a=i&&i.getContext(),o=this.hitFunc()||this.sceneFunc(),s=this._getCanvasCache(),u=s&&s.hit;if(this.colorKey||p.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),u){a.save();let t=this.getAbsoluteTransform(e).getMatrix();return a.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this._drawCachedHitCanvas(a),a.restore(),this}if(!o)return this;if(a.save(),a._applyLineJoin(this),this!==e){let t=this.getAbsoluteTransform(e).getMatrix();a.transform(t[0],t[1],t[2],t[3],t[4],t[5])}return o.call(this,a,this),a.restore(),this}drawHitFromCache(t=0){let e=this._getCanvasCache(),r=this._getCachedSceneCanvas(),n=e.hit,i=n.getContext(),a=n.getWidth(),o=n.getHeight(),s,u,l,h,c;i.clear(),i.drawImage(r._canvas,0,0,a,o);try{for(c=0,l=(u=(s=i.getImageData(0,0,a,o)).data).length,h=p.Util._hexToRgb(this.colorKey);c<l;c+=4)u[c+3]>t?(u[c]=h.r,u[c+1]=h.g,u[c+2]=h.b,u[c+3]=255):u[c+3]=0;i.putImageData(s,0,0)}catch(t){p.Util.error("Unable to draw hit graph from cached scene canvas. "+t.message)}return this}hasPointerCapture(t){return Z.hasPointerCapture(t,this)}setPointerCapture(t){Z.setPointerCapture(t,this)}releaseCapture(t){Z.releaseCapture(t,this)}}tM.Shape=tI,tI.prototype._fillFunc=function(t){let e=this.attrs.fillRule;e?t.fill(e):t.fill()},tI.prototype._strokeFunc=function(t){t.stroke()},tI.prototype._fillFuncHit=function(t){let e=this.attrs.fillRule;e?t.fill(e):t.fill()},tI.prototype._strokeFuncHit=function(t){t.stroke()},tI.prototype._centroid=!1,tI.prototype.nodeType="Shape",(0,f._registerNode)(tI),tI.prototype.eventListeners={},tI.prototype.on.call(tI.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",function(){this._clearCache(tN)}),tI.prototype.on.call(tI.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",function(){this._clearCache(tB)}),tI.prototype.on.call(tI.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",function(){this._clearCache(tT)}),tI.prototype.on.call(tI.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",function(){this._clearCache(tk)}),tI.prototype.on.call(tI.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",function(){this._clearCache(tP)}),C.Factory.addGetterSetter(tI,"stroke",void 0,(0,A.getStringOrGradientValidator)()),C.Factory.addGetterSetter(tI,"strokeWidth",2,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(tI,"fillAfterStrokeEnabled",!1),C.Factory.addGetterSetter(tI,"hitStrokeWidth","auto",(0,A.getNumberOrAutoValidator)()),C.Factory.addGetterSetter(tI,"strokeHitEnabled",!0,(0,A.getBooleanValidator)()),C.Factory.addGetterSetter(tI,"perfectDrawEnabled",!0,(0,A.getBooleanValidator)()),C.Factory.addGetterSetter(tI,"shadowForStrokeEnabled",!0,(0,A.getBooleanValidator)()),C.Factory.addGetterSetter(tI,"lineJoin"),C.Factory.addGetterSetter(tI,"lineCap"),C.Factory.addGetterSetter(tI,"sceneFunc"),C.Factory.addGetterSetter(tI,"hitFunc"),C.Factory.addGetterSetter(tI,"dash"),C.Factory.addGetterSetter(tI,"dashOffset",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(tI,"shadowColor",void 0,(0,A.getStringValidator)()),C.Factory.addGetterSetter(tI,"shadowBlur",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(tI,"shadowOpacity",1,(0,A.getNumberValidator)()),C.Factory.addComponentsGetterSetter(tI,"shadowOffset",["x","y"]),C.Factory.addGetterSetter(tI,"shadowOffsetX",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(tI,"shadowOffsetY",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(tI,"fillPatternImage"),C.Factory.addGetterSetter(tI,"fill",void 0,(0,A.getStringOrGradientValidator)()),C.Factory.addGetterSetter(tI,"fillPatternX",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(tI,"fillPatternY",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(tI,"fillLinearGradientColorStops"),C.Factory.addGetterSetter(tI,"strokeLinearGradientColorStops"),C.Factory.addGetterSetter(tI,"fillRadialGradientStartRadius",0),C.Factory.addGetterSetter(tI,"fillRadialGradientEndRadius",0),C.Factory.addGetterSetter(tI,"fillRadialGradientColorStops"),C.Factory.addGetterSetter(tI,"fillPatternRepeat","repeat"),C.Factory.addGetterSetter(tI,"fillEnabled",!0),C.Factory.addGetterSetter(tI,"strokeEnabled",!0),C.Factory.addGetterSetter(tI,"shadowEnabled",!0),C.Factory.addGetterSetter(tI,"dashEnabled",!0),C.Factory.addGetterSetter(tI,"strokeScaleEnabled",!0),C.Factory.addGetterSetter(tI,"fillPriority","color"),C.Factory.addComponentsGetterSetter(tI,"fillPatternOffset",["x","y"]),C.Factory.addGetterSetter(tI,"fillPatternOffsetX",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(tI,"fillPatternOffsetY",0,(0,A.getNumberValidator)()),C.Factory.addComponentsGetterSetter(tI,"fillPatternScale",["x","y"]),C.Factory.addGetterSetter(tI,"fillPatternScaleX",1,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(tI,"fillPatternScaleY",1,(0,A.getNumberValidator)()),C.Factory.addComponentsGetterSetter(tI,"fillLinearGradientStartPoint",["x","y"]),C.Factory.addComponentsGetterSetter(tI,"strokeLinearGradientStartPoint",["x","y"]),C.Factory.addGetterSetter(tI,"fillLinearGradientStartPointX",0),C.Factory.addGetterSetter(tI,"strokeLinearGradientStartPointX",0),C.Factory.addGetterSetter(tI,"fillLinearGradientStartPointY",0),C.Factory.addGetterSetter(tI,"strokeLinearGradientStartPointY",0),C.Factory.addComponentsGetterSetter(tI,"fillLinearGradientEndPoint",["x","y"]),C.Factory.addComponentsGetterSetter(tI,"strokeLinearGradientEndPoint",["x","y"]),C.Factory.addGetterSetter(tI,"fillLinearGradientEndPointX",0),C.Factory.addGetterSetter(tI,"strokeLinearGradientEndPointX",0),C.Factory.addGetterSetter(tI,"fillLinearGradientEndPointY",0),C.Factory.addGetterSetter(tI,"strokeLinearGradientEndPointY",0),C.Factory.addComponentsGetterSetter(tI,"fillRadialGradientStartPoint",["x","y"]),C.Factory.addGetterSetter(tI,"fillRadialGradientStartPointX",0),C.Factory.addGetterSetter(tI,"fillRadialGradientStartPointY",0),C.Factory.addComponentsGetterSetter(tI,"fillRadialGradientEndPoint",["x","y"]),C.Factory.addGetterSetter(tI,"fillRadialGradientEndPointX",0),C.Factory.addGetterSetter(tI,"fillRadialGradientEndPointY",0),C.Factory.addGetterSetter(tI,"fillPatternRotation",0),C.Factory.addGetterSetter(tI,"fillRule",void 0,(0,A.getStringValidator)()),C.Factory.backCompat(tI,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const tz=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],tR=tz.length;class tU extends Y.Container{constructor(t){super(t),this.canvas=new F.SceneCanvas,this.hitCanvas=new F.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);let e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){w.Node.prototype.moveToTop.call(this);let t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!w.Node.prototype.moveUp.call(this))return!1;let t=this.getStage();return!!t&&!!t.content&&(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(w.Node.prototype.moveDown.call(this)){let t=this.getStage();if(t){let e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(w.Node.prototype.moveToBottom.call(this)){let t=this.getStage();if(t){let e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let t=this.getNativeCanvasElement();return w.Node.prototype.remove.call(this),t&&t.parentNode&&p.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){let e=t.getType();"Group"!==e&&"Shape"!==e&&p.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return(t=t||{}).width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=void 0!==t.x?t.x:this.x(),t.y=void 0!==t.y?t.y:this.y(),w.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){p.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){p.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,p.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let e=1,r=!1;for(;;){for(let n=0;n<tR;n++){let i=tz[n],a=this._getIntersection({x:t.x+i.x*e,y:t.y+i.y*e}),o=a.shape;if(o)return o;if(r=!!a.antialiased,!a.antialiased)break}if(!r)return null;e+=1}}_getIntersection(t){let e=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,n=r[3];if(255===n){let t=p.Util._rgbToHex(r[0],r[1],r[2]),e=tM.shapes["#"+t];return e?{shape:e}:{antialiased:!0}}return n>0?{antialiased:!0}:{}}drawScene(t,e){let r=this.getLayer(),n=t||r&&r.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),Y.Container.prototype.drawScene.call(this,n,e),this._fire("draw",{node:this}),this}drawHit(t,e){let r=this.getLayer(),n=t||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),Y.Container.prototype.drawHit.call(this,n,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){p.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return p.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let t=this.parent;this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return p.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}tE.Layer=tU,tU.prototype.nodeType="Layer",(0,f._registerNode)(tU),C.Factory.addGetterSetter(tU,"imageSmoothingEnabled",!0),C.Factory.addGetterSetter(tU,"clearBeforeDraw",!0),C.Factory.addGetterSetter(tU,"hitGraphEnabled",!0,(0,A.getBooleanValidator)());var tL={};Object.defineProperty(tL,"__esModule",{value:!0}),tL.FastLayer=void 0;class tG extends tE.Layer{constructor(t){super(t),this.listening(!1),p.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}tL.FastLayer=tG,tG.prototype.nodeType="FastLayer",(0,f._registerNode)(tG);var tj={};Object.defineProperty(tj,"__esModule",{value:!0}),tj.Group=void 0;class tq extends Y.Container{_validateAdd(t){let e=t.getType();"Group"!==e&&"Shape"!==e&&p.Util.throw("You may only add groups and shapes to groups.")}}tj.Group=tq,tq.prototype.nodeType="Group",(0,f._registerNode)(tq);var tV={};Object.defineProperty(tV,"__esModule",{value:!0}),tV.Animation=void 0;const tH=f.glob.performance&&f.glob.performance.now?function(){return f.glob.performance.now()}:function(){return new Date().getTime()};class tW{constructor(t,e){this.id=tW.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:tH(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){let e=this.layers,r=e.length;for(let n=0;n<r;n++)if(e[n]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){let t=tW.animations,e=t.length;for(let r=0;r<e;r++)if(t[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=tH(),tW._addAnimation(this),this}stop(){return tW._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){let e=t.id,r=this.animations,n=r.length;for(let t=0;t<n;t++)if(r[t].id===e){this.animations.splice(t,1);break}}static _runFrames(){let t={},e=this.animations;for(let r=0;r<e.length;r++){let n=e[r],i=n.layers,a=n.func;n._updateFrameObject(tH());let o=i.length;if(!a||!1!==a.call(n,n.frame))for(let e=0;e<o;e++){let r=i[e];void 0!==r._id&&(t[r._id]=r)}}for(let e in t)t.hasOwnProperty(e)&&t[e].batchDraw()}static _animationLoop(){tW.animations.length?(tW._runFrames(),p.Util.requestAnimFrame(tW._animationLoop)):tW.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,p.Util.requestAnimFrame(this._animationLoop))}}tV.Animation=tW,tW.animations=[],tW.animIdCounter=0,tW.animRunning=!1;var tK={};Object.defineProperty(tK,"__esModule",{value:!0}),tK.Easings=tK.Tween=void 0;let tY={node:1,duration:1,easing:1,onFinish:1,yoyo:1},tX=0,t$=["fill","stroke","shadowColor"];class tZ{constructor(t,e,r,n,i,a,o){this.prop=t,this.propFunc=e,this.begin=n,this._pos=n,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=r,this._change=i-this.begin,this.pause()}fire(t){let e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){let t=this.getTimer()-this._startTime;2===this.state?this.setTime(t):3===this.state&&this.setTime(this.duration-t)}pause(){this.state=1,this.fire("onPause")}getTimer(){return new Date().getTime()}}class tJ{constructor(t){let e=this,r=t.node,n=r._id,i,a=t.easing||tK.Easings.Linear,o=!!t.yoyo,s;i=void 0===t.duration?.3:0===t.duration?.001:t.duration,this.node=r,this._id=tX++;let u=r.getLayer()||(r instanceof f.Konva.Stage?r.getLayers():null);for(s in u||p.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new tV.Animation(function(){e.tween.onEnterFrame()},u),this.tween=new tZ(s,function(t){e._tweenFunc(t)},a,0,1,1e3*i,o),this._addListeners(),tJ.attrs[n]||(tJ.attrs[n]={}),tJ.attrs[n][this._id]||(tJ.attrs[n][this._id]={}),tJ.tweens[n]||(tJ.tweens[n]={}),t)void 0===tY[s]&&this._addAttr(s,t[s]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){let r=this.node,n=r._id,i,a,o,s,u,l,h,c;if((o=tJ.tweens[n][t])&&delete tJ.attrs[n][o][t],i=r.getAttr(t),p.Util._isArray(e)){if(a=[],u=Math.max(e.length,i.length),"points"===t&&e.length!==i.length&&(e.length>i.length?(h=i,i=p.Util._prepareArrayForTween(i,e,r.closed())):(l=e,e=p.Util._prepareArrayForTween(e,i,r.closed()))),0===t.indexOf("fill"))for(s=0;s<u;s++)if(s%2==0)a.push(e[s]-i[s]);else{let t=p.Util.colorToRGBA(i[s]);c=p.Util.colorToRGBA(e[s]),i[s]=t,a.push({r:c.r-t.r,g:c.g-t.g,b:c.b-t.b,a:c.a-t.a})}else for(s=0;s<u;s++)a.push(e[s]-i[s])}else -1!==t$.indexOf(t)?(i=p.Util.colorToRGBA(i),a={r:(c=p.Util.colorToRGBA(e)).r-i.r,g:c.g-i.g,b:c.b-i.b,a:c.a-i.a}):a=e-i;tJ.attrs[n][this._id][t]={start:i,diff:a,end:e,trueEnd:l,trueStart:h},tJ.tweens[n][t]=this._id}_tweenFunc(t){let e=this.node,r=tJ.attrs[e._id][this._id],n,i,a,o,s,u,l,h;for(n in r){if(a=(i=r[n]).start,o=i.diff,h=i.end,p.Util._isArray(a)){if(s=[],l=Math.max(a.length,h.length),0===n.indexOf("fill"))for(u=0;u<l;u++)u%2==0?s.push((a[u]||0)+o[u]*t):s.push("rgba("+Math.round(a[u].r+o[u].r*t)+","+Math.round(a[u].g+o[u].g*t)+","+Math.round(a[u].b+o[u].b*t)+","+(a[u].a+o[u].a*t)+")");else for(u=0;u<l;u++)s.push((a[u]||0)+o[u]*t)}else s=-1!==t$.indexOf(n)?"rgba("+Math.round(a.r+o.r*t)+","+Math.round(a.g+o.g*t)+","+Math.round(a.b+o.b*t)+","+(a.a+o.a*t)+")":a+o*t;e.setAttr(n,s)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let t=this.node,e=tJ.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let t=this.node,e=tJ.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(1e3*t),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let t=this.node._id,e=this._id,r=tJ.tweens[t],n;for(n in this.pause(),r)delete tJ.tweens[t][n];delete tJ.attrs[t][e]}}tK.Tween=tJ,tJ.attrs={},tJ.tweens={},w.Node.prototype.to=function(t){let e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()},new tJ(t).play()},tK.Easings={BackEaseIn:(t,e,r,n)=>r*(t/=n)*t*(2.70158*t-1.70158)+e,BackEaseOut:(t,e,r,n)=>r*((t=t/n-1)*t*(2.70158*t+1.70158)+1)+e,BackEaseInOut(t,e,r,n){let i=1.70158;return(t/=n/2)<1?r/2*(t*t*(((i*=1.525)+1)*t-i))+e:r/2*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)+e},ElasticEaseIn(t,e,r,n,i,a){let o=0;return 0===t?e:1==(t/=n)?e+r:(a||(a=.3*n),!i||i<Math.abs(r)?(i=r,o=a/4):o=a/(2*Math.PI)*Math.asin(r/i),-(i*Math.pow(2,10*(t-=1))*Math.sin(2*Math.PI*(t*n-o)/a))+e)},ElasticEaseOut(t,e,r,n,i,a){let o=0;return 0===t?e:1==(t/=n)?e+r:(a||(a=.3*n),!i||i<Math.abs(r)?(i=r,o=a/4):o=a/(2*Math.PI)*Math.asin(r/i),i*Math.pow(2,-10*t)*Math.sin(2*Math.PI*(t*n-o)/a)+r+e)},ElasticEaseInOut(t,e,r,n,i,a){let o=0;return 0===t?e:2==(t/=n/2)?e+r:(a||(a=.3*1.5*n),!i||i<Math.abs(r)?(i=r,o=a/4):o=a/(2*Math.PI)*Math.asin(r/i),t<1)?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin(2*Math.PI*(t*n-o)/a))+e:i*Math.pow(2,-10*(t-=1))*Math.sin(2*Math.PI*(t*n-o)/a)*.5+r+e},BounceEaseOut:(t,e,r,n)=>(t/=n)<1/2.75?7.5625*t*t*r+e:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+e:r*(7.5625*(t-=2.625/2.75)*t+.984375)+e,BounceEaseIn:(t,e,r,n)=>r-tK.Easings.BounceEaseOut(n-t,0,r,n)+e,BounceEaseInOut:(t,e,r,n)=>t<n/2?.5*tK.Easings.BounceEaseIn(2*t,0,r,n)+e:.5*tK.Easings.BounceEaseOut(2*t-n,0,r,n)+.5*r+e,EaseIn:(t,e,r,n)=>r*(t/=n)*t+e,EaseOut:(t,e,r,n)=>-r*(t/=n)*(t-2)+e,EaseInOut:(t,e,r,n)=>(t/=n/2)<1?r/2*t*t+e:-r/2*(--t*(t-2)-1)+e,StrongEaseIn:(t,e,r,n)=>r*(t/=n)*t*t*t*t+e,StrongEaseOut:(t,e,r,n)=>r*((t=t/n-1)*t*t*t*t+1)+e,StrongEaseInOut:(t,e,r,n)=>(t/=n/2)<1?r/2*t*t*t*t*t+e:r/2*((t-=2)*t*t*t*t+2)+e,Linear:(t,e,r,n)=>r*t/n+e},c.Konva=p.Util._assign(f.Konva,{Util:p.Util,Transform:p.Transform,Node:w.Node,Container:Y.Container,Stage:$.Stage,stages:$.stages,Layer:tE.Layer,FastLayer:tL.FastLayer,Group:tj.Group,DD:T.DD,Shape:tM.Shape,shapes:tM.shapes,Animation:tV.Animation,Tween:tK.Tween,Easings:tK.Easings,Context:E.Context,Canvas:F.Canvas}),c.default=c.Konva;var tQ={};Object.defineProperty(tQ,"__esModule",{value:!0}),tQ.Arc=void 0;class t0 extends tM.Shape{_sceneFunc(t){let e=f.Konva.getAngle(this.angle()),r=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,r),t.arc(0,0,this.innerRadius(),e,0,!r),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){let t=this.innerRadius(),e=this.outerRadius(),r=this.clockwise(),n=f.Konva.getAngle(r?360-this.angle():this.angle()),i=Math.cos(Math.min(n,Math.PI)),a=Math.sin(Math.min(Math.max(Math.PI,n),3*Math.PI/2)),o=Math.sin(Math.min(n,Math.PI/2)),s=i*(i>0?t:e),u=a*(a>0?t:e),l=o*(o>0?e:t);return{x:s,y:r?-1*l:u,width:1*e-s,height:l-u}}}tQ.Arc=t0,t0.prototype._centroid=!0,t0.prototype.className="Arc",t0.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,f._registerNode)(t0),C.Factory.addGetterSetter(t0,"innerRadius",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(t0,"outerRadius",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(t0,"angle",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(t0,"clockwise",!1,(0,A.getBooleanValidator)());var t1={};Object.defineProperty(t1,"__esModule",{value:!0}),t1.Arrow=void 0;var t2={};function t5(t,e,r,n,i,a,o){let s=Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),u=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),l=o*s/(s+u),h=o*u/(s+u);return[r-l*(i-t),n-l*(a-e),r+h*(i-t),n+h*(a-e)]}function t3(t,e){let r=t.length,n=[];for(let i=2;i<r-2;i+=2){let r=t5(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e);isNaN(r[0])||(n.push(r[0]),n.push(r[1]),n.push(t[i]),n.push(t[i+1]),n.push(r[2]),n.push(r[3]))}return n}Object.defineProperty(t2,"__esModule",{value:!0}),t2.Line=void 0;class t4 extends tM.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){let e=this.points(),r=e.length,n=this.tension(),i=this.closed(),a=this.bezier(),o,s,u;if(r){if(t.beginPath(),t.moveTo(e[0],e[1]),0!==n&&r>4){for(s=(o=this.getTensionPoints()).length,u=i?0:4,i||t.quadraticCurveTo(o[0],o[1],o[2],o[3]);u<s-2;)t.bezierCurveTo(o[u++],o[u++],o[u++],o[u++],o[u++],o[u++]);i||t.quadraticCurveTo(o[s-2],o[s-1],e[r-2],e[r-1])}else if(a)for(u=2;u<r;)t.bezierCurveTo(e[u++],e[u++],e[u++],e[u++],e[u++],e[u++]);else for(u=2;u<r;u+=2)t.lineTo(e[u],e[u+1]);i?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():t3(this.points(),this.tension())}_getTensionPointsClosed(){let t=this.points(),e=t.length,r=this.tension(),n=t5(t[e-2],t[e-1],t[0],t[1],t[2],t[3],r),i=t5(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],r),a=t3(t,r);return[n[2],n[3]].concat(a).concat([i[0],i[1],t[e-2],t[e-1],i[2],i[3],n[0],n[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t,e,r=this.points();if(r.length<4)return{x:r[0]||0,y:r[1]||0,width:0,height:0};let n=(r=0!==this.tension()?[r[0],r[1],...this._getTensionPoints(),r[r.length-2],r[r.length-1]]:this.points())[0],i=r[0],a=r[1],o=r[1];for(let s=0;s<r.length/2;s++)t=r[2*s],e=r[2*s+1],n=Math.min(n,t),i=Math.max(i,t),a=Math.min(a,e),o=Math.max(o,e);return{x:n,y:a,width:i-n,height:o-a}}}t2.Line=t4,t4.prototype.className="Line",t4.prototype._attrsAffectingSize=["points","bezier","tension"],(0,f._registerNode)(t4),C.Factory.addGetterSetter(t4,"closed",!1),C.Factory.addGetterSetter(t4,"bezier",!1),C.Factory.addGetterSetter(t4,"tension",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(t4,"points",[],(0,A.getNumberArrayValidator)());var t8={};Object.defineProperty(t8,"__esModule",{value:!0}),t8.Path=void 0;var t6={};Object.defineProperty(t6,"__esModule",{value:!0}),t6.t2length=t6.getQuadraticArcLength=t6.getCubicArcLength=t6.binomialCoefficients=t6.cValues=t6.tValues=void 0,t6.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t6.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t6.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]],t6.getCubicArcLength=(t,e,r)=>{let n,i;let a=r/2;n=0;for(let r=0;r<20;r++)i=a*t6.tValues[20][r]+a,n+=t6.cValues[20][r]*function(t,e,r){let n=t9(1,r,t),i=t9(1,r,e);return Math.sqrt(n*n+i*i)}(t,e,i);return a*n},t6.getQuadraticArcLength=(t,e,r)=>{void 0===r&&(r=1);let n=t[0]-2*t[1]+t[2],i=e[0]-2*e[1]+e[2],a=2*t[1]-2*t[0],o=2*e[1]-2*e[0],s=4*(n*n+i*i);if(0===s)return r*Math.sqrt(Math.pow(t[2]-t[0],2)+Math.pow(e[2]-e[0],2));let u=4*(n*a+i*o)/(2*s),l=r+u,h=(a*a+o*o)/s-u*u,c=l*l+h>0?Math.sqrt(l*l+h):0,f=u*u+h>0?Math.sqrt(u*u+h):0,d=u+Math.sqrt(u*u+h)!==0?h*Math.log(Math.abs((l+c)/(u+f))):0;return Math.sqrt(s)/2*(l*c-u*f+d)};const t9=(t,e,r)=>{let n,i;let a=r.length-1;if(0===a)return 0;if(0===t){i=0;for(let t=0;t<=a;t++)i+=t6.binomialCoefficients[a][t]*Math.pow(1-e,a-t)*Math.pow(e,t)*r[t];return i}n=Array(a);for(let t=0;t<a;t++)n[t]=a*(r[t+1]-r[t]);return t9(t-1,e,n)};t6.t2length=(t,e,r)=>{let n=1,i=t/e,a=(t-r(i))/e,o=0;for(;n>.001;){let s=Math.abs(t-r(i+a))/e;if(s<n)n=s,i+=a;else{let o=Math.abs(t-r(i-a))/e;o<n?(n=o,i-=a):a/=2}if(++o>500)break}return i};class t7 extends tM.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=t7.parsePathData(this.data()),this.pathLength=t7.getPathLength(this.dataArray)}_sceneFunc(t){let e=this.dataArray;t.beginPath();let r=!1;for(let p=0;p<e.length;p++){let g=e[p].command,m=e[p].points;switch(g){case"L":t.lineTo(m[0],m[1]);break;case"M":t.moveTo(m[0],m[1]);break;case"C":t.bezierCurveTo(m[0],m[1],m[2],m[3],m[4],m[5]);break;case"Q":t.quadraticCurveTo(m[0],m[1],m[2],m[3]);break;case"A":var n=m[0],i=m[1],a=m[2],o=m[3],s=m[4],u=m[5],l=m[6],h=m[7],c=a>o?a:o,f=a>o?1:a/o,d=a>o?o/a:1;t.translate(n,i),t.rotate(l),t.scale(f,d),t.arc(0,0,c,s,s+u,1-h),t.scale(1/f,1/d),t.rotate(-l),t.translate(-n,-i);break;case"z":r=!0,t.closePath()}}r||this.hasFill()?t.fillStrokeShape(this):t.strokeShape(this)}getSelfRect(){let t,e,r=[];this.dataArray.forEach(function(t){if("A"===t.command){let e=t.points[4],n=t.points[5],i=t.points[4]+n,a=Math.PI/180;if(Math.abs(e-i)<a&&(a=Math.abs(e-i)),n<0)for(let n=e-a;n>i;n-=a){let e=t7.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],n,0);r.push(e.x,e.y)}else for(let n=e+a;n<i;n+=a){let e=t7.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],n,0);r.push(e.x,e.y)}}else if("C"===t.command)for(let e=0;e<=1;e+=.01){let n=t7.getPointOnCubicBezier(e,t.start.x,t.start.y,t.points[0],t.points[1],t.points[2],t.points[3],t.points[4],t.points[5]);r.push(n.x,n.y)}else r=r.concat(t.points)});let n=r[0],i=r[0],a=r[1],o=r[1];for(let s=0;s<r.length/2;s++)t=r[2*s],e=r[2*s+1],isNaN(t)||(n=Math.min(n,t),i=Math.max(i,t)),isNaN(e)||(a=Math.min(a,e),o=Math.max(o,e));return{x:n,y:a,width:i-n,height:o-a}}getLength(){return this.pathLength}getPointAtLength(t){return t7.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,r,n){return Math.sqrt((r-t)*(r-t)+(n-e)*(n-e))}static getPathLength(t){let e=0;for(let r=0;r<t.length;++r)e+=t[r].pathLength;return e}static getPointAtLengthOfDataArray(t,e){let r,n=0,i=e.length;if(!i)return null;for(;n<i&&t>e[n].pathLength;)t-=e[n].pathLength,++n;if(n===i)return{x:(r=e[n-1].points.slice(-2))[0],y:r[1]};if(t<.01)return{x:(r=e[n].points.slice(0,2))[0],y:r[1]};let a=e[n],o=a.points;switch(a.command){case"L":return t7.getPointOnLine(t,a.start.x,a.start.y,o[0],o[1]);case"C":return t7.getPointOnCubicBezier((0,t6.t2length)(t,t7.getPathLength(e),t=>(0,t6.getCubicArcLength)([a.start.x,o[0],o[2],o[4]],[a.start.y,o[1],o[3],o[5]],t)),a.start.x,a.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return t7.getPointOnQuadraticBezier((0,t6.t2length)(t,t7.getPathLength(e),t=>(0,t6.getQuadraticArcLength)([a.start.x,o[0],o[2]],[a.start.y,o[1],o[3]],t)),a.start.x,a.start.y,o[0],o[1],o[2],o[3]);case"A":var s=o[0],u=o[1],l=o[2],h=o[3],c=o[4],f=o[5],d=o[6];return c+=f*t/a.pathLength,t7.getPointOnEllipticalArc(s,u,l,h,c,d)}return null}static getPointOnLine(t,e,r,n,i,a,o){a=null!=a?a:e,o=null!=o?o:r;let s=this.getLineLength(e,r,n,i);if(s<1e-10)return{x:e,y:r};if(n===e)return{x:a,y:o+(i>r?t:-t)};let u=(i-r)/(n-e),l=Math.sqrt(t*t/(1+u*u))*(n<e?-1:1);if(1e-10>Math.abs(o-r-u*(a-e)))return{x:a+l,y:o+u*l};let h=((a-e)*(n-e)+(o-r)*(i-r))/(s*s),c=e+h*(n-e),f=r+h*(i-r),d=this.getLineLength(a,o,c,f),p=Math.sqrt(t*t-d*d),g=Math.sqrt(p*p/(1+u*u))*(n<e?-1:1);return{x:c+g,y:f+u*g}}static getPointOnCubicBezier(t,e,r,n,i,a,o,s,u){function l(t){return 3*t*(1-t)*(1-t)}return{x:t*t*t*s+3*t*t*(1-t)*a+n*l(t)+(1-t)*(1-t)*(1-t)*e,y:t*t*t*u+3*t*t*(1-t)*o+i*l(t)+(1-t)*(1-t)*(1-t)*r}}static getPointOnQuadraticBezier(t,e,r,n,i,a,o){return{x:t*t*a+2*t*(1-t)*n+(1-t)*(1-t)*e,y:t*t*o+2*t*(1-t)*i+(1-t)*(1-t)*r}}static getPointOnEllipticalArc(t,e,r,n,i,a){let o=Math.cos(a),s=Math.sin(a),u={x:r*Math.cos(i),y:n*Math.sin(i)};return{x:t+(u.x*o-u.y*s),y:e+(u.x*s+u.y*o)}}static parsePathData(t){let e;if(!t)return[];let r=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(RegExp(" ","g"),",");for(var i=0;i<n.length;i++)r=r.replace(RegExp(n[i],"g"),"|"+n[i]);let a=r.split("|"),o=[],s=[],u=0,l=0,h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(i=1;i<a.length;i++){let t=a[i],r=t.charAt(0);for(t=t.slice(1),s.length=0;e=h.exec(t);)s.push(e[0]);let n=[];for(let t=0,e=s.length;t<e;t++){if("00"===s[t]){n.push(0,0);continue}let e=parseFloat(s[t]);isNaN(e)?n.push(0):n.push(e)}for(;n.length>0&&!isNaN(n[0]);){let t="",e=[],i=u,a=l;switch(r){case"l":u+=n.shift(),l+=n.shift(),t="L",e.push(u,l);break;case"L":u=n.shift(),l=n.shift(),e.push(u,l);break;case"m":var c,f,d,p,g,m,y,v,x,D,b=n.shift(),_=n.shift();if(u+=b,l+=_,t="M",o.length>2&&"z"===o[o.length-1].command){for(let t=o.length-2;t>=0;t--)if("M"===o[t].command){u=o[t].points[0]+b,l=o[t].points[1]+_;break}}e.push(u,l),r="l";break;case"M":u=n.shift(),l=n.shift(),t="M",e.push(u,l),r="L";break;case"h":u+=n.shift(),t="L",e.push(u,l);break;case"H":u=n.shift(),t="L",e.push(u,l);break;case"v":l+=n.shift(),t="L",e.push(u,l);break;case"V":l=n.shift(),t="L",e.push(u,l);break;case"C":e.push(n.shift(),n.shift(),n.shift(),n.shift()),u=n.shift(),l=n.shift(),e.push(u,l);break;case"c":e.push(u+n.shift(),l+n.shift(),u+n.shift(),l+n.shift()),u+=n.shift(),l+=n.shift(),t="C",e.push(u,l);break;case"S":f=u,d=l,"C"===(c=o[o.length-1]).command&&(f=u+(u-c.points[2]),d=l+(l-c.points[3])),e.push(f,d,n.shift(),n.shift()),u=n.shift(),l=n.shift(),t="C",e.push(u,l);break;case"s":f=u,d=l,"C"===(c=o[o.length-1]).command&&(f=u+(u-c.points[2]),d=l+(l-c.points[3])),e.push(f,d,u+n.shift(),l+n.shift()),u+=n.shift(),l+=n.shift(),t="C",e.push(u,l);break;case"Q":e.push(n.shift(),n.shift()),u=n.shift(),l=n.shift(),e.push(u,l);break;case"q":e.push(u+n.shift(),l+n.shift()),u+=n.shift(),l+=n.shift(),t="Q",e.push(u,l);break;case"T":f=u,d=l,"Q"===(c=o[o.length-1]).command&&(f=u+(u-c.points[0]),d=l+(l-c.points[1])),u=n.shift(),l=n.shift(),t="Q",e.push(f,d,u,l);break;case"t":f=u,d=l,"Q"===(c=o[o.length-1]).command&&(f=u+(u-c.points[0]),d=l+(l-c.points[1])),u+=n.shift(),l+=n.shift(),t="Q",e.push(f,d,u,l);break;case"A":p=n.shift(),g=n.shift(),m=n.shift(),y=n.shift(),v=n.shift(),x=u,D=l,u=n.shift(),l=n.shift(),t="A",e=this.convertEndpointToCenterParameterization(x,D,u,l,y,v,p,g,m);break;case"a":p=n.shift(),g=n.shift(),m=n.shift(),y=n.shift(),v=n.shift(),x=u,D=l,u+=n.shift(),l+=n.shift(),t="A",e=this.convertEndpointToCenterParameterization(x,D,u,l,y,v,p,g,m)}o.push({command:t||r,points:e,start:{x:i,y:a},pathLength:this.calcLength(i,a,t||r,e)})}("z"===r||"Z"===r)&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(t,e,r,n){let i,a,o,s;switch(r){case"L":return t7.getLineLength(t,e,n[0],n[1]);case"C":return(0,t6.getCubicArcLength)([t,n[0],n[2],n[4]],[e,n[1],n[3],n[5]],1);case"Q":return(0,t6.getQuadraticArcLength)([t,n[0],n[2]],[e,n[1],n[3]],1);case"A":i=0;var u=n[4],l=n[5],h=n[4]+l,c=Math.PI/180;if(Math.abs(u-h)<c&&(c=Math.abs(u-h)),a=t7.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],u,0),l<0)for(s=u-c;s>h;s-=c)o=t7.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],s,0),i+=t7.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(s=u+c;s<h;s+=c)o=t7.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],s,0),i+=t7.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=t7.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),i+=t7.getLineLength(a.x,a.y,o.x,o.y)}return 0}static convertEndpointToCenterParameterization(t,e,r,n,i,a,o,s,u){let l=Math.PI/180*u,h=Math.cos(l)*(t-r)/2+Math.sin(l)*(e-n)/2,c=-1*Math.sin(l)*(t-r)/2+Math.cos(l)*(e-n)/2,f=h*h/(o*o)+c*c/(s*s);f>1&&(o*=Math.sqrt(f),s*=Math.sqrt(f));let d=Math.sqrt((o*o*(s*s)-o*o*(c*c)-s*s*(h*h))/(o*o*(c*c)+s*s*(h*h)));i===a&&(d*=-1),isNaN(d)&&(d=0);let p=d*o*c/s,g=-(d*s)*h/o,m=(t+r)/2+Math.cos(l)*p-Math.sin(l)*g,y=(e+n)/2+Math.sin(l)*p+Math.cos(l)*g,v=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},x=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(v(t)*v(e))},D=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(x(t,e))},b=D([1,0],[(h-p)/o,(c-g)/s]),_=[(h-p)/o,(c-g)/s],w=[(-1*h-p)/o,(-1*c-g)/s],C=D(_,w);return -1>=x(_,w)&&(C=Math.PI),x(_,w)>=1&&(C=0),0===a&&C>0&&(C-=2*Math.PI),1===a&&C<0&&(C+=2*Math.PI),[m,y,o,s,b,C,l,a]}}t8.Path=t7,t7.prototype.className="Path",t7.prototype._attrsAffectingSize=["data"],(0,f._registerNode)(t7),C.Factory.addGetterSetter(t7,"data");class et extends t2.Line{_sceneFunc(t){let e,r;super._sceneFunc(t);let n=2*Math.PI,i=this.points(),a=i,o=0!==this.tension()&&i.length>4;o&&(a=this.getTensionPoints());let s=this.pointerLength(),u=i.length;if(o){let t=[a[a.length-4],a[a.length-3],a[a.length-2],a[a.length-1],i[u-2],i[u-1]],n=t8.Path.calcLength(a[a.length-4],a[a.length-3],"C",t),o=t8.Path.getPointOnQuadraticBezier(Math.min(1,1-s/n),t[0],t[1],t[2],t[3],t[4],t[5]);e=i[u-2]-o.x,r=i[u-1]-o.y}else e=i[u-2]-i[u-4],r=i[u-1]-i[u-3];let l=(Math.atan2(r,e)+n)%n,h=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[u-2],i[u-1]),t.rotate(l),t.moveTo(0,0),t.lineTo(-s,h/2),t.lineTo(-s,-h/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),o?(e=(a[0]+a[2])/2-i[0],r=(a[1]+a[3])/2-i[1]):(e=i[2]-i[0],r=i[3]-i[1]),t.rotate((Math.atan2(-r,-e)+n)%n),t.moveTo(0,0),t.lineTo(-s,h/2),t.lineTo(-s,-h/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){let e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){let t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e}}}t1.Arrow=et,et.prototype.className="Arrow",(0,f._registerNode)(et),C.Factory.addGetterSetter(et,"pointerLength",10,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(et,"pointerWidth",10,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(et,"pointerAtBeginning",!1),C.Factory.addGetterSetter(et,"pointerAtEnding",!0);var ee={};Object.defineProperty(ee,"__esModule",{value:!0}),ee.Circle=void 0;class er extends tM.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}ee.Circle=er,er.prototype._centroid=!0,er.prototype.className="Circle",er.prototype._attrsAffectingSize=["radius"],(0,f._registerNode)(er),C.Factory.addGetterSetter(er,"radius",0,(0,A.getNumberValidator)());var en={};Object.defineProperty(en,"__esModule",{value:!0}),en.Ellipse=void 0;class ei extends tM.Shape{_sceneFunc(t){let e=this.radiusX(),r=this.radiusY();t.beginPath(),t.save(),e!==r&&t.scale(1,r/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}en.Ellipse=ei,ei.prototype.className="Ellipse",ei.prototype._centroid=!0,ei.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,f._registerNode)(ei),C.Factory.addComponentsGetterSetter(ei,"radius",["x","y"]),C.Factory.addGetterSetter(ei,"radiusX",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(ei,"radiusY",0,(0,A.getNumberValidator)());var ea={};Object.defineProperty(ea,"__esModule",{value:!0}),ea.Image=void 0;class eo extends tM.Shape{constructor(t){super(t),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let t=this.image();t&&t.complete||t&&4===t.readyState||!t||!t.addEventListener||t.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){let t=!!this.cornerRadius(),e=this.hasShadow();return!!t&&!!e||super._useBufferCanvas(!0)}_sceneFunc(t){let e;let r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;if(a){let t=this.attrs.cropWidth,i=this.attrs.cropHeight;e=t&&i?[a,this.cropX(),this.cropY(),t,i,0,0,r,n]:[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(t.beginPath(),i?p.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)),a&&(i&&t.clip(),t.drawImage.apply(t,e))}_hitFunc(t){let e=this.width(),r=this.height(),n=this.cornerRadius();t.beginPath(),n?p.Util.drawRoundedRectPath(t,e,r,n):t.rect(0,0,e,r),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return null!==(t=this.attrs.width)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.width}getHeight(){var t,e;return null!==(t=this.attrs.height)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.height}static fromURL(t,e,r=null){let n=p.Util.createImageElement();n.onload=function(){e(new eo({image:n}))},n.onerror=r,n.crossOrigin="Anonymous",n.src=t}}ea.Image=eo,eo.prototype.className="Image",(0,f._registerNode)(eo),C.Factory.addGetterSetter(eo,"cornerRadius",0,(0,A.getNumberOrArrayOfNumbersValidator)(4)),C.Factory.addGetterSetter(eo,"image"),C.Factory.addComponentsGetterSetter(eo,"crop",["x","y","width","height"]),C.Factory.addGetterSetter(eo,"cropX",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eo,"cropY",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eo,"cropWidth",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eo,"cropHeight",0,(0,A.getNumberValidator)());var es={};Object.defineProperty(es,"__esModule",{value:!0}),es.Tag=es.Label=void 0;const eu=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],el="right",eh="down",ec="left",ef=eu.length;class ed extends tj.Group{constructor(t){super(t),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let e=this,r,n=function(){e._sync()};for(r=0;r<ef;r++)t.on(eu[r]+"Change.konva",n)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),e=this.getTag(),r,n,i,a,o,s,u;if(t&&e){switch(r=t.width(),n=t.height(),i=e.pointerDirection(),a=e.pointerWidth(),u=e.pointerHeight(),o=0,s=0,i){case"up":o=r/2,s=-1*u;break;case el:o=r+a,s=n/2;break;case eh:o=r/2,s=n+u;break;case ec:o=-1*a,s=n/2}e.setAttrs({x:-1*o,y:-1*s,width:r,height:n}),t.setAttrs({x:-1*o,y:-1*s})}}}es.Label=ed,ed.prototype.className="Label",(0,f._registerNode)(ed);class ep extends tM.Shape{_sceneFunc(t){let e=this.width(),r=this.height(),n=this.pointerDirection(),i=this.pointerWidth(),a=this.pointerHeight(),o=this.cornerRadius(),s=0,u=0,l=0,h=0;"number"==typeof o?s=u=l=h=Math.min(o,e/2,r/2):(s=Math.min(o[0]||0,e/2,r/2),u=Math.min(o[1]||0,e/2,r/2),h=Math.min(o[2]||0,e/2,r/2),l=Math.min(o[3]||0,e/2,r/2)),t.beginPath(),t.moveTo(s,0),"up"===n&&(t.lineTo((e-i)/2,0),t.lineTo(e/2,-1*a),t.lineTo((e+i)/2,0)),t.lineTo(e-u,0),t.arc(e-u,u,u,3*Math.PI/2,0,!1),n===el&&(t.lineTo(e,(r-a)/2),t.lineTo(e+i,r/2),t.lineTo(e,(r+a)/2)),t.lineTo(e,r-h),t.arc(e-h,r-h,h,0,Math.PI/2,!1),n===eh&&(t.lineTo((e+i)/2,r),t.lineTo(e/2,r+a),t.lineTo((e-i)/2,r)),t.lineTo(l,r),t.arc(l,r-l,l,Math.PI/2,Math.PI,!1),n===ec&&(t.lineTo(0,(r+a)/2),t.lineTo(-1*i,r/2),t.lineTo(0,(r-a)/2)),t.lineTo(0,s),t.arc(s,s,s,Math.PI,3*Math.PI/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,e=0,r=this.pointerWidth(),n=this.pointerHeight(),i=this.pointerDirection(),a=this.width(),o=this.height();return"up"===i?(e-=n,o+=n):i===eh?o+=n:i===ec?(t-=1.5*r,a+=r):i===el&&(a+=1.5*r),{x:t,y:e,width:a,height:o}}}es.Tag=ep,ep.prototype.className="Tag",(0,f._registerNode)(ep),C.Factory.addGetterSetter(ep,"pointerDirection","none"),C.Factory.addGetterSetter(ep,"pointerWidth",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(ep,"pointerHeight",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(ep,"cornerRadius",0,(0,A.getNumberOrArrayOfNumbersValidator)(4));var eg={};Object.defineProperty(eg,"__esModule",{value:!0}),eg.Rect=void 0;class em extends tM.Shape{_sceneFunc(t){let e=this.cornerRadius(),r=this.width(),n=this.height();t.beginPath(),e?p.Util.drawRoundedRectPath(t,r,n,e):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}}eg.Rect=em,em.prototype.className="Rect",(0,f._registerNode)(em),C.Factory.addGetterSetter(em,"cornerRadius",0,(0,A.getNumberOrArrayOfNumbersValidator)(4));var ey={};Object.defineProperty(ey,"__esModule",{value:!0}),ey.RegularPolygon=void 0;class ev extends tM.Shape{_sceneFunc(t){let e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let r=1;r<e.length;r++)t.lineTo(e[r].x,e[r].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){let t=this.attrs.sides,e=this.attrs.radius||0,r=[];for(let n=0;n<t;n++)r.push({x:e*Math.sin(2*n*Math.PI/t),y:-1*e*Math.cos(2*n*Math.PI/t)});return r}getSelfRect(){let t=this._getPoints(),e=t[0].x,r=t[0].y,n=t[0].x,i=t[0].y;return t.forEach(t=>{e=Math.min(e,t.x),r=Math.max(r,t.x),n=Math.min(n,t.y),i=Math.max(i,t.y)}),{x:e,y:n,width:r-e,height:i-n}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}ey.RegularPolygon=ev,ev.prototype.className="RegularPolygon",ev.prototype._centroid=!0,ev.prototype._attrsAffectingSize=["radius"],(0,f._registerNode)(ev),C.Factory.addGetterSetter(ev,"radius",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(ev,"sides",0,(0,A.getNumberValidator)());var ex={};Object.defineProperty(ex,"__esModule",{value:!0}),ex.Ring=void 0;const eD=2*Math.PI;class eb extends tM.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,eD,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),eD,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}ex.Ring=eb,eb.prototype.className="Ring",eb.prototype._centroid=!0,eb.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,f._registerNode)(eb),C.Factory.addGetterSetter(eb,"innerRadius",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eb,"outerRadius",0,(0,A.getNumberValidator)());var e_={};Object.defineProperty(e_,"__esModule",{value:!0}),e_.Sprite=void 0;class ew extends tM.Shape{constructor(t){super(t),this._updated=!0,this.anim=new tV.Animation(()=>{let t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){let e=this.animation(),r=this.frameIndex(),n=4*r,i=this.animations()[e],a=this.frameOffsets(),o=i[n+0],s=i[n+1],u=i[n+2],l=i[n+3],h=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,u,l),t.closePath(),t.fillStrokeShape(this)),h){if(a){let n=a[e],i=2*r;t.drawImage(h,o,s,u,l,n[i+0],n[i+1],u,l)}else t.drawImage(h,o,s,u,l,0,0,u,l)}}_hitFunc(t){let e=this.animation(),r=this.frameIndex(),n=4*r,i=this.animations()[e],a=this.frameOffsets(),o=i[n+2],s=i[n+3];if(t.beginPath(),a){let n=a[e],i=2*r;t.rect(n[i+0],n[i+1],o,s)}else t.rect(0,0,o,s);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let t=this.frameIndex(),e=this.animation();t<this.animations()[e].length/4-1?this.frameIndex(t+1):this.frameIndex(0)}}e_.Sprite=ew,ew.prototype.className="Sprite",(0,f._registerNode)(ew),C.Factory.addGetterSetter(ew,"animation"),C.Factory.addGetterSetter(ew,"animations"),C.Factory.addGetterSetter(ew,"frameOffsets"),C.Factory.addGetterSetter(ew,"image"),C.Factory.addGetterSetter(ew,"frameIndex",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(ew,"frameRate",17,(0,A.getNumberValidator)()),C.Factory.backCompat(ew,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var eC={};Object.defineProperty(eC,"__esModule",{value:!0}),eC.Star=void 0;class eA extends tM.Shape{_sceneFunc(t){let e=this.innerRadius(),r=this.outerRadius(),n=this.numPoints();t.beginPath(),t.moveTo(0,0-r);for(let i=1;i<2*n;i++){let a=i%2==0?r:e,o=a*Math.sin(i*Math.PI/n),s=-1*a*Math.cos(i*Math.PI/n);t.lineTo(o,s)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}eC.Star=eA,eA.prototype.className="Star",eA.prototype._centroid=!0,eA.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,f._registerNode)(eA),C.Factory.addGetterSetter(eA,"numPoints",5,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eA,"innerRadius",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eA,"outerRadius",0,(0,A.getNumberValidator)());var eS={};function eF(t){return[...t].reduce((t,e,r,n)=>(/\p{Emoji_Modifier_Base}\p{Emoji_Modifier}?(?:\u200D\p{Emoji_Presentation})+/u.test(e)?t.push(e):/\p{Regional_Indicator}{2}/u.test(e+(n[r+1]||""))?t.push(e+n[r+1]):r>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(e)?t[t.length-1]+=e:t.push(e),t),[])}Object.defineProperty(eS,"__esModule",{value:!0}),eS.Text=void 0,eS.stringToArray=eF;const eE="auto",eM="inherit",eN="justify",eB="left",eT="middle",ek="normal",eP="none",eO=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],eI=eO.length;function ez(){return r||(r=p.Util.createCanvasElement().getContext("2d"))}class eR extends tM.Shape{constructor(t){var e;super(((e=(e=t)||{}).fillLinearGradientColorStops||e.fillRadialGradientColorStops||e.fillPatternImage||(e.fill=e.fill||"black"),e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<eI;t++)this.on(eO[t]+"Change.konva",this._setTextData);this._setTextData()}_sceneFunc(t){let e=this.textArr,r=e.length;if(!this.text())return;let n=this.padding(),i=this.fontSize(),a=this.lineHeight()*i,o=this.verticalAlign(),s=this.direction(),u=0,l=this.align(),h=this.getWidth(),c=this.letterSpacing(),d=this.fill(),p=this.textDecoration(),g=-1!==p.indexOf("underline"),m=-1!==p.indexOf("line-through"),y;s=s===eM?t.direction:s;let v=a/2,x=eT;if(f.Konva._fixTextRendering){let t=this.measureSize("M");x="alphabetic",v=(t.fontBoundingBoxAscent-t.fontBoundingBoxDescent)/2+a/2}var D=0,b=0;for("rtl"===s&&t.setAttr("direction",s),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",x),t.setAttr("textAlign",eB),o===eT?u=(this.getHeight()-r*a-2*n)/2:"bottom"===o&&(u=this.getHeight()-r*a-2*n),t.translate(n,u+n),y=0;y<r;y++){var _,w,C,D=0,b=0,A=e[y],S=A.text,F=A.width,E=A.lastInParagraph;if(t.save(),"right"===l?D+=h-F-2*n:"center"===l&&(D+=(h-F-2*n)/2),g){t.save(),t.beginPath();let e=f.Konva._fixTextRendering?Math.round(i/4):Math.round(i/2),r=D,a=v+b+e;t.moveTo(r,a),w=0==(_=S.split(" ").length-1),C=l!==eN||E?F:h-2*n,t.lineTo(r+Math.round(C),a),t.lineWidth=i/15;let o=this._getLinearGradient();t.strokeStyle=o||d,t.stroke(),t.restore()}if(m){t.save(),t.beginPath();let e=f.Konva._fixTextRendering?-Math.round(i/4):0;t.moveTo(D,v+b+e),w=0==(_=S.split(" ").length-1),C=l===eN&&E&&!w?h-2*n:F,t.lineTo(D+Math.round(C),v+b+e),t.lineWidth=i/15;let r=this._getLinearGradient();t.strokeStyle=r||d,t.stroke(),t.restore()}if("rtl"!==s&&(0!==c||l===eN)){_=S.split(" ").length-1;let e=eF(S);for(let r=0;r<e.length;r++){let i=e[r];" "!==i||E||l!==eN||(D+=(h-2*n-F)/_),this._partialTextX=D,this._partialTextY=v+b,this._partialText=i,t.fillStrokeShape(this),D+=this.measureSize(i).width+c}}else 0!==c&&t.setAttr("letterSpacing",`${c}px`),this._partialTextX=D,this._partialTextY=v+b,this._partialText=S,t.fillStrokeShape(this);t.restore(),r>1&&(v+=a)}}_hitFunc(t){let e=this.getWidth(),r=this.getHeight();t.beginPath(),t.rect(0,0,e,r),t.closePath(),t.fillStrokeShape(this)}setText(t){let e=p.Util._isString(t)?t:null==t?"":t+"";return this._setAttr("text",e),this}getWidth(){return this.attrs.width===eE||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){return this.attrs.height===eE||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return p.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,r,n,i,a,o,s,u,l,h,c;let f=ez(),d=this.fontSize(),p;f.save(),f.font=this._getContextFont(),p=f.measureText(t),f.restore();let g=d/100;return{actualBoundingBoxAscent:null!==(e=p.actualBoundingBoxAscent)&&void 0!==e?e:71.58203125*g,actualBoundingBoxDescent:null!==(r=p.actualBoundingBoxDescent)&&void 0!==r?r:0,actualBoundingBoxLeft:null!==(n=p.actualBoundingBoxLeft)&&void 0!==n?n:-7.421875*g,actualBoundingBoxRight:null!==(i=p.actualBoundingBoxRight)&&void 0!==i?i:75.732421875*g,alphabeticBaseline:null!==(a=p.alphabeticBaseline)&&void 0!==a?a:0,emHeightAscent:null!==(o=p.emHeightAscent)&&void 0!==o?o:100*g,emHeightDescent:null!==(s=p.emHeightDescent)&&void 0!==s?s:-20*g,fontBoundingBoxAscent:null!==(u=p.fontBoundingBoxAscent)&&void 0!==u?u:91*g,fontBoundingBoxDescent:null!==(l=p.fontBoundingBoxDescent)&&void 0!==l?l:21*g,hangingBaseline:null!==(h=p.hangingBaseline)&&void 0!==h?h:72.80000305175781*g,ideographicBaseline:null!==(c=p.ideographicBaseline)&&void 0!==c?c:-21*g,width:p.width,height:d}}_getContextFont(){return this.fontStyle()+" "+this.fontVariant()+" "+this.fontSize()+"px "+this.fontFamily().split(",").map(t=>{let e=(t=t.trim()).indexOf(" ")>=0,r=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!r&&(t=`"${t}"`),t}).join(", ")}_addTextLine(t){this.align()===eN&&(t=t.trim());let e=this._getTextWidth(t);return this.textArr.push({text:t,width:e,lastInParagraph:!1})}_getTextWidth(t){let e=this.letterSpacing(),r=t.length;return ez().measureText(t).width+(r?e*(r-1):0)}_setTextData(){let t=this.text().split("\n"),e=+this.fontSize(),r=0,n=this.lineHeight()*e,i=this.attrs.width,a=this.attrs.height,o=i!==eE&&void 0!==i,s=a!==eE&&void 0!==a,u=this.padding(),l=i-2*u,h=a-2*u,c=0,f=this.wrap(),d="char"!==f&&f!==eP,p=this.ellipsis();this.textArr=[],ez().font=this._getContextFont();let g=p?this._getTextWidth("…"):0;for(let e=0,i=t.length;e<i;++e){let a=t[e],u=this._getTextWidth(a);if(o&&u>l)for(;a.length>0;){let t=0,e=a.length,i="",o=0;for(;t<e;){let r=t+e>>>1,n=a.slice(0,r+1),s=this._getTextWidth(n)+g;s<=l?(t=r+1,i=n,o=s):e=r}if(i){if(d){var m;let e=a[i.length];(m=(" "===e||"-"===e)&&o<=l?i.length:Math.max(i.lastIndexOf(" "),i.lastIndexOf("-"))+1)>0&&(t=m,i=i.slice(0,t),o=this._getTextWidth(i))}if(i=i.trimRight(),this._addTextLine(i),r=Math.max(r,o),c+=n,this._shouldHandleEllipsis(c)){this._tryToAddEllipsisToLastLine();break}if((a=(a=a.slice(t)).trimLeft()).length>0&&(u=this._getTextWidth(a))<=l){this._addTextLine(a),c+=n,r=Math.max(r,u);break}}else break}else this._addTextLine(a),c+=n,r=Math.max(r,u),this._shouldHandleEllipsis(c)&&e<i-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),s&&c+n>h)break}this.textHeight=e,this.textWidth=r}_shouldHandleEllipsis(t){let e=+this.fontSize(),r=this.lineHeight()*e,n=this.attrs.height,i=this.padding();return!(this.wrap()!==eP)||n!==eE&&void 0!==n&&t+r>n-2*i}_tryToAddEllipsisToLastLine(){let t=this.attrs.width,e=this.padding(),r=this.ellipsis(),n=this.textArr[this.textArr.length-1];n&&r&&(t===eE||void 0===t||this._getTextWidth(n.text+"…")<t-2*e||(n.text=n.text.slice(0,n.text.length-3)),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(n.text+"…"))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let t=-1!==this.textDecoration().indexOf("underline")||-1!==this.textDecoration().indexOf("line-through"),e=this.hasShadow();return!!t&&!!e||super._useBufferCanvas()}}eS.Text=eR,eR.prototype._fillFunc=function(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)},eR.prototype._strokeFunc=function(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)},eR.prototype.className="Text",eR.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,f._registerNode)(eR),C.Factory.overWriteSetter(eR,"width",(0,A.getNumberOrAutoValidator)()),C.Factory.overWriteSetter(eR,"height",(0,A.getNumberOrAutoValidator)()),C.Factory.addGetterSetter(eR,"direction",eM),C.Factory.addGetterSetter(eR,"fontFamily","Arial"),C.Factory.addGetterSetter(eR,"fontSize",12,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eR,"fontStyle",ek),C.Factory.addGetterSetter(eR,"fontVariant",ek),C.Factory.addGetterSetter(eR,"padding",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eR,"align",eB),C.Factory.addGetterSetter(eR,"verticalAlign","top"),C.Factory.addGetterSetter(eR,"lineHeight",1,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eR,"wrap","word"),C.Factory.addGetterSetter(eR,"ellipsis",!1,(0,A.getBooleanValidator)()),C.Factory.addGetterSetter(eR,"letterSpacing",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eR,"text","",(0,A.getStringValidator)()),C.Factory.addGetterSetter(eR,"textDecoration","");var eU={};Object.defineProperty(eU,"__esModule",{value:!0}),eU.TextPath=void 0;const eL="normal";function eG(t){t.fillText(this.partialText,0,0)}function ej(t){t.strokeText(this.partialText,0,0)}class eq extends tM.Shape{constructor(t){super(t),this.dummyCanvas=p.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return t8.Path.getPathLength(this.dataArray)}_getPointAtLength(t){return!this.attrs.data||t-1>this.pathLength?null:t8.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=t8.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();let e=this.textDecoration(),r=this.fill(),n=this.fontSize(),i=this.glyphInfo;"underline"===e&&t.beginPath();for(let r=0;r<i.length;r++){t.save();let a=i[r].p0;t.translate(a.x,a.y),t.rotate(i[r].rotation),this.partialText=i[r].text,t.fillStrokeShape(this),"underline"===e&&(0===r&&t.moveTo(0,n/2+1),t.lineTo(n,n/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=r,t.lineWidth=n/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();let e=this.glyphInfo;if(e.length>=1){let r=e[0].p0;t.moveTo(r.x,r.y)}for(let r=0;r<e.length;r++){let n=e[r].p1;t.lineTo(n.x,n.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return p.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return eS.Text.prototype.setText.call(this,t)}_getContextFont(){return eS.Text.prototype._getContextFont.call(this)}_getTextSize(t){let e=this.dummyCanvas.getContext("2d");e.save(),e.font=this._getContextFont();let r=e.measureText(t);return e.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let{width:t,height:e}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=e,this.glyphInfo=[],!this.attrs.data)return null;let r=this.letterSpacing(),n=this.align(),i=this.kerningFunc(),a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0),o=0;"center"===n&&(o=Math.max(0,this.pathLength/2-a/2)),"right"===n&&(o=Math.max(0,this.pathLength-a));let s=(0,eS.stringToArray)(this.text()),u=o;for(let t=0;t<s.length;t++){let e=this._getPointAtLength(u);if(!e)return;let o=this._getTextSize(s[t]).width+r;if(" "===s[t]&&"justify"===n){let t=this.text().split(" ").length-1;o+=(this.pathLength-a)/t}let l=this._getPointAtLength(u+o);if(!l)return;let h=t8.Path.getLineLength(e.x,e.y,l.x,l.y),c=0;if(i)try{c=i(s[t-1],s[t])*this.fontSize()}catch(t){c=0}e.x+=c,l.x+=c,this.textWidth+=c;let f=t8.Path.getPointOnLine(c+h/2,e.x,e.y,l.x,l.y),d=Math.atan2(l.y-e.y,l.x-e.x);this.glyphInfo.push({transposeX:f.x,transposeY:f.y,text:s[t],rotation:d,p0:e,p1:l}),u+=o}}getSelfRect(){let t,e;if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let r=[];this.glyphInfo.forEach(function(t){r.push(t.p0.x),r.push(t.p0.y),r.push(t.p1.x),r.push(t.p1.y)});let n=r[0]||0,i=r[0]||0,a=r[1]||0,o=r[1]||0;for(let s=0;s<r.length/2;s++)t=r[2*s],e=r[2*s+1],n=Math.min(n,t),i=Math.max(i,t),a=Math.min(a,e),o=Math.max(o,e);let s=this.fontSize();return{x:n-s/2,y:a-s/2,width:i-n+s,height:o-a+s}}destroy(){return p.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}eU.TextPath=eq,eq.prototype._fillFunc=eG,eq.prototype._strokeFunc=ej,eq.prototype._fillFuncHit=eG,eq.prototype._strokeFuncHit=ej,eq.prototype.className="TextPath",eq.prototype._attrsAffectingSize=["text","fontSize","data"],(0,f._registerNode)(eq),C.Factory.addGetterSetter(eq,"data"),C.Factory.addGetterSetter(eq,"fontFamily","Arial"),C.Factory.addGetterSetter(eq,"fontSize",12,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eq,"fontStyle",eL),C.Factory.addGetterSetter(eq,"align","left"),C.Factory.addGetterSetter(eq,"letterSpacing",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(eq,"textBaseline","middle"),C.Factory.addGetterSetter(eq,"fontVariant",eL),C.Factory.addGetterSetter(eq,"text",""),C.Factory.addGetterSetter(eq,"textDecoration",null),C.Factory.addGetterSetter(eq,"kerningFunc",null);var eV={};Object.defineProperty(eV,"__esModule",{value:!0}),eV.Transformer=void 0;const eH="tr-konva",eW=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${eH}`).join(" "),eK="nodesRect",eY=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],eX={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},e$="ontouchstart"in f.Konva._global,eZ=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function eJ(t,e,r){let n=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),i=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:n,y:i}}let eQ=0;class e0 extends tj.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(eW,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return p.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return eH+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();let e=t.filter(t=>!t.isAncestorOf(this)||(p.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1));return this._nodes=t=e,1===t.length&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(t=>{let e=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),this._transforming||this.isDragging()||this.update()},r=t._attrsAffectingSize.map(t=>t+"Change."+this._getEventNamespace()).join(" ");t.on(r,e),t.on(eY.map(t=>t+`.${this._getEventNamespace()}`).join(" "),e),t.on(`absoluteTransformChange.${this._getEventNamespace()}`,e),this._proxyDrag(t)}),this._resetTransformCache(),this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,r=>{e=t.getAbsolutePosition(),this.isDragging()||t===this.findOne(".back")||this.startDrag(r,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!e)return;let n=t.getAbsolutePosition(),i=n.x-e.x,a=n.y-e.y;this.nodes().forEach(e=>{if(e===t||e.isDragging())return;let n=e.getAbsolutePosition();e.setAbsolutePosition({x:n.x+i,y:n.y+a}),e.startDrag(r)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(eK),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(eK,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),r){let n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),i=t.getAbsoluteScale(r),a=t.getAbsolutePosition(r),o=n.x*i.x-t.offsetX()*i.x,s=n.y*i.y-t.offsetY()*i.y,u=(f.Konva.getAngle(t.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI);return eJ({x:a.x+o*Math.cos(u)+s*Math.sin(-u),y:a.y+s*Math.cos(u)+o*Math.sin(u),width:n.width*i.x,height:n.height*i.y,rotation:u},-f.Konva.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};let t=[];this.nodes().map(e=>{let r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),n=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],i=e.getAbsoluteTransform();n.forEach(function(e){let r=i.point(e);t.push(r)})});let e=new p.Transform;e.rotate(-f.Konva.getAngle(this.rotation()));let r=1/0,n=1/0,i=-1/0,a=-1/0;t.forEach(function(t){let o=e.point(t);void 0===r&&(r=i=o.x,n=a=o.y),r=Math.min(r,o.x),n=Math.min(n,o.y),i=Math.max(i,o.x),a=Math.max(a,o.y)}),e.invert();let o=e.point({x:r,y:n});return{x:o.x,y:o.y,width:i-r,height:a-n,rotation:f.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),eZ.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){let e=new eg.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:e$?10:"auto"}),r=this;e.on("mousedown touchstart",function(t){r._handleMouseDown(t)}),e.on("dragstart",t=>{e.stopDrag(),t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),e.on("mouseenter",()=>{let r=function(t,e,r){if("rotater"===t)return r;e+=p.Util.degToRad(eX[t]||0);let n=(p.Util.radToDeg(e)%360+360)%360;return p.Util._inRange(n,337.5,360)||p.Util._inRange(n,0,22.5)?"ns-resize":p.Util._inRange(n,22.5,67.5)?"nesw-resize":p.Util._inRange(n,67.5,112.5)?"ew-resize":p.Util._inRange(n,112.5,157.5)?"nwse-resize":p.Util._inRange(n,157.5,202.5)?"ns-resize":p.Util._inRange(n,202.5,247.5)?"nesw-resize":p.Util._inRange(n,247.5,292.5)?"ew-resize":p.Util._inRange(n,292.5,337.5)?"nwse-resize":(p.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}(t,f.Konva.getAngle(this.rotation()),this.rotateAnchorCursor());e.getStage().content&&(e.getStage().content.style.cursor=r),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){let t=new tM.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(t,e){let r=e.getParent(),n=r.padding();t.beginPath(),t.rect(-n,-n,e.width()+2*n,e.height()+2*n),t.moveTo(e.width()/2,-n),r.rotateEnabled()&&r.rotateLineVisible()&&t.lineTo(e.width()/2,-r.rotateAnchorOffset()*p.Util._sign(e.height())-n),t.fillStrokeShape(e)},hitFunc:(t,e)=>{if(!this.shouldOverdrawWholeArea())return;let r=this.padding();t.beginPath(),t.rect(-r,-r,e.width()+2*r,e.height()+2*r),t.fillStrokeShape(e)}});this.add(t),this._proxyDrag(t),t.on("dragstart",t=>{t.cancelBubble=!0}),t.on("dragmove",t=>{t.cancelBubble=!0}),t.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];let e=this._getNodeRect(),r=e.width,n=e.height,i=Math.sqrt(Math.pow(r,2)+Math.pow(n,2));this.sin=Math.abs(n/i),this.cos=Math.abs(r/i),"undefined"!=typeof window&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;let a=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-a.x,y:o.y-a.y},eQ++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(e=>{e._fire("transformstart",{evt:t.evt,target:e})})}_handleMouseMove(t){let e,r,n,i;let a=this.findOne("."+this._movingAnchorName),o=a.getStage();o.setPointersPositions(t);let s=o.getPointerPosition(),u={x:s.x-this._anchorDragOffset.x,y:s.y-this._anchorDragOffset.y},l=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(l,u,t)),a.setAbsolutePosition(u);let h=a.getAbsolutePosition();if(l.x===h.x&&l.y===h.y)return;if("rotater"===this._movingAnchorName){let n=this._getNodeRect();e=a.x()-n.width/2;let i=Math.atan2(-(r=-a.y()+n.height/2),e)+Math.PI/2;n.height<0&&(i-=Math.PI);let o=f.Konva.getAngle(this.rotation())+i,s=f.Konva.getAngle(this.rotationSnapTolerance()),u=function(t,e,r){let n=e;for(let i=0;i<t.length;i++){let a=f.Konva.getAngle(t[i]),o=Math.abs(a-e)%(2*Math.PI);Math.min(o,2*Math.PI-o)<r&&(n=a)}return n}(this.rotationSnaps(),o,s)-n.rotation,l=function(t,e){let r={x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)};return eJ(t,e,r)}(n,u);this._fitNodesInto(l,t);return}let c=this.shiftBehavior();i="inverted"===c?this.keepRatio()&&!t.shiftKey:"none"===c?this.keepRatio():this.keepRatio()||t.shiftKey;var d=this.centeredScaling()||t.altKey;if("top-left"===this._movingAnchorName){if(i){var p=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};n=Math.sqrt(Math.pow(p.x-a.x(),2)+Math.pow(p.y-a.y(),2));var g=this.findOne(".top-left").x()>p.x?-1:1,m=this.findOne(".top-left").y()>p.y?-1:1;e=n*this.cos*g,r=n*this.sin*m,this.findOne(".top-left").x(p.x-e),this.findOne(".top-left").y(p.y-r)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(a.y());else if("top-right"===this._movingAnchorName){if(i){var p=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};n=Math.sqrt(Math.pow(a.x()-p.x,2)+Math.pow(p.y-a.y(),2));var g=this.findOne(".top-right").x()<p.x?-1:1,m=this.findOne(".top-right").y()>p.y?-1:1;e=n*this.cos*g,r=n*this.sin*m,this.findOne(".top-right").x(p.x+e),this.findOne(".top-right").y(p.y-r)}var y=a.position();this.findOne(".top-left").y(y.y),this.findOne(".bottom-right").x(y.x)}else if("middle-left"===this._movingAnchorName)this.findOne(".top-left").x(a.x());else if("middle-right"===this._movingAnchorName)this.findOne(".bottom-right").x(a.x());else if("bottom-left"===this._movingAnchorName){if(i){var p=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};n=Math.sqrt(Math.pow(p.x-a.x(),2)+Math.pow(a.y()-p.y,2));var g=p.x<a.x()?-1:1,m=a.y()<p.y?-1:1;e=n*this.cos*g,r=n*this.sin*m,a.x(p.x-e),a.y(p.y+r)}y=a.position(),this.findOne(".top-left").x(y.x),this.findOne(".bottom-right").y(y.y)}else if("bottom-center"===this._movingAnchorName)this.findOne(".bottom-right").y(a.y());else if("bottom-right"===this._movingAnchorName){if(i){var p=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};n=Math.sqrt(Math.pow(a.x()-p.x,2)+Math.pow(a.y()-p.y,2));var g=this.findOne(".bottom-right").x()<p.x?-1:1,m=this.findOne(".bottom-right").y()<p.y?-1:1;e=n*this.cos*g,r=n*this.sin*m,this.findOne(".bottom-right").x(p.x+e),this.findOne(".bottom-right").y(p.y+r)}}else console.error(Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var d=this.centeredScaling()||t.altKey;if(d){let t=this.findOne(".top-left"),e=this.findOne(".bottom-right"),r=t.x(),n=t.y(),i=this.getWidth()-e.x(),a=this.getHeight()-e.y();e.move({x:-r,y:-n}),t.move({x:i,y:a})}let v=this.findOne(".top-left").getAbsolutePosition();e=v.x,r=v.y;let x=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),D=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:r,width:x,height:D,rotation:f.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var e;if(this._transforming){this._transforming=!1,"undefined"!=typeof window&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));let r=this.getNode();eQ--,this._fire("transformend",{evt:t,target:r}),null===(e=this.getLayer())||void 0===e||e.batchDraw(),r&&this._nodes.forEach(e=>{var r;e._fire("transformend",{evt:t,target:e}),null===(r=e.getLayer())||void 0===r||r.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,e){let r=this._getNodeRect();if(p.Util._inRange(t.width,-(2*this.padding())-1,1)||p.Util._inRange(t.height,-(2*this.padding())-1,1)){this.update();return}let n=new p.Transform;if(n.rotate(f.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){let e=n.point({x:-(2*this.padding()),y:0});t.x+=e.x,t.y+=e.y,t.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){let e=n.point({x:2*this.padding(),y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.width+=2*this.padding()}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){let e=n.point({x:0,y:-(2*this.padding())});t.x+=e.x,t.y+=e.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding()}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){let e=n.point({x:0,y:2*this.padding()});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding()}if(this.boundBoxFunc()){let e=this.boundBoxFunc()(r,t);e?t=e:p.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}let i=new p.Transform;i.translate(r.x,r.y),i.rotate(r.rotation),i.scale(r.width/1e7,r.height/1e7);let a=new p.Transform,o=t.width/1e7,s=t.height/1e7;!1===this.flipEnabled()?(a.translate(t.x,t.y),a.rotate(t.rotation),a.translate(t.width<0?t.width:0,t.height<0?t.height:0),a.scale(Math.abs(o),Math.abs(s))):(a.translate(t.x,t.y),a.rotate(t.rotation),a.scale(o,s));let u=a.multiply(i.invert());this._nodes.forEach(t=>{var e;let r=t.getParent().getAbsoluteTransform(),n=t.getTransform().copy();n.translate(t.offsetX(),t.offsetY());let i=new p.Transform;i.multiply(r.copy().invert()).multiply(u).multiply(r).multiply(n);let a=i.decompose();t.setAttrs(a),null===(e=t.getLayer())||void 0===e||e.batchDraw()}),this.rotation(p.Util._getRotation(t.rotation)),this._nodes.forEach(t=>{this._fire("transform",{evt:e,target:t}),t._fire("transform",{evt:e,target:t})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t;let e=this._getNodeRect();this.rotation(p.Util._getRotation(e.rotation));let r=e.width,n=e.height,i=this.enabledAnchors(),a=this.resizeEnabled(),o=this.padding(),s=this.anchorSize(),u=this.find("._anchor");u.forEach(t=>{t.setAttrs({width:s,height:s,offsetX:s/2,offsetY:s/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:s/2+o,offsetY:s/2+o,visible:a&&i.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:s/2+o,visible:a&&i.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:s/2-o,offsetY:s/2+o,visible:a&&i.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:n/2,offsetX:s/2+o,visible:a&&i.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:n/2,offsetX:s/2-o,visible:a&&i.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:n,offsetX:s/2+o,offsetY:s/2-o,visible:a&&i.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:n,offsetY:s/2-o,visible:a&&i.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:n,offsetX:s/2-o,offsetY:s/2-o,visible:a&&i.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*p.Util._sign(n)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:n,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});let l=this.anchorStyleFunc();l&&u.forEach(t=>{l(t)}),null===(t=this.getLayer())||void 0===t||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),tj.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return w.Node.prototype.toObject.call(this)}clone(t){return w.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}eV.Transformer=e0,e0.isTransforming=()=>eQ>0,e0.prototype.className="Transformer",(0,f._registerNode)(e0),C.Factory.addGetterSetter(e0,"enabledAnchors",eZ,function(t){return t instanceof Array||p.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(t){-1===eZ.indexOf(t)&&p.Util.warn("Unknown anchor name: "+t+". Available names are: "+eZ.join(", "))}),t||[]}),C.Factory.addGetterSetter(e0,"flipEnabled",!0,(0,A.getBooleanValidator)()),C.Factory.addGetterSetter(e0,"resizeEnabled",!0),C.Factory.addGetterSetter(e0,"anchorSize",10,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(e0,"rotateEnabled",!0),C.Factory.addGetterSetter(e0,"rotateLineVisible",!0),C.Factory.addGetterSetter(e0,"rotationSnaps",[]),C.Factory.addGetterSetter(e0,"rotateAnchorOffset",50,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(e0,"rotateAnchorCursor","crosshair"),C.Factory.addGetterSetter(e0,"rotationSnapTolerance",5,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(e0,"borderEnabled",!0),C.Factory.addGetterSetter(e0,"anchorStroke","rgb(0, 161, 255)"),C.Factory.addGetterSetter(e0,"anchorStrokeWidth",1,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(e0,"anchorFill","white"),C.Factory.addGetterSetter(e0,"anchorCornerRadius",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(e0,"borderStroke","rgb(0, 161, 255)"),C.Factory.addGetterSetter(e0,"borderStrokeWidth",1,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(e0,"borderDash"),C.Factory.addGetterSetter(e0,"keepRatio",!0),C.Factory.addGetterSetter(e0,"shiftBehavior","default"),C.Factory.addGetterSetter(e0,"centeredScaling",!1),C.Factory.addGetterSetter(e0,"ignoreStroke",!1),C.Factory.addGetterSetter(e0,"padding",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(e0,"node"),C.Factory.addGetterSetter(e0,"nodes"),C.Factory.addGetterSetter(e0,"boundBoxFunc"),C.Factory.addGetterSetter(e0,"anchorDragBoundFunc"),C.Factory.addGetterSetter(e0,"anchorStyleFunc"),C.Factory.addGetterSetter(e0,"shouldOverdrawWholeArea",!1),C.Factory.addGetterSetter(e0,"useSingleNodeRotation",!0),C.Factory.backCompat(e0,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var e1={};Object.defineProperty(e1,"__esModule",{value:!0}),e1.Wedge=void 0;class e2 extends tM.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,f.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}e1.Wedge=e2,e2.prototype.className="Wedge",e2.prototype._centroid=!0,e2.prototype._attrsAffectingSize=["radius"],(0,f._registerNode)(e2),C.Factory.addGetterSetter(e2,"radius",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(e2,"angle",0,(0,A.getNumberValidator)()),C.Factory.addGetterSetter(e2,"clockwise",!1),C.Factory.backCompat(e2,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var e5={};function e3(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}Object.defineProperty(e5,"__esModule",{value:!0}),e5.Blur=void 0;const e4=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],e8=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];e5.Blur=function(t){let e=Math.round(this.blurRadius());e>0&&function(t,e){let r,n,i,a,o,s,u,l,h,c,f,d,p,g,m,y,v,x,D,b,_,w,C,A;let S=t.data,F=t.width,E=t.height,M=e+e+1,N=F-1,B=E-1,T=e+1,k=T*(T+1)/2,P=new e3,O=null,I=P,z=null,R=null,U=e4[e],L=e8[e];for(i=1;i<M;i++)I=I.next=new e3,i===T&&(O=I);for(n=0,I.next=P,u=s=0;n<E;n++){for(y=v=x=D=l=h=c=f=0,d=T*(b=S[s]),p=T*(_=S[s+1]),g=T*(w=S[s+2]),m=T*(C=S[s+3]),l+=k*b,h+=k*_,c+=k*w,f+=k*C,I=P,i=0;i<T;i++)I.r=b,I.g=_,I.b=w,I.a=C,I=I.next;for(i=1;i<T;i++)a=s+((N<i?N:i)<<2),l+=(I.r=b=S[a])*(A=T-i),h+=(I.g=_=S[a+1])*A,c+=(I.b=w=S[a+2])*A,f+=(I.a=C=S[a+3])*A,y+=b,v+=_,x+=w,D+=C,I=I.next;for(r=0,z=P,R=O;r<F;r++)S[s+3]=C=f*U>>L,0!==C?(C=255/C,S[s]=(l*U>>L)*C,S[s+1]=(h*U>>L)*C,S[s+2]=(c*U>>L)*C):S[s]=S[s+1]=S[s+2]=0,l-=d,h-=p,c-=g,f-=m,d-=z.r,p-=z.g,g-=z.b,m-=z.a,a=u+((a=r+e+1)<N?a:N)<<2,y+=z.r=S[a],v+=z.g=S[a+1],x+=z.b=S[a+2],D+=z.a=S[a+3],l+=y,h+=v,c+=x,f+=D,z=z.next,d+=b=R.r,p+=_=R.g,g+=w=R.b,m+=C=R.a,y-=b,v-=_,x-=w,D-=C,R=R.next,s+=4;u+=F}for(r=0;r<F;r++){for(v=x=D=y=h=c=f=l=0,d=T*(b=S[s=r<<2]),p=T*(_=S[s+1]),g=T*(w=S[s+2]),m=T*(C=S[s+3]),l+=k*b,h+=k*_,c+=k*w,f+=k*C,I=P,i=0;i<T;i++)I.r=b,I.g=_,I.b=w,I.a=C,I=I.next;for(i=1,o=F;i<=e;i++)s=o+r<<2,l+=(I.r=b=S[s])*(A=T-i),h+=(I.g=_=S[s+1])*A,c+=(I.b=w=S[s+2])*A,f+=(I.a=C=S[s+3])*A,y+=b,v+=_,x+=w,D+=C,I=I.next,i<B&&(o+=F);for(n=0,s=r,z=P,R=O;n<E;n++)S[(a=s<<2)+3]=C=f*U>>L,C>0?(C=255/C,S[a]=(l*U>>L)*C,S[a+1]=(h*U>>L)*C,S[a+2]=(c*U>>L)*C):S[a]=S[a+1]=S[a+2]=0,l-=d,h-=p,c-=g,f-=m,d-=z.r,p-=z.g,g-=z.b,m-=z.a,a=r+((a=n+T)<B?a:B)*F<<2,l+=y+=z.r=S[a],h+=v+=z.g=S[a+1],c+=x+=z.b=S[a+2],f+=D+=z.a=S[a+3],z=z.next,d+=b=R.r,p+=_=R.g,g+=w=R.b,m+=C=R.a,y-=b,v-=_,x-=w,D-=C,R=R.next,s+=F}}(t,e)},C.Factory.addGetterSetter(w.Node,"blurRadius",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var e6={};Object.defineProperty(e6,"__esModule",{value:!0}),e6.Brighten=void 0,e6.Brighten=function(t){let e=255*this.brightness(),r=t.data,n=r.length,i;for(i=0;i<n;i+=4)r[i]+=e,r[i+1]+=e,r[i+2]+=e},C.Factory.addGetterSetter(w.Node,"brightness",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var e9={};Object.defineProperty(e9,"__esModule",{value:!0}),e9.Contrast=void 0,e9.Contrast=function(t){let e=Math.pow((this.contrast()+100)/100,2),r=t.data,n=r.length,i=150,a=150,o=150,s;for(s=0;s<n;s+=4)i=r[s],a=r[s+1],o=r[s+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,o=o<0?0:o>255?255:o,r[s]=i,r[s+1]=a,r[s+2]=o},C.Factory.addGetterSetter(w.Node,"contrast",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var e7={};Object.defineProperty(e7,"__esModule",{value:!0}),e7.Emboss=void 0,e7.Emboss=function(t){let e=10*this.embossStrength(),r=255*this.embossWhiteLevel(),n=this.embossDirection(),i=this.embossBlend(),a=0,o=0,s=t.data,u=t.width,l=t.height,h=4*u,c=l;switch(n){case"top-left":a=-1,o=-1;break;case"top":a=-1,o=0;break;case"top-right":a=-1,o=1;break;case"right":a=0,o=1;break;case"bottom-right":a=1,o=1;break;case"bottom":a=1,o=0;break;case"bottom-left":a=1,o=-1;break;case"left":a=0,o=-1;break;default:p.Util.error("Unknown emboss direction: "+n)}do{let t=(c-1)*h,n=a;c+n<1&&(n=0),c+n>l&&(n=0);let f=(c-1+n)*u*4,d=u;do{let n=t+(d-1)*4,a=o;d+a<1&&(a=0),d+a>u&&(a=0);let l=f+(d-1+a)*4,h=s[n]-s[l],c=s[n+1]-s[l+1],p=s[n+2]-s[l+2],g=h,m=g>0?g:-g,y=p>0?p:-p;if((c>0?c:-c)>m&&(g=c),y>m&&(g=p),g*=e,i){let t=s[n]+g,e=s[n+1]+g,r=s[n+2]+g;s[n]=t>255?255:t<0?0:t,s[n+1]=e>255?255:e<0?0:e,s[n+2]=r>255?255:r<0?0:r}else{let t=r-g;t<0?t=0:t>255&&(t=255),s[n]=s[n+1]=s[n+2]=t}}while(--d)}while(--c)},C.Factory.addGetterSetter(w.Node,"embossStrength",.5,(0,A.getNumberValidator)(),C.Factory.afterSetFilter),C.Factory.addGetterSetter(w.Node,"embossWhiteLevel",.5,(0,A.getNumberValidator)(),C.Factory.afterSetFilter),C.Factory.addGetterSetter(w.Node,"embossDirection","top-left",null,C.Factory.afterSetFilter),C.Factory.addGetterSetter(w.Node,"embossBlend",!1,null,C.Factory.afterSetFilter);var rt={};function re(t,e,r,n,i){let a=r-e,o=i-n;return 0===a?n+o/2:0===o?n:(t-e)/a*o+n}Object.defineProperty(rt,"__esModule",{value:!0}),rt.Enhance=void 0,rt.Enhance=function(t){let e,r,n,i,a,o,s,u,l,h=t.data,c=h.length,f=h[0],d=f,p,g=h[1],m=g,y,v=h[2],x=v,D,b,_=this.enhance();if(0!==_){for(b=0;b<c;b+=4)(p=h[b+0])<f?f=p:p>d&&(d=p),(y=h[b+1])<g?g=y:y>m&&(m=y),(D=h[b+2])<v?v=D:D>x&&(x=D);for(d===f&&(d=255,f=0),m===g&&(m=255,g=0),x===v&&(x=255,v=0),_>0?(r=d+_*(255-d),n=f-_*(f-0),a=m+_*(255-m),o=g-_*(g-0),u=x+_*(255-x),l=v-_*(v-0)):(e=(d+f)*.5,r=d+_*(d-e),n=f+_*(f-e),i=(m+g)*.5,a=m+_*(m-i),o=g+_*(g-i),s=(x+v)*.5,u=x+_*(x-s),l=v+_*(v-s)),b=0;b<c;b+=4)h[b+0]=re(h[b+0],f,d,n,r),h[b+1]=re(h[b+1],g,m,o,a),h[b+2]=re(h[b+2],v,x,l,u)}},C.Factory.addGetterSetter(w.Node,"enhance",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var rr={};Object.defineProperty(rr,"__esModule",{value:!0}),rr.Grayscale=void 0,rr.Grayscale=function(t){let e=t.data,r=e.length,n,i;for(n=0;n<r;n+=4)i=.34*e[n]+.5*e[n+1]+.16*e[n+2],e[n]=i,e[n+1]=i,e[n+2]=i};var rn={};Object.defineProperty(rn,"__esModule",{value:!0}),rn.HSL=void 0,C.Factory.addGetterSetter(w.Node,"hue",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter),C.Factory.addGetterSetter(w.Node,"saturation",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter),C.Factory.addGetterSetter(w.Node,"luminance",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter),rn.HSL=function(t){let e,r,n,i,a=t.data,o=a.length,s=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,l=127*this.luminance(),h,c=1*s*Math.cos(u*Math.PI/180),f=1*s*Math.sin(u*Math.PI/180),d=.299+.701*c+.167*f,p=.587-.587*c+.33*f,g=.114-.114*c-.497*f,m=.299-.299*c-.328*f,y=.587+.413*c+.035*f,v=.114-.114*c+.293*f,x=.299-.3*c+1.25*f,D=.587-.586*c-1.05*f,b=.114+.886*c-.2*f;for(h=0;h<o;h+=4)e=a[h+0],r=a[h+1],n=a[h+2],i=a[h+3],a[h+0]=d*e+p*r+g*n+l,a[h+1]=m*e+y*r+v*n+l,a[h+2]=x*e+D*r+b*n+l,a[h+3]=i};var ri={};Object.defineProperty(ri,"__esModule",{value:!0}),ri.HSV=void 0,ri.HSV=function(t){let e,r,n,i;let a=t.data,o=a.length,s=Math.pow(2,this.value()),u=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,h=s*u*Math.cos(l*Math.PI/180),c=s*u*Math.sin(l*Math.PI/180),f=.299*s+.701*h+.167*c,d=.587*s-.587*h+.33*c,p=.114*s-.114*h-.497*c,g=.299*s-.299*h-.328*c,m=.587*s+.413*h+.035*c,y=.114*s-.114*h+.293*c,v=.299*s-.3*h+1.25*c,x=.587*s-.586*h-1.05*c,D=.114*s+.886*h-.2*c;for(let t=0;t<o;t+=4)e=a[t+0],r=a[t+1],n=a[t+2],i=a[t+3],a[t+0]=f*e+d*r+p*n,a[t+1]=g*e+m*r+y*n,a[t+2]=v*e+x*r+D*n,a[t+3]=i},C.Factory.addGetterSetter(w.Node,"hue",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter),C.Factory.addGetterSetter(w.Node,"saturation",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter),C.Factory.addGetterSetter(w.Node,"value",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var ra={};Object.defineProperty(ra,"__esModule",{value:!0}),ra.Invert=void 0,ra.Invert=function(t){let e=t.data,r=e.length,n;for(n=0;n<r;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]};var ro={};Object.defineProperty(ro,"__esModule",{value:!0}),ro.Kaleidoscope=void 0;const rs=function(t,e,r){let n,i,a=t.data,o=e.data,s=t.width,u=t.height,l=r.polarCenterX||s/2,h=r.polarCenterY||u/2,c,f,d,p=0,g=0,m=0,y=0,v,x=Math.sqrt(l*l+h*h);x=(v=Math.sqrt((f=s-l)*f+(d=u-h)*d))>x?v:x;let D=360/s*Math.PI/180,b,_;for(i=0;i<s;i+=1)for(n=0,b=Math.sin(i*D),_=Math.cos(i*D);n<u;n+=1)f=Math.floor(l+x*n/u*_),p=a[(c=((d=Math.floor(h+x*n/u*b))*s+f)*4)+0],g=a[c+1],m=a[c+2],y=a[c+3],o[(c=(i+n*s)*4)+0]=p,o[c+1]=g,o[c+2]=m,o[c+3]=y},ru=function(t,e,r){let n,i=t.data,a=e.data,o=t.width,s=t.height,u=r.polarCenterX||o/2,l=r.polarCenterY||s/2,h,c,f,d,p,g=0,m=0,y=0,v=0,x,D=Math.sqrt(u*u+l*l);D=(x=Math.sqrt((c=o-u)*c+(f=s-l)*f))>D?x:D;let b,_=r.polarRotation||0;for(c=0;c<o;c+=1)for(f=0;f<s;f+=1)b=Math.sqrt((d=c-u)*d+(p=f-l)*p)*s/D,n=Math.floor((180*Math.atan2(p,d)/Math.PI+360+_)%360*o/360),g=i[(h=(Math.floor(b)*o+n)*4)+0],m=i[h+1],y=i[h+2],v=i[h+3],a[(h=(f*o+c)*4)+0]=g,a[h+1]=m,a[h+2]=y,a[h+3]=v};ro.Kaleidoscope=function(t){let e,r,n,i,a,o,s,u,l,h;let c=t.width,f=t.height,d=Math.round(this.kaleidoscopePower()),g=Math.floor(Math.round(this.kaleidoscopeAngle())%360*c/360);if(d<1)return;let m=p.Util.createCanvasElement();m.width=c,m.height=f;let y=m.getContext("2d").getImageData(0,0,c,f);p.Util.releaseCanvas(m),rs(t,y,{polarCenterX:c/2,polarCenterY:f/2});let v=c/Math.pow(2,d);for(;v<=8;)v*=2,d-=1;let x=v=Math.ceil(v),D=0,b=x,_=1;for(g+v>c&&(D=x,b=0,_=-1),r=0;r<f;r+=1)for(e=D;e!==b;e+=_)n=Math.round(e+g)%c,l=(c*r+n)*4,a=y.data[l+0],o=y.data[l+1],s=y.data[l+2],u=y.data[l+3],h=(c*r+e)*4,y.data[h+0]=a,y.data[h+1]=o,y.data[h+2]=s,y.data[h+3]=u;for(r=0;r<f;r+=1)for(i=0,x=Math.floor(v);i<d;i+=1){for(e=0;e<x+1;e+=1)l=(c*r+e)*4,a=y.data[l+0],o=y.data[l+1],s=y.data[l+2],u=y.data[l+3],h=(c*r+2*x-e-1)*4,y.data[h+0]=a,y.data[h+1]=o,y.data[h+2]=s,y.data[h+3]=u;x*=2}ru(y,t,{polarRotation:0})},C.Factory.addGetterSetter(w.Node,"kaleidoscopePower",2,(0,A.getNumberValidator)(),C.Factory.afterSetFilter),C.Factory.addGetterSetter(w.Node,"kaleidoscopeAngle",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var rl={};function rh(t,e,r){let n=(r*t.width+e)*4,i=[];return i.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),i}function rc(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}Object.defineProperty(rl,"__esModule",{value:!0}),rl.Mask=void 0,rl.Mask=function(t){let e=function(t,e){let r=rh(t,0,0),n=rh(t,t.width-1,0),i=rh(t,0,t.height-1),a=rh(t,t.width-1,t.height-1),o=e||10;if(rc(r,n)<o&&rc(n,a)<o&&rc(a,i)<o&&rc(i,r)<o){let e=function(t){let e=[0,0,0];for(let r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}([n,r,a,i]),s=[];for(let r=0;r<t.width*t.height;r++){let n=rc(e,[t.data[4*r],t.data[4*r+1],t.data[4*r+2]]);s[r]=n<o?0:255}return s}}(t,this.threshold());return e&&(e=function(t,e,r){let n=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),o=[];for(let s=0;s<r;s++)for(let u=0;u<e;u++){let l=s*e+u,h=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++){let c=s+o-a,f=u+l-a;if(c>=0&&c<r&&f>=0&&f<e){let r=c*e+f,a=n[o*i+l];h+=t[r]*a}}o[l]=h}return o}(e=function(t,e,r){let n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),o=[];for(let s=0;s<r;s++)for(let u=0;u<e;u++){let l=s*e+u,h=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++){let c=s+o-a,f=u+l-a;if(c>=0&&c<r&&f>=0&&f<e){let r=c*e+f,a=n[o*i+l];h+=t[r]*a}}o[l]=h>=1020?255:0}return o}(e=function(t,e,r){let n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),o=[];for(let s=0;s<r;s++)for(let u=0;u<e;u++){let l=s*e+u,h=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++){let c=s+o-a,f=u+l-a;if(c>=0&&c<r&&f>=0&&f<e){let r=c*e+f,a=n[o*i+l];h+=t[r]*a}}o[l]=2040===h?255:0}return o}(e,t.width,t.height),t.width,t.height),t.width,t.height),function(t,e){for(let r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}(t,e)),t},C.Factory.addGetterSetter(w.Node,"threshold",0,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var rf={};Object.defineProperty(rf,"__esModule",{value:!0}),rf.Noise=void 0,rf.Noise=function(t){let e=255*this.noise(),r=t.data,n=r.length,i=e/2;for(let t=0;t<n;t+=4)r[t+0]+=i-2*i*Math.random(),r[t+1]+=i-2*i*Math.random(),r[t+2]+=i-2*i*Math.random()},C.Factory.addGetterSetter(w.Node,"noise",.2,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var rd={};Object.defineProperty(rd,"__esModule",{value:!0}),rd.Pixelate=void 0,rd.Pixelate=function(t){let e=Math.ceil(this.pixelSize()),r=t.width,n=t.height,i,a,o,s,u,l,h,c=Math.ceil(r/e),f=Math.ceil(n/e),d,g,m,y,v,x,D,b=t.data;if(e<=0){p.Util.error("pixelSize value can not be <= 0");return}for(v=0;v<c;v+=1)for(x=0;x<f;x+=1){for(s=0,u=0,l=0,h=0,g=(d=v*e)+e,y=(m=x*e)+e,D=0,i=d;i<g;i+=1)if(!(i>=r))for(a=m;a<y;a+=1)a>=n||(s+=b[(o=(r*a+i)*4)+0],u+=b[o+1],l+=b[o+2],h+=b[o+3],D+=1);for(s/=D,u/=D,l/=D,h/=D,i=d;i<g;i+=1)if(!(i>=r))for(a=m;a<y;a+=1)a>=n||(b[(o=(r*a+i)*4)+0]=s,b[o+1]=u,b[o+2]=l,b[o+3]=h)}},C.Factory.addGetterSetter(w.Node,"pixelSize",8,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var rp={};Object.defineProperty(rp,"__esModule",{value:!0}),rp.Posterize=void 0,rp.Posterize=function(t){let e=Math.round(254*this.levels())+1,r=t.data,n=r.length,i=255/e,a;for(a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i},C.Factory.addGetterSetter(w.Node,"levels",.5,(0,A.getNumberValidator)(),C.Factory.afterSetFilter);var rg={};Object.defineProperty(rg,"__esModule",{value:!0}),rg.RGB=void 0,rg.RGB=function(t){let e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue(),o,s;for(o=0;o<r;o+=4)s=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255,e[o]=s*n,e[o+1]=s*i,e[o+2]=s*a,e[o+3]=e[o+3]},C.Factory.addGetterSetter(w.Node,"red",0,function(t){return(this._filterUpToDate=!1,t>255)?255:t<0?0:Math.round(t)}),C.Factory.addGetterSetter(w.Node,"green",0,function(t){return(this._filterUpToDate=!1,t>255)?255:t<0?0:Math.round(t)}),C.Factory.addGetterSetter(w.Node,"blue",0,A.RGBComponent,C.Factory.afterSetFilter);var rm={};Object.defineProperty(rm,"__esModule",{value:!0}),rm.RGBA=void 0,rm.RGBA=function(t){let e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue(),o=this.alpha();for(let t=0;t<r;t+=4){let r=1-o;e[t]=n*o+e[t]*r,e[t+1]=i*o+e[t+1]*r,e[t+2]=a*o+e[t+2]*r}},C.Factory.addGetterSetter(w.Node,"red",0,function(t){return(this._filterUpToDate=!1,t>255)?255:t<0?0:Math.round(t)}),C.Factory.addGetterSetter(w.Node,"green",0,function(t){return(this._filterUpToDate=!1,t>255)?255:t<0?0:Math.round(t)}),C.Factory.addGetterSetter(w.Node,"blue",0,A.RGBComponent,C.Factory.afterSetFilter),C.Factory.addGetterSetter(w.Node,"alpha",1,function(t){return(this._filterUpToDate=!1,t>1)?1:t<0?0:t});var ry={};Object.defineProperty(ry,"__esModule",{value:!0}),ry.Sepia=void 0,ry.Sepia=function(t){let e=t.data,r=e.length,n,i,a,o;for(n=0;n<r;n+=4)i=e[n+0],a=e[n+1],o=e[n+2],e[n+0]=Math.min(255,.393*i+.769*a+.189*o),e[n+1]=Math.min(255,.349*i+.686*a+.168*o),e[n+2]=Math.min(255,.272*i+.534*a+.131*o)};var rv={};Object.defineProperty(rv,"__esModule",{value:!0}),rv.Solarize=void 0,rv.Solarize=function(t){let e=t.data,r=t.width,n=t.height,i=4*r,a=n;do{let t=(a-1)*i,n=r;do{let r=t+(n-1)*4,i=e[r],a=e[r+1],o=e[r+2];i>127&&(i=255-i),a>127&&(a=255-a),o>127&&(o=255-o),e[r]=i,e[r+1]=a,e[r+2]=o}while(--n)}while(--a)};var rx={};Object.defineProperty(rx,"__esModule",{value:!0}),rx.Threshold=void 0,rx.Threshold=function(t){let e=255*this.threshold(),r=t.data,n=r.length;for(let t=0;t<n;t+=1)r[t]=r[t]<e?0:255},C.Factory.addGetterSetter(w.Node,"threshold",.5,(0,A.getNumberValidator)(),C.Factory.afterSetFilter),h.Konva=c.Konva.Util._assign(c.Konva,{Arc:tQ.Arc,Arrow:t1.Arrow,Circle:ee.Circle,Ellipse:en.Ellipse,Image:ea.Image,Label:es.Label,Tag:es.Tag,Line:t2.Line,Path:t8.Path,Rect:eg.Rect,RegularPolygon:ey.RegularPolygon,Ring:ex.Ring,Sprite:e_.Sprite,Star:eC.Star,Text:eS.Text,TextPath:eU.TextPath,Transformer:eV.Transformer,Wedge:e1.Wedge,Filters:{Blur:e5.Blur,Brighten:e6.Brighten,Contrast:e9.Contrast,Emboss:e7.Emboss,Enhance:rt.Enhance,Grayscale:rr.Grayscale,HSL:rn.HSL,HSV:ri.HSV,Invert:ra.Invert,Kaleidoscope:ro.Kaleidoscope,Mask:rl.Mask,Noise:rf.Noise,Pixelate:rd.Pixelate,Posterize:rp.Posterize,RGB:rg.RGB,RGBA:rm.RGBA,Sepia:ry.Sepia,Solarize:rv.Solarize,Threshold:rx.Threshold}}),l=h.Konva;let rD=-1,rb=0;class r_ extends /*@__PURE__*/i(l).Image{constructor(t){super(t),this.name="",this.node1=[this.x(),this.y()+this.height()/2],this.node2=[this.x()+this.width(),this.y()+this.height()/2],this.horizontal=!0,this.type="",this.value=1,this.node1Connected=!1,this.node2Connected=!1,this.ID=rD++,this.prefix=" ",this.shownText=!0,this.unit="",this.text=null}getFirstNode(){return this.node1}getSecondNode(){return this.node2}setValue(t){Number.isFinite(parseInt(t))&&t>0&&(this.value=parseInt(t))}setPrefix(t){["p","n","µ","m","c"," ","k","M","G","T"].includes(t)&&(this.prefix=t)}setRotationvalue(t){(Number.isFinite(parseInt(t))&&0==parseInt(t)||90==parseInt(t)||180==parseInt(t)||270==parseInt(t))&&this.rotation(parseInt(t))}getValue(){return this.value}}class rw extends r_{constructor(t){super(t),this.type="Ground",this.node=null,this.name="GND"}getSymbol(){return"GND"}}class rC extends r_{static count=1;constructor(t){super(t),this.type="Resistance",this.unit="Ω",this.name=`R${rC.count++}`}getSymbol(){return"R"}decreaseCount(){rC.count--}}class rA extends r_{static count=1;constructor(t){super(t),this.type="DC Voltage Source",this.unit="V",this.name=`Vs${rA.count++}`}getSymbol(){return"Vs"}decreaseCount(){rA.count--}}class rS extends r_{static count=1;constructor(t){super(t),this.type="DC Current Source",this.unit="A",this.name=`Cs${rS.count++}`}getSymbol(){return"Cs"}decreaseCount(){rS.count--}}class rF{constructor(){this.ID=rb++,this.type="Wire",this.gridPoints=[],this.drawnLines=[],this.connectedComponents=[]}}var rE={};function rM(){return(rE=rM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).__esModule=!0,rE.default=rE,rM.apply(null,arguments)}(rE=rM).__esModule=!0,rE.default=rE;var rN={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null};function rB(t,e){if(rk(t,e))return t[e];if("function"==typeof t[e]&&!(null==t||"function"!=typeof t[e]||nv(t,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(t))&&(nv(rO,e)||!(e in Object.prototype)&&!(e in Function.prototype)))throw Error('Cannot access method "'+e+'" as a property');throw Error('No access to property "'+e+'"')}function rT(t,e,r){if(rk(t,e))return t[e]=r,r;throw Error('No access to property "'+e+'"')}function rk(t,e){return!!("object"==typeof t&&t&&t.constructor===Object||Array.isArray(t))&&(!!nv(rP,e)||!(e in Object.prototype)&&!(e in Function.prototype))}var rP={length:!0,name:!0},rO={toString:!0,valueOf:!0,toLocaleString:!0};class rI{constructor(t){this.wrappedObject=t,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter(t=>this.has(t)).values()}get(t){return rB(this.wrappedObject,t)}set(t,e){return rT(this.wrappedObject,t,e),this}has(t){return rk(this.wrappedObject,t)&&t in this.wrappedObject}entries(){var t,e;return t=this.keys(),e=t=>[t,this.get(t)],{next:()=>{var r=t.next();return r.done?r:{value:e(r.value),done:!1}}}}forEach(t){for(var e of this.keys())t(this.get(e),e,this)}delete(t){rk(this.wrappedObject,t)&&delete this.wrappedObject[t]}clear(){for(var t of this.keys())this.delete(t)}get size(){return Object.keys(this.wrappedObject).length}}function rz(t){return"number"==typeof t}function rR(t){return!!t&&"object"==typeof t&&"function"==typeof t.constructor&&(!0===t.isBigNumber&&"object"==typeof t.constructor.prototype&&!0===t.constructor.prototype.isBigNumber||"function"==typeof t.constructor.isDecimal&&!0===t.constructor.isDecimal(t))}function rU(t){return"bigint"==typeof t}function rL(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isComplex||!1}function rG(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isFraction||!1}function rj(t){return t&&!0===t.constructor.prototype.isUnit||!1}function rq(t){return"string"==typeof t}var rV=Array.isArray;function rH(t){return t&&!0===t.constructor.prototype.isMatrix||!1}function rW(t){return Array.isArray(t)||rH(t)}function rK(t){return t&&t.isDenseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function rY(t){return t&&t.isSparseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function rX(t){return t&&!0===t.constructor.prototype.isRange||!1}function r$(t){return t&&!0===t.constructor.prototype.isIndex||!1}function rZ(t){return"boolean"==typeof t}function rJ(t){return t&&!0===t.constructor.prototype.isResultSet||!1}function rQ(t){return t&&!0===t.constructor.prototype.isHelp||!1}function r0(t){return"function"==typeof t}function r1(t){return t instanceof Date}function r2(t){return t instanceof RegExp}function r5(t){return!!(t&&"object"==typeof t&&t.constructor===Object&&!rL(t)&&!rG(t))}function r3(t){return!!t&&(t instanceof Map||t instanceof rI||"function"==typeof t.set&&"function"==typeof t.get&&"function"==typeof t.keys&&"function"==typeof t.has)}function r4(t){return null===t}function r8(t){return void 0===t}function r6(t){return t&&!0===t.isAccessorNode&&!0===t.constructor.prototype.isNode||!1}function r9(t){return t&&!0===t.isArrayNode&&!0===t.constructor.prototype.isNode||!1}function r7(t){return t&&!0===t.isAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function nt(t){return t&&!0===t.isBlockNode&&!0===t.constructor.prototype.isNode||!1}function ne(t){return t&&!0===t.isConditionalNode&&!0===t.constructor.prototype.isNode||!1}function nr(t){return t&&!0===t.isConstantNode&&!0===t.constructor.prototype.isNode||!1}function nn(t){return t&&!0===t.isFunctionAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function ni(t){return t&&!0===t.isFunctionNode&&!0===t.constructor.prototype.isNode||!1}function na(t){return t&&!0===t.isIndexNode&&!0===t.constructor.prototype.isNode||!1}function no(t){return t&&!0===t.isNode&&!0===t.constructor.prototype.isNode||!1}function ns(t){return t&&!0===t.isObjectNode&&!0===t.constructor.prototype.isNode||!1}function nu(t){return t&&!0===t.isOperatorNode&&!0===t.constructor.prototype.isNode||!1}function nl(t){return t&&!0===t.isParenthesisNode&&!0===t.constructor.prototype.isNode||!1}function nh(t){return t&&!0===t.isRangeNode&&!0===t.constructor.prototype.isNode||!1}function nc(t){return t&&!0===t.isRelationalNode&&!0===t.constructor.prototype.isNode||!1}function nf(t){return t&&!0===t.isSymbolNode&&!0===t.constructor.prototype.isNode||!1}function nd(t){return t&&!0===t.constructor.prototype.isChain||!1}function np(t){var e=typeof t;return"object"===e?null===t?"null":rR(t)?"BigNumber":t.constructor&&t.constructor.name?t.constructor.name:"Object":e}function ng(t){var e=typeof t;if("number"===e||"bigint"===e||"string"===e||"boolean"===e||null==t)return t;if("function"==typeof t.clone)return t.clone();if(Array.isArray(t))return t.map(function(t){return ng(t)});if(t instanceof Date)return new Date(t.valueOf());if(rR(t))return t;if(r5(t))return function(t,e){var r={};for(var n in t)nv(t,n)&&(r[n]=e(t[n]));return r}(t,ng);if("function"===e)return t;throw TypeError("Cannot clone: unknown type of value (value: ".concat(t,")"))}function nm(t,e){for(var r in e)nv(e,r)&&(t[r]=e[r]);return t}function ny(t,e){var r,n,i;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;n++)if(!ny(t[n],e[n]))return!1;return!0}if("function"==typeof t||!(t instanceof Object))return t===e;if(Array.isArray(e)||!(e instanceof Object))return!1;for(r in t)if(!(r in e)||!ny(t[r],e[r]))return!1;for(r in e)if(!(r in t))return!1;return!0}function nv(t,e){return t&&Object.hasOwnProperty.call(t,e)}var nx=function(t){if(t)throw Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(rN)};function nD(t,e,r,n){function i(n){var i=function(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n],a=t[i];void 0!==a&&(r[i]=a)}return r}(n,e.map(nb));return function(t,e,r){if(!e.filter(t=>!(t&&"?"===t[0])).every(t=>void 0!==r[t])){var n=e.filter(t=>void 0===r[t]);throw Error('Cannot create function "'.concat(t,'", ')+"some dependencies are missing: ".concat(n.map(t=>'"'.concat(t,'"')).join(", "),"."))}}(t,e,n),r(i)}return i.isFactory=!0,i.fn=t,i.dependencies=e.slice().sort(),n&&(i.meta=n),i}function nb(t){return t&&"?"===t[0]?t.slice(1):t}function n_(t,e,r){if(!(this instanceof n_))throw SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=r),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=Error().stack}function nw(t){return"boolean"==typeof t||!!isFinite(t)&&t===Math.round(t)}function nC(t,e){return"bigint"!==e.number||/^-?\d+$/.test(t)?e.number:e.numberFallback}/*@__PURE__*/i(rE)(nx,rN,{MATRIX_OPTIONS:["Matrix","Array"],NUMBER_OPTIONS:["number","BigNumber","Fraction"]}),n_.prototype=RangeError(),n_.prototype.constructor=RangeError,n_.prototype.name="IndexError",n_.prototype.isIndexError=!0;var nA=Math.sign||function(t){return t>0?1:t<0?-1:0},nS=Math.log2||function(t){return Math.log(t)/Math.LN2},nF=Math.cbrt||function(t){if(0===t)return t;var e,r=t<0;return r&&(t=-t),isFinite(t)?(e=Math.exp(Math.log(t)/3),e=(t/(e*e)+2*e)/3):e=t,r?-e:e},nE=Math.expm1||function(t){return t>=2e-4||t<=-2e-4?Math.exp(t)-1:t+t*t/2+t*t*t/6};function nM(t,e,r){var n="";if(r){if(r<1)throw Error("size must be in greater than 0");if(!nw(r))throw Error("size must be an integer");if(t>2**(r-1)-1||t<-(2**(r-1)))throw Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!nw(t))throw Error("Value must be an integer");t<0&&(t+=2**r),n="i".concat(r)}var i="";return t<0&&(t=-t,i="-"),"".concat(i).concat({2:"0b",8:"0o",16:"0x"}[e]).concat(t.toString(e)).concat(n)}function nN(t,e){if("function"==typeof e)return e(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var{notation:r,precision:n,wordSize:i}=nB(e);switch(r){case"fixed":return nk(t,n);case"exponential":return nP(t,n);case"engineering":return function(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=nO(nT(t),e),n=r.exponent,i=r.coefficients,a=n%3==0?n:n<0?n-3-n%3:n-n%3;if(rz(e))for(;e>i.length||n-a+1>i.length;)i.push(0);else for(var o=Math.abs(n-a)-(i.length-1),s=0;s<o;s++)i.push(0);for(var u=Math.abs(n-a),l=1;u>0;)l++,u--;var h=i.slice(l).join(""),c=rz(e)&&h.length||h.match(/[1-9]/)?"."+h:"",f=i.slice(0,l).join("")+c+"e"+(n>=0?"+":"")+a.toString();return r.sign+f}(t,n);case"bin":return nM(t,2,i);case"oct":return nM(t,8,i);case"hex":return nM(t,16,i);case"auto":return(function(t,e,r){if(isNaN(t)||!isFinite(t))return String(t);var n=nj(null==r?void 0:r.lowerExp,-3),i=nj(null==r?void 0:r.upperExp,5),a=nT(t),o=e?nO(a,e):a;if(o.exponent<n||o.exponent>=i)return nP(t,e);var s=o.coefficients,u=o.exponent;s.length<e&&(s=s.concat(nI(e-s.length))),s=s.concat(nI(u-s.length+1+(s.length<e?e-s.length:0))),s=nI(-u).concat(s);var l=u>0?u:0;return l<s.length-1&&s.splice(l+1,0,"."),o.sign+s.join("")})(t,n,e).replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw Error('Unknown notation "'+r+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function nB(t){var e,r,n="auto";if(void 0!==t){if(rz(t))e=t;else if(rR(t))e=t.toNumber();else if(r5(t))void 0!==t.precision&&(e=nG(t.precision,()=>{throw Error('Option "precision" must be a number or BigNumber')})),void 0!==t.wordSize&&(r=nG(t.wordSize,()=>{throw Error('Option "wordSize" must be a number or BigNumber')})),t.notation&&(n=t.notation);else throw Error("Unsupported type of options, number, BigNumber, or object expected")}return{notation:n,precision:e,wordSize:r}}function nT(t){var e=String(t).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw SyntaxError("Invalid number "+t);var r=e[1],n=e[2],i=parseFloat(e[4]||"0"),a=n.indexOf(".");i+=-1!==a?a-1:n.length-1;var o=n.replace(".","").replace(/^0*/,function(t){return i-=t.length,""}).replace(/0*$/,"").split("").map(function(t){return parseInt(t)});return 0===o.length&&(o.push(0),i++),{sign:r,coefficients:o,exponent:i}}function nk(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=nT(t),n="number"==typeof e?nO(r,r.exponent+1+e):r,i=n.coefficients,a=n.exponent+1,o=a+(e||0);return i.length<o&&(i=i.concat(nI(o-i.length))),a<0&&(i=nI(-a+1).concat(i),a=1),a<i.length&&i.splice(a,0,0===a?"0.":"."),n.sign+i.join("")}function nP(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=nT(t),n=e?nO(r,e):r,i=n.coefficients,a=n.exponent;i.length<e&&(i=i.concat(nI(e-i.length)));var o=i.shift();return n.sign+o+(i.length>0?"."+i.join(""):"")+"e"+(a>=0?"+":"")+a}function nO(t,e){for(var r={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},n=r.coefficients;e<=0;)n.unshift(0),r.exponent++,e++;if(n.length>e&&n.splice(e,n.length-e)[0]>=5){var i=e-1;for(n[i]++;10===n[i];)n.pop(),0===i&&(n.unshift(0),r.exponent++,i++),i--,n[i]++}return r}function nI(t){for(var e=[],r=0;r<t;r++)e.push(0);return e}function nz(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-8,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(r<=0)throw Error("Relative tolerance must be greater than 0");if(n<0)throw Error("Absolute tolerance must be at least 0");return!(isNaN(t)||isNaN(e))&&(isFinite(t)&&isFinite(e)?t===e||Math.abs(t-e)<=Math.max(r*Math.max(Math.abs(t),Math.abs(e)),n):t===e)}var nR=Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},nU=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2},nL=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2};function nG(t,e){return rz(t)?t:rR(t)?t.toNumber():void e()}function nj(t,e){return rz(t)?t:rR(t)?t.toNumber():e}function nq(t,e,r){var n=new t.constructor(2),i="";if(r){if(r<1)throw Error("size must be in greater than 0");if(!nw(r))throw Error("size must be an integer");if(t.greaterThan(n.pow(r-1).sub(1))||t.lessThan(n.pow(r-1).mul(-1)))throw Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!t.isInteger())throw Error("Value must be an integer");t.lessThan(0)&&(t=t.add(n.pow(r))),i="i".concat(r)}switch(e){case 2:return"".concat(t.toBinary()).concat(i);case 8:return"".concat(t.toOctal()).concat(i);case 16:return"".concat(t.toHexadecimal()).concat(i);default:throw Error("Base ".concat(e," not supported "))}}function nV(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()}function nH(t,e){return rz(t)?t:rR(t)?t.toNumber():e}function nW(t,e){var r=function(t,e){return"number"==typeof t?nN(t,e):rR(t)?function(t,e){if("function"==typeof e)return e(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var{notation:r,precision:n,wordSize:i}=nB(e);switch(r){case"fixed":return t.toFixed(n);case"exponential":return nV(t,n);case"engineering":return o=(a=t.e)%3==0?a:a<0?a-3-a%3:a-a%3,(s=t.mul(Math.pow(10,-o)).toPrecision(n)).includes("e")&&(s=new t.constructor(s).toFixed()),s+"e"+(a>=0?"+":"")+o.toString();case"bin":return nq(t,2,i);case"oct":return nq(t,8,i);case"hex":return nq(t,16,i);case"auto":var a,o,s,u=nH(null==e?void 0:e.lowerExp,-3),l=nH(null==e?void 0:e.upperExp,5);if(t.isZero())return"0";var h=t.toSignificantDigits(n),c=h.e;return(c>=u&&c<l?h.toFixed():nV(t,n)).replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw Error('Unknown notation "'+r+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}(t,e):t&&"object"==typeof t&&"bigint"==typeof t.s&&"bigint"==typeof t.n&&"bigint"==typeof t.d?e&&"decimal"===e.fraction?t.toString():"".concat(t.s*t.n,"/").concat(t.d):Array.isArray(t)?function t(e,r){if(!Array.isArray(e))return nW(e,r);for(var n="[",i=e.length,a=0;a<i;a++)0!==a&&(n+=", "),n+=t(e[a],r);return n+"]"}(t,e):rq(t)?nK(t):"function"==typeof t?t.syntax?String(t.syntax):"function":t&&"object"==typeof t?"function"==typeof t.format?t.format(e):t&&t.toString(e)!==({}).toString()?t.toString(e):"{"+Object.keys(t).map(r=>nK(r)+": "+nW(t[r],e)).join(", ")+"}":String(t)}(t,e);return e&&"object"==typeof e&&"truncate"in e&&r.length>e.truncate?r.substring(0,e.truncate-3)+"...":r}function nK(t){for(var e=String(t),r="",n=0;n<e.length;){var i=e.charAt(n);r+=i in nY?nY[i]:i,n++}return'"'+r+'"'}var nY={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function nX(t,e){if(!rq(t))throw TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+np(t)+", index: 0)");if(!rq(e))throw TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+np(e)+", index: 1)");return t===e?0:t>e?1:-1}function n$(t,e,r){if(!(this instanceof n$))throw SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=r,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=Error().stack}function nZ(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e}function nJ(t,e){if(0===e.length){if(Array.isArray(t))throw new n$(t.length,0)}else!function t(e,r,n){var i,a=e.length;if(a!==r[n])throw new n$(a,r[n]);if(n<r.length-1){var o=n+1;for(i=0;i<a;i++){if(!Array.isArray(e[i]))throw new n$(r.length-1,r.length,"<");t(e[i],r,o)}}else for(i=0;i<a;i++)if(Array.isArray(e[i]))throw new n$(r.length+1,r.length,">")}(t,e,0)}function nQ(t,e){var r=t.isMatrix?t._size:nZ(t);e._sourceSize.forEach((t,e)=>{if(null!==t&&t!==r[e])throw new n$(t,r[e])})}function n0(t,e){if(void 0!==t){if(!rz(t)||!nw(t))throw TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"==typeof e&&t>=e)throw new n_(t,e)}}function n1(t){for(var e=0;e<t._dimensions.length;++e){var r=t._dimensions[e];if(r._data&&rV(r._data)){if(0===r._size[0])return!0}else if(r.isRange){if(r.start===r.end)return!0}else if(rq(r)&&0===r.length)return!0}return!1}function n2(t,e,r){if(!Array.isArray(e))throw TypeError("Array expected");if(0===e.length)throw Error("Resizing to scalar is not supported");return e.forEach(function(t){if(!rz(t)||!nw(t)||t<0)throw TypeError("Invalid size, must contain positive integers (size: "+nW(e)+")")}),(rz(t)||rR(t))&&(t=[t]),function t(e,r,n,i){var a,o,s=e.length,u=r[n],l=Math.min(s,u);if(e.length=u,n<r.length-1){var h=n+1;for(a=0;a<l;a++)Array.isArray(o=e[a])||(o=[o],e[a]=o),t(o,r,h,i);for(a=l;a<u;a++)o=[],e[a]=o,t(o,r,h,i)}else{for(a=0;a<l;a++)for(;Array.isArray(e[a]);)e[a]=e[a][0];for(a=l;a<u;a++)e[a]=i}}(t,e,0,void 0!==r?r:0),t}function n5(t,e){var r=n6(t),n=r.length;if(!Array.isArray(t)||!Array.isArray(e))throw TypeError("Array expected");if(0===e.length)throw new n$(0,n,"!=");var i=n4(e=n3(e,n));if(n!==i)throw new n$(i,n,"!=");try{return function(t,e){for(var r,n=t,i=e.length-1;i>0;i--){var a=e[i];r=[];for(var o=n.length/a,s=0;s<o;s++)r.push(n.slice(s*a,(s+1)*a));n=r}return n}(r,e)}catch(t){if(t instanceof n$)throw new n$(i,n,"!=");throw t}}function n3(t,e){var r=n4(t),n=t.slice(),i=t.indexOf(-1);if(t.indexOf(-1,i+1)>=0)throw Error("More than one wildcard in sizes");if(i>=0){if(e%r==0)n[i]=-e/r;else throw Error("Could not replace wildcard, since "+e+" is no multiple of "+-r)}return n}function n4(t){return t.reduce((t,e)=>t*e,1)}function n8(t,e,r,n){var i=n||nZ(t);if(r)for(var a=0;a<r;a++)t=[t],i.unshift(1);for(t=function t(e,r,n){var i,a;if(Array.isArray(e)){var o=n+1;for(i=0,a=e.length;i<a;i++)e[i]=t(e[i],r,o)}else for(var s=n;s<r;s++)e=[e];return e}(t,e,0);i.length<e;)i.push(1);return t}function n6(t){if(!Array.isArray(t))return t;var e=[];return t.forEach(function t(r){Array.isArray(r)?r.forEach(t):e.push(r)}),e}function n9(t){if(!Array.isArray(t))throw TypeError("Array input expected");if(0===t.length)return t;var e=[],r=0;e[0]={value:t[0],identifier:0};for(var n=1;n<t.length;n++)t[n]===t[n-1]?r++:r=0,e.push({value:t[n],identifier:r});return e}function n7(t){if(!Array.isArray(t))throw TypeError("Array input expected");if(0===t.length)return t;for(var e=[],r=0;r<t.length;r++)e.push(t[r].value);return e}function it(t,e){for(var r,n=0,i=0;i<t.length;i++){var a=t[i],o=Array.isArray(a);if(0===i&&o&&(n=a.length),o&&a.length!==n)return;var s=o?it(a,e):e(a);if(void 0===r)r=s;else if(r!==s)return"mixed"}return r}function ie(){var t=Array.prototype.slice.call(arguments,0,-1),e=Array.prototype.slice.call(arguments,-1);if(1===t.length)return t[0];if(t.length>1)return t.slice(1).reduce(function(t,r){return function t(e,r,n,i){if(!(i<n))return e.concat(r);if(e.length!==r.length)throw new n$(e.length,r.length);for(var a=[],o=0;o<e.length;o++)a[o]=t(e[o],r[o],n,i+1);return a}(t,r,e,0)},t[0]);throw Error("Wrong number of arguments in function concat")}function ir(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=e.map(t=>t.length),i=Math.max(...n),a=Array(i).fill(null),o=0;o<e.length;o++)for(var s=e[o],u=n[o],l=0;l<u;l++){var h=i-u+l;s[l]>a[h]&&(a[h]=s[l])}for(var c=0;c<e.length;c++)ii(e[c],a);return a}function ii(t,e){for(var r=e.length,n=t.length,i=0;i<n;i++){var a=r-n+i;if(t[i]<e[a]&&t[i]>1||t[i]>e[a])throw Error("shape missmatch: missmatch is found in arg with shape (".concat(t,") not possible to broadcast dimension ").concat(n," with size ").concat(t[i]," to size ").concat(e[a]))}}function ia(t,e){var r,n,a,o=nZ(t);if(ny(o,e))return t;ii(o,e);var s=ir(o,e),u=s.length,l=[...Array(u-o.length).fill(1),...o],h=/*@__PURE__*/i(rE)([],t);o.length<u&&(o=nZ(h=n5(h,l)));for(var c=0;c<u;c++)o[c]<s[c]&&(o=nZ((r=h,n=s[c],a=c,h=ie(...Array(n).fill(r),a))));return h}function io(t,e){if(!Array.isArray(t))throw Error("Array expected");var r=nZ(t);if(e.length!==r.length)throw new n$(e.length,r.length);for(var n=0;n<e.length;n++)n0(e[n],r[n]);return e.reduce((t,e)=>t[e],t)}function is(t,e,r,n){return Array.isArray(t)?t.map(function(t,i){return is(t,e.concat(i),r,n)}):n(t,e,r)}function iu(t){for(var e=0;e<t.length;e++)if(rW(t[e]))return!0;return!1}function il(t,e){rH(t)&&(t=t.valueOf());for(var r=0,n=t.length;r<n;r++){var i=t[r];Array.isArray(i)?il(i,e):e(i)}}function ih(t,e,r){return t&&"function"==typeof t.map?t.map(function(t){return ih(t,e,r)}):e(t)}function ic(t,e,r){var n=Array.isArray(t)?nZ(t):t.size();if(e<0||e>=n.length)throw new n_(e,n.length);return rH(t)?t.create(id(t.valueOf(),e,r),t.datatype()):id(t,e,r)}function id(t,e,r){var n,i,a,o;if(e<=0){if(Array.isArray(t[0])){for(n=0,o=function(t){var e,r,n=t.length,i=t[0].length,a=[];for(r=0;r<i;r++){var o=[];for(e=0;e<n;e++)o.push(t[e][r]);a.push(o)}return a}(t),i=[];n<o.length;n++)i[n]=id(o[n],e-1,r);return i}for(n=1,a=t[0];n<t.length;n++)a=r(a,t[n]);return a}for(n=0,i=[];n<t.length;n++)i[n]=id(t[n],e-1,r);return i}function ip(t,e,r,n,i,a,o,s,u,l,h){var c,f,d,p,g=t._values,m=t._index,y=t._ptr;if(n)for(f=y[e],d=y[e+1],c=f;c<d;c++)r[p=m[c]]!==a?(r[p]=a,o.push(p),l?(n[p]=u?s(g[c],h):s(h,g[c]),i[p]=a):n[p]=g[c]):(n[p]=u?s(g[c],n[p]):s(n[p],g[c]),i[p]=a);else for(f=y[e],d=y[e+1],c=f;c<d;c++)r[p=m[c]]!==a?(r[p]=a,o.push(p)):i[p]=a}n$.prototype=RangeError(),n$.prototype.constructor=RangeError,n$.prototype.name="DimensionError",n$.prototype.isDimensionError=!0;var ig="number",im="number, number";function iy(t){return Math.abs(t)}function iv(t,e){return t+e}function ix(t,e){return t-e}function iD(t,e){return t*e}function ib(t){return-t}function i_(t){return t}function iw(t){return nF(t)}function iC(t){return Math.exp(t)}iy.signature=ig,iv.signature=im,ix.signature=im,iD.signature=im,ib.signature=ig,i_.signature=ig,iw.signature=ig,iC.signature=ig;function iA(t){return nA(t)}function iS(t,e){var r,n,i,a=0,o=1,s=1,u=0;if(!nw(t)||!nw(e))throw Error("Parameters in function xgcd must be integer numbers");for(;e;)n=Math.floor(t/e),i=t-n*e,r=a,a=o-n*a,o=r,r=s,s=u-n*s,u=r,t=e,e=i;return t<0?[-t,-o,-u]:[t,t?o:0,u]}function iF(t,e){return t*t<1&&e===1/0||t*t>1&&e===-1/0?0:Math.pow(t,e)}function iE(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!nw(e)||e<0||e>15)throw Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(nk(t,e))}iA.signature=ig,iS.signature=im,iF.signature=im;var iM=/* #__PURE__ */nD("abs",["typed"],t=>{var{typed:e}=t;return e("abs",{number:iy,"Complex | BigNumber | Fraction | Unit":t=>t.abs(),bigint:t=>t<0n?-t:t,"Array | Matrix":e.referToSelf(t=>e=>ih(e,t,!0))})}),iN="number",iB=/* #__PURE__ */nD("matAlgo01xDSid",["typed"],t=>{var{typed:e}=t;return function(t,r,n,i){var a,o,s=t._data,u=t._size,l=t._datatype||t.getDataType(),h=r._values,c=r._index,f=r._ptr,d=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(u.length!==d.length)throw new n$(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");if(!h)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=u[0],m=u[1],y="string"==typeof l&&"mixed"!==l&&l===p?l:void 0,v=y?e.find(n,[y,y]):n,x=[];for(a=0;a<g;a++)x[a]=[];var D=[],b=[];for(o=0;o<m;o++){for(var _=o+1,w=f[o],C=f[o+1],A=w;A<C;A++)D[a=c[A]]=i?v(h[A],s[a][o]):v(s[a][o],h[A]),b[a]=_;for(a=0;a<g;a++)b[a]===_?x[a][o]=D[a]:x[a][o]=s[a][o]}return t.createDenseMatrix({data:x,size:[g,m],datatype:l===t._datatype&&p===r._datatype?y:void 0})}}),iT=/* #__PURE__ */nD("matAlgo04xSidSid",["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o,s,u,l,h,c=t._values,f=t._index,d=t._ptr,p=t._size,g=t._datatype||void 0===t._data?t._datatype:t.getDataType(),m=n._values,y=n._index,v=n._ptr,x=n._size,D=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(p.length!==x.length)throw new n$(p.length,x.length);if(p[0]!==x[0]||p[1]!==x[1])throw RangeError("Dimension mismatch. Matrix A ("+p+") must match Matrix B ("+x+")");var b=p[0],_=p[1],w=r,C=0,A=i;"string"==typeof g&&g===D&&"mixed"!==g&&(a=g,w=e.find(r,[a,a]),C=e.convert(0,a),A=e.find(i,[a,a]));var S=c&&m?[]:void 0,F=[],E=[],M=c&&m?[]:void 0,N=c&&m?[]:void 0,B=[],T=[];for(s=0;s<_;s++){E[s]=F.length;var k=s+1;for(l=d[s],h=d[s+1],u=l;u<h;u++)o=f[u],F.push(o),B[o]=k,M&&(M[o]=c[u]);for(l=v[s],h=v[s+1],u=l;u<h;u++)if(B[o=y[u]]===k){if(M){var P=A(M[o],m[u]);w(P,C)?B[o]=null:M[o]=P}}else F.push(o),T[o]=k,N&&(N[o]=m[u]);if(M&&N)for(u=E[s];u<F.length;)B[o=F[u]]===k?(S[u]=M[o],u++):T[o]===k?(S[u]=N[o],u++):F.splice(u,1)}return E[_]=F.length,t.createSparseMatrix({values:S,index:F,ptr:E,size:[b,_],datatype:g===t._datatype&&D===n._datatype?a:void 0})}}),ik=/* #__PURE__ */nD("matAlgo10xSids",["typed","DenseMatrix"],t=>{var{typed:e,DenseMatrix:r}=t;return function(t,n,i,a){var o,s=t._values,u=t._index,l=t._ptr,h=t._size,c=t._datatype;if(!s)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],d=h[1],p=i;"string"==typeof c&&(o=c,n=e.convert(n,o),p=e.find(i,[o,o]));for(var g=[],m=[],y=[],v=0;v<d;v++){for(var x=v+1,D=l[v],b=l[v+1],_=D;_<b;_++){var w=u[_];m[w]=s[_],y[w]=x}for(var C=0;C<f;C++)0===v&&(g[C]=[]),y[C]===x?g[C][v]=a?p(n,m[C]):p(m[C],n):g[C][v]=n}return new r({data:g,size:[f,d],datatype:o})}}),iP=/* #__PURE__ */nD("matAlgo13xDD",["typed"],t=>{var{typed:e}=t;return function(t,r,n){var i,a=t._data,o=t._size,s=t._datatype,u=r._data,l=r._size,h=r._datatype,c=[];if(o.length!==l.length)throw new n$(o.length,l.length);for(var f=0;f<o.length;f++){if(o[f]!==l[f])throw RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+l+")");c[f]=o[f]}var d=n;"string"==typeof s&&s===h&&(i=s,d=e.find(n,[i,i]));var p=c.length>0?function t(e,r,n,i,a,o){var s=[];if(r===n.length-1)for(var u=0;u<i;u++)s[u]=e(a[u],o[u]);else for(var l=0;l<i;l++)s[l]=t(e,r+1,n,n[r+1],a[l],o[l]);return s}(d,0,c,c[0],a,u):[];return t.createDenseMatrix({data:p,size:c,datatype:i})}}),iO=/* #__PURE__ */nD("matAlgo14xDs",["typed"],t=>{var{typed:e}=t;return function(t,r,n,i){var a,o=t._data,s=t._size,u=t._datatype,l=n;"string"==typeof u&&(a=u,r=e.convert(r,a),l=e.find(n,[a,a]));var h=s.length>0?function t(e,r,n,i,a,o,s){var u=[];if(r===n.length-1)for(var l=0;l<i;l++)u[l]=s?e(o,a[l]):e(a[l],o);else for(var h=0;h<i;h++)u[h]=t(e,r+1,n,n[r+1],a[h],o,s);return u}(l,0,s,s[0],o,r,i):[];return t.createDenseMatrix({data:h,size:ng(s),datatype:a})}});function iI(t,e){if(ny(t.size(),e.size()))return[t,e];var r=ir(t.size(),e.size());return[t,e].map(t=>ny(t.size(),r)?t:t.create(ia(t.valueOf(),r),t.datatype()))}var iz=/* #__PURE__ */nD("matrixAlgorithmSuite",["typed","matrix"],t=>{var{typed:e,matrix:r}=t,n=iP({typed:e}),i=iO({typed:e});return function(t){var a,o=t.elop,s=t.SD||t.DS;o?(a={"DenseMatrix, DenseMatrix":(t,e)=>n(...iI(t,e),o),"Array, Array":(t,e)=>n(...iI(r(t),r(e)),o).valueOf(),"Array, DenseMatrix":(t,e)=>n(...iI(r(t),e),o),"DenseMatrix, Array":(t,e)=>n(...iI(t,r(e)),o)},t.SS&&(a["SparseMatrix, SparseMatrix"]=(e,r)=>t.SS(...iI(e,r),o,!1)),t.DS&&(a["DenseMatrix, SparseMatrix"]=(e,r)=>t.DS(...iI(e,r),o,!1),a["Array, SparseMatrix"]=(e,n)=>t.DS(...iI(r(e),n),o,!1)),s&&(a["SparseMatrix, DenseMatrix"]=(t,e)=>s(...iI(e,t),o,!0),a["SparseMatrix, Array"]=(t,e)=>s(...iI(r(e),t),o,!0))):(a={"DenseMatrix, DenseMatrix":e.referToSelf(t=>(e,r)=>n(...iI(e,r),t)),"Array, Array":e.referToSelf(t=>(e,i)=>n(...iI(r(e),r(i)),t).valueOf()),"Array, DenseMatrix":e.referToSelf(t=>(e,i)=>n(...iI(r(e),i),t)),"DenseMatrix, Array":e.referToSelf(t=>(e,i)=>n(...iI(e,r(i)),t))},t.SS&&(a["SparseMatrix, SparseMatrix"]=e.referToSelf(e=>(r,n)=>t.SS(...iI(r,n),e,!1))),t.DS&&(a["DenseMatrix, SparseMatrix"]=e.referToSelf(e=>(r,n)=>t.DS(...iI(r,n),e,!1)),a["Array, SparseMatrix"]=e.referToSelf(e=>(n,i)=>t.DS(...iI(r(n),i),e,!1))),s&&(a["SparseMatrix, DenseMatrix"]=e.referToSelf(t=>(e,r)=>s(...iI(r,e),t,!0)),a["SparseMatrix, Array"]=e.referToSelf(t=>(e,n)=>s(...iI(r(n),e),t,!0))));var u=t.scalar||"any";(t.Ds||t.Ss)&&(o?(a["DenseMatrix,"+u]=(t,e)=>i(t,e,o,!1),a[u+", DenseMatrix"]=(t,e)=>i(e,t,o,!0),a["Array,"+u]=(t,e)=>i(r(t),e,o,!1).valueOf(),a[u+", Array"]=(t,e)=>i(r(e),t,o,!0).valueOf()):(a["DenseMatrix,"+u]=e.referToSelf(t=>(e,r)=>i(e,r,t,!1)),a[u+", DenseMatrix"]=e.referToSelf(t=>(e,r)=>i(r,e,t,!0)),a["Array,"+u]=e.referToSelf(t=>(e,n)=>i(r(e),n,t,!1).valueOf()),a[u+", Array"]=e.referToSelf(t=>(e,n)=>i(r(n),e,t,!0).valueOf())));var l=void 0!==t.sS?t.sS:t.Ss;return o?(t.Ss&&(a["SparseMatrix,"+u]=(e,r)=>t.Ss(e,r,o,!1)),l&&(a[u+", SparseMatrix"]=(t,e)=>l(e,t,o,!0))):(t.Ss&&(a["SparseMatrix,"+u]=e.referToSelf(e=>(r,n)=>t.Ss(r,n,e,!1))),l&&(a[u+", SparseMatrix"]=e.referToSelf(t=>(e,r)=>l(r,e,t,!0)))),o&&o.signatures&&nm(a,o.signatures),a}}),iR=/* #__PURE__ */nD("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],t=>{var{typed:e,matrix:r,addScalar:n,equalScalar:i,DenseMatrix:a,SparseMatrix:o,concat:s}=t,u=iB({typed:e}),l=iT({typed:e,equalScalar:i}),h=ik({typed:e,DenseMatrix:a}),c=iz({typed:e,matrix:r,concat:s});return e("add",{"any, any":n,"any, any, ...any":e.referToSelf(t=>(e,r,n)=>{for(var i=t(e,r),a=0;a<n.length;a++)i=t(i,n[a]);return i})},c({elop:n,DS:u,SS:l,Ss:h}))}),iU="addScalar",iL=/* #__PURE__ */nD(iU,["typed"],t=>{var{typed:e}=t;return e(iU,{"number, number":iv,"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"bigint, bigint":function(t,e){return t+e},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":e.referToSelf(t=>(r,n)=>{if(null===r.value||void 0===r.value)throw Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw Error("Units do not match");var i=r.clone();return i.value=e.find(t,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i})})}),iG=/* #__PURE__ */nD("matAlgo02xDS0",["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i,a){var o,s=t._data,u=t._size,l=t._datatype||t.getDataType(),h=n._values,c=n._index,f=n._ptr,d=n._size,p=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(u.length!==d.length)throw new n$(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");if(!h)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=u[0],m=u[1],y=r,v=0,x=i;"string"==typeof l&&l===p&&"mixed"!==l&&(o=l,y=e.find(r,[o,o]),v=e.convert(0,o),x=e.find(i,[o,o]));for(var D=[],b=[],_=[],w=0;w<m;w++){_[w]=b.length;for(var C=f[w],A=f[w+1],S=C;S<A;S++){var F=c[S],E=a?x(h[S],s[F][w]):x(s[F][w],h[S]);y(E,v)||(b.push(F),D.push(E))}}return _[m]=b.length,n.createSparseMatrix({values:D,index:b,ptr:_,size:[g,m],datatype:l===t._datatype&&p===n._datatype?o:void 0})}}),ij=/* #__PURE__ */nD("matAlgo11xS0s",["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i,a){var o,s=t._values,u=t._index,l=t._ptr,h=t._size,c=t._datatype;if(!s)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],d=h[1],p=r,g=0,m=i;"string"==typeof c&&(o=c,p=e.find(r,[o,o]),g=e.convert(0,o),n=e.convert(n,o),m=e.find(i,[o,o]));for(var y=[],v=[],x=[],D=0;D<d;D++){x[D]=v.length;for(var b=l[D],_=l[D+1],w=b;w<_;w++){var C=u[w],A=a?m(n,s[w]):m(s[w],n);p(A,g)||(v.push(C),y.push(A))}}return x[d]=v.length,t.createSparseMatrix({values:y,index:v,ptr:x,size:[f,d],datatype:o})}}),iq=(t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o=t._values,s=t._size,u=t._datatype||void 0===t._data?t._datatype:t.getDataType(),l=n._values,h=n._size,c=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(s.length!==h.length)throw new n$(s.length,h.length);if(s[0]!==h[0]||s[1]!==h[1])throw RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+h+")");var f=s[0],d=s[1],p=r,g=0,m=i;"string"==typeof u&&u===c&&"mixed"!==u&&(a=u,p=e.find(r,[a,a]),g=e.convert(0,a),m=e.find(i,[a,a]));for(var y=o&&l?[]:void 0,v=[],x=[],D=y?[]:void 0,b=[],_=[],w=0;w<d;w++){x[w]=v.length;var C=w+1;if(ip(t,w,b,D,_,C,v,m),ip(n,w,b,D,_,C,v,m),D)for(var A=x[w];A<v.length;){var S=v[A];if(_[S]===C){var F=D[S];p(F,g)?v.splice(A,1):(y.push(F),A++)}else v.splice(A,1)}else for(var E=x[w];E<v.length;)_[v[E]]!==C?v.splice(E,1):E++}return x[d]=v.length,t.createSparseMatrix({values:y,index:v,ptr:x,size:[f,d],datatype:u===t._datatype&&c===n._datatype?a:void 0})}},"number, number");function iV(t){return!t}iV.signature="number";var iH="apply";function iW(t,e,r){var n,i,a;if(e<=0){if(!Array.isArray(t[0]))return r(t);for(n=0,a=function(t){var e,r,n=t.length,i=t[0].length,a=[];for(r=0;r<i;r++){var o=[];for(e=0;e<n;e++)o.push(t[e][r]);a.push(o)}return a}(t),i=[];n<a.length;n++)i[n]=iW(a[n],e-1,r);return i}for(n=0,i=[];n<t.length;n++)i[n]=iW(t[n],e-1,r);return i}t=>{var{typed:e,isInteger:r}=t;return e(iH,{"Array | Matrix, number | BigNumber, function":function(t,e,n){if(!r(e))throw TypeError("Integer number expected for dimension");var i=Array.isArray(t)?nZ(t):t.size();if(e<0||e>=i.length)throw new n_(e,i.length);return rH(t)?t.create(iW(t.valueOf(),e,n),t.datatype()):iW(t,e,n)}})};var iK=/* #__PURE__ */nD("atan",["typed"],t=>{var{typed:e}=t;return e("atan",{number:function(t){return Math.atan(t)},Complex:function(t){return t.atan()},BigNumber:function(t){return t.atan()}})}),iY=/* #__PURE__ */nD("matAlgo03xDSf",["typed"],t=>{var{typed:e}=t;return function(t,r,n,i){var a,o=t._data,s=t._size,u=t._datatype||t.getDataType(),l=r._values,h=r._index,c=r._ptr,f=r._size,d=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(s.length!==f.length)throw new n$(s.length,f.length);if(s[0]!==f[0]||s[1]!==f[1])throw RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+f+")");if(!l)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p=s[0],g=s[1],m=0,y=n;"string"==typeof u&&u===d&&"mixed"!==u&&(a=u,m=e.convert(0,a),y=e.find(n,[a,a]));for(var v=[],x=0;x<p;x++)v[x]=[];for(var D=[],b=[],_=0;_<g;_++){for(var w=_+1,C=c[_],A=c[_+1],S=C;S<A;S++){var F=h[S];D[F]=i?y(l[S],o[F][_]):y(o[F][_],l[S]),b[F]=w}for(var E=0;E<p;E++)b[E]===w?v[E][_]=D[E]:v[E][_]=i?y(m,o[E][_]):y(o[E][_],m)}return t.createDenseMatrix({data:v,size:[p,g],datatype:u===t._datatype&&d===r._datatype?a:void 0})}}),iX=(t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o,s,u,l,h,c=t._values,f=t._index,d=t._ptr,p=t._size,g=t._datatype||void 0===t._data?t._datatype:t.getDataType(),m=n._values,y=n._index,v=n._ptr,x=n._size,D=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(p.length!==x.length)throw new n$(p.length,x.length);if(p[0]!==x[0]||p[1]!==x[1])throw RangeError("Dimension mismatch. Matrix A ("+p+") must match Matrix B ("+x+")");var b=p[0],_=p[1],w=r,C=0,A=i;"string"==typeof g&&g===D&&"mixed"!==g&&(a=g,w=e.find(r,[a,a]),C=e.convert(0,a),A=e.find(i,[a,a]));var S=c&&m?[]:void 0,F=[],E=[],M=S?[]:void 0,N=[];for(s=0;s<_;s++){E[s]=F.length;var B=s+1;if(M)for(l=v[s],h=v[s+1],u=l;u<h;u++)N[o=y[u]]=B,M[o]=m[u];for(l=d[s],h=d[s+1],u=l;u<h;u++)if(o=f[u],M){var T=N[o]===B?M[o]:C,k=A(c[u],T);w(k,C)||(F.push(o),S.push(k))}else F.push(o)}return E[_]=F.length,t.createSparseMatrix({values:S,index:F,ptr:E,size:[b,_],datatype:g===t._datatype&&D===n._datatype?a:void 0})}},/* #__PURE__ */nD("matAlgo12xSfs",["typed","DenseMatrix"],t=>{var{typed:e,DenseMatrix:r}=t;return function(t,n,i,a){var o,s=t._values,u=t._index,l=t._ptr,h=t._size,c=t._datatype;if(!s)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],d=h[1],p=i;"string"==typeof c&&(o=c,n=e.convert(n,o),p=e.find(i,[o,o]));for(var g=[],m=[],y=[],v=0;v<d;v++){for(var x=v+1,D=l[v],b=l[v+1],_=D;_<b;_++){var w=u[_];m[w]=s[_],y[w]=x}for(var C=0;C<f;C++)0===v&&(g[C]=[]),y[C]===x?g[C][v]=a?p(n,m[C]):p(m[C],n):g[C][v]=a?p(n,0):p(0,n)}return new r({data:g,size:[f,d],datatype:o})}}));function i$(t,e){return nD(t,["config","BigNumber"],t=>{var{config:r,BigNumber:n}=t;return"BigNumber"===r.number?new n(e):e})}i$("fineStructure",.0072973525693),i$("weakMixingAngle",.2229),i$("efimovFactor",22.7),i$("sackurTetrode",-1.16487052358);var iZ=/* #__PURE__ */nD("bignumber",["typed","BigNumber"],t=>{var{typed:e,BigNumber:r}=t;return e("bignumber",{"":function(){return new r(0)},number:function(t){return new r(t+"")},string:function(t){var e=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(e){var n=e[2],i=r(e[1]),a=new r(2).pow(Number(n));if(i.gt(a.sub(1)))throw SyntaxError('String "'.concat(t,'" is out of range'));var o=new r(2).pow(Number(n)-1);return i.gte(o)?i.sub(a):i}return new r(t)},BigNumber:function(t){return t},bigint:function(t){return new r(t.toString())},Unit:e.referToSelf(t=>e=>{var r=e.clone();return r.value=t(e.value),r}),Fraction:function(t){return new r(String(t.n)).div(String(t.d)).times(String(t.s))},null:function(t){return new r(0)},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})}),iJ={};!function(t){/*!
   *  decimal.js v10.4.3
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   */var e,r,n,i,a="0123456789abcdef",o="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",s="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",u={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-9e15,maxE:9e15,crypto:!1},l=!0,h="[DecimalError] ",c=h+"Invalid argument: ",f=h+"Precision limit exceeded",d=h+"crypto unavailable",p="[object Decimal]",g=Math.floor,m=Math.pow,y=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,v=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,x=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,D=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,b=o.length-1,_=s.length-1,w={toStringTag:p};function C(t){var e,r,n,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,e=1;e<i;e++)(r=7-(n=t[e]+"").length)&&(a+=O(r)),a+=n;(r=7-(n=(o=t[e])+"").length)&&(a+=O(r))}else if(0===o)return"0";for(;o%10==0;)o/=10;return a+o}function A(t,e,r){if(t!==~~t||t<e||t>r)throw Error(c+t)}function S(t,e,r,n){var i,a,o,s;for(a=t[0];a>=10;a/=10)--e;return--e<0?(e+=7,i=0):(i=Math.ceil((e+1)/7),e%=7),a=m(10,7-e),s=t[i]%a|0,null==n?e<3?(0==e?s=s/100|0:1==e&&(s=s/10|0),o=r<4&&99999==s||r>3&&49999==s||5e4==s||0==s):o=(r<4&&s+1==a||r>3&&s+1==a/2)&&(t[i+1]/a/100|0)==m(10,e-2)-1||(s==a/2||0==s)&&(t[i+1]/a/100|0)==0:e<4?(0==e?s=s/1e3|0:1==e?s=s/100|0:2==e&&(s=s/10|0),o=(n||r<4)&&9999==s||!n&&r>3&&4999==s):o=((n||r<4)&&s+1==a||!n&&r>3&&s+1==a/2)&&(t[i+1]/a/1e3|0)==m(10,e-3)-1,o}function F(t,e,r){for(var n,i,o=[0],s=0,u=t.length;s<u;){for(i=o.length;i--;)o[i]*=e;for(o[0]+=a.indexOf(t.charAt(s++)),n=0;n<o.length;n++)o[n]>r-1&&(void 0===o[n+1]&&(o[n+1]=0),o[n+1]+=o[n]/r|0,o[n]%=r)}return o.reverse()}w.absoluteValue=w.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),M(t)},w.ceil=function(){return M(new this.constructor(this),this.e+1,2)},w.clampedTo=w.clamp=function(t,e){var r=this.constructor;if(t=new r(t),e=new r(e),!t.s||!e.s)return new r(NaN);if(t.gt(e))throw Error(c+e);return 0>this.cmp(t)?t:this.cmp(e)>0?e:new r(this)},w.comparedTo=w.cmp=function(t){var e,r,n,i,a=this.d,o=(t=new this.constructor(t)).d,s=this.s,u=t.s;if(!a||!o)return s&&u?s!==u?s:a===o?0:!a^s<0?1:-1:NaN;if(!a[0]||!o[0])return a[0]?s:o[0]?-u:0;if(s!==u)return s;if(this.e!==t.e)return this.e>t.e^s<0?1:-1;for(e=0,r=(n=a.length)<(i=o.length)?n:i;e<r;++e)if(a[e]!==o[e])return a[e]>o[e]^s<0?1:-1;return n===i?0:n>i^s<0?1:-1},w.cosine=w.cos=function(){var t,e,r=this,n=r.constructor;return r.d?r.d[0]?(t=n.precision,e=n.rounding,n.precision=t+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(t,e){var r,n,i;if(e.isZero())return e;(n=e.d.length)<32?i=(1/V(4,r=Math.ceil(n/3))).toString():(r=16,i="2.3283064365386962890625e-10"),t.precision+=r,e=q(t,1,e.times(i),new t(1));for(var a=r;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return t.precision-=r,e}(n,H(n,r)),n.precision=t,n.rounding=e,M(2==i||3==i?r.neg():r,t,e,!0)):new n(1):new n(NaN)},w.cubeRoot=w.cbrt=function(){var t,e,r,n,i,a,o,s,u,h,c=this.constructor;if(!this.isFinite()||this.isZero())return new c(this);for(l=!1,(a=this.s*m(this.s*this,1/3))&&Math.abs(a)!=1/0?n=new c(a.toString()):(r=C(this.d),(a=((t=this.e)-r.length+1)%3)&&(r+=1==a||-2==a?"0":"00"),a=m(r,1/3),t=g((t+1)/3)-(t%3==(t<0?-1:2)),(n=new c(r=a==1/0?"5e"+t:(r=a.toExponential()).slice(0,r.indexOf("e")+1)+t)).s=this.s),o=(t=c.precision)+3;;)if(n=E((h=(u=(s=n).times(s).times(s)).plus(this)).plus(this).times(s),h.plus(u),o+2,1),C(s.d).slice(0,o)===(r=C(n.d)).slice(0,o)){if("9999"!=(r=r.slice(o-3,o+1))&&(i||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(M(n,t+1,1),e=!n.times(n).times(n).eq(this));break}if(!i&&(M(s,t+1,0),s.times(s).times(s).eq(this))){n=s;break}o+=4,i=1}return l=!0,M(n,t,c.rounding,e)},w.decimalPlaces=w.dp=function(){var t,e=this.d,r=NaN;if(e){if(r=((t=e.length-1)-g(this.e/7))*7,t=e[t])for(;t%10==0;t/=10)r--;r<0&&(r=0)}return r},w.dividedBy=w.div=function(t){return E(this,new this.constructor(t))},w.dividedToIntegerBy=w.divToInt=function(t){var e=this.constructor;return M(E(this,new e(t),0,1,1),e.precision,e.rounding)},w.equals=w.eq=function(t){return 0===this.cmp(t)},w.floor=function(){return M(new this.constructor(this),this.e+1,3)},w.greaterThan=w.gt=function(t){return this.cmp(t)>0},w.greaterThanOrEqualTo=w.gte=function(t){var e=this.cmp(t);return 1==e||0===e},w.hyperbolicCosine=w.cosh=function(){var t,e,r,n,i,a=this,o=a.constructor,s=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return s;r=o.precision,n=o.rounding,o.precision=r+Math.max(a.e,a.sd())+4,o.rounding=1,(i=a.d.length)<32?e=(1/V(4,t=Math.ceil(i/3))).toString():(t=16,e="2.3283064365386962890625e-10"),a=q(o,1,a.times(e),new o(1),!0);for(var u,l=t,h=new o(8);l--;)u=a.times(a),a=s.minus(u.times(h.minus(u.times(h))));return M(a,o.precision=r,o.rounding=n,!0)},w.hyperbolicSine=w.sinh=function(){var t,e,r,n,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,r=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,(n=i.d.length)<3)i=q(a,2,i,i,!0);else{t=(t=1.4*Math.sqrt(n))>16?16:0|t,i=q(a,2,i=i.times(1/V(5,t)),i,!0);for(var o,s=new a(5),u=new a(16),l=new a(20);t--;)o=i.times(i),i=i.times(s.plus(o.times(u.times(o).plus(l))))}return a.precision=e,a.rounding=r,M(i,e,r,!0)},w.hyperbolicTangent=w.tanh=function(){var t,e,r=this.constructor;return this.isFinite()?this.isZero()?new r(this):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,E(this.sinh(),this.cosh(),r.precision=t,r.rounding=e)):new r(this.s)},w.inverseCosine=w.acos=function(){var t,e=this,r=e.constructor,n=e.abs().cmp(1),i=r.precision,a=r.rounding;return -1!==n?0===n?e.isNeg()?k(r,i,a):new r(0):new r(NaN):e.isZero()?k(r,i+4,a).times(.5):(r.precision=i+6,r.rounding=1,e=e.asin(),t=k(r,i+4,a).times(.5),r.precision=i,r.rounding=a,t.minus(e))},w.inverseHyperbolicCosine=w.acosh=function(){var t,e,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(t=n.precision,e=n.rounding,n.precision=t+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,l=!1,r=r.times(r).minus(1).sqrt().plus(r),l=!0,n.precision=t,n.rounding=e,r.ln()):new n(r)},w.inverseHyperbolicSine=w.asinh=function(){var t,e,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,l=!1,r=r.times(r).plus(1).sqrt().plus(r),l=!0,n.precision=t,n.rounding=e,r.ln())},w.inverseHyperbolicTangent=w.atanh=function(){var t,e,r,n,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=a.precision,e=a.rounding,Math.max(n=i.sd(),t)<-(2*i.e)-1)?M(new a(i),t,e,!0):(a.precision=r=n-i.e,i=E(i.plus(1),new a(1).minus(i),r+t,1),a.precision=t+4,a.rounding=1,i=i.ln(),a.precision=t,a.rounding=e,i.times(.5)):new a(NaN)},w.inverseSine=w.asin=function(){var t,e,r,n,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),r=a.precision,n=a.rounding,-1!==e)?0===e?((t=k(a,r+4,n).times(.5)).s=i.s,t):new a(NaN):(a.precision=r+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=r,a.rounding=n,i.times(2))},w.inverseTangent=w.atan=function(){var t,e,r,n,i,a,o,s,u,h=this,c=h.constructor,f=c.precision,d=c.rounding;if(h.isFinite()){if(h.isZero())return new c(h);if(h.abs().eq(1)&&f+4<=_)return(o=k(c,f+4,d).times(.25)).s=h.s,o}else{if(!h.s)return new c(NaN);if(f+4<=_)return(o=k(c,f+4,d).times(.5)).s=h.s,o}for(c.precision=s=f+10,c.rounding=1,t=r=Math.min(28,s/7+2|0);t;--t)h=h.div(h.times(h).plus(1).sqrt().plus(1));for(l=!1,e=Math.ceil(s/7),n=1,u=h.times(h),o=new c(h),i=h;-1!==t;)if(i=i.times(u),a=o.minus(i.div(n+=2)),i=i.times(u),void 0!==(o=a.plus(i.div(n+=2))).d[e])for(t=e;o.d[t]===a.d[t]&&t--;);return r&&(o=o.times(2<<r-1)),l=!0,M(o,c.precision=f,c.rounding=d,!0)},w.isFinite=function(){return!!this.d},w.isInteger=w.isInt=function(){return!!this.d&&g(this.e/7)>this.d.length-2},w.isNaN=function(){return!this.s},w.isNegative=w.isNeg=function(){return this.s<0},w.isPositive=w.isPos=function(){return this.s>0},w.isZero=function(){return!!this.d&&0===this.d[0]},w.lessThan=w.lt=function(t){return 0>this.cmp(t)},w.lessThanOrEqualTo=w.lte=function(t){return 1>this.cmp(t)},w.logarithm=w.log=function(t){var e,r,n,i,a,o,s,u=this.constructor,h=u.precision,c=u.rounding;if(null==t)t=new u(10),e=!0;else{if(r=(t=new u(t)).d,t.s<0||!r||!r[0]||t.eq(1))return new u(NaN);e=t.eq(10)}if(r=this.d,this.s<0||!r||!r[0]||this.eq(1))return new u(r&&!r[0]?-1/0:1!=this.s?NaN:r?0:1/0);if(e){if(r.length>1)i=!0;else{for(n=r[0];n%10==0;)n/=10;i=1!==n}}if(l=!1,S((s=E(L(this,o=h+5),e?T(u,o+10):L(t,o),o,1)).d,n=h,c))do if(o+=10,s=E(L(this,o),e?T(u,o+10):L(t,o),o,1),!i){+C(s.d).slice(n+1,n+15)+1==1e14&&(s=M(s,h+1,0));break}while(S(s.d,n+=10,c))return l=!0,M(s,h,c)},w.minus=w.sub=function(t){var e,r,n,i,a,o,s,u,h,c,f,d,p=this.constructor;if(t=new p(t),!this.d||!t.d)return this.s&&t.s?this.d?t.s=-t.s:t=new p(t.d||this.s!==t.s?this:NaN):t=new p(NaN),t;if(this.s!=t.s)return t.s=-t.s,this.plus(t);if(h=this.d,d=t.d,s=p.precision,u=p.rounding,!h[0]||!d[0]){if(d[0])t.s=-t.s;else{if(!h[0])return new p(3===u?-0:0);t=new p(this)}return l?M(t,s,u):t}if(r=g(t.e/7),c=g(this.e/7),h=h.slice(),a=c-r){for((f=a<0)?(e=h,a=-a,o=d.length):(e=d,r=c,o=h.length),a>(n=Math.max(Math.ceil(s/7),o)+2)&&(a=n,e.length=1),e.reverse(),n=a;n--;)e.push(0);e.reverse()}else{for((f=(n=h.length)<(o=d.length))&&(o=n),n=0;n<o;n++)if(h[n]!=d[n]){f=h[n]<d[n];break}a=0}for(f&&(e=h,h=d,d=e,t.s=-t.s),o=h.length,n=d.length-o;n>0;--n)h[o++]=0;for(n=d.length;n>a;){if(h[--n]<d[n]){for(i=n;i&&0===h[--i];)h[i]=1e7-1;--h[i],h[n]+=1e7}h[n]-=d[n]}for(;0===h[--o];)h.pop();for(;0===h[0];h.shift())--r;return h[0]?(t.d=h,t.e=B(h,r),l?M(t,s,u):t):new p(3===u?-0:0)},w.modulo=w.mod=function(t){var e,r=this.constructor;return(t=new r(t),this.d&&t.s&&(!t.d||t.d[0]))?t.d&&(!this.d||this.d[0])?(l=!1,9==r.modulo?(e=E(this,t.abs(),0,3,1),e.s*=t.s):e=E(this,t,0,r.modulo,1),e=e.times(t),l=!0,this.minus(e)):M(new r(this),r.precision,r.rounding):new r(NaN)},w.naturalExponential=w.exp=function(){return U(this)},w.naturalLogarithm=w.ln=function(){return L(this)},w.negated=w.neg=function(){var t=new this.constructor(this);return t.s=-t.s,M(t)},w.plus=w.add=function(t){var e,r,n,i,a,o,s,u,h,c,f=this.constructor;if(t=new f(t),!this.d||!t.d)return this.s&&t.s?this.d||(t=new f(t.d||this.s===t.s?this:NaN)):t=new f(NaN),t;if(this.s!=t.s)return t.s=-t.s,this.minus(t);if(h=this.d,c=t.d,s=f.precision,u=f.rounding,!h[0]||!c[0])return c[0]||(t=new f(this)),l?M(t,s,u):t;if(a=g(this.e/7),n=g(t.e/7),h=h.slice(),i=a-n){for(i<0?(r=h,i=-i,o=c.length):(r=c,n=a,o=h.length),i>(o=(a=Math.ceil(s/7))>o?a+1:o+1)&&(i=o,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for((o=h.length)-(i=c.length)<0&&(i=o,r=c,c=h,h=r),e=0;i;)e=(h[--i]=h[i]+c[i]+e)/1e7|0,h[i]%=1e7;for(e&&(h.unshift(e),++n),o=h.length;0==h[--o];)h.pop();return t.d=h,t.e=B(h,n),l?M(t,s,u):t},w.precision=w.sd=function(t){var e;if(void 0!==t&&!!t!==t&&1!==t&&0!==t)throw Error(c+t);return this.d?(e=P(this.d),t&&this.e+1>e&&(e=this.e+1)):e=NaN,e},w.round=function(){var t=this.constructor;return M(new t(this),this.e+1,t.rounding)},w.sine=w.sin=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(t,e){var r,n=e.d.length;if(n<3)return e.isZero()?e:q(t,2,e,e);r=(r=1.4*Math.sqrt(n))>16?16:0|r,e=q(t,2,e=e.times(1/V(5,r)),e);for(var i,a=new t(5),o=new t(16),s=new t(20);r--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(s))));return e}(n,H(n,r)),n.precision=t,n.rounding=e,M(i>2?r.neg():r,t,e,!0)):new n(NaN)},w.squareRoot=w.sqrt=function(){var t,e,r,n,i,a,o=this.d,s=this.e,u=this.s,h=this.constructor;if(1!==u||!o||!o[0])return new h(!u||u<0&&(!o||o[0])?NaN:o?this:1/0);for(l=!1,0==(u=Math.sqrt(+this))||u==1/0?(((e=C(o)).length+s)%2==0&&(e+="0"),u=Math.sqrt(e),s=g((s+1)/2)-(s<0||s%2),n=new h(e=u==1/0?"5e"+s:(e=u.toExponential()).slice(0,e.indexOf("e")+1)+s)):n=new h(u.toString()),r=(s=h.precision)+3;;)if(n=(a=n).plus(E(this,a,r+2,1)).times(.5),C(a.d).slice(0,r)===(e=C(n.d)).slice(0,r)){if("9999"!=(e=e.slice(r-3,r+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(M(n,s+1,1),t=!n.times(n).eq(this));break}if(!i&&(M(a,s+1,0),a.times(a).eq(this))){n=a;break}r+=4,i=1}return l=!0,M(n,s,h.rounding,t)},w.tangent=w.tan=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+10,n.rounding=1,(r=r.sin()).s=1,r=E(r,new n(1).minus(r.times(r)).sqrt(),t+10,0),n.precision=t,n.rounding=e,M(2==i||4==i?r.neg():r,t,e,!0)):new n(NaN)},w.times=w.mul=function(t){var e,r,n,i,a,o,s,u,h,c=this.constructor,f=this.d,d=(t=new c(t)).d;if(t.s*=this.s,!f||!f[0]||!d||!d[0])return new c(t.s&&(!f||f[0]||d)&&(!d||d[0]||f)?f&&d?0*t.s:t.s/0:NaN);for(r=g(this.e/7)+g(t.e/7),(u=f.length)<(h=d.length)&&(a=f,f=d,d=a,o=u,u=h,h=o),a=[],n=o=u+h;n--;)a.push(0);for(n=h;--n>=0;){for(e=0,i=u+n;i>n;)s=a[i]+d[n]*f[i-n-1]+e,a[i--]=s%1e7|0,e=s/1e7|0;a[i]=(a[i]+e)%1e7|0}for(;!a[--o];)a.pop();return e?++r:a.shift(),t.d=a,t.e=B(a,r),l?M(t,c.precision,c.rounding):t},w.toBinary=function(t,e){return W(this,2,t,e)},w.toDecimalPlaces=w.toDP=function(t,e){var r=this,n=r.constructor;return(r=new n(r),void 0===t)?r:(A(t,0,1e9),void 0===e?e=n.rounding:A(e,0,8),M(r,t+r.e+1,e))},w.toExponential=function(t,e){var r,n=this,i=n.constructor;return void 0===t?r=N(n,!0):(A(t,0,1e9),void 0===e?e=i.rounding:A(e,0,8),r=N(n=M(new i(n),t+1,e),!0,t+1)),n.isNeg()&&!n.isZero()?"-"+r:r},w.toFixed=function(t,e){var r,n,i=this.constructor;return void 0===t?r=N(this):(A(t,0,1e9),void 0===e?e=i.rounding:A(e,0,8),r=N(n=M(new i(this),t+this.e+1,e),!1,t+n.e+1)),this.isNeg()&&!this.isZero()?"-"+r:r},w.toFraction=function(t){var e,r,n,i,a,o,s,u,h,f,d,p,g=this.d,y=this.constructor;if(!g)return new y(this);if(h=r=new y(1),n=u=new y(0),o=(a=(e=new y(n)).e=P(g)-this.e-1)%7,e.d[0]=m(10,o<0?7+o:o),null==t)t=a>0?e:h;else{if(!(s=new y(t)).isInt()||s.lt(h))throw Error(c+s);t=s.gt(e)?a>0?e:h:s}for(l=!1,s=new y(C(g)),f=y.precision,y.precision=a=14*g.length;d=E(s,e,0,1,1),1!=(i=r.plus(d.times(n))).cmp(t);)r=n,n=i,i=h,h=u.plus(d.times(i)),u=i,i=e,e=s.minus(d.times(i)),s=i;return i=E(t.minus(r),n,0,1,1),u=u.plus(i.times(h)),r=r.plus(i.times(n)),u.s=h.s=this.s,p=1>E(h,n,a,1).minus(this).abs().cmp(E(u,r,a,1).minus(this).abs())?[h,n]:[u,r],y.precision=f,l=!0,p},w.toHexadecimal=w.toHex=function(t,e){return W(this,16,t,e)},w.toNearest=function(t,e){var r=this,n=r.constructor;if(r=new n(r),null==t){if(!r.d)return r;t=new n(1),e=n.rounding}else{if(t=new n(t),void 0===e?e=n.rounding:A(e,0,8),!r.d)return t.s?r:t;if(!t.d)return t.s&&(t.s=r.s),t}return t.d[0]?(l=!1,r=E(r,t,0,e,1).times(t),l=!0,M(r)):(t.s=r.s,r=t),r},w.toNumber=function(){return+this},w.toOctal=function(t,e){return W(this,8,t,e)},w.toPower=w.pow=function(t){var e,r,n,i,a,o,s=this,u=s.constructor,h=+(t=new u(t));if(!s.d||!t.d||!s.d[0]||!t.d[0])return new u(m(+s,h));if((s=new u(s)).eq(1))return s;if(n=u.precision,a=u.rounding,t.eq(1))return M(s,n,a);if((e=g(t.e/7))>=t.d.length-1&&(r=h<0?-h:h)<=0x1fffffffffffff)return i=I(u,s,r,n),t.s<0?new u(1).div(i):M(i,n,a);if((o=s.s)<0){if(e<t.d.length-1)return new u(NaN);if((1&t.d[e])==0&&(o=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=o,s}return(e=0!=(r=m(+s,h))&&isFinite(r)?new u(r+"").e:g(h*(Math.log("0."+C(s.d))/Math.LN10+s.e+1)))>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(l=!1,u.rounding=s.s=1,r=Math.min(12,(e+"").length),(i=U(t.times(L(s,n+r)),n)).d&&S((i=M(i,n+5,1)).d,n,a)&&(e=n+10,+C((i=M(U(t.times(L(s,e+r)),e),e+5,1)).d).slice(n+1,n+15)+1==1e14&&(i=M(i,n+1,0))),i.s=o,l=!0,u.rounding=a,M(i,n,a))},w.toPrecision=function(t,e){var r,n=this,i=n.constructor;return void 0===t?r=N(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(A(t,1,1e9),void 0===e?e=i.rounding:A(e,0,8),r=N(n=M(new i(n),t,e),t<=n.e||n.e<=i.toExpNeg,t)),n.isNeg()&&!n.isZero()?"-"+r:r},w.toSignificantDigits=w.toSD=function(t,e){var r=this.constructor;return void 0===t?(t=r.precision,e=r.rounding):(A(t,1,1e9),void 0===e?e=r.rounding:A(e,0,8)),M(new r(this),t,e)},w.toString=function(){var t=this.constructor,e=N(this,this.e<=t.toExpNeg||this.e>=t.toExpPos);return this.isNeg()&&!this.isZero()?"-"+e:e},w.truncated=w.trunc=function(){return M(new this.constructor(this),this.e+1,1)},w.valueOf=w.toJSON=function(){var t=this.constructor,e=N(this,this.e<=t.toExpNeg||this.e>=t.toExpPos);return this.isNeg()?"-"+e:e};var E=function(){function t(t,e,r){var n,i=0,a=t.length;for(t=t.slice();a--;)n=t[a]*e+i,t[a]=n%r|0,i=n/r|0;return i&&t.unshift(i),t}function e(t,e,r,n){var i,a;if(r!=n)a=r>n?1:-1;else for(i=a=0;i<r;i++)if(t[i]!=e[i]){a=t[i]>e[i]?1:-1;break}return a}function n(t,e,r,n){for(var i=0;r--;)t[r]-=i,i=t[r]<e[r]?1:0,t[r]=i*n+t[r]-e[r];for(;!t[0]&&t.length>1;)t.shift()}return function(i,a,o,s,u,l){var h,c,f,d,p,m,y,v,x,D,b,_,w,C,A,S,F,E,N,B,T=i.constructor,k=i.s==a.s?1:-1,P=i.d,O=a.d;if(!P||!P[0]||!O||!O[0])return new T(i.s&&a.s&&(P?!O||P[0]!=O[0]:O)?P&&0==P[0]||!O?0*k:k/0:NaN);for(l?(p=1,c=i.e-a.e):(l=1e7,p=7,c=g(i.e/p)-g(a.e/p)),N=O.length,F=P.length,D=(x=new T(k)).d=[],f=0;O[f]==(P[f]||0);f++);if(O[f]>(P[f]||0)&&c--,null==o?(C=o=T.precision,s=T.rounding):C=u?o+(i.e-a.e)+1:o,C<0)D.push(1),m=!0;else{if(C=C/p+2|0,f=0,1==N){for(d=0,O=O[0],C++;(f<F||d)&&C--;f++)A=d*l+(P[f]||0),D[f]=A/O|0,d=A%O|0;m=d||f<F}else{for((d=l/(O[0]+1)|0)>1&&(O=t(O,d,l),P=t(P,d,l),N=O.length,F=P.length),S=N,_=(b=P.slice(0,N)).length;_<N;)b[_++]=0;(B=O.slice()).unshift(0),E=O[0],O[1]>=l/2&&++E;do d=0,(h=e(O,b,N,_))<0?(w=b[0],N!=_&&(w=w*l+(b[1]||0)),(d=w/E|0)>1?(d>=l&&(d=l-1),v=(y=t(O,d,l)).length,_=b.length,1==(h=e(y,b,v,_))&&(d--,n(y,N<v?B:O,v,l))):(0==d&&(h=d=1),y=O.slice()),(v=y.length)<_&&y.unshift(0),n(b,y,_,l),-1==h&&(_=b.length,(h=e(O,b,N,_))<1&&(d++,n(b,N<_?B:O,_,l))),_=b.length):0===h&&(d++,b=[0]),D[f++]=d,h&&b[0]?b[_++]=P[S]||0:(b=[P[S]],_=1);while((S++<F||void 0!==b[0])&&C--)m=void 0!==b[0]}D[0]||D.shift()}if(1==p)x.e=c,r=m;else{for(f=1,d=D[0];d>=10;d/=10)f++;x.e=f+c*p-1,M(x,u?o+x.e+1:o,s,m)}return x}}();function M(t,e,r,n){var i,a,o,s,u,h,c,f,d,p=t.constructor;t:if(null!=e){if(!(f=t.d))return t;for(i=1,s=f[0];s>=10;s/=10)i++;if((a=e-i)<0)a+=7,o=e,u=(c=f[d=0])/m(10,i-o-1)%10|0;else if((d=Math.ceil((a+1)/7))>=(s=f.length)){if(n){for(;s++<=d;)f.push(0);c=u=0,i=1,a%=7,o=a-7+1}else break t}else{for(i=1,c=s=f[d];s>=10;s/=10)i++;a%=7,u=(o=a-7+i)<0?0:c/m(10,i-o-1)%10|0}if(n=n||e<0||void 0!==f[d+1]||(o<0?c:c%m(10,i-o-1)),h=r<4?(u||n)&&(0==r||r==(t.s<0?3:2)):u>5||5==u&&(4==r||n||6==r&&(a>0?o>0?c/m(10,i-o):0:f[d-1])%10&1||r==(t.s<0?8:7)),e<1||!f[0])return f.length=0,h?(e-=t.e+1,f[0]=m(10,(7-e%7)%7),t.e=-e||0):f[0]=t.e=0,t;if(0==a?(f.length=d,s=1,d--):(f.length=d+1,s=m(10,7-a),f[d]=o>0?(c/m(10,i-o)%m(10,o)|0)*s:0),h)for(;;)if(0==d){for(a=1,o=f[0];o>=10;o/=10)a++;for(o=f[0]+=s,s=1;o>=10;o/=10)s++;a!=s&&(t.e++,1e7==f[0]&&(f[0]=1));break}else{if(f[d]+=s,1e7!=f[d])break;f[d--]=0,s=1}for(a=f.length;0===f[--a];)f.pop()}return l&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function N(t,e,r){if(!t.isFinite())return G(t);var n,i=t.e,a=C(t.d),o=a.length;return e?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+O(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):i<0?(a="0."+O(-i-1)+a,r&&(n=r-o)>0&&(a+=O(n))):i>=o?(a+=O(i+1-o),r&&(n=r-i-1)>0&&(a=a+"."+O(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(a+="."),a+=O(n))),a}function B(t,e){var r=t[0];for(e*=7;r>=10;r/=10)e++;return e}function T(t,e,r){if(e>b)throw l=!0,r&&(t.precision=r),Error(f);return M(new t(o),e,1,!0)}function k(t,e,r){if(e>_)throw Error(f);return M(new t(s),e,r,!0)}function P(t){var e=t.length-1,r=7*e+1;if(e=t[e]){for(;e%10==0;e/=10)r--;for(e=t[0];e>=10;e/=10)r++}return r}function O(t){for(var e="";t--;)e+="0";return e}function I(t,e,r,n){var i,a=new t(1),o=Math.ceil(n/7+4);for(l=!1;;){if(r%2&&K((a=a.times(e)).d,o)&&(i=!0),0===(r=g(r/2))){r=a.d.length-1,i&&0===a.d[r]&&++a.d[r];break}K((e=e.times(e)).d,o)}return l=!0,a}function z(t){return 1&t.d[t.d.length-1]}function R(t,e,r){for(var n,i=new t(e[0]),a=0;++a<e.length;)if((n=new t(e[a])).s)i[r](n)&&(i=n);else{i=n;break}return i}function U(t,e){var r,n,i,a,o,s,u,h=0,c=0,f=0,d=t.constructor,p=d.rounding,g=d.precision;if(!t.d||!t.d[0]||t.e>17)return new d(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:0/0);for(null==e?(l=!1,u=g):u=e,s=new d(.03125);t.e>-2;)t=t.times(s),f+=5;for(u+=n=Math.log(m(2,f))/Math.LN10*2+5|0,r=a=o=new d(1),d.precision=u;;){if(a=M(a.times(t),u,1),r=r.times(++c),C((s=o.plus(E(a,r,u,1))).d).slice(0,u)===C(o.d).slice(0,u)){for(i=f;i--;)o=M(o.times(o),u,1);if(null!=e)return d.precision=g,o;if(!(h<3&&S(o.d,u-n,p,h)))return M(o,d.precision=g,p,l=!0);d.precision=u+=10,r=a=s=new d(1),c=0,h++}o=s}}function L(t,e){var r,n,i,a,o,s,u,h,c,f,d,p=1,g=t,m=g.d,y=g.constructor,v=y.rounding,x=y.precision;if(g.s<0||!m||!m[0]||!g.e&&1==m[0]&&1==m.length)return new y(m&&!m[0]?-1/0:1!=g.s?NaN:m?0:g);if(null==e?(l=!1,c=x):c=e,y.precision=c+=10,n=(r=C(m)).charAt(0),!(15e14>Math.abs(a=g.e)))return h=T(y,c+2,x).times(a+""),g=L(new y(n+"."+r.slice(1)),c-10).plus(h),y.precision=x,null==e?M(g,x,v,l=!0):g;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=C((g=g.times(t)).d)).charAt(0),p++;for(a=g.e,n>1?(g=new y("0."+r),a++):g=new y(n+"."+r.slice(1)),f=g,u=o=g=E(g.minus(1),g.plus(1),c,1),d=M(g.times(g),c,1),i=3;;){if(o=M(o.times(d),c,1),C((h=u.plus(E(o,new y(i),c,1))).d).slice(0,c)===C(u.d).slice(0,c)){if(u=u.times(2),0!==a&&(u=u.plus(T(y,c+2,x).times(a+""))),u=E(u,new y(p),c,1),null!=e)return y.precision=x,u;if(!S(u.d,c-10,v,s))return M(u,y.precision=x,v,l=!0);y.precision=c+=10,h=o=g=E(f.minus(1),f.plus(1),c,1),d=M(g.times(g),c,1),i=s=1}u=h,i+=2}}function G(t){return String(t.s*t.s/0)}function j(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;48===e.charCodeAt(n);n++);for(i=e.length;48===e.charCodeAt(i-1);--i);if(e=e.slice(n,i)){if(i-=n,t.e=r=r-n-1,t.d=[],n=(r+1)%7,r<0&&(n+=7),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=7;n<i;)t.d.push(+e.slice(n,n+=7));n=7-(e=e.slice(n)).length}else n-=i;for(;n--;)e+="0";t.d.push(+e),l&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function q(t,e,r,n,i){var a,o,s,u,h=t.precision,c=Math.ceil(h/7);for(l=!1,u=r.times(r),s=new t(n);;){if(o=E(s.times(u),new t(e++*e++),h,1),s=i?n.plus(o):n.minus(o),n=E(o.times(u),new t(e++*e++),h,1),void 0!==(o=s.plus(n)).d[c]){for(a=c;o.d[a]===s.d[a]&&a--;);if(-1==a)break}a=s,s=n,n=o,o=a}return l=!0,o.d.length=c+1,o}function V(t,e){for(var r=t;--e;)r*=t;return r}function H(t,e){var r,n=e.s<0,a=k(t,t.precision,1),o=a.times(.5);if((e=e.abs()).lte(o))return i=n?4:1,e;if((r=e.divToInt(a)).isZero())i=n?3:2;else{if((e=e.minus(r.times(a))).lte(o))return i=z(r)?n?2:3:n?4:1,e;i=z(r)?n?1:4:n?3:2}return e.minus(a).abs()}function W(t,e,n,i){var o,s,u,l,h,c,f,d,p,g=t.constructor,m=void 0!==n;if(m?(A(n,1,1e9),void 0===i?i=g.rounding:A(i,0,8)):(n=g.precision,i=g.rounding),t.isFinite()){for(u=(f=N(t)).indexOf("."),m?(o=2,16==e?n=4*n-3:8==e&&(n=3*n-2)):o=e,u>=0&&(f=f.replace(".",""),(p=new g(1)).e=f.length-u,p.d=F(N(p),10,o),p.e=p.d.length),s=h=(d=F(f,10,o)).length;0==d[--h];)d.pop();if(d[0]){if(u<0?s--:((t=new g(t)).d=d,t.e=s,d=(t=E(t,p,n,i,0,o)).d,s=t.e,c=r),u=d[n],l=o/2,c=c||void 0!==d[n+1],c=i<4?(void 0!==u||c)&&(0===i||i===(t.s<0?3:2)):u>l||u===l&&(4===i||c||6===i&&1&d[n-1]||i===(t.s<0?8:7)),d.length=n,c)for(;++d[--n]>o-1;)d[n]=0,n||(++s,d.unshift(1));for(h=d.length;!d[h-1];--h);for(u=0,f="";u<h;u++)f+=a.charAt(d[u]);if(m){if(h>1){if(16==e||8==e){for(u=16==e?4:3,--h;h%u;h++)f+="0";for(h=(d=F(f,o,e)).length;!d[h-1];--h);for(u=1,f="1.";u<h;u++)f+=a.charAt(d[u])}else f=f.charAt(0)+"."+f.slice(1)}f=f+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)f="0"+f;f="0."+f}else if(++s>h)for(s-=h;s--;)f+="0";else s<h&&(f=f.slice(0,s)+"."+f.slice(s))}else f=m?"0p+0":"0";f=(16==e?"0x":2==e?"0b":8==e?"0o":"")+f}else f=G(t);return t.s<0?"-"+f:f}function K(t,e){if(t.length>e)return t.length=e,!0}function Y(t){return new this(t).abs()}function X(t){return new this(t).acos()}function $(t){return new this(t).acosh()}function Z(t,e){return new this(t).plus(e)}function J(t){return new this(t).asin()}function Q(t){return new this(t).asinh()}function tt(t){return new this(t).atan()}function te(t){return new this(t).atanh()}function tr(t,e){t=new this(t),e=new this(e);var r,n=this.precision,i=this.rounding,a=n+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(r=e.s<0?k(this,n,i):new this(0)).s=t.s:!t.d||e.isZero()?(r=k(this,a,1).times(.5)).s=t.s:e.s<0?(this.precision=a,this.rounding=1,r=this.atan(E(t,e,a,1)),e=k(this,a,1),this.precision=n,this.rounding=i,r=t.s<0?r.minus(e):r.plus(e)):r=this.atan(E(t,e,a,1)):(r=k(this,a,1).times(e.s>0?.25:.75)).s=t.s:r=new this(NaN),r}function tn(t){return new this(t).cbrt()}function ti(t){return M(t=new this(t),t.e+1,2)}function ta(t,e,r){return new this(t).clamp(e,r)}function to(t){if(!t||"object"!=typeof t)throw Error(h+"Object expected");var e,r,n,i=!0===t.defaults,a=["precision",1,1e9,"rounding",0,8,"toExpNeg",-9e15,0,"toExpPos",0,9e15,"maxE",0,9e15,"minE",-9e15,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(r=a[e],i&&(this[r]=u[r]),void 0!==(n=t[r])){if(g(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(c+r+": "+n)}if(r="crypto",i&&(this[r]=u[r]),void 0!==(n=t[r])){if(!0===n||!1===n||0===n||1===n){if(n){if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[r]=!0;else throw Error(d)}else this[r]=!1}else throw Error(c+r+": "+n)}return this}function ts(t){return new this(t).cos()}function tu(t){return new this(t).cosh()}function tl(t,e){return new this(t).div(e)}function th(t){return new this(t).exp()}function tc(t){return M(t=new this(t),t.e+1,3)}function tf(){var t,e,r=new this(0);for(t=0,l=!1;t<arguments.length;)if(e=new this(arguments[t++]),e.d)r.d&&(r=r.plus(e.times(e)));else{if(e.s)return l=!0,new this(1/0);r=e}return l=!0,r.sqrt()}function td(t){return t instanceof e||t&&t.toStringTag===p||!1}function tp(t){return new this(t).ln()}function tg(t,e){return new this(t).log(e)}function tm(t){return new this(t).log(2)}function ty(t){return new this(t).log(10)}function tv(){return R(this,arguments,"lt")}function tx(){return R(this,arguments,"gt")}function tD(t,e){return new this(t).mod(e)}function tb(t,e){return new this(t).mul(e)}function t_(t,e){return new this(t).pow(e)}function tw(t){var e,r,n,i,a=0,o=new this(1),s=[];if(void 0===t?t=this.precision:A(t,1,1e9),n=Math.ceil(t/7),this.crypto){if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(n));a<n;)(i=e[a])>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:s[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(n*=4);a<n;)(i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((127&e[a+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,a):(s.push(i%1e7),a+=4);a=n/4}else throw Error(d)}else for(;a<n;)s[a++]=1e7*Math.random()|0;for(n=s[--a],t%=7,n&&t&&(i=m(10,7-t),s[a]=(n/i|0)*i);0===s[a];a--)s.pop();if(a<0)r=0,s=[0];else{for(r=-1;0===s[0];r-=7)s.shift();for(n=1,i=s[0];i>=10;i/=10)n++;n<7&&(r-=7-n)}return o.e=r,o.d=s,o}function tC(t){return M(t=new this(t),t.e+1,this.rounding)}function tA(t){return(t=new this(t)).d?t.d[0]?t.s:0*t.s:t.s||NaN}function tS(t){return new this(t).sin()}function tF(t){return new this(t).sinh()}function tE(t){return new this(t).sqrt()}function tM(t,e){return new this(t).sub(e)}function tN(){var t=0,e=arguments,r=new this(e[0]);for(l=!1;r.s&&++t<e.length;)r=r.plus(e[t]);return l=!0,M(r,this.precision,this.rounding)}function tB(t){return new this(t).tan()}function tT(t){return new this(t).tanh()}function tk(t){return M(t=new this(t),t.e+1,1)}(e=function t(r){var n,i,a;function o(t){var r,n,i;if(!(this instanceof o))return new o(t);if(this.constructor=o,td(t)){this.s=t.s,l?!t.d||t.e>o.maxE?(this.e=NaN,this.d=null):t.e<o.minE?(this.e=0,this.d=[0]):(this.e=t.e,this.d=t.d.slice()):(this.e=t.e,this.d=t.d?t.d.slice():t.d);return}if("number"==(i=typeof t)){if(0===t){this.s=1/t<0?-1:1,this.e=0,this.d=[0];return}if(t<0?(t=-t,this.s=-1):this.s=1,t===~~t&&t<1e7){for(r=0,n=t;n>=10;n/=10)r++;l?r>o.maxE?(this.e=NaN,this.d=null):r<o.minE?(this.e=0,this.d=[0]):(this.e=r,this.d=[t]):(this.e=r,this.d=[t]);return}if(0*t!=0){t||(this.s=NaN),this.e=NaN,this.d=null;return}return j(this,t.toString())}if("string"!==i)throw Error(c+t);return 45===(n=t.charCodeAt(0))?(t=t.slice(1),this.s=-1):(43===n&&(t=t.slice(1)),this.s=1),D.test(t)?j(this,t):function(t,r){var n,i,a,o,s,u,h,f,d;if(r.indexOf("_")>-1){if(r=r.replace(/(\d)_(?=\d)/g,"$1"),D.test(r))return j(t,r)}else if("Infinity"===r||"NaN"===r)return+r||(t.s=NaN),t.e=NaN,t.d=null,t;if(v.test(r))n=16,r=r.toLowerCase();else if(y.test(r))n=2;else if(x.test(r))n=8;else throw Error(c+r);for((o=r.search(/p/i))>0?(h=+r.slice(o+1),r=r.substring(2,o)):r=r.slice(2),s=(o=r.indexOf("."))>=0,i=t.constructor,s&&(o=(u=(r=r.replace(".","")).length)-o,a=I(i,new i(n),o,2*o)),o=d=(f=F(r,n,1e7)).length-1;0===f[o];--o)f.pop();return o<0?new i(0*t.s):(t.e=B(f,d),t.d=f,l=!1,s&&(t=E(t,a,4*u)),h&&(t=t.times(54>Math.abs(h)?m(2,h):e.pow(2,h))),l=!0,t)}(this,t)}if(o.prototype=w,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=to,o.clone=t,o.isDecimal=td,o.abs=Y,o.acos=X,o.acosh=$,o.add=Z,o.asin=J,o.asinh=Q,o.atan=tt,o.atanh=te,o.atan2=tr,o.cbrt=tn,o.ceil=ti,o.clamp=ta,o.cos=ts,o.cosh=tu,o.div=tl,o.exp=th,o.floor=tc,o.hypot=tf,o.ln=tp,o.log=tg,o.log10=ty,o.log2=tm,o.max=tv,o.min=tx,o.mod=tD,o.mul=tb,o.pow=t_,o.random=tw,o.round=tC,o.sign=tA,o.sin=tS,o.sinh=tF,o.sqrt=tE,o.sub=tM,o.sum=tN,o.tan=tB,o.tanh=tT,o.trunc=tk,void 0===r&&(r={}),r&&!0!==r.defaults)for(n=0,a=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"];n<a.length;)r.hasOwnProperty(i=a[n++])||(r[i]=this[i]);return o.config(r),o}(u)).prototype.constructor=e,e.default=e.Decimal=e,o=new e(o),s=new e(s),"function"==typeof define&&define.amd?define(function(){return e}):iJ?("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(w[Symbol.for("nodejs.util.inspect.custom")]=w.toString,w[Symbol.toStringTag]="Decimal"),iJ=e):(t||(t="undefined"!=typeof self&&self&&self.self==self?self:window),n=t.Decimal,e.noConflict=function(){return t.Decimal=n,e},t.Decimal=e)}(iJ);var iQ=/* #__PURE__ */nD("BigNumber",["?on","config"],t=>{var{on:e,config:r}=t,n=/*@__PURE__*/i(iJ).clone({precision:r.precision,modulo:/*@__PURE__*/i(iJ).EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(t){return new n(t.value)},e&&e("config",function(t,e){t.precision!==e.precision&&n.config({precision:t.precision})}),n},{isClass:!0});function i0(t){if(t.isFinite()&&!t.isInteger())throw Error("Integer expected in function bitNot");var e=t.constructor,r=e.precision;e.config({precision:1e9});var n=t.plus(new e(1));return n.s=-n.s||null,e.config({precision:r}),n}function i1(t,e,r){var n,i,a,o,s,u=t.constructor,l=+(t.s<0),h=+(e.s<0);if(l){n=i2(i0(t));for(var c=0;c<n.length;++c)n[c]^=1}else n=i2(t);if(h){i=i2(i0(e));for(var f=0;f<i.length;++f)i[f]^=1}else i=i2(e);n.length<=i.length?(a=n,o=i,s=l):(a=i,o=n,s=h);var d=a.length,p=o.length,g=1^r(l,h),m=new u(1^g),y=new u(1),v=new u(2),x=u.precision;for(u.config({precision:1e9});d>0;)r(a[--d],o[--p])===g&&(m=m.plus(y)),y=y.times(v);for(;p>0;)r(s,o[--p])===g&&(m=m.plus(y)),y=y.times(v);return u.config({precision:x}),0===g&&(m.s=-m.s),m}function i2(t){for(var e=t.d,r=e[0]+"",n=1;n<e.length;++n){for(var i=e[n]+"",a=7-i.length;a--;)i="0"+i;r+=i}for(var o=r.length;"0"===r.charAt(o);)o--;var s=t.e,u=r.slice(0,o+1||1),l=u.length;if(s>0){if(++s>l)for(s-=l;s--;)u+="0";else s<l&&(u=u.slice(0,s)+"."+u.slice(s))}for(var h=[0],c=0;c<u.length;){for(var f=h.length;f--;)h[f]*=10;h[0]+=parseInt(u.charAt(c++));for(var d=0;d<h.length;++d)h[d]>1&&((null===h[d+1]||void 0===h[d+1])&&(h[d+1]=0),h[d+1]+=h[d]>>1,h[d]&=1)}return h.reverse()}nD("bin",["typed","format"],t=>{var{typed:e,format:r}=t;return e("bin",{"number | BigNumber":function(t){return r(t,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(t,e){return r(t,{notation:"bin",wordSize:e})}})});var i5="number, number",i3=/* #__PURE__ */nD("matAlgo07xSSf",["typed","SparseMatrix"],t=>{var{typed:e,SparseMatrix:r}=t;return function(t,i,a){var o,s=t._size,u=t._datatype||void 0===t._data?t._datatype:t.getDataType(),l=i._size,h=i._datatype||void 0===i._data?i._datatype:i.getDataType();if(s.length!==l.length)throw new n$(s.length,l.length);if(s[0]!==l[0]||s[1]!==l[1])throw RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+l+")");var c=s[0],f=s[1],d=0,p=a;"string"==typeof u&&u===h&&"mixed"!==u&&(o=u,d=e.convert(0,o),p=e.find(a,[o,o]));for(var g=[],m=[],y=Array(f+1).fill(0),v=[],x=[],D=[],b=[],_=0;_<f;_++){var w=_+1,C=0;n(t,_,D,v,w),n(i,_,b,x,w);for(var A=0;A<c;A++){var S=p(D[A]===w?v[A]:d,b[A]===w?x[A]:d);0!==S&&!1!==S&&(m.push(A),g.push(S),C++)}y[_+1]=y[_]+C}return new r({values:g,index:m,ptr:y,size:[c,f],datatype:u===t._datatype&&h===i._datatype?o:void 0})};function n(t,e,r,n,i){for(var a=t._values,o=t._index,s=t._ptr,u=s[e],l=s[e+1];u<l;u++){var h=o[u];r[h]=i,n[h]=a[u]}}});function i4(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-9,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(r<=0)throw Error("Relative tolerance must be greater than 0");if(n<0)throw Error("Absolute tolerance must be at least 0");return!(t.isNaN()||e.isNaN())&&(t.isFinite()&&e.isFinite()?!!t.eq(e)||t.minus(e).abs().lte(t.constructor.max(t.constructor.max(t.abs(),e.abs()).mul(r),n)):t.eq(e))}var i8="ceil",i6=/* #__PURE__ */nD(i8,["typed","config","round"],t=>{var{typed:e,config:r,round:n}=t;return e(i8,{number:function(t){return nz(t,n(t),r.relTol,r.absTol)?n(t):Math.ceil(t)},"number, number":function(t,e){if(nz(t,n(t,e),r.relTol,r.absTol))return n(t,e);var[i,a]="".concat(t,"e").split("e"),o=Math.ceil(Number("".concat(i,"e").concat(Number(a)+e)));return[i,a]="".concat(o,"e").split("e"),Number("".concat(i,"e").concat(Number(a)-e))}})}),i9=/* #__PURE__ */nD(i8,["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],t=>{var{typed:e,config:r,round:n,matrix:a,equalScalar:o,zeros:s,DenseMatrix:u}=t,l=ij({typed:e,equalScalar:o}),h=iX({typed:e,DenseMatrix:u}),c=iO({typed:e}),f=i6({typed:e,config:r,round:n});return e("ceil",{number:f.signatures.number,"number,number":f.signatures["number,number"],Complex:function(t){return t.ceil()},"Complex, number":function(t,e){return t.ceil(e)},"Complex, BigNumber":function(t,e){return t.ceil(e.toNumber())},BigNumber:function(t){return i4(t,n(t),r.relTol,r.absTol)?n(t):t.ceil()},"BigNumber, BigNumber":function(t,e){return i4(t,n(t,e),r.relTol,r.absTol)?n(t,e):t.toDecimalPlaces(e.toNumber(),/*@__PURE__*/i(iJ).ROUND_CEIL)},Fraction:function(t){return t.ceil()},"Fraction, number":function(t,e){return t.ceil(e)},"Fraction, BigNumber":function(t,e){return t.ceil(e.toNumber())},"Unit, number, Unit":e.referToSelf(t=>function(e,r,n){var i=e.toNumeric(n);return n.multiply(t(i,r))}),"Unit, BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>t(e,r.toNumber(),n)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>ih(e,e=>t(e,r,n),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(t=>(e,r)=>t(e,0,r)),"Array | Matrix":e.referToSelf(t=>e=>ih(e,t,!0)),"Array, number | BigNumber":e.referToSelf(t=>(e,r)=>ih(e,e=>t(e,r),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>l(e,r,t,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>c(e,r,t,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(t=>(e,r)=>c(a(r),e,t,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(t=>(e,r)=>o(e,0)?s(r.size(),r.storage()):"dense"===r.storage()?c(r,e,t,!0):h(r,e,t,!0))})}),i7="column",at=/* #__PURE__ */nD(i7,["typed","Index","matrix","range"],t=>{var{typed:e,Index:r,matrix:n,range:i}=t;return e(i7,{"Matrix, number":a,"Array, number":function(t,e){return a(n(ng(t)),e).valueOf()}});function a(t,e){if(2!==t.size().length)throw Error("Only two dimensional matrix is supported");n0(e,t.size()[1]);var a=new r(i(0,t.size()[0]),e),o=t.subset(a);return rH(o)?o:n([[o]])}});function ae(t,e){if(e<t)return 1;if(e===t)return e;var r=e+t>>1;return ae(t,r)*ae(r+1,e)}function ar(t,e){if(!nw(t)||t<0||!nw(e)||e<0)throw TypeError("Positive integer value expected in function combinations");if(e>t)throw TypeError("k must be less than or equal to n");for(var r=t-e,n=1,i=e<r?r+1:e+1,a=2,o=e<r?e:r,s=i;s<=t;++s)for(n*=s;a<=o&&n%a==0;)n/=a,++a;return a<=o&&(n/=ae(a,o)),n}ar.signature="number, number";var an="combinations";function ai(t){return t.isInteger()&&t.gte(0)}t=>{var{typed:e}=t;return e(an,{"number, number":ar,"BigNumber, BigNumber":function(t,e){var r,n,i=t.constructor,a=t.minus(e),o=new i(1);if(!ai(t)||!ai(e))throw TypeError("Positive integer value expected in function combinations");if(e.gt(t))throw TypeError("k must be less than n in function combinations");if(r=o,e.lt(a))for(n=o;n.lte(a);n=n.plus(o))r=r.times(e.plus(n)).dividedBy(n);else for(n=o;n.lte(e);n=n.plus(o))r=r.times(a.plus(n)).dividedBy(n);return r}})};var aa=/* #__PURE__ */nD("matAlgo05xSfSf",["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o,s,u,l,h=t._values,c=t._index,f=t._ptr,d=t._size,p=t._datatype||void 0===t._data?t._datatype:t.getDataType(),g=n._values,m=n._index,y=n._ptr,v=n._size,x=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(d.length!==v.length)throw new n$(d.length,v.length);if(d[0]!==v[0]||d[1]!==v[1])throw RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+v+")");var D=d[0],b=d[1],_=r,w=0,C=i;"string"==typeof p&&p===x&&"mixed"!==p&&(a=p,_=e.find(r,[a,a]),w=e.convert(0,a),C=e.find(i,[a,a]));var A=h&&g?[]:void 0,S=[],F=[],E=A?[]:void 0,M=A?[]:void 0,N=[],B=[];for(s=0;s<b;s++){F[s]=S.length;var T=s+1;for(u=f[s],l=f[s+1];u<l;u++)o=c[u],S.push(o),N[o]=T,E&&(E[o]=h[u]);for(u=y[s],l=y[s+1];u<l;u++)N[o=m[u]]!==T&&S.push(o),B[o]=T,M&&(M[o]=g[u]);if(A)for(u=F[s];u<S.length;){var k=N[o=S[u]],P=B[o];if(k===T||P===T){var O=C(k===T?E[o]:w,P===T?M[o]:w);_(O,w)?S.splice(u,1):(A.push(O),u++)}}}return F[b]=S.length,t.createSparseMatrix({values:A,index:S,ptr:F,size:[D,b],datatype:p===t._datatype&&x===n._datatype?a:void 0})}}),ao=/* #__PURE__ */nD("compareUnits",["typed"],t=>{var{typed:e}=t;return{"Unit, Unit":e.referToSelf(t=>(r,n)=>{if(!r.equalBase(n))throw Error("Cannot compare units with different base");return e.find(t,[r.valueType(),n.valueType()])(r.value,n.value)})}}),as="compare",au=/* #__PURE__ */nD(as,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],t=>{var{typed:e,config:r,equalScalar:n,matrix:i,BigNumber:a,Fraction:o,DenseMatrix:s,concat:u}=t,l=iY({typed:e}),h=aa({typed:e,equalScalar:n}),c=iX({typed:e,DenseMatrix:s}),f=iz({typed:e,matrix:i,concat:u}),d=ao({typed:e});return e(as,al({typed:e,config:r}),{"boolean, boolean":function(t,e){return t===e?0:t>e?1:-1},"BigNumber, BigNumber":function(t,e){return new a(i4(t,e,r.relTol,r.absTol)?0:t.cmp(e))},"bigint, bigint":function(t,e){return t===e?0n:t>e?1n:-1n},"Fraction, Fraction":function(t,e){return new o(t.compare(e))},"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},d,f({SS:h,DS:l,Ss:c}))}),al=/* #__PURE__ */nD(as,["typed","config"],t=>{var{typed:e,config:r}=t;return e(as,{"number, number":function(t,e){return nz(t,e,r.relTol,r.absTol)?0:t>e?1:-1}})}),ah={};ah=function t(e,r){var n,i,a=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,u=/^0x[0-9a-f]+$/i,l=/^0/,h=function(e){return t.insensitive&&(""+e).toLowerCase()||""+e},c=h(e).replace(o,"")||"",f=h(r).replace(o,"")||"",d=c.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=f.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=parseInt(c.match(u),16)||1!==d.length&&c.match(s)&&Date.parse(c),m=parseInt(f.match(u),16)||g&&f.match(s)&&Date.parse(f)||null;if(m){if(g<m)return -1;if(g>m)return 1}for(var y=0,v=Math.max(d.length,p.length);y<v;y++){if(n=!(d[y]||"").match(l)&&parseFloat(d[y])||d[y]||0,i=!(p[y]||"").match(l)&&parseFloat(p[y])||p[y]||0,isNaN(n)!==isNaN(i))return isNaN(n)?1:-1;if(typeof n!=typeof i&&(n+="",i+=""),n<i)return -1;if(n>i)return 1}return 0};var ac="compareNatural",af=/* #__PURE__ */nD(ac,["typed","compare"],t=>{var{typed:e,compare:r}=t,n=r.signatures["boolean,boolean"];return e(ac,{"any, any":function t(e,o){var s,u=np(e),l=np(o);if(("number"===u||"BigNumber"===u||"Fraction"===u)&&("number"===l||"BigNumber"===l||"Fraction"===l))return"0"!==(s=r(e,o)).toString()?s>0?1:-1:/*@__PURE__*/i(ah)(u,l);var h=["Array","DenseMatrix","SparseMatrix"];if(h.includes(u)||h.includes(l))return 0!==(s=function t(e,r,n){return rY(r)&&rY(n)?a(e,r.toJSON().values,n.toJSON().values):rY(r)?t(e,r.toArray(),n):rY(n)?t(e,r,n.toArray()):rK(r)?t(e,r.toJSON().data,n):rK(n)?t(e,r,n.toJSON().data):Array.isArray(r)?Array.isArray(n)?a(e,r,n):t(e,r,[n]):t(e,[r],n)}(t,e,o))?s:/*@__PURE__*/i(ah)(u,l);if(u!==l)return /*@__PURE__*/i(ah)(u,l);if("Complex"===u)return e.re>o.re?1:e.re<o.re?-1:e.im>o.im?1:e.im<o.im?-1:0;if("Unit"===u)return e.equalBase(o)?t(e.value,o.value):a(t,e.formatUnits(),o.formatUnits());if("boolean"===u)return n(e,o);if("string"===u)return /*@__PURE__*/i(ah)(e,o);if("Object"===u)return function(t,e,r){var n=Object.keys(e),o=Object.keys(r);n.sort(/*@__PURE__*/i(ah)),o.sort(/*@__PURE__*/i(ah));var s=a(t,n,o);if(0!==s)return s;for(var u=0;u<n.length;u++){var l=t(e[n[u]],r[o[u]]);if(0!==l)return l}return 0}(t,e,o);if("null"===u||"undefined"===u)return 0;throw TypeError('Unsupported type of value "'+u+'"')}});function a(t,e,r){for(var n=0,i=Math.min(e.length,r.length);n<i;n++){var a=t(e[n],r[n]);if(0!==a)return a}return e.length>r.length?1:e.length<r.length?-1:0}});nX.signature="any, any",t=>{var{typed:e,matrix:r,concat:n}=t,i=iz({typed:e,matrix:r,concat:n});return e("compareText",nX,i({elop:nX,Ds:!0}))};var ad=/* #__PURE__ */nD("complex",["typed","Complex"],t=>{var{typed:e,Complex:r}=t;return e("complex",{"":function(){return r.ZERO},number:function(t){return new r(t,0)},"number, number":function(t,e){return new r(t,e)},"BigNumber, BigNumber":function(t,e){return new r(t.toNumber(),e.toNumber())},Fraction:function(t){return new r(t.valueOf(),0)},Complex:function(t){return t.clone()},string:function(t){return r(t)},null:function(t){return r(0)},Object:function(t){if("re"in t&&"im"in t)return new r(t.re,t.im);if("r"in t&&"phi"in t||"abs"in t&&"arg"in t)return new r(t);throw Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})}),ap={};!function(t){function e(t,e){if(null==t)u.re=u.im=0;else if(void 0!==e)u.re=t,u.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)u.re=t.re,u.im=t.im;else if("abs"in t&&"arg"in t){if(!isFinite(t.abs)&&isFinite(t.arg))return a.INFINITY;u.re=t.abs*Math.cos(t.arg),u.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!isFinite(t.r)&&isFinite(t.phi))return a.INFINITY;u.re=t.r*Math.cos(t.phi),u.im=t.r*Math.sin(t.phi)}else 2===t.length?(u.re=t[0],u.im=t[1]):r();break;case"string":u.im=u.re=0,t=t.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),e=1;let n=0;null===t&&r();for(let i=0;i<t.length;i++){let a=t[i];" "!==a&&"	"!==a&&"\n"!==a&&("+"===a?e++:"-"===a?n++:("i"===a||"I"===a?(0===e+n&&r()," "===t[i+1]||isNaN(t[i+1])?u.im+=parseFloat((n%2?"-":"")+"1"):(u.im+=parseFloat((n%2?"-":"")+t[i+1]),i++)):((0===e+n||isNaN(a))&&r(),"i"===t[i+1]||"I"===t[i+1]?(u.im+=parseFloat((n%2?"-":"")+a),i++):u.re+=parseFloat((n%2?"-":"")+a)),e=n=0))}0<e+n&&r();break;case"number":u.im=0,u.re=t;break;default:r()}return u}function r(){throw SyntaxError("Invalid Param")}function n(t,e){return((t=Math.abs(t))<(e=Math.abs(e))&&([t,e]=[e,t]),1e8>t)?Math.sqrt(t*t+e*e):(e/=t,t*Math.sqrt(1+e*e))}function i(t,e){let r=Math.abs(t),n=Math.abs(e);return 0===t?Math.log(n):0===e?Math.log(r):3e3>r&&3e3>n?.5*Math.log(t*t+e*e):.5*Math.log((t*=.5)*t+(e*=.5)*e)+Math.LN2}function a(t,r){if(!(this instanceof a))return new a(t,r);t=e(t,r),this.re=t.re,this.im=t.im}let o=Math.cosh||function(t){return 1e-9>Math.abs(t)?1-t:.5*(Math.exp(t)+Math.exp(-t))},s=Math.sinh||function(t){return 1e-9>Math.abs(t)?t:.5*(Math.exp(t)-Math.exp(-t))},u={re:0,im:0};a.prototype={re:0,im:0,sign:function(){let t=n(this.re,this.im);return new a(this.re/t,this.im/t)},add:function(t,r){t=e(t,r),r=this.isInfinite();let n=!(isFinite(t.re)&&isFinite(t.im));return r||n?r&&n?a.NAN:a.INFINITY:new a(this.re+t.re,this.im+t.im)},sub:function(t,r){t=e(t,r),r=this.isInfinite();let n=!(isFinite(t.re)&&isFinite(t.im));return r||n?r&&n?a.NAN:a.INFINITY:new a(this.re-t.re,this.im-t.im)},mul:function(t,r){t=e(t,r),r=this.isInfinite();let n=!(isFinite(t.re)&&isFinite(t.im)),i=0===this.re&&0===this.im,o=0===t.re&&0===t.im;return r&&o||n&&i?a.NAN:r||n?a.INFINITY:0===t.im&&0===this.im?new a(this.re*t.re,0):new a(this.re*t.re-this.im*t.im,this.re*t.im+this.im*t.re)},div:function(t,r){t=e(t,r),r=this.isInfinite();let n=!(isFinite(t.re)&&isFinite(t.im)),i=0===this.re&&0===this.im,o=0===t.re&&0===t.im;return i&&o||r&&n?a.NAN:o||r?a.INFINITY:i||n?a.ZERO:0===t.im?new a(this.re/t.re,this.im/t.re):Math.abs(t.re)<Math.abs(t.im)?(r=t.re/t.im,t=t.re*r+t.im,new a((this.re*r+this.im)/t,(this.im*r-this.re)/t)):(r=t.im/t.re,t=t.im*r+t.re,new a((this.re+this.im*r)/t,(this.im-this.re*r)/t))},pow:function(t,r){if(t=e(t,r),r=0===this.re&&0===this.im,0===t.re&&0===t.im)return a.ONE;if(0===t.im){if(0===this.im&&0<this.re)return new a(Math.pow(this.re,t.re),0);if(0===this.re)switch((t.re%4+4)%4){case 0:return new a(Math.pow(this.im,t.re),0);case 1:return new a(0,Math.pow(this.im,t.re));case 2:return new a(-Math.pow(this.im,t.re),0);case 3:return new a(0,-Math.pow(this.im,t.re))}}if(r&&0<t.re)return a.ZERO;let n=Math.atan2(this.im,this.re),o=i(this.re,this.im);return new a((r=Math.exp(t.re*o-t.im*n))*Math.cos(t=t.im*o+t.re*n),r*Math.sin(t))},sqrt:function(){let t=this.re,e=this.im;if(0===e)return 0<=t?new a(Math.sqrt(t),0):new a(0,Math.sqrt(-t));var r=n(t,e);let i=Math.abs(e)/(2*(r=Math.sqrt(.5*(r+Math.abs(t)))));return 0<=t?new a(r,0>e?-i:i):new a(i,0>e?-r:r)},exp:function(){let t=Math.exp(this.re);return 0===this.im?new a(t,0):new a(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){let t=this.re,e=this.im;var r=Math.expm1(t)*Math.cos(e),n=Math.PI/4;return-n>e||e>n?n=Math.cos(e)-1:(n=e*e,n*=n*(n*(n*(n*(n*(n*(n/20922789888e3-1/0x144c3b2800)+1/0x1c8cfc00)-1/3628800)+1/40320)-1/720)+1/24)-.5),new a(r+n,Math.exp(t)*Math.sin(e))},log:function(){let t=this.re,e=this.im;return 0===e&&0<t?new a(Math.log(t),0):new a(i(t,e),Math.atan2(e,t))},abs:function(){return n(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){let t=this.re,e=this.im;return new a(Math.sin(t)*o(e),Math.cos(t)*s(e))},cos:function(){let t=this.re,e=this.im;return new a(Math.cos(t)*o(e),-Math.sin(t)*s(e))},tan:function(){let t=2*this.re,e=2*this.im,r=Math.cos(t)+o(e);return new a(Math.sin(t)/r,s(e)/r)},cot:function(){let t=2*this.re,e=2*this.im,r=Math.cos(t)-o(e);return new a(-Math.sin(t)/r,s(e)/r)},sec:function(){let t=this.re,e=this.im,r=.5*o(2*e)+.5*Math.cos(2*t);return new a(Math.cos(t)*o(e)/r,Math.sin(t)*s(e)/r)},csc:function(){let t=this.re,e=this.im,r=.5*o(2*e)-.5*Math.cos(2*t);return new a(Math.sin(t)*o(e)/r,-Math.cos(t)*s(e)/r)},asin:function(){var t=this.re;let e=this.im,r=new a(e*e-t*t+1,-2*t*e).sqrt();return t=new a(r.re-e,r.im+t).log(),new a(t.im,-t.re)},acos:function(){var t=this.re;let e=this.im,r=new a(e*e-t*t+1,-2*t*e).sqrt();return t=new a(r.re-e,r.im+t).log(),new a(Math.PI/2-t.im,t.re)},atan:function(){var t=this.re;let e=this.im;if(0===t){if(1===e)return new a(0,1/0);if(-1===e)return new a(0,-1/0)}let r=t*t+(1-e)*(1-e);return t=new a((1-e*e-t*t)/r,-2*t/r).log(),new a(-.5*t.im,.5*t.re)},acot:function(){let t=this.re,e=this.im;if(0===e)return new a(Math.atan2(1,t),0);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).atan():new a(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){let t=this.re,e=this.im;if(0===t&&0===e)return new a(0,1/0);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).acos():new a(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){let t=this.re,e=this.im;if(0===t&&0===e)return new a(Math.PI/2,1/0);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).asin():new a(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){let t=this.re,e=this.im;return new a(s(t)*Math.cos(e),o(t)*Math.sin(e))},cosh:function(){let t=this.re,e=this.im;return new a(o(t)*Math.cos(e),s(t)*Math.sin(e))},tanh:function(){let t=2*this.re,e=2*this.im,r=o(t)+Math.cos(e);return new a(s(t)/r,Math.sin(e)/r)},coth:function(){let t=2*this.re,e=2*this.im,r=o(t)-Math.cos(e);return new a(s(t)/r,-Math.sin(e)/r)},csch:function(){let t=this.re,e=this.im,r=Math.cos(2*e)-o(2*t);return new a(-2*s(t)*Math.cos(e)/r,2*o(t)*Math.sin(e)/r)},sech:function(){let t=this.re,e=this.im,r=Math.cos(2*e)+o(2*t);return new a(2*o(t)*Math.cos(e)/r,-2*s(t)*Math.sin(e)/r)},asinh:function(){let t=this.im;this.im=-this.re,this.re=t;let e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){let t=this.acos();if(0>=t.im){var e=t.re;t.re=-t.im,t.im=e}else e=t.im,t.im=-t.re,t.re=e;return t},atanh:function(){var t=this.re,e=this.im;let r=1<t&&0===e,n=1-t,o=1+t,s=n*n+e*e;return e=(t=0!==s?new a((o*n-e*e)/s,(e*n+o*e)/s):new a(-1!==t?t/0:0,0!==e?e/0:0)).re,t.re=i(t.re,t.im)/2,t.im=Math.atan2(t.im,e)/2,r&&(t.im=-t.im),t},acoth:function(){let t=this.re,e=this.im;if(0===t&&0===e)return new a(0,Math.PI/2);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).atanh():new a(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){let t=this.re,e=this.im;if(0===e)return new a(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).asinh():new a(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){let t=this.re,e=this.im;if(this.isZero())return a.INFINITY;let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).acosh():new a(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return a.INFINITY;if(this.isInfinite())return a.ZERO;let t=this.re,e=this.im,r=t*t+e*e;return new a(t/r,-e/r)},conjugate:function(){return new a(this.re,-this.im)},neg:function(){return new a(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new a(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new a(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new a(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,r){return Math.abs((t=e(t,r)).re-this.re)<=a.EPSILON&&Math.abs(t.im-this.im)<=a.EPSILON},clone:function(){return new a(this.re,this.im)},toString:function(){let t=this.re,e=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(t)<a.EPSILON&&(t=0),Math.abs(e)<a.EPSILON&&(e=0),0===e)?r+t:(0!==t?(r=r+t+" ",0>e?(e=-e,r+="-"):r+="+",r+=" "):0>e&&(e=-e,r+="-"),1!==e&&(r+=e),r+"i")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!this.isFinite()}},a.ZERO=new a(0,0),a.ONE=new a(1,0),a.I=new a(0,1),a.PI=new a(Math.PI,0),a.E=new a(Math.E,0),a.INFINITY=new a(1/0,1/0),a.NAN=new a(NaN,NaN),a.EPSILON=1e-15,"function"==typeof define&&define.amd?define([],function(){return a}):(Object.defineProperty(a,"__esModule",{value:!0}),a.default=a,a.Complex=a,ap=a)}(0);var ag=/* #__PURE__ */nD("Complex",[],()=>(Object.defineProperty(/*@__PURE__*/i(ap),"name",{value:"Complex"}),/*@__PURE__*/i(ap).prototype.constructor=/*@__PURE__*/i(ap),/*@__PURE__*/i(ap).prototype.type="Complex",/*@__PURE__*/i(ap).prototype.isComplex=!0,/*@__PURE__*/i(ap).prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},/*@__PURE__*/i(ap).prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},/*@__PURE__*/i(ap).prototype.format=function(t){var e=this.im,r=this.re,n=nN(this.re,t),i=nN(this.im,t),a=rz(t)?t:t?t.precision:null;if(null!==a){var o=Math.pow(10,-a);Math.abs(r/e)<o&&(r=0),Math.abs(e/r)<o&&(e=0)}return 0===e?n:0===r?1===e?"i":-1===e?"-i":i+"i":e<0?-1===e?n+" - i":n+" - "+i.substring(1)+"i":1===e?n+" + i":n+" + "+i+"i"},/*@__PURE__*/i(ap).fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return /*@__PURE__*/i(ap)(e);throw TypeError("Input has to be an object with r and phi keys.");case 2:var r=arguments[0],n=arguments[1];if(rz(r)){if(rj(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),rz(n))return new/*@__PURE__*/(i(ap))({r:r,phi:n});throw TypeError("Phi is not a number nor an angle unit.")}throw TypeError("Radius r is not a number.");default:throw SyntaxError("Wrong number of arguments in function fromPolar")}},/*@__PURE__*/i(ap).prototype.valueOf=/*@__PURE__*/i(ap).prototype.toString,/*@__PURE__*/i(ap).fromJSON=function(t){return new/*@__PURE__*/(i(ap))(t)},/*@__PURE__*/i(ap).compare=function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0},/*@__PURE__*/i(ap)),{isClass:!0}),am="concat",ay=/* #__PURE__ */nD(am,["typed","matrix","isInteger"],t=>{var{typed:e,matrix:r,isInteger:n}=t;return e(am,{"...Array | Matrix | number | BigNumber":function(t){var e,i,a=t.length,o=-1,s=!1,u=[];for(e=0;e<a;e++){var l=t[e];if(rH(l)&&(s=!0),rz(l)||rR(l)){if(e!==a-1)throw Error("Dimension must be specified as last argument");if(i=o,!n(o=l.valueOf()))throw TypeError("Integer number expected for dimension");if(o<0||e>0&&o>i)throw new n_(o,i+1)}else{var h=ng(l).valueOf(),c=nZ(h);if(u[e]=h,i=o,o=c.length-1,e>0&&o!==i)throw new n$(i+1,o+1)}}if(0===u.length)throw SyntaxError("At least one matrix expected");for(var f=u.shift();u.length;)f=ie(f,u.shift(),o);return s?r(f):f},"...string":function(t){return t.join("")}})}),av="conj",ax=/* #__PURE__ */nD(av,["typed"],t=>{var{typed:e}=t;return e(av,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.conjugate(),"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})}),aD=/* #__PURE__ */nD("trigUnit",["typed"],t=>{var{typed:e}=t;return{Unit:e.referToSelf(t=>r=>{if(!r.hasBase(r.constructor.BASE_UNITS.ANGLE))throw TypeError("Unit in function cot is no angle");return e.find(t,r.valueType())(r.value)})}}),ab=/* #__PURE__ */nD("cos",["typed"],t=>{var{typed:e}=t,r=aD({typed:e});return e("cos",{number:Math.cos,"Complex | BigNumber":t=>t.cos()},r)}),a_="ctranspose",aw=/* #__PURE__ */nD(a_,["typed","transpose","conj"],t=>{var{typed:e,transpose:r,conj:n}=t;return e(a_,{any:function(t){return n(r(t))}})});function aC(t,e,r){var n;return String(t).includes("Unexpected type")?(n=arguments.length>2?" (type: "+np(r)+", value: "+JSON.stringify(r)+")":" (type: "+t.data.actual+")",TypeError("Cannot calculate "+e+", unexpected type of argument"+n)):String(t).includes("complex numbers")?(n=arguments.length>2?" (type: "+np(r)+", value: "+JSON.stringify(r)+")":"",TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+n)):t}var aA=(t=>{var{typed:e,equal:r}=t;return e("deepEqual",{"any, any":function(t,e){return function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n))return!1;var i=e.length;if(i!==n.length)return!1;for(var a=0;a<i;a++)if(!t(e[a],n[a]))return!1;return!0}return!Array.isArray(n)&&r(e,n)}(t.valueOf(),e.valueOf())}})},{});function aS(t,e,r){if(/*@__PURE__*/i(aA).isTypedFunction(t)){var n=(e.isMatrix?e.size():nZ(e)).map(()=>0),a=e.isMatrix?e.get(n):io(e,n),o=1===Object.keys(t.signatures).length,s=function(t,e,r,n){for(var a=[e,r,n],o=3;o>0;o--){var s=a.slice(0,o);if(null!==/*@__PURE__*/i(aA).resolve(t,s))return o}}(t,a,n,e),u=o?Object.values(t.signatures)[0]:t;return s>=1&&s<=3?function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return aF(u,n.slice(0,s),r,t.name)}:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return aF(u,n,r,t.name)}}return t}function aF(t,e,r,n){try{return t(...e)}catch(t){!function(t,e,r,n){var i;if(t instanceof TypeError&&(null===(i=t.data)||void 0===i?void 0:i.category)==="wrongType"){var a=[];throw a.push("value: ".concat(np(e[0]))),e.length>=2&&a.push("index: ".concat(np(e[1]))),e.length>=3&&a.push("array: ".concat(np(e[2]))),TypeError("Function ".concat(r," cannot apply callback arguments ")+"".concat(n,"(").concat(a.join(", "),") at index ").concat(JSON.stringify(e[1])))}throw TypeError("Function ".concat(r," cannot apply callback arguments ")+"to function ".concat(n,": ").concat(t.message))}(t,e,r,n)}}aA=function(){function t(){return!0}function e(){return!1}function r(){}let n="Argument is not a typed-function.";return function i(){let a,o;function s(t){return"object"==typeof t&&null!==t&&t.constructor===Object}let u=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:s},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],l={name:"any",test:t,isAny:!0},h=0,c={createCount:0};function f(t){let e;let r=a.get(t);if(r)return r;let n='Unknown type "'+t+'"',i=t.toLowerCase();for(e of o)if(e.toLowerCase()===i){n+='. Did you mean "'+e+'" ?';break}throw TypeError(n)}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any",r=e?f(e).index:o.length,n=[];for(let e=0;e<t.length;++e){if(!t[e]||"string"!=typeof t[e].name||"function"!=typeof t[e].test)throw TypeError("Object with properties {name: string, test: function} expected");let i=t[e].name;if(a.has(i))throw TypeError('Duplicate type name "'+i+'"');n.push(i),a.set(i,{name:i,test:t[e].test,isAny:t[e].isAny,index:r+e,conversionsTo:[]})}let i=o.slice(r);o=o.slice(0,r).concat(n).concat(i);for(let t=r+n.length;t<o.length;++t)a.get(o[t]).index=t}function p(){a=new Map,o=[],h=0,d([l],!1)}function g(t){let e=o.filter(e=>{let r=a.get(e);return!r.isAny&&r.test(t)});return e.length?e:["any"]}function m(t){return t&&"function"==typeof t&&"_typedFunctionData"in t}function y(t,e,r){let i,a;if(!m(t))throw TypeError(n);let o=r&&r.exact,s=b(Array.isArray(e)?e.join(","):e),u=v(s);if(!o||u in t.signatures){let e=t._typedFunctionData.signatureMap.get(u);if(e)return e}let l=s.length;if(o){let e;for(e in i=[],t.signatures)i.push(t._typedFunctionData.signatureMap.get(e))}else i=t._typedFunctionData.signatures;for(let t=0;t<l;++t){let e;let r=s[t],n=[];for(e of i){let i=C(e.params,t);if(i&&(!r.restParam||i.restParam)){if(!i.hasAny){let t=D(i);if(r.types.some(e=>!t.has(e.name)))continue}n.push(e)}}if(0===(i=n).length)break}for(a of i)if(a.params.length<=l)return a;throw TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+v(s,", ")+"))")}function v(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return t.map(t=>t.name).join(e)}function x(t){let e=function(t){if(0===t.length)return[];let e=t.map(f);t.length>1&&e.sort((t,e)=>t.index-e.index);let r=e[0].conversionsTo;if(1===t.length)return r;r=r.concat([]);let n=new Set(t);for(let t=1;t<e.length;++t){let i;for(i of e[t].conversionsTo)n.has(i.from)||(r.push(i),n.add(i.from))}return r}(t.types.map(t=>t.name)),r=t.hasAny,n=t.name,i=e.map(function(t){let e=f(t.from);return r=e.isAny||r,n+="|"+t.from,{name:t.from,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:t,conversionIndex:t.index}});return{types:t.types.concat(i),name:n,hasAny:r,hasConversion:i.length>0,restParam:t.restParam}}function D(t){return t.typeSet||(t.typeSet=new Set,t.types.forEach(e=>t.typeSet.add(e.name))),t.typeSet}function b(t){let e=[];if("string"!=typeof t)throw TypeError("Signatures must be strings");let r=t.trim();if(""===r)return e;let n=r.split(",");for(let t=0;t<n.length;++t){let r=function(t){let e=0===t.indexOf("..."),r=(e?t.length>3?t.slice(3):"any":t).split("|").map(t=>f(t.trim())),n=!1,i=e?"...":"";return{types:r.map(function(t){return n=t.isAny||n,i+=t.name+"|",{name:t.name,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:null,conversionIndex:-1}}),name:i.slice(0,-1),hasAny:n,hasConversion:!1,restParam:e}}(n[t].trim());if(r.restParam&&t!==n.length-1)throw SyntaxError('Unexpected rest parameter "'+n[t]+'": only allowed for the last parameter');if(0===r.types.length)return null;e.push(r)}return e}function _(t){let e=O(t);return!!e&&e.restParam}function w(e){if(!e||0===e.types.length)return t;if(1===e.types.length)return f(e.types[0].name).test;if(2===e.types.length){let t=f(e.types[0].name).test,r=f(e.types[1].name).test;return function(e){return t(e)||r(e)}}{let t=e.types.map(function(t){return f(t.name).test});return function(e){for(let r=0;r<t.length;r++)if(t[r](e))return!0;return!1}}}function C(t,e){return e<t.length?t[e]:_(t)?O(t):null}function A(t,e){let r=C(t,e);return r?D(r):new Set}function S(t){return null===t.conversion||void 0===t.conversion}function F(t,e){let r=new Set;return t.forEach(t=>{let n;for(n of A(t.params,e))r.add(n)}),r.has("any")?["any"]:Array.from(r)}function E(t,e,r){let n,i,a;let o=t||"unnamed",s=r;for(a=0;a<e.length;a++){let t=[];if(s.forEach(r=>{let n=w(C(r.params,a));(a<r.params.length||_(r.params))&&n(e[a])&&t.push(r)}),0===t.length){if((i=F(s,a)).length>0){let t=g(e[a]);return(n=TypeError("Unexpected type of argument in function "+o+" (expected: "+i.join(" or ")+", actual: "+t.join(" | ")+", index: "+a+")")).data={category:"wrongType",fn:o,index:a,actual:t,expected:i},n}}else s=t}let u=s.map(function(t){return _(t.params)?1/0:t.params.length});if(e.length<Math.min.apply(null,u))return(n=TypeError("Too few arguments in function "+o+" (expected: "+(i=F(s,a)).join(" or ")+", index: "+e.length+")")).data={category:"tooFewArgs",fn:o,index:e.length,expected:i},n;let l=Math.max.apply(null,u);if(e.length>l)return(n=TypeError("Too many arguments in function "+o+" (expected: "+l+", actual: "+e.length+")")).data={category:"tooManyArgs",fn:o,index:e.length,expectedLength:l},n;let h=[];for(let t=0;t<e.length;++t)h.push(g(e[t]).join("|"));return(n=TypeError('Arguments of type "'+h.join(", ")+'" do not match any of the defined signatures of function '+o+".")).data={category:"mismatch",actual:h},n}function M(t){let e=o.length+1;for(let r=0;r<t.types.length;r++)S(t.types[r])&&(e=Math.min(e,t.types[r].typeIndex));return e}function N(t){let e=h+1;for(let r=0;r<t.types.length;r++)S(t.types[r])||(e=Math.min(e,t.types[r].conversionIndex));return e}function B(t,e){let r,n;let i=t.params,a=e.params,o=O(i),s=O(a),u=_(i),l=_(a);if(u&&o.hasAny){if(!l||!s.hasAny)return 1}else if(l&&s.hasAny)return -1;let h=0,c=0;for(r of i)r.hasAny&&++h,r.hasConversion&&++c;let f=0,d=0;for(r of a)r.hasAny&&++f,r.hasConversion&&++d;if(h!==f)return h-f;if(u&&o.hasConversion){if(!l||!s.hasConversion)return 1}else if(l&&s.hasConversion)return -1;if(c!==d)return c-d;if(u){if(!l)return 1}else if(l)return -1;let p=(i.length-a.length)*(u?-1:1);if(0!==p)return p;let g=[],m=0;for(let t=0;t<i.length;++t){let e=function(t,e){if(t.hasAny){if(!e.hasAny)return 1}else if(e.hasAny)return -1;if(t.restParam){if(!e.restParam)return 1}else if(e.restParam)return -1;if(t.hasConversion){if(!e.hasConversion)return 1}else if(e.hasConversion)return -1;let r=M(t)-M(e);if(r<0)return -1;if(r>0)return 1;let n=N(t)-N(e);return n<0?-1:n>0?1:0}(i[t],a[t]);g.push(e),m+=e}if(0!==m)return m;for(n of g)if(0!==n)return n;return 0}function T(t){let e,r,n,i;let a=[],o=[];switch(t.types.forEach(function(t){t.conversion&&(a.push(f(t.conversion.from).test),o.push(t.conversion.convert))}),o.length){case 0:return function(t){return t};case 1:return e=a[0],n=o[0],function(t){return e(t)?n(t):t};case 2:return e=a[0],r=a[1],n=o[0],i=o[1],function(t){return e(t)?n(t):r(t)?i(t):t};default:return function(t){for(let e=0;e<o.length;e++)if(a[e](t))return o[e](t);return t}}}function k(t,e,r){throw E(t,e,r)}function P(t){return I(t,0,t.length-1)}function O(t){return t[t.length-1]}function I(t,e,r){return Array.prototype.slice.call(t,e,r)}function z(t,e){return{referTo:{references:t,callback:e}}}function R(t){if("function"!=typeof t)throw TypeError("Callback function expected as first argument");return{referToSelf:{callback:t}}}function U(t){return t&&"object"==typeof t.referTo&&Array.isArray(t.referTo.references)&&"function"==typeof t.referTo.callback}function L(t){return t&&"object"==typeof t.referToSelf&&"function"==typeof t.referToSelf.callback}function G(t,e){if(!t)return e;if(e&&e!==t){let r=Error("Function names do not match (expected: "+t+", actual: "+e+")");throw r.data={actual:e,expected:t},r}return t}p(),d(u);let j=c;function q(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw TypeError("Object with properties {from: string, to: string, convert: function} expected");if(t.to===t.from)throw SyntaxError('Illegal to define conversion from "'+t.from+'" to itself.')}return(c=function(t){let n="string"==typeof t,i=n?1:0,a=n?t:"",o={};for(let t=i;t<arguments.length;++t){let e;let r=arguments[t],i={};if("function"==typeof r?(e=r.name,"string"==typeof r.signature?i[r.signature]=r:m(r)&&(i=r.signatures)):s(r)&&(i=r,n||(e=function(t){let e;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(m(t[r])||"string"==typeof t[r].signature)&&(e=G(e,t[r].name));return e}(r))),0===Object.keys(i).length){let e=TypeError("Argument to 'typed' at index "+t+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw e.data={index:t,argument:r},e}n||(a=G(a,e)),function(t,e){let r;for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(r in t&&e[r]!==t[r]){let n=Error('Signature "'+r+'" is defined twice');throw n.data={signature:r,sourceFunction:e[r],destFunction:t[r]},n}t[r]=e[r]}}(o,i)}return function(t,n){let i,a;if(c.createCount++,0===Object.keys(n).length)throw SyntaxError("No signatures provided");c.warnAgainstDeprecatedThis&&function(t){let e=/\bthis(\(|\.signatures\b)/;Object.keys(t).forEach(r=>{let n=t[r];if(e.test(n.toString()))throw SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}(n);let o=[],s=[],u={},l=[];for(i in n){let t;if(!Object.prototype.hasOwnProperty.call(n,i))continue;let e=b(i);if(!e)continue;o.forEach(function(t){if(function(t,e){let r=Math.max(t.length,e.length);for(let n=0;n<r;n++){let r;let i=A(t,n),a=A(e,n),o=!1;for(r of a)if(i.has(r)){o=!0;break}if(!o)return!1}let n=t.length,i=e.length,a=_(t),o=_(e);return a?o?n===i:i>=n:o?n>=i:n===i}(t,e))throw TypeError('Conflicting signatures "'+v(t)+'" and "'+v(e)+'".')}),o.push(e);let r=s.length;for(t of(s.push(n[i]),function t(e,r,n){if(!(r<e.length))return[n];{var i,a;let o=e[r],s=[];if(o.restParam){let t=o.types.filter(S);t.length<o.types.length&&s.push({types:t,name:"..."+t.map(t=>t.name).join("|"),hasAny:t.some(t=>t.isAny),hasConversion:!1,restParam:!0}),s.push(o)}else s=o.types.map(function(t){return{types:[t],name:t.name,hasAny:t.isAny,hasConversion:t.conversion,restParam:!1}});return i=s,a=function(i){return t(e,r+1,n.concat([i]))},Array.prototype.concat.apply([],i.map(a))}}(e.map(x),0,[]))){let e=v(t);l.push({params:t,name:e,fn:r}),t.every(t=>!t.hasConversion)&&(u[e]=r)}}l.sort(B);let h=function(t,e,r){let n=t.map(t=>L(t)?R(t.referToSelf.callback):U(t)?z(t.referTo.references,t.referTo.callback):t),i=Array(n.length).fill(!1),a=!0;for(;a;){a=!1;let t=!0;for(let o=0;o<n.length;++o){if(i[o])continue;let s=n[o];if(L(s))n[o]=s.referToSelf.callback(r),n[o].referToSelf=s.referToSelf,i[o]=!0,t=!1;else if(U(s)){let r=function(t,e,r){let n;let i=[];for(n of t){let t=r[n];if("number"!=typeof t)throw TypeError('No definition for referenced signature "'+n+'"');if("function"!=typeof(t=e[t]))return!1;i.push(t)}return i}(s.referTo.references,n,e);r?(n[o]=s.referTo.callback.apply(this,r),n[o].referTo=s.referTo,i[o]=!0,t=!1):a=!0}}if(t&&a)throw SyntaxError("Circular reference detected in resolving typed.referTo")}return n}(s,u,tc);for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(u[a]=h[u[a]]);let f=[],d=new Map;for(a of l)d.has(a.name)||(a.fn=h[a.fn],f.push(a),d.set(a.name,a));let p=f[0]&&f[0].params.length<=2&&!_(f[0].params),g=f[1]&&f[1].params.length<=2&&!_(f[1].params),m=f[2]&&f[2].params.length<=2&&!_(f[2].params),y=f[3]&&f[3].params.length<=2&&!_(f[3].params),D=f[4]&&f[4].params.length<=2&&!_(f[4].params),C=f[5]&&f[5].params.length<=2&&!_(f[5].params);for(let t=0;t<f.length;++t)f[t].test=function(t){let e,r,n;if(_(t)){let r=(e=P(t).map(w)).length,n=w(O(t)),i=function(t){for(let e=r;e<t.length;e++)if(!n(t[e]))return!1;return!0};return function(t){for(let r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return i(t)&&t.length>=r+1}}return 0===t.length?function(t){return 0===t.length}:1===t.length?(r=w(t[0]),function(t){return r(t[0])&&1===t.length}):2===t.length?(r=w(t[0]),n=w(t[1]),function(t){return r(t[0])&&n(t[1])&&2===t.length}):(e=t.map(w),function(t){for(let r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return t.length===e.length})}(f[t].params);let F=p?w(f[0].params[0]):e,E=g?w(f[1].params[0]):e,M=m?w(f[2].params[0]):e,N=y?w(f[3].params[0]):e,k=D?w(f[4].params[0]):e,G=C?w(f[5].params[0]):e,j=p?w(f[0].params[1]):e,q=g?w(f[1].params[1]):e,V=m?w(f[2].params[1]):e,H=y?w(f[3].params[1]):e,W=D?w(f[4].params[1]):e,K=C?w(f[5].params[1]):e;for(let t=0;t<f.length;++t)f[t].implementation=function(t,e){let r=e;if(t.some(t=>t.hasConversion)){let n=_(t),i=t.map(T);r=function(){let t=[],r=n?arguments.length-1:arguments.length;for(let e=0;e<r;e++)t[e]=i[e](arguments[e]);return n&&(t[r]=arguments[r].map(i[r])),e.apply(this,t)}}let n=r;if(_(t)){let e=t.length-1;n=function(){return r.apply(this,I(arguments,0,e).concat([I(arguments,e)]))}}return n}(f[t].params,f[t].fn);let Y=p?f[0].implementation:r,X=g?f[1].implementation:r,$=m?f[2].implementation:r,Z=y?f[3].implementation:r,J=D?f[4].implementation:r,Q=C?f[5].implementation:r,tt=p?f[0].params.length:-1,te=g?f[1].params.length:-1,tr=m?f[2].params.length:-1,tn=y?f[3].params.length:-1,ti=D?f[4].params.length:-1,ta=C?f[5].params.length:-1,to=p&&g&&m&&y&&D&&C?6:0,ts=f.length,tu=f.map(t=>t.test),tl=f.map(t=>t.implementation),th=function(){for(let t=to;t<ts;t++)if(tu[t](arguments))return tl[t].apply(this,arguments);return c.onMismatch(t,arguments,f)};function tc(t,e){return arguments.length===tt&&F(t)&&j(e)?Y.apply(this,arguments):arguments.length===te&&E(t)&&q(e)?X.apply(this,arguments):arguments.length===tr&&M(t)&&V(e)?$.apply(this,arguments):arguments.length===tn&&N(t)&&H(e)?Z.apply(this,arguments):arguments.length===ti&&k(t)&&W(e)?J.apply(this,arguments):arguments.length===ta&&G(t)&&K(e)?Q.apply(this,arguments):th.apply(this,arguments)}try{Object.defineProperty(tc,"name",{value:t})}catch(t){}return tc.signatures=u,tc._typedFunctionData={signatures:f,signatureMap:d},tc}(a||"",o)}).create=i,c.createCount=j.createCount,c.onMismatch=k,c.throwMismatchError=k,c.createError=E,c.clear=p,c.clearConversions=function(){let t;for(t of o)a.get(t).conversionsTo=[];h=0},c.addTypes=d,c._findType=f,c.referTo=function(){let t=P(arguments).map(t=>v(b(t))),e=O(arguments);if("function"!=typeof e)throw TypeError("Callback function expected as last argument");return z(t,e)},c.referToSelf=R,c.convert=function(t,e){let r=f(e);if(r.test(t))return t;let n=r.conversionsTo;if(0===n.length)throw Error("There are no conversions to "+e+" defined.");for(let e=0;e<n.length;e++)if(f(n[e].from).test(t))return n[e].convert(t);throw Error("Cannot convert "+t+" to "+e)},c.findSignature=y,c.find=function(t,e,r){return y(t,e,r).implementation},c.isTypedFunction=m,c.warnAgainstDeprecatedThis=!0,c.addType=function(t,e){let r="any";!1!==e&&a.has("Object")&&(r="Object"),c.addTypes([t],r)},c.addConversion=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{override:!1};q(t);let r=f(t.to),n=r.conversionsTo.find(e=>e.from===t.from);if(n){if(e&&e.override)c.removeConversion({from:n.from,to:t.to,convert:n.convert});else throw Error('There is already a conversion from "'+t.from+'" to "'+r.name+'"')}r.conversionsTo.push({from:t.from,convert:t.convert,index:h++})},c.addConversions=function(t,e){t.forEach(t=>c.addConversion(t,e))},c.removeConversion=function(t){q(t);let e=f(t.to),r=function(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return t[r]}(e.conversionsTo,e=>e.from===t.from);if(!r)throw Error("Attempt to remove nonexistent conversion from "+t.from+" to "+t.to);if(r.convert!==t.convert)throw Error("Conversion to remove does not match existing conversion");let n=e.conversionsTo.indexOf(r);e.conversionsTo.splice(n,1)},c.resolve=function(t,e){if(!m(t))throw TypeError(n);let r=t._typedFunctionData.signatures;for(let t=0;t<r.length;++t)if(r[t].test(e))return r[t];return null},c}()}();var aE=/* #__PURE__ */nD("DenseMatrix",["Matrix"],t=>{var{Matrix:e}=t;function r(t,e){if(!(this instanceof r))throw SyntaxError("Constructor must be called with the new operator");if(e&&!rq(e))throw Error("Invalid datatype: "+e);if(rH(t))"DenseMatrix"===t.type?(this._data=ng(t._data),this._size=ng(t._size)):(this._data=t.toArray(),this._size=t.size()),this._datatype=e||t._datatype;else if(t&&rV(t.data)&&rV(t.size))this._data=t.data,this._size=t.size,nJ(this._data,this._size),this._datatype=e||t.datatype;else if(rV(t))this._data=function t(e){return rH(e)?t(e.valueOf()):rV(e)?e.map(t):e}(t),this._size=nZ(this._data),nJ(this._data,this._size),this._datatype=e;else if(t)throw TypeError("Unsupported type of data ("+np(t)+")");else this._data=[],this._size=[0],this._datatype=e}function n(t,e,r){if(0===e.length){for(var n=t._data;rV(n);)n=n[0];return n}return t._size=e.slice(0),t._data=n2(t._data,t._size,r),t}function i(t,e,r){for(var i=t._size.slice(0),a=!1;i.length<e.length;)i.push(0),a=!0;for(var o=0,s=e.length;o<s;o++)e[o]>i[o]&&(i[o]=e[o],a=!0);a&&n(t,i,r)}return r.prototype=new e,r.prototype.createDenseMatrix=function(t,e){return new r(t,e)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return it(this._data,np)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(t,e){return new r(t,e)},r.prototype.subset=function(t,e,n){switch(arguments.length){case 1:return function(t,e){if(!r$(e))throw TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var n=e.size();if(n.length!==t._size.length)throw new n$(n.length,t._size.length);for(var i=e.min(),a=e.max(),o=0,s=t._size.length;o<s;o++)n0(i[o],t._size[o]),n0(a[o],t._size[o]);return new r(function t(e,r,n,i){var a=i===n-1,o=r.dimension(i);return a?o.map(function(t){return n0(t,e.length),e[t]}).valueOf():o.map(function(a){return n0(a,e.length),t(e[a],r,n,i+1)}).valueOf()}(t._data,e,n.length,0),t._datatype)}(this,t);case 2:case 3:return function(t,e,r,n){if(!e||!0!==e.isIndex)throw TypeError("Invalid index");var a,o=e.size(),s=e.isScalar();if(rH(r)?(a=r.size(),r=r.valueOf()):a=nZ(r),s){if(0!==a.length)throw TypeError("Scalar expected");t.set(e.min(),r,n)}else{if(!ny(a,o))try{r=0===a.length?ia([r],o):ia(r,o),a=nZ(r)}catch(t){}if(o.length<t._size.length)throw new n$(o.length,t._size.length,"<");if(a.length<o.length){for(var u=0,l=0;1===o[u]&&1===a[u];)u++;for(;1===o[u];)l++,u++;r=n8(r,o.length,l,a)}if(!ny(o,a))throw new n$(o,a,">");i(t,e.max().map(function(t){return t+1}),n);var h=o.length;(function t(e,r,n,i,a){var o=a===i-1,s=r.dimension(a);o?s.forEach(function(t,r){n0(t),e[t]=n[r[0]]}):s.forEach(function(o,s){n0(o),t(e[o],r,n[s[0]],i,a+1)})})(t._data,e,r,h,0)}return t}(this,t,e,n);default:throw SyntaxError("Wrong number of arguments")}},r.prototype.get=function(t){return io(this._data,t)},r.prototype.set=function(t,e,r){if(!rV(t))throw TypeError("Array expected");if(t.length<this._size.length)throw new n$(t.length,this._size.length,"<");i(this,t.map(function(t){return t+1}),r);var n,a,o,s=this._data;for(n=0,a=t.length-1;n<a;n++)n0(o=t[n],s.length),s=s[o];return n0(o=t[t.length-1],s.length),s[o]=e,this},r.prototype.resize=function(t,e,r){if(!rW(t))throw TypeError("Array or Matrix expected");var i=t.valueOf().map(t=>Array.isArray(t)&&1===t.length?t[0]:t);return n(r?this.clone():this,i,e)},r.prototype.reshape=function(t,e){var r=e?this.clone():this;r._data=n5(r._data,t);var n=r._size.reduce((t,e)=>t*e);return r._size=n3(t,n),r},r.prototype.clone=function(){return new r({data:ng(this._data),size:ng(this._size),datatype:this._datatype})},r.prototype.size=function(){return this._size.slice(0)},r.prototype._forEach=function(t){var e=this.size();if(1===e.length){for(var r=0;r<e[0];r++)t(this._data,r,[r]);return}var n=Array(e.length).fill(0),i=Array(e.length-1),a=i.length-1;i[0]=this._data[0];for(var o=0;o<a;o++)i[o+1]=i[o][0];for(n[a]=-1;;){var s=void 0;for(s=a;s>=0;s--){if(n[s]++,n[s]===e[s]){n[s]=0;continue}i[s]=0===s?this._data[n[s]]:i[s-1][n[s]];for(var u=s;u<a;u++)i[u+1]=i[u][0];for(var l=0;l<e[i.length];l++)n[i.length]=l,t(i[a],l,n.slice(0));break}if(-1===s)break}},r.prototype.map=function(t){var e=this,n=new r(e),i=aS(t,e._data,"map");return n._forEach(function(t,r,n){t[r]=i(t[r],n,e)}),n},r.prototype.forEach=function(t){var e=this,r=aS(t,e._data,"map");e._forEach(function(t,n,i){r(t[n],i,e)})},r.prototype[Symbol.iterator]=function*(){var t=function*(e,r){if(rV(e))for(var n=0;n<e.length;n++)yield*t(e[n],r.concat(n));else yield{value:e,index:r}};yield*t(this._data,[])},r.prototype.rows=function(){var t=[];if(2!==this.size().length)throw TypeError("Rows can only be returned for a 2D matrix.");for(var e of this._data)t.push(new r([e],this._datatype));return t},r.prototype.columns=function(){var t=this,e=[],n=this.size();if(2!==n.length)throw TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,a=function(n){var a=i.map(t=>[t[n]]);e.push(new r(a,t._datatype))},o=0;o<n[1];o++)a(o);return e},r.prototype.toArray=function(){return ng(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(t){return nW(this._data,t)},r.prototype.toString=function(){return nW(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(t){if(t){if(rR(t)&&(t=t.toNumber()),!rz(t)||!nw(t))throw TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,n=t<0?-t:0,i=Math.min(this._size[0]-n,this._size[1]-e),a=[],o=0;o<i;o++)a[o]=this._data[o+n][o+e];return new r({data:a,size:[i],datatype:this._datatype})},r.diagonal=function(t,e,n,i){if(!rV(t))throw TypeError("Array expected, size parameter");if(2!==t.length)throw Error("Only two dimensions matrix are supported");if(t=t.map(function(t){if(rR(t)&&(t=t.toNumber()),!rz(t)||!nw(t)||t<1)throw Error("Size values must be positive integers");return t}),n){if(rR(n)&&(n=n.toNumber()),!rz(n)||!nw(n))throw TypeError("The parameter k must be an integer number")}else n=0;var a,o=n>0?n:0,s=n<0?-n:0,u=t[0],l=t[1],h=Math.min(u-s,l-o);if(rV(e)){if(e.length!==h)throw Error("Invalid value array length");a=function(t){return e[t]}}else if(rH(e)){var c=e.size();if(1!==c.length||c[0]!==h)throw Error("Invalid matrix length");a=function(t){return e.get([t])}}else a=function(){return e};i||(i=rR(a(0))?a(0).mul(0):0);var f=[];if(t.length>0){f=n2(f,t,i);for(var d=0;d<h;d++)f[d+s][d+o]=a(d)}return new r({data:f,size:[u,l]})},r.fromJSON=function(t){return new r(t)},r.prototype.swapRows=function(t,e){if(!rz(t)||!nw(t)||!rz(e)||!nw(e))throw Error("Row index must be positive integers");if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");return n0(t,this._size[0]),n0(e,this._size[0]),r._swapRows(t,e,this._data),this},r._swapRows=function(t,e,r){var n=r[t];r[t]=r[e],r[e]=n},r},{isClass:!0}),aM=/* #__PURE__ */nD("det",["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],t=>{var{typed:e,matrix:r,subtractScalar:n,multiply:i,divideScalar:a,isZero:o,unaryMinus:s}=t;return e("det",{any:function(t){return ng(t)},"Array | Matrix":function(t){var e;switch((e=rH(t)?t.size():Array.isArray(t)?(t=r(t)).size():[]).length){case 0:return ng(t);case 1:if(1===e[0])return ng(t.valueOf()[0]);if(0===e[0])return 1;throw RangeError("Matrix must be square (size: "+nW(e)+")");case 2:var u=e[0],l=e[1];if(u===l)return function(t,e,r){if(1===e)return ng(t[0][0]);if(2===e)return n(i(t[0][0],t[1][1]),i(t[1][0],t[0][1]));for(var u=!1,l=Array(e).fill(0).map((t,e)=>e),h=0;h<e;h++){var c=l[h];if(o(t[c][h])){var f=void 0;for(f=h+1;f<e;f++)if(!o(t[l[f]][h])){c=l[f],l[f]=l[h],l[h]=c,u=!u;break}if(f===e)return t[c][h]}for(var d=t[c][h],p=0===h?1:t[l[h-1]][h-1],g=h+1;g<e;g++)for(var m=l[g],y=h+1;y<e;y++)t[m][y]=a(n(i(t[m][y],d),i(t[m][h],t[c][y])),p)}var v=t[l[e-1]][e-1];return u?s(v):v}(t.clone().valueOf(),u,0);if(0===l)return 1;throw RangeError("Matrix must be square (size: "+nW(e)+")");default:throw RangeError("Matrix must be two dimensional (size: "+nW(e)+")")}}})}),aN="diag",aB=/* #__PURE__ */nD(aN,["typed","matrix","DenseMatrix","SparseMatrix"],t=>{var{typed:e,matrix:r,DenseMatrix:n,SparseMatrix:i}=t;return e(aN,{Array:function(t){return a(t,0,nZ(t),null)},"Array, number":function(t,e){return a(t,e,nZ(t),null)},"Array, BigNumber":function(t,e){return a(t,e.toNumber(),nZ(t),null)},"Array, string":function(t,e){return a(t,0,nZ(t),e)},"Array, number, string":function(t,e,r){return a(t,e,nZ(t),r)},"Array, BigNumber, string":function(t,e,r){return a(t,e.toNumber(),nZ(t),r)},Matrix:function(t){return a(t,0,t.size(),t.storage())},"Matrix, number":function(t,e){return a(t,e,t.size(),t.storage())},"Matrix, BigNumber":function(t,e){return a(t,e.toNumber(),t.size(),t.storage())},"Matrix, string":function(t,e){return a(t,0,t.size(),e)},"Matrix, number, string":function(t,e,r){return a(t,e,t.size(),r)},"Matrix, BigNumber, string":function(t,e,r){return a(t,e.toNumber(),t.size(),r)}});function a(t,e,a,o){if(!nw(e))throw TypeError("Second parameter in function diag must be an integer");var s=e>0?e:0,u=e<0?-e:0;switch(a.length){case 1:return function(t,e,r,a,o,s){var u=[a+o,a+s];if(r&&"sparse"!==r&&"dense"!==r)throw TypeError("Unknown matrix type ".concat(r,'"'));var l="sparse"===r?i.diagonal(u,t,e):n.diagonal(u,t,e);return null!==r?l:l.valueOf()}(t,e,o,a[0],u,s);case 2:return function(t,e,n,i,a,o){if(rH(t)){var s=t.diagonal(e);return null!==n?n!==s.storage()?r(s,n):s:s.valueOf()}for(var u=Math.min(i[0]-a,i[1]-o),l=[],h=0;h<u;h++)l[h]=t[h+a][h+o];return null!==n?r(l):l}(t,e,o,a,u,s)}throw RangeError("Matrix for function diag must be 2 dimensional")}}),aT=(t=>{var{typed:e,matrix:r,multiply:n,equalScalar:i,divideScalar:a,inv:o}=t,s=ij({typed:e,equalScalar:i}),u=iO({typed:e});return e("divide",nm({"Array | Matrix, Array | Matrix":function(t,e){return n(t,o(e))},"DenseMatrix, any":function(t,e){return u(t,e,a,!1)},"SparseMatrix, any":function(t,e){return s(t,e,a,!1)},"Array, any":function(t,e){return u(r(t),e,a,!1).valueOf()},"any, Array | Matrix":function(t,e){return n(t,o(e))}},a.signatures))},"divideScalar"),ak=/* #__PURE__ */nD(aT,["typed","numeric"],t=>{var{typed:e,numeric:r}=t;return e(aT,{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"bigint, bigint":function(t,e){return t/e},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Complex | Fraction | BigNumber | Unit":(t,e)=>t.divide(e),"number | Fraction | Complex | BigNumber, Unit":(t,e)=>e.divideInto(t)})}),aP=/* #__PURE__ */nD("dot",["typed","addScalar","multiplyScalar","conj","size"],t=>{var{typed:e,addScalar:r,multiplyScalar:n,conj:i,size:a}=t;return e("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(t,a){var u=o(t,a),l=rH(t)?t._data:t,h=rH(t)?t._datatype||t.getDataType():void 0,c=rH(a)?a._data:a,f=rH(a)?a._datatype||a.getDataType():void 0,d=2===s(t).length,p=2===s(a).length,g=r,m=n;if(h&&f&&h===f&&"string"==typeof h&&"mixed"!==h&&(g=e.find(r,[h,h]),m=e.find(n,[h,h])),!d&&!p){for(var y=m(i(l[0]),c[0]),v=1;v<u;v++)y=g(y,m(i(l[v]),c[v]));return y}if(!d&&p){for(var x=m(i(l[0]),c[0][0]),D=1;D<u;D++)x=g(x,m(i(l[D]),c[D][0]));return x}if(d&&!p){for(var b=m(i(l[0][0]),c[0]),_=1;_<u;_++)b=g(b,m(i(l[_][0]),c[_]));return b}if(d&&p){for(var w=m(i(l[0][0]),c[0][0]),C=1;C<u;C++)w=g(w,m(i(l[C][0]),c[C][0]));return w}},"SparseMatrix, SparseMatrix":function(t,e){o(t,e);for(var i=t._index,a=t._values,s=e._index,u=e._values,l=0,h=0,c=0;h<i.length&&c<s.length;){var f=i[h],d=s[c];if(f<d){h++;continue}if(f>d){c++;continue}f===d&&(l=r(l,n(a[h],u[c])),h++,c++)}return l}});function o(t,e){var r,n,i=s(t),a=s(e);if(1===i.length)r=i[0];else if(2===i.length&&1===i[1])r=i[0];else throw RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");if(1===a.length)n=a[0];else if(2===a.length&&1===a[1])n=a[0];else throw RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");if(r!==n)throw RangeError("Vectors must have equal length ("+r+" != "+n+")");if(0===r)throw RangeError("Cannot calculate the dot product of empty vectors");return r}function s(t){return rH(t)?t.size():a(t)}}),aO="dotDivide";function aI(t){var{hasher:e,limit:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=null==r?Number.POSITIVE_INFINITY:r,e=null==e?JSON.stringify:e,function n(){if("object"!=typeof n.cache){var i,a,o,s,u,l,h;n.cache={values:new Map,lru:(i=r||Number.POSITIVE_INFINITY,a=0,o=1,s=Object.create(null),u=Object.create(null),l=0,h=function(t){var e=u[t];if(e&&(delete s[e],delete u[t],--a,o===e)){if(!a){l=0,o=1;return}for(;!Object.prototype.hasOwnProperty.call(s,++o););}},i=Math.abs(i),{hit:function(t){var e=u[t],r=++l;if(s[r]=t,u[t]=r,!e){if(++a<=i)return;return h(t=s[o]),t}if(delete s[e],o===e)for(;!Object.prototype.hasOwnProperty.call(s,++o););},delete:h,clear:function(){a=l=0,o=1,s=Object.create(null),u=Object.create(null)}})}}for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var d=e(c);if(n.cache.values.has(d))return n.cache.lru.hit(d),n.cache.values.get(d);var p=t.apply(t,c);return n.cache.values.set(d,p),n.cache.values.delete(n.cache.lru.hit(d)),p}}aI(function(t){return new t(1).exp()},{hasher:aU}),aI(function(t){return new t(1).plus(new t(5).sqrt()).div(2)},{hasher:aU});var az=aI(function(t){return t.acos(-1)},{hasher:aU}),aR=aI(function(t){return az(t).times(2)},{hasher:aU});function aU(t){return t[0].precision}var aL=Math.PI,aG=2*Math.PI;function aj(t,e,r){return nD(t,e,r,{recreateOnConfigChange:!0})}/* #__PURE__ */t=>{var{config:e,BigNumber:r}=t;return"BigNumber"===e.number?aR(r):aG},/* #__PURE__ */t=>{var{Complex:e}=t;return e.I};var aq=/* #__PURE__ */nD("eigs",["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],t=>{var{config:e,typed:r,matrix:n,addScalar:a,subtract:o,equal:s,abs:u,atan:l,cos:h,sin:c,multiplyScalar:f,divideScalar:d,inv:p,bignumber:g,multiply:m,add:y,larger:v,column:x,flatten:D,number:b,complex:_,sqrt:w,diag:C,size:A,reshape:S,qr:F,usolve:E,usolveAll:M,im:N,re:B,smaller:T,matrixFromColumns:k,dot:P}=t,O=function(t){var{config:e,addScalar:r,subtract:n,abs:i,atan:a,cos:o,sin:s,multiplyScalar:u,inv:l,bignumber:h,multiply:c,add:f}=t;function d(t){for(var e=t.length,r=0,n=[0,1],i=0;i<e;i++)for(var a=i+1;a<e;a++)Math.abs(r)<Math.abs(t[i][a])&&(r=Math.abs(t[i][a]),n=[i,a]);return[n,r]}function p(t){for(var e=t.length,r=0,n=[0,1],a=0;a<e;a++)for(var o=a+1;o<e;o++)i(r)<i(t[a][o])&&(r=i(t[a][o]),n=[a,o]);return[n,r]}function g(t,e,r){var n,a=t.length,o=Array(a);if(r){n=Array(a);for(var s=0;s<a;s++)n[s]=Array(a)}for(var u=0;u<a;u++){for(var l=0,h=t[0],c=0;c<t.length;c++)i(t[c])<i(h)&&(h=t[l=c]);if(o[u]=t.splice(l,1)[0],r)for(var f=0;f<a;f++)n[u][f]=e[f][l],e[f].splice(l,1)}if(!r)return{values:o};var d=n.map((t,e)=>({value:o[e],vector:t}));return{values:o,eigenvectors:d}}return function(t,m){var y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.relTol,v=arguments.length>3?arguments[3]:void 0,x=arguments.length>4?arguments[4]:void 0;if("number"===v)return function(t,r,n){var i,a,o=t.length,s=Math.abs(r/o);if(n){a=Array(o);for(var u=0;u<o;u++)a[u]=Array(o).fill(0),a[u][u]=1}for(var l=d(t);Math.abs(l[1])>=Math.abs(s);){var h,c,f,p=l[0][0],m=l[0][1];h=t[p][p],c=t[m][m],f=t[p][m],t=function(t,e,r,n){for(var i=t.length,a=Math.cos(e),o=Math.sin(e),s=a*a,u=o*o,l=Array(i).fill(0),h=Array(i).fill(0),c=s*t[r][r]-2*a*o*t[r][n]+u*t[n][n],f=u*t[r][r]+2*a*o*t[r][n]+s*t[n][n],d=0;d<i;d++)l[d]=a*t[r][d]-o*t[n][d],h[d]=o*t[r][d]+a*t[n][d];t[r][r]=c,t[n][n]=f,t[r][n]=0,t[n][r]=0;for(var p=0;p<i;p++)p!==r&&p!==n&&(t[r][p]=l[p],t[p][r]=l[p],t[n][p]=h[p],t[p][n]=h[p]);return t}(t,i=Math.abs(c-h)<=e.relTol?Math.PI/4:.5*Math.atan(2*f/(c-h)),p,m),n&&(a=function(t,e,r,n){for(var i=t.length,a=Math.cos(e),o=Math.sin(e),s=Array(i).fill(0),u=Array(i).fill(0),l=0;l<i;l++)s[l]=a*t[l][r]-o*t[l][n],u[l]=o*t[l][r]+a*t[l][n];for(var h=0;h<i;h++)t[h][r]=s[h],t[h][n]=u[h];return t}(a,i,p,m)),l=d(t)}for(var y=Array(o).fill(0),v=0;v<o;v++)y[v]=t[v][v];return g(ng(y),a,n)}(t,y,x);if("BigNumber"===v)return function(t,d,m){var y,v,x=t.length,D=i(d/x);if(m){v=Array(x);for(var b=0;b<x;b++)v[b]=Array(x).fill(0),v[b][b]=1}for(var _=p(t);i(_[1])>=i(D);){var w=_[0][0],C=_[0][1];y=function(t,r,o){var s=n(r,t);return i(s)<=e.relTol?h(-1).acos().div(4):u(.5,a(c(2,o,l(s))))}(t[w][w],t[C][C],t[w][C]),t=function(t,e,i,a){for(var l=t.length,d=h(o(e)),p=h(s(e)),g=u(d,d),m=u(p,p),y=Array(l).fill(h(0)),v=Array(l).fill(h(0)),x=c(h(2),d,p,t[i][a]),D=r(n(u(g,t[i][i]),x),u(m,t[a][a])),b=f(u(m,t[i][i]),x,u(g,t[a][a])),_=0;_<l;_++)y[_]=n(u(d,t[i][_]),u(p,t[a][_])),v[_]=r(u(p,t[i][_]),u(d,t[a][_]));t[i][i]=D,t[a][a]=b,t[i][a]=h(0),t[a][i]=h(0);for(var w=0;w<l;w++)w!==i&&w!==a&&(t[i][w]=y[w],t[w][i]=y[w],t[a][w]=v[w],t[w][a]=v[w]);return t}(t,y,w,C),m&&(v=function(t,e,i,a){for(var l=t.length,c=o(e),f=s(e),d=Array(l).fill(h(0)),p=Array(l).fill(h(0)),g=0;g<l;g++)d[g]=n(u(c,t[g][i]),u(f,t[g][a])),p[g]=r(u(f,t[g][i]),u(c,t[g][a]));for(var m=0;m<l;m++)t[m][i]=d[m],t[m][a]=p[m];return t}(v,y,w,C)),_=p(t)}for(var A=Array(x).fill(0),S=0;S<x;S++)A[S]=t[S][S];return g(ng(A),v,m)}(t,y,x);throw TypeError("Unsupported data type: "+v)}}({config:e,addScalar:a,subtract:o,column:x,flatten:D,equal:s,abs:u,atan:l,cos:h,sin:c,multiplyScalar:f,inv:p,bignumber:g,complex:_,multiply:m,add:y}),I=function(t){var{addScalar:e,subtract:r,flatten:n,multiply:i,multiplyScalar:a,divideScalar:o,sqrt:s,abs:u,bignumber:l,diag:h,size:c,reshape:f,inv:d,qr:p,usolve:g,usolveAll:m,equal:y,complex:v,larger:x,smaller:D,matrixFromColumns:b,dot:_}=t;function w(t,e){for(var r=0;r<t.length;r++)t[r].push(...Array(e-t[r].length).fill(0));for(var n=t.length;n<e;n++)t.push(Array(e).fill(0)),t[n][n]=1;return t}function C(t,e){var n=c(t);for(var a of e)t=r(t,i(o(_(a=f(a,n),t),_(a,a)),a));return t}function A(t){return u(s(_(t,t)))}function S(t,e){return i(o("BigNumber"===e?l(1):"Complex"===e?v(1):1,A(t)),t)}return function(t,c,f,b){var _=!(arguments.length>4)||void 0===arguments[4]||arguments[4],F=function(t,r,n,i,s){var c,f="BigNumber"===i,d=f?l(0):0,p=f?l(1):"Complex"===i?v(1):1,g=f?l(1):1,m=f?l(10):2,b=a(m,m);s&&(c=Array(r).fill(p));for(var _=!1;!_;){_=!0;for(var w=0;w<r;w++){for(var C=d,A=d,S=0;S<r;S++)w!==S&&(C=e(C,u(t[S][w])),A=e(A,u(t[w][S])));if(!y(C,0)&&!y(A,0)){for(var F=g,E=C,M=o(A,m),N=a(A,m);D(E,M);)E=a(E,b),F=a(F,m);for(;x(E,N);)E=o(E,b),F=o(F,m);if(D(o(e(E,A),F),a(e(C,A),.95))){_=!1;for(var B=o(1,F),T=0;T<r;T++)w!==T&&(t[w][T]=a(t[w][T],B),t[T][w]=a(t[T][w],F));s&&(c[w]=a(c[w],B))}}}}return s?h(c):null}(t,c,0,b,_);!function(t,n,i,s,h,c){var f="BigNumber"===s,d=f?l(0):"Complex"===s?v(0):0;f&&(i=l(i));for(var p=0;p<n-2;p++){for(var g=0,m=d,y=p+1;y<n;y++){var x=t[y][p];D(u(m),u(x))&&(m=x,g=y)}if(!D(u(m),i)){if(g!==p+1){var b=t[g];t[g]=t[p+1],t[p+1]=b;for(var _=0;_<n;_++){var w=t[_][g];t[_][g]=t[_][p+1],t[_][p+1]=w}if(h){var C=c[g];c[g]=c[p+1],c[p+1]=C}}for(var A=p+2;A<n;A++){var S=o(t[A][p],m);if(0!==S){for(var F=0;F<n;F++)t[A][F]=r(t[A][F],a(S,t[p+1][F]));for(var E=0;E<n;E++)t[E][p+1]=e(t[E][p+1],a(S,t[E][A]));if(h)for(var M=0;M<n;M++)c[A][M]=r(c[A][M],a(S,c[p+1][M]))}}}}}(t,c,f,b,_,F);var{values:E,C:M}=function(t,n,o,c,f){var d="BigNumber"===c,g="Complex"===c,m=d?l(1):g?v(1):1;d&&(o=l(o));for(var y=ng(t),b=[],_=n,C=[],A=f?h(Array(n).fill(m)):void 0,S=f?h(Array(_).fill(m)):void 0,F=0;F<=100;){F+=1;for(var E=y[_-1][_-1],M=0;M<_;M++)y[M][M]=r(y[M][M],E);var{Q:N,R:B}=p(y);y=i(B,N);for(var T=0;T<_;T++)y[T][T]=e(y[T][T],E);if(f&&(S=i(S,N)),1===_||D(u(y[_-1][_-2]),o)){F=0,b.push(y[_-1][_-1]),f&&(C.unshift([[1]]),w(S,n),A=i(A,S),_>1&&(S=h(Array(_-1).fill(m)))),_-=1,y.pop();for(var k=0;k<_;k++)y[k].pop()}else if(2===_||D(u(y[_-2][_-3]),o)){F=0;var P=function(t,n,i,o){var u=e(t,o),l=r(a(t,o),a(n,i)),h=a(u,.5),c=a(s(r(a(u,u),a(4,l))),.5);return[e(h,c),r(h,c)]}(y[_-2][_-2],y[_-2][_-1],y[_-1][_-2],y[_-1][_-1]);b.push(...P),f&&(C.unshift(function(t,e,n,i,a,o,s,h){var c="BigNumber"===h,f="Complex"===h,d=c?l(0):f?v(0):0,p=c?l(1):f?v(1):1;if(D(u(n),s))return[[p,d],[d,p]];if(x(u(r(a,o)),s))return[[r(a,i),r(o,i)],[n,n]];var g=r(t,a),m=r(i,a);return D(u(e),s)&&D(u(m),s)?[[g,p],[n,d]]:[[e,d],[m,p]]}(y[_-2][_-2],y[_-2][_-1],y[_-1][_-2],y[_-1][_-1],P[0],P[1],o,c)),w(S,n),A=i(A,S),_>2&&(S=h(Array(_-2).fill(m)))),_-=2,y.pop(),y.pop();for(var O=0;O<_;O++)y[O].pop(),y[O].pop()}if(0===_)break}if(b.sort((t,e)=>+r(u(t),u(e))),F>100){var I=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+b.join(", "));throw I.values=b,I.vectors=[],I}return{values:b,C:f?i(A,function(t,e){for(var r=[],n=0;n<e;n++)r[n]=Array(e).fill(0);var i=0;for(var a of t){for(var o=a.length,s=0;s<o;s++)for(var u=0;u<o;u++)r[i+s][i+u]=a[s][u];i+=o}return r}(C,n)):void 0}}(t,c,f,b,_);if(_){var N=function(t,e,a,o,s,u,c){var f=i(d(a),t,a),p="BigNumber"===c,b="Complex"===c,_=p?l(0):b?v(0):0,w=p?l(1):b?v(1):1,F=[],E=[];for(var M of s){var N=function(t,e,r){for(var n=0;n<t.length;n++)if(r(t[n],e))return n;return -1}(F,M,y);-1===N?(F.push(M),E.push(1)):E[N]+=1}for(var B=[],T=F.length,k=Array(e).fill(_),P=h(Array(e).fill(w)),O=0;O<T;O++)!function(){var t=F[O],s=r(f,i(t,P)),h=m(s,k);for(h.shift();h.length<E[O];){var p=function(t,e,r,n,i){for(var a,o="BigNumber"===i?l(1e3):1e3,s=0;s<5;++s){a=function(t,e,r){var n="BigNumber"===r,i="Complex"===r,a=Array(t).fill(0).map(t=>2*Math.random()-1);return n&&(a=a.map(t=>l(t))),i&&(a=a.map(t=>v(t))),S(a=C(a,e),r)}(e,r,i);try{a=g(t,a)}catch(t){continue}if(x(A(a),o))break}if(s>=5)return null;for(s=0;;){var u=g(t,a);if(D(A(C(a,[u])),n))break;if(++s>=10)return null;a=S(u)}return a}(s,e,h,u,c);if(null===p)break;h.push(p)}var y=i(d(o),a);h=h.map(t=>i(y,t)),B.push(...h.map(e=>({value:t,vector:n(e)})))}();return B}(t,c,M,F,E,f,b);return{values:E,eigenvectors:N}}return{values:E}}}({config:e,addScalar:a,subtract:o,multiply:m,multiplyScalar:f,flatten:D,divideScalar:d,sqrt:w,abs:u,bignumber:g,diag:C,size:A,reshape:S,qr:F,inv:p,usolve:E,usolveAll:M,equal:s,complex:_,larger:v,smaller:T,matrixFromColumns:k,dot:P});return r("eigs",{Array:function(t){return z(n(t))},"Array, number|BigNumber":function(t,e){return z(n(t),{precision:e})},"Array, Object":(t,e)=>z(n(t),e),Matrix:function(t){return z(t,{matricize:!0})},"Matrix, number|BigNumber":function(t,e){return z(t,{precision:e,matricize:!0})},"Matrix, Object":function(t,e){var r={matricize:!0};return /*@__PURE__*/i(rE)(r,e),z(t,r)}});function z(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=!("eigenvectors"in i)||i.eigenvectors,s=function(t,e,r){var n=t.toArray(),i=t.size();if(2!==i.length||i[0]!==i[1])throw RangeError("Matrix must be square (size: ".concat(nW(i),")"));var a=i[0];if(function(t,e,r){for(var n=0;n<e;n++)for(var i=0;i<e;i++)if(v(g(u(N(t[n][i]))),r))return!1;return!0}(n,a,e)&&(function(t,e){for(var r=0;r<e;r++)for(var n=0;n<e;n++)t[r][n]=B(t[r][n])}(n,a),function(t,e,r){for(var n=0;n<e;n++)for(var i=n;i<e;i++)if(v(g(u(o(t[n][i],t[i][n]))),r))return!1;return!0}(n,a,e))){var s=R(t,n,a);return O(n,a,e,s,r)}var l=R(t,n,a);return I(n,a,e,l,r)}(t,null!==(r=i.precision)&&void 0!==r?r:e.relTol,a);return i.matricize&&(s.values=n(s.values),a&&(s.eigenvectors=s.eigenvectors.map(t=>{var{value:e,vector:r}=t;return{value:e,vector:n(r)}}))),a&&Object.defineProperty(s,"vectors",{enumerable:!1,get:()=>{throw Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),s}function R(t,e,r){var n=t.datatype();if("number"===n||"BigNumber"===n||"Complex"===n)return n;for(var i=!1,a=!1,o=!1,s=0;s<r;s++)for(var u=0;u<r;u++){var l=e[s][u];if(rz(l)||rG(l))i=!0;else if(rR(l))a=!0;else if(rL(l))o=!0;else throw TypeError("Unsupported type in Matrix: "+np(l))}if(a&&o&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),o){for(var h=0;h<r;h++)for(var c=0;c<r;c++)e[h][c]=_(e[h][c]);return"Complex"}if(a){for(var f=0;f<r;f++)for(var d=0;d<r;d++)e[f][d]=g(e[f][d]);return"BigNumber"}if(i){for(var p=0;p<r;p++)for(var m=0;m<r;m++)e[p][m]=b(e[p][m]);return"number"}throw TypeError("Matrix contains unsupported types only.")}}),aV="equal",aH=/* #__PURE__ */nD(aV,["typed","matrix","equalScalar","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=iY({typed:e}),u=i3({typed:e,SparseMatrix:o}),l=iX({typed:e,DenseMatrix:i}),h=iz({typed:e,matrix:r,concat:a});return e(aV,aW({typed:e,equalScalar:n}),h({elop:n,SS:u,DS:s,Ss:l}))}),aW=nD(aV,["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return e(aV,{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:r(t,e)}})}),aK="equalScalar",aY=/* #__PURE__ */nD(aK,["typed","config"],t=>{var{typed:e,config:r}=t,n=ao({typed:e});return e(aK,{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,e){return nz(t,e,r.relTol,r.absTol)},"BigNumber, BigNumber":function(t,e){return t.eq(e)||i4(t,e,r.relTol,r.absTol)},"bigint, bigint":function(t,e){return t===e},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){var n,i;return n=r.relTol,i=r.absTol,nz(t.re,e.re,n,i)&&nz(t.im,e.im,n,i)}},n)});nD(aK,["typed","config"],t=>{var{typed:e,config:r}=t;return e(aK,{"number, number":function(t,e){return nz(t,e,r.relTol,r.absTol)}})}),t=>{var{typed:e}=t;return e("exp",{number:iC,Complex:function(t){return t.exp()},BigNumber:function(t){return t.exp()}})};var aX="factorial",a$=(t=>{var{typed:e,gamma:r}=t;return e(aX,{number:function(t){if(t<0)throw Error("Value must be non-negative");return r(t+1)},BigNumber:function(t){if(t.isNegative())throw Error("Value must be non-negative");return r(t.plus(1))},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})},/* #__PURE__ */nD("FibonacciHeap",["smaller","larger"],t=>{var{smaller:e,larger:r}=t,n=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function a(t,e,r){e.left.right=e.right,e.right.left=e.left,r.degree--,r.child===e&&(r.child=e.right),0===r.degree&&(r.child=null),e.left=t,e.right=t.right,t.right=e,e.right.left=e,e.parent=null,e.mark=!1}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(t,r){var n={key:t,value:r,degree:0};if(this._minimum){var i=this._minimum;n.left=i,n.right=i.right,i.right=n,n.right.left=n,e(t,i.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var t=this._minimum;if(null===t)return t;for(var i=this._minimum,a=t.degree,s=t.child;a>0;){var u=s.right;s.left.right=s.right,s.right.left=s.left,s.left=i,s.right=i.right,i.right=s,s.right.left=s,s.parent=null,s=u,a--}return t.left.right=t.right,t.right.left=t.left,i=t===t.right?null:function(t,i){var a,s=Math.floor(Math.log(i)*n)+1,u=Array(s),l=0,h=t;if(h)for(l++,h=h.right;h!==t;)l++,h=h.right;for(;l>0;){for(var c=h.degree,f=h.right;a=u[c];){if(r(h.key,a.key)){var d=a;a=h,h=d}o(a,h),u[c]=null,c++}u[c]=h,h=f,l--}t=null;for(var p=0;p<s;p++)(a=u[p])&&(t?(a.left.right=a.right,a.right.left=a.left,a.left=t,a.right=t.right,t.right=a,a.right.left=a,e(a.key,t.key)&&(t=a)):t=a);return t}(i=t.right,this._size),this._size--,this._minimum=i,t},i.prototype.remove=function(t){var r,n;this._minimum=(r=this._minimum,t.key=-1,(n=t.parent)&&e(t.key,n.key)&&(a(r,t,n),function t(e,r){var n=r.parent;n&&(r.mark?(a(e,r,n),t(n)):r.mark=!0)}(r,n)),e(t.key,r.key)&&(r=t),r),this.extractMinimum()};var o=function(t,e){t.left.right=t.right,t.right.left=t.left,t.parent=e,e.child?(t.left=e.child,t.right=e.child.right,e.child.right=t,t.right.left=t):(e.child=t,t.right=t,t.left=t),e.degree++,t.mark=!1};return i},{isClass:!0})),aZ=/* #__PURE__ */nD("fix",["typed","ceil","floor"],t=>{var{typed:e,ceil:r,floor:n}=t;return e("fix",{number:function(t){return t>0?n(t):r(t)},"number, number":function(t,e){return t>0?n(t,e):r(t,e)}})}),aJ=(t=>{var{typed:e,Complex:r,matrix:n,ceil:i,floor:a,equalScalar:o,zeros:s,DenseMatrix:u}=t,l=iX({typed:e,DenseMatrix:u}),h=iO({typed:e}),c=aZ({typed:e,ceil:i,floor:a});return e("fix",{number:c.signatures.number,"number, number | BigNumber":c.signatures["number,number"],Complex:function(t){return new r(t.re>0?Math.floor(t.re):Math.ceil(t.re),t.im>0?Math.floor(t.im):Math.ceil(t.im))},"Complex, number":function(t,e){return new r(t.re>0?a(t.re,e):i(t.re,e),t.im>0?a(t.im,e):i(t.im,e))},"Complex, BigNumber":function(t,e){var n=e.toNumber();return new r(t.re>0?a(t.re,n):i(t.re,n),t.im>0?a(t.im,n):i(t.im,n))},BigNumber:function(t){return t.isNegative()?i(t):a(t)},"BigNumber, number | BigNumber":function(t,e){return t.isNegative()?i(t,e):a(t,e)},Fraction:function(t){return t.s<0n?t.ceil():t.floor()},"Fraction, number | BigNumber":function(t,e){return t.s<0n?i(t,e):a(t,e)},"Unit, number, Unit":e.referToSelf(t=>function(e,r,n){var i=e.toNumeric(n);return n.multiply(t(i,r))}),"Unit, BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>t(e,r.toNumber(),n)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>ih(e,e=>t(e,r,n),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(t=>(e,r)=>t(e,0,r)),"Array | Matrix":e.referToSelf(t=>e=>ih(e,t,!0)),"Array | Matrix, number | BigNumber":e.referToSelf(t=>(e,r)=>ih(e,e=>t(e,r),!0)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(t=>(e,r)=>h(n(r),e,t,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(t=>(e,r)=>o(e,0)?s(r.size(),r.storage()):"dense"===r.storage()?h(r,e,t,!0):l(r,e,t,!0))})},"flatten"),aQ=/* #__PURE__ */nD(aJ,["typed"],t=>{var{typed:e}=t;return e(aJ,{Array:function(t){return n6(t)},Matrix:function(t){return t.create(n6(t.toArray()),t.datatype())}})}),a0="floor",a1=/* #__PURE__ */nD(a0,["typed","config","round"],t=>{var{typed:e,config:r,round:n}=t;return e(a0,{number:function(t){return nz(t,n(t),r.relTol,r.absTol)?n(t):Math.floor(t)},"number, number":function(t,e){if(nz(t,n(t,e),r.relTol,r.absTol))return n(t,e);var[i,a]="".concat(t,"e").split("e"),o=Math.floor(Number("".concat(i,"e").concat(Number(a)+e)));return[i,a]="".concat(o,"e").split("e"),Number("".concat(i,"e").concat(Number(a)-e))}})}),a2=/* #__PURE__ */nD(a0,["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],t=>{var{typed:e,config:r,round:n,matrix:a,equalScalar:o,zeros:s,DenseMatrix:u}=t,l=ij({typed:e,equalScalar:o}),h=iX({typed:e,DenseMatrix:u}),c=iO({typed:e}),f=a1({typed:e,config:r,round:n});return e("floor",{number:f.signatures.number,"number,number":f.signatures["number,number"],Complex:function(t){return t.floor()},"Complex, number":function(t,e){return t.floor(e)},"Complex, BigNumber":function(t,e){return t.floor(e.toNumber())},BigNumber:function(t){return i4(t,n(t),r.relTol,r.absTol)?n(t):t.floor()},"BigNumber, BigNumber":function(t,e){return i4(t,n(t,e),r.relTol,r.absTol)?n(t,e):t.toDecimalPlaces(e.toNumber(),/*@__PURE__*/i(iJ).ROUND_FLOOR)},Fraction:function(t){return t.floor()},"Fraction, number":function(t,e){return t.floor(e)},"Fraction, BigNumber":function(t,e){return t.floor(e.toNumber())},"Unit, number, Unit":e.referToSelf(t=>function(e,r,n){var i=e.toNumeric(n);return n.multiply(t(i,r))}),"Unit, BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>t(e,r.toNumber(),n)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>ih(e,e=>t(e,r,n),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(t=>(e,r)=>t(e,0,r)),"Array | Matrix":e.referToSelf(t=>e=>ih(e,t,!0)),"Array, number | BigNumber":e.referToSelf(t=>(e,r)=>ih(e,e=>t(e,r),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>l(e,r,t,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>c(e,r,t,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(t=>(e,r)=>c(a(r),e,t,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(t=>(e,r)=>o(e,0)?s(r.size(),r.storage()):"dense"===r.storage()?c(r,e,t,!0):h(r,e,t,!0))})}),a5="format",a3=(t=>{var{typed:e}=t;return e(a5,{any:nW,"any, Object | function | number | BigNumber":nW})},/* #__PURE__ */nD("fraction",["typed","Fraction"],t=>{var{typed:e,Fraction:r}=t;return e("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw Error(t+" cannot be represented as a fraction");return new r(t)},string:function(t){return new r(t)},"number, number":function(t,e){return new r(t,e)},"bigint, bigint":function(t,e){return new r(t,e)},null:function(t){return new r(0)},BigNumber:function(t){return new r(t.toString())},bigint:function(t){return new r(t.toString())},Fraction:function(t){return t},Unit:e.referToSelf(t=>e=>{var r=e.clone();return r.value=t(e.value),r}),Object:function(t){return new r(t)},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})})),a4={};!function(t){function e(){return Error("Parameters must be integer")}function r(){return Error("Invalid argument")}function n(){return Error("Division by Zero")}function i(t,i){var o=c,s=f;let u=f;if(null!=t){if(void 0!==i){if("bigint"==typeof t)o=t;else{if(isNaN(t))throw r();if(0!=t%1)throw e();o=BigInt(t)}if("bigint"==typeof i)s=i;else{if(isNaN(i))throw r();if(0!=i%1)throw e();s=BigInt(i)}u=o*s}else if("object"==typeof t){if("d"in t&&"n"in t)o=BigInt(t.n),s=BigInt(t.d),"s"in t&&(o*=BigInt(t.s));else if(0 in t)o=BigInt(t[0]),1 in t&&(s=BigInt(t[1]));else if("bigint"==typeof t)o=t;else throw r();u=o*s}else if("number"==typeof t){if(isNaN(t))throw r();if(0>t&&(u=-f,t=-t),0==t%1)o=BigInt(t);else if(0<t){i=1;var l=0,h=1,d=1;let e=1;for(1<=t&&(i=10**Math.floor(1+Math.log10(t)),t/=i);1e7>=h&&1e7>=e;)if(t===(s=(l+d)/(h+e))){1e7>=h+e?(o=l+d,s=h+e):e>h?(o=d,s=e):(o=l,s=h);break}else t>s?(l+=d,h+=e):(d+=l,e+=h),1e7<h?(o=d,s=e):(o=l,s=h);o=BigInt(o)*BigInt(i),s=BigInt(s)}}else if("string"==typeof t){if(s=0,l=i=o=c,h=d=f,null===(t=t.replace(/_/g,"").match(/\d+|./g)))throw r();if("-"===t[s]?(u=-f,s++):"+"===t[s]&&s++,t.length===s+1?i=a(t[s++],u):"."===t[s+1]||"."===t[s]?("."!==t[s]&&(o=a(t[s++],u)),(++s+1===t.length||"("===t[s+1]&&")"===t[s+3]||"'"===t[s+1]&&"'"===t[s+3])&&(i=a(t[s],u),d=g**BigInt(t[s].length),s++),("("===t[s]&&")"===t[s+2]||"'"===t[s]&&"'"===t[s+2])&&(l=a(t[s+1],u),h=g**BigInt(t[s+1].length)-f,s+=3)):"/"===t[s+1]||":"===t[s+1]?(i=a(t[s],u),d=a(t[s+2],f),s+=3):"/"===t[s+3]&&" "===t[s+1]&&(o=a(t[s],u),i=a(t[s+2],u),d=a(t[s+4],f),s+=5),t.length<=s)u=o=l+(s=d*h)*o+h*i;else throw r()}else if("bigint"==typeof t)u=o=t,s=f;else throw r()}if(s===c)throw n();m.s=u<c?-f:f,m.n=o<c?-o:o,m.d=s<c?-s:s}function a(t,e){try{t=BigInt(t)}catch(t){throw r()}return t*e}function o(t){return"bigint"==typeof t?t:Math.floor(t)}function s(t,e){if(e===c)throw n();let r=Object.create(h.prototype);r.s=t<c?-f:f;let i=l(t=t<c?-t:t,e);return r.n=t/i,r.d=e/i,r}function u(t){let e={},r=t,n=d,i=p-f;for(;i<=r;){for(;r%n===c;)r/=n,e[n]=(e[n]||c)+f;i+=f+d*n++}return r!==t?1<r&&(e[r]=(e[r]||c)+f):e[t]=(e[t]||c)+f,e}function l(t,e){if(!t)return e;if(!e)return t;for(;;){if(!(t%=e))return e;if(!(e%=t))return t}}function h(t,e){if(i(t,e),!(this instanceof h))return s(m.s*m.n,m.d);t=l(m.d,m.n),this.s=m.s,this.n=m.n/t,this.d=m.d/t}"undefined"==typeof BigInt&&(BigInt=function(t){if(isNaN(t))throw Error("");return t});let c=BigInt(0),f=BigInt(1),d=BigInt(2),p=BigInt(5),g=BigInt(10),m={s:f,n:c,d:f};h.prototype={s:f,n:c,d:f,abs:function(){return s(this.n,this.d)},neg:function(){return s(-this.s*this.n,this.d)},add:function(t,e){return i(t,e),s(this.s*this.n*m.d+m.s*this.d*m.n,this.d*m.d)},sub:function(t,e){return i(t,e),s(this.s*this.n*m.d-m.s*this.d*m.n,this.d*m.d)},mul:function(t,e){return i(t,e),s(this.s*m.s*this.n*m.n,this.d*m.d)},div:function(t,e){return i(t,e),s(this.s*m.s*this.n*m.d,this.d*m.n)},clone:function(){return s(this.s*this.n,this.d)},mod:function(t,e){if(void 0===t)return s(this.s*this.n%this.d,f);if(i(t,e),c===m.n*this.d)throw n();return s(this.s*m.d*this.n%(m.n*this.d),m.d*this.d)},gcd:function(t,e){return i(t,e),s(l(m.n,this.n)*l(m.d,this.d),m.d*this.d)},lcm:function(t,e){return i(t,e),m.n===c&&this.n===c?s(c,f):s(m.n*this.n,l(m.n,this.n)*l(m.d,this.d))},inverse:function(){return s(this.s*this.d,this.n)},pow:function(t,e){if(i(t,e),m.d===f)return m.s<c?s((this.s*this.d)**m.n,this.n**m.n):s((this.s*this.n)**m.n,this.d**m.n);if(this.s<c)return null;t=u(this.n),e=u(this.d);let r=f,n=f;for(let e in t)if("1"!==e){if("0"===e){r=c;break}if(t[e]*=m.n,t[e]%m.d!==c)return null;t[e]/=m.d,r*=BigInt(e)**t[e]}for(let t in e)if("1"!==t){if(e[t]*=m.n,e[t]%m.d!==c)return null;e[t]/=m.d,n*=BigInt(t)**e[t]}return m.s<c?s(n,r):s(r,n)},log:function(t,e){if(i(t,e),this.s<=c||m.s<=c)return null;var r={};t=u(m.n);let n=u(m.d);e=u(this.n);let a=u(this.d);for(var o in n)t[o]=(t[o]||c)-n[o];for(var h in a)e[h]=(e[h]||c)-a[h];for(var f in t)"1"!==f&&(r[f]=!0);for(var d in e)"1"!==d&&(r[d]=!0);for(let n in h=o=null,r)if(f=t[n]||c,r=e[n]||c,f===c){if(r!==c)return null}else if(d=l(r,f),r/=d,f/=d,null===o&&null===h)o=r,h=f;else if(r*h!=o*f)return null;return null!==o&&null!==h?s(o,h):null},equals:function(t,e){return i(t,e),this.s*this.n*m.d==m.s*m.n*this.d},lt:function(t,e){return i(t,e),this.s*this.n*m.d<m.s*m.n*this.d},lte:function(t,e){return i(t,e),this.s*this.n*m.d<=m.s*m.n*this.d},gt:function(t,e){return i(t,e),this.s*this.n*m.d>m.s*m.n*this.d},gte:function(t,e){return i(t,e),this.s*this.n*m.d>=m.s*m.n*this.d},compare:function(t,e){return i(t,e),(c<(t=this.s*this.n*m.d-m.s*m.n*this.d))-(t<c)},ceil:function(t){return t=g**BigInt(t||0),s(o(this.s*t*this.n/this.d)+(t*this.n%this.d>c&&this.s>=c?f:c),t)},floor:function(t){return t=g**BigInt(t||0),s(o(this.s*t*this.n/this.d)-(t*this.n%this.d>c&&this.s<c?f:c),t)},round:function(t){return t=g**BigInt(t||0),s(o(this.s*t*this.n/this.d)+this.s*((this.s>=c?f:c)+t*this.n%this.d*d>this.d?f:c),t)},roundTo:function(t,e){i(t,e);var r=this.n*m.d;return e=r%(t=this.d*m.n),r=o(r/t),e+e>=t&&r++,s(this.s*r*m.n,m.d)},divisible:function(t,e){return i(t,e),!(!(m.n*this.d)||this.n*m.d%(m.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let e=this.n,r=this.d;t=t||15;e:{for(n=r;n%d===c;n/=d);for(;n%p===c;n/=p);if(n===f)n=c;else{for(var n,i=g%n,a=1;i!==f;a++)if(i=i*g%n,2e3<a){n=c;break e}n=BigInt(a)}}e:{i=f,a=g;var s=n;let t=f;for(;s>c;a=a*a%r,s>>=f)s&f&&(t=t*a%r);for(s=0,a=t;300>s;s++){if(i===a){i=BigInt(s);break e}i=i*g%r,a=a*g%r}i=0}if(a=i,i=(this.s<c?"-":"")+o(e/r),(e=e%r*g)&&(i+="."),n){for(t=a;t--;)i+=o(e/r),e%=r,e*=g;for(i+="(",t=n;t--;)i+=o(e/r),e%=r,e*=g;i+=")"}else for(;e&&t--;)i+=o(e/r),e%=r,e*=g;return i},toFraction:function(t){let e=this.n,r=this.d,n=this.s<c?"-":"";if(r===f)n+=e;else{let i=o(e/r);t&&i>c&&(n+=i,n+=" ",e%=r),n=n+e+"/"+r}return n},toLatex:function(t){let e=this.n,r=this.d,n=this.s<c?"-":"";if(r===f)n+=e;else{let i=o(e/r);t&&i>c&&(n+=i,e%=r),n=n+"\\frac{"+e+"}{"+r+"}"}return n},toContinued:function(){let t=this.n,e=this.d,r=[];do{r.push(o(t/e));let n=t%e;t=e,e=n}while(t!==f)return r},simplify:function(t){t=BigInt(1/(t||.001)|0);let e=this.abs(),r=e.toContinued();for(let i=1;i<r.length;i++){let a=s(r[i-1],f);for(var n=i-2;0<=n;n--)a=a.inverse().add(r[n]);if((n=a.sub(e)).n*t<n.d)return a.mul(this.s)}return this}},"function"==typeof define&&define.amd?define([],function(){return h}):(Object.defineProperty(h,"__esModule",{value:!0}),h.default=h,h.Fraction=h,a4=h)}(0);var a8=/* #__PURE__ */nD("Fraction",[],()=>(Object.defineProperty(/*@__PURE__*/i(a4),"name",{value:"Fraction"}),/*@__PURE__*/i(a4).prototype.constructor=/*@__PURE__*/i(a4),/*@__PURE__*/i(a4).prototype.type="Fraction",/*@__PURE__*/i(a4).prototype.isFraction=!0,/*@__PURE__*/i(a4).prototype.toJSON=function(){return{mathjs:"Fraction",n:String(this.s*this.n),d:String(this.d)}},/*@__PURE__*/i(a4).fromJSON=function(t){return new/*@__PURE__*/(i(a4))(t)},/*@__PURE__*/i(a4)),{isClass:!0});function a6(t){if(nw(t))return t<=0?isFinite(t)?1/0:NaN:t>171?1/0:ae(1,t-1);if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*a6(1-t));if(t>=171.35)return 1/0;if(t>85){var e,r=t*t,n=r*t,i=n*t,a=i*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*r)-139/(51840*n)-571/(2488320*i)+163879/(0xc756000*a)+5246819/(0x11850f0000*a*t))}--t,e=a7[0];for(var o=1;o<a7.length;++o)e+=a7[o]/(t+o);var s=t+a9+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,t+.5)*Math.exp(-s)*e}t=>{var{typed:e,add:r,multiply:n,Complex:i,divide:a,matrix:o}=t;return e("freqz",{"Array, Array":function(t,e){return s(t,e,u(512))},"Array, Array, Array":function(t,e,r){return s(t,e,r)},"Array, Array, number":function(t,e,r){if(r<0)throw Error("w must be a positive number");return s(t,e,u(r))},"Matrix, Matrix":function(t,e){var r=u(512),{w:n,h:i}=s(t.valueOf(),e.valueOf(),r);return{w:o(n),h:o(i)}},"Matrix, Matrix, Matrix":function(t,e,r){var{h:n}=s(t.valueOf(),e.valueOf(),r.valueOf());return{h:o(n),w:o(r)}},"Matrix, Matrix, number":function(t,e,r){if(r<0)throw Error("w must be a positive number");var n=u(r),{h:i}=s(t.valueOf(),e.valueOf(),n);return{h:o(i),w:o(n)}}});function s(t,e,o){for(var s=[],u=[],l=0;l<o.length;l++){for(var h=i(0,0),c=i(0,0),f=0;f<t.length;f++)h=r(h,n(t[f],i(Math.cos(-f*o[l]),Math.sin(-f*o[l]))));for(var d=0;d<e.length;d++)c=r(c,n(e[d],i(Math.cos(-d*o[l]),Math.sin(-d*o[l]))));s.push(h),u.push(c)}for(var p=[],g=0;g<s.length;g++)p.push(a(s[g],u[g]));return{h:p,w:o}}function u(t){for(var e=[],r=0;r<t;r++)e.push(r/t*Math.PI);return e}},a6.signature="number";var a9=4.7421875,a7=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,1580887032249125e-19,-21026444172410488e-20,21743961811521265e-20,-1643181065367639e-19,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],ot=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],oe="gamma",or=/* #__PURE__ */nD(oe,["typed","config","multiplyScalar","pow","BigNumber","Complex"],t=>{var{typed:e,config:r,multiplyScalar:n,pow:i,BigNumber:a,Complex:o}=t;return e(oe,{number:a6,Complex:function t(e){if(0===e.im)return a6(e.re);if(e.re<.5){var r=new o(1-e.re,-e.im),n=new o(Math.PI*e.re,Math.PI*e.im);return new o(Math.PI).div(n.sin()).div(t(r))}e=new o(e.re-1,e.im);for(var i=new o(a7[0],0),a=1;a<a7.length;++a){var s=new o(a7[a],0);i=i.add(s.div(e.add(a)))}var u=new o(e.re+a9+.5,e.im),l=Math.sqrt(2*Math.PI),h=u.pow(e.add(.5)),c=u.neg().exp();return i.mul(l).mul(h).mul(c)},BigNumber:function(t){if(t.isInteger())return t.isNegative()||t.isZero()?new a(1/0):function t(e){if(e<8)return new a([1,1,2,6,24,120,720,5040][e]);var n=r.precision+(0|Math.log(e.toNumber())),i=a.clone({precision:n});if(e%2==1)return e.times(t(new a(e-1)));for(var o=e,s=new i(e),u=e.toNumber();o>2;)o-=2,u+=o,s=s.times(u);return new a(s.toPrecision(a.precision))}(t.minus(1));if(!t.isFinite())return new a(t.isNegative()?NaN:1/0);throw Error("Integer BigNumber expected")}})});function on(t,e,r,n){if(!(this instanceof on))throw SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=r,this.max=n,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+r+(null!=n?"-"+n:"")+" expected)",this.stack=Error().stack}on.prototype=Error(),on.prototype.constructor=Error,on.prototype.name="ArgumentsError",on.prototype.isArgumentsError=!0;var oi="number | BigNumber | Fraction | Matrix | Array";"".concat(oi,", ").concat(oi,", ...").concat(oi);var oa="getMatrixDataType",oo=/* #__PURE__ */nD(oa,["typed"],t=>{var{typed:e}=t;return e(oa,{Array:function(t){return it(t,np)},Matrix:function(t){return t.getDataType()}})});nD("hex",["typed","format"],t=>{var{typed:e,format:r}=t;return e("hex",{"number | BigNumber":function(t){return r(t,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(t,e){return r(t,{notation:"hex",wordSize:e})}})});var os="identity",ou=/* #__PURE__ */nD(os,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,BigNumber:i,DenseMatrix:a,SparseMatrix:o}=t;return e(os,{"":function(){return"Matrix"===r.matrix?n([]):[]},string:function(t){return n(t)},"number | BigNumber":function(t){return u(t,t,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, string":function(t,e){return u(t,t,e)},"number | BigNumber, number | BigNumber":function(t,e){return u(t,e,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,r){return u(t,e,r)},Array:function(t){return s(t)},"Array, string":function(t,e){return s(t,e)},Matrix:function(t){return s(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return s(t.valueOf(),e)}});function s(t,e){switch(t.length){case 0:return e?n(e):[];case 1:return u(t[0],t[0],e);case 2:return u(t[0],t[1],e);default:throw Error("Vector containing two values expected")}}function u(t,e,r){var n=rR(t)||rR(e)?i:null;if(rR(t)&&(t=t.toNumber()),rR(e)&&(e=e.toNumber()),!nw(t)||t<1||!nw(e)||e<1)throw Error("Parameters in function identity must be positive integers");var s=n?new i(1):1,u=n?new n(0):0,l=[t,e];if(r){if("sparse"===r)return o.diagonal(l,s,0,u);if("dense"===r)return a.diagonal(l,s,0,u);throw TypeError('Unknown matrix type "'.concat(r,'"'))}for(var h=n2([],l,u),c=t<e?t:e,f=0;f<c;f++)h[f][f]=s;return h}}),ol=/* #__PURE__ */nD("im",["typed"],t=>{var{typed:e}=t;return e("im",{number:()=>0,"BigNumber | Fraction":t=>t.mul(0),Complex:t=>t.im,"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})}),oh=/* #__PURE__ */nD("ImmutableDenseMatrix",["smaller","DenseMatrix"],t=>{var{smaller:e,DenseMatrix:r}=t;function n(t,e){if(!(this instanceof n))throw SyntaxError("Constructor must be called with the new operator");if(e&&!rq(e))throw Error("Invalid datatype: "+e);if(rH(t)||rV(t)){var i=new r(t,e);this._data=i._data,this._size=i._size,this._datatype=i._datatype,this._min=null,this._max=null}else if(t&&rV(t.data)&&rV(t.size))this._data=t.data,this._size=t.size,this._datatype=t.datatype,this._min=void 0!==t.min?t.min:null,this._max=void 0!==t.max?t.max:null;else if(t)throw TypeError("Unsupported type of data ("+np(t)+")");else this._data=[],this._size=[0],this._datatype=e,this._min=null,this._max=null}return n.prototype=new r,n.prototype.type="ImmutableDenseMatrix",n.prototype.isImmutableDenseMatrix=!0,n.prototype.subset=function(t){switch(arguments.length){case 1:var e=r.prototype.subset.call(this,t);if(rH(e))return new n({data:e._data,size:e._size,datatype:e._datatype});return e;case 2:case 3:throw Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw SyntaxError("Wrong number of arguments")}},n.prototype.set=function(){throw Error("Cannot invoke set on an Immutable Matrix instance")},n.prototype.resize=function(){throw Error("Cannot invoke resize on an Immutable Matrix instance")},n.prototype.reshape=function(){throw Error("Cannot invoke reshape on an Immutable Matrix instance")},n.prototype.clone=function(){return new n({data:ng(this._data),size:ng(this._size),datatype:this._datatype})},n.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.fromJSON=function(t){return new n(t)},n.prototype.swapRows=function(){throw Error("Cannot invoke swapRows on an Immutable Matrix instance")},n.prototype.min=function(){if(null===this._min){var t=null;this.forEach(function(r){(null===t||e(r,t))&&(t=r)}),this._min=null!==t?t:void 0}return this._min},n.prototype.max=function(){if(null===this._max){var t=null;this.forEach(function(r){(null===t||e(t,r))&&(t=r)}),this._max=null!==t?t:void 0}return this._max},n},{isClass:!0}),oc="index",of=(t=>{var{typed:e,Index:r}=t;return e(oc,{"...number | string | BigNumber | Range | Array | Matrix":function(t){var e=t.map(function(t){return rR(t)?t.toNumber():rV(t)||rH(t)?t.map(function(t){return rR(t)?t.toNumber():t}):t}),n=new r;return r.apply(n,e),n}})},/* #__PURE__ */nD("Index",["ImmutableDenseMatrix","getMatrixDataType"],t=>{var{ImmutableDenseMatrix:e,getMatrixDataType:r}=t;function n(t){if(!(this instanceof n))throw SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var e=0,a=arguments.length;e<a;e++){var o=arguments[e],s=rV(o),u=rH(o),l=null;if(rX(o))this._dimensions.push(o),this._isScalar=!1;else if(s||u){var h=void 0;"boolean"===r(o)?(s&&(h=i(od(o).valueOf())),u&&(h=i(od(o._data).valueOf())),l=o.valueOf().length):h=i(o.valueOf()),this._dimensions.push(h);var c=h.size();(1!==c.length||1!==c[0]||null!==l)&&(this._isScalar=!1)}else if("number"==typeof o)this._dimensions.push(i([o]));else if("string"==typeof o)this._dimensions.push(o);else throw TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._sourceSize.push(l)}}function i(t){for(var r=0,n=t.length;r<n;r++)if("number"!=typeof t[r]||!nw(t[r]))throw TypeError("Index parameters must be positive integer numbers");return new e(t)}return n.prototype.type="Index",n.prototype.isIndex=!0,n.prototype.clone=function(){var t=new n;return t._dimensions=ng(this._dimensions),t._isScalar=this._isScalar,t._sourceSize=this._sourceSize,t},n.create=function(t){var e=new n;return n.apply(e,t),e},n.prototype.size=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];t[e]="string"==typeof n?1:n.size()[0]}return t},n.prototype.max=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];t[e]="string"==typeof n?n:n.max()}return t},n.prototype.min=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];t[e]="string"==typeof n?n:n.min()}return t},n.prototype.forEach=function(t){for(var e=0,r=this._dimensions.length;e<r;e++)t(this._dimensions[e],e,this)},n.prototype.dimension=function(t){return"number"!=typeof t?null:this._dimensions[t]||null},n.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},n.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},n.prototype.isScalar=function(){return this._isScalar},n.prototype.toArray=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];t.push("string"==typeof n?n:n.toArray())}return t},n.prototype.valueOf=n.prototype.toArray,n.prototype.toString=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];"string"==typeof n?t.push(JSON.stringify(n)):t.push(n.toString())}return"["+t.join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},n.fromJSON=function(t){return n.create(t.dimensions)},n},{isClass:!0}));function od(t){var e=[];return t.forEach((t,r)=>{t&&e.push(r)}),e}var op=/* #__PURE__ */nD("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],t=>{var{typed:e,matrix:r,divideScalar:n,addScalar:i,multiply:a,unaryMinus:o,det:s,identity:u,abs:l}=t;return e("inv",{"Array | Matrix":function(t){var e=rH(t)?t.size():nZ(t);switch(e.length){case 1:if(1===e[0]){if(rH(t))return r([n(1,t.valueOf()[0])]);return[n(1,t[0])]}throw RangeError("Matrix must be square (size: "+nW(e)+")");case 2:var i=e[0],a=e[1];if(i===a){if(rH(t))return r(h(t.valueOf(),i,a),t.storage());return h(t,i,a)}throw RangeError("Matrix must be square (size: "+nW(e)+")");default:throw RangeError("Matrix must be two dimensional (size: "+nW(e)+")")}},any:function(t){return n(1,t)}});function h(t,e,r){if(1===e){if(0===(d=t[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,d)]]}if(2===e){var h,c,f,d,p,g=s(t);if(0===g)throw Error("Cannot calculate inverse, determinant is zero");return[[n(t[1][1],g),n(o(t[0][1]),g)],[n(o(t[1][0]),g),n(t[0][0],g)]]}var m=t.concat();for(h=0;h<e;h++)m[h]=m[h].concat();for(var y=u(e).valueOf(),v=0;v<r;v++){var x=l(m[v][v]),D=v;for(h=v+1;h<e;)l(m[h][v])>x&&(x=l(m[h][v]),D=h),h++;if(0===x)throw Error("Cannot calculate inverse, determinant is zero");(h=D)!==v&&(p=m[v],m[v]=m[h],m[h]=p,p=y[v],y[v]=y[h],y[h]=p);var b=m[v],_=y[v];for(h=0;h<e;h++){var w=m[h],C=y[h];if(h!==v){if(0!==w[v]){for(f=n(o(w[v]),b[v]),c=v;c<r;c++)w[c]=i(w[c],a(f,b[c]));for(c=0;c<r;c++)C[c]=i(C[c],a(f,_[c]))}}else{for(f=b[v],c=v;c<r;c++)w[c]=n(w[c],f);for(c=0;c<r;c++)C[c]=n(C[c],f)}}}return y}}),og="isInteger",om=/* #__PURE__ */nD(og,["typed"],t=>{var{typed:e}=t;return e(og,{number:nw,BigNumber:function(t){return t.isInt()},bigint:function(t){return!0},Fraction:function(t){return 1n===t.d},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})});function oy(t){return Number.isNaN(t)}oy.signature="number";var ov="isNaN",ox=/* #__PURE__ */nD(ov,["typed"],t=>{var{typed:e}=t;return e(ov,{number:oy,BigNumber:function(t){return t.isNaN()},bigint:function(t){return!1},Fraction:function(t){return!1},Complex:function(t){return t.isNaN()},Unit:function(t){return Number.isNaN(t.value)},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})}),oD="isNegative",ob=(t=>{var{typed:e,config:r}=t;return e(oD,{number:t=>!nz(t,0,r.relTol,r.absTol)&&t<0,BigNumber:t=>!i4(t,new t.constructor(0),r.relTol,r.absTol)&&t.isNeg()&&!t.isZero()&&!t.isNaN(),bigint:t=>t<0n,Fraction:t=>t.s<0n,Unit:e.referToSelf(t=>r=>e.find(t,r.valueType())(r.value)),"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})},"isNumeric"),o_=/* #__PURE__ */nD(ob,["typed"],t=>{var{typed:e}=t;return e(ob,{"number | BigNumber | bigint | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})}),ow="isPositive",oC=/* #__PURE__ */nD(ow,["typed","config"],t=>{var{typed:e,config:r}=t;return e(ow,{number:t=>!nz(t,0,r.relTol,r.absTol)&&t>0,BigNumber:t=>!i4(t,new t.constructor(0),r.relTol,r.absTol)&&!t.isNeg()&&!t.isZero()&&!t.isNaN(),bigint:t=>t>0n,Fraction:t=>t.s>0n&&t.n>0n,Unit:e.referToSelf(t=>r=>e.find(t,r.valueType())(r.value)),"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})}),oA="isZero",oS=/* #__PURE__ */nD(oA,["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return e(oA,{"number | BigNumber | Complex | Fraction":t=>r(t,0),bigint:t=>0n===t,Unit:e.referToSelf(t=>r=>e.find(t,r.valueType())(r.value)),"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})}),oF="larger",oE=/* #__PURE__ */nD(oF,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=iY({typed:e}),u=i3({typed:e,SparseMatrix:o}),l=iX({typed:e,DenseMatrix:i}),h=iz({typed:e,matrix:n,concat:a}),c=ao({typed:e});return e(oF,oM({typed:e,config:r}),{"boolean, boolean":(t,e)=>t>e,"BigNumber, BigNumber":function(t,e){return t.gt(e)&&!i4(t,e,r.relTol,r.absTol)},"bigint, bigint":(t,e)=>t>e,"Fraction, Fraction":(t,e)=>1===t.compare(e),"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},c,h({SS:u,DS:s,Ss:l}))}),oM=/* #__PURE__ */nD(oF,["typed","config"],t=>{var{typed:e,config:r}=t;return e(oF,{"number, number":function(t,e){return t>e&&!nz(t,e,r.relTol,r.absTol)}})}),oN="largerEq",oB=/* #__PURE__ */nD(oN,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=iY({typed:e}),u=i3({typed:e,SparseMatrix:o}),l=iX({typed:e,DenseMatrix:i}),h=iz({typed:e,matrix:n,concat:a}),c=ao({typed:e});return e(oN,oT({typed:e,config:r}),{"boolean, boolean":(t,e)=>t>=e,"BigNumber, BigNumber":function(t,e){return t.gte(e)||i4(t,e,r.relTol,r.absTol)},"bigint, bigint":function(t,e){return t>=e},"Fraction, Fraction":(t,e)=>-1!==t.compare(e),"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},c,h({SS:u,DS:s,Ss:l}))}),oT=/* #__PURE__ */nD(oN,["typed","config"],t=>{var{typed:e,config:r}=t;return e(oN,{"number, number":function(t,e){return t>=e||nz(t,e,r.relTol,r.absTol)}})});t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o,s,u,l,h=t._values,c=t._index,f=t._ptr,d=t._size,p=t._datatype||void 0===t._data?t._datatype:t.getDataType(),g=n._values,m=n._index,y=n._ptr,v=n._size,x=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(d.length!==v.length)throw new n$(d.length,v.length);if(d[0]!==v[0]||d[1]!==v[1])throw RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+v+")");if(!h||!g)throw Error("Cannot perform operation on Pattern Sparse Matrices");var D=d[0],b=d[1],_=r,w=0,C=i;"string"==typeof p&&p===x&&"mixed"!==p&&(a=p,_=e.find(r,[a,a]),w=e.convert(0,a),C=e.find(i,[a,a]));for(var A=[],S=[],F=[],E=[],M=[],N=0;N<b;N++){F[N]=S.length;var B=N+1;for(s=f[N],u=f[N+1],o=s;o<u;o++)M[l=c[o]]=B,E[l]=h[o],S.push(l);for(s=y[N],u=y[N+1],o=s;o<u;o++)M[l=m[o]]===B&&(E[l]=C(E[l],g[o]));for(o=F[N];o<S.length;){var T=E[l=S[o]];_(T,w)?S.splice(o,1):(A.push(T),o++)}}return F[b]=S.length,t.createSparseMatrix({values:A,index:S,ptr:F,size:[D,b],datatype:p===t._datatype&&x===n._datatype?a:void 0})}},t=>{var{typed:e,matrix:r}=t;return{"Array, number":e.referTo("DenseMatrix, number",t=>(e,n)=>t(r(e),n).valueOf()),"Array, BigNumber":e.referTo("DenseMatrix, BigNumber",t=>(e,n)=>t(r(e),n).valueOf()),"number, Array":e.referTo("number, DenseMatrix",t=>(e,n)=>t(e,r(n)).valueOf()),"BigNumber, Array":e.referTo("BigNumber, DenseMatrix",t=>(e,n)=>t(e,r(n)).valueOf())}};var ok="log2";function oP(t){var{DenseMatrix:e}=t;return function(t,r,n){var i=t.size();if(2!==i.length)throw RangeError("Matrix must be two dimensional (size: "+nW(i)+")");var a=i[0];if(a!==i[1])throw RangeError("Matrix must be square (size: "+nW(i)+")");var o=[];if(rH(r)){var s=r.size(),u=r._data;if(1===s.length){if(s[0]!==a)throw RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var l=0;l<a;l++)o[l]=[u[l]];return new e({data:o,size:[a,1],datatype:r._datatype})}if(2===s.length){if(s[0]!==a||1!==s[1])throw RangeError("Dimension mismatch. Matrix columns must match vector length.");if(rK(r)){if(n){o=[];for(var h=0;h<a;h++)o[h]=[u[h][0]];return new e({data:o,size:[a,1],datatype:r._datatype})}return r}if(rY(r)){for(var c=0;c<a;c++)o[c]=[0];for(var f=r._values,d=r._index,p=r._ptr,g=p[1],m=p[0];m<g;m++)o[d[m]][0]=f[m];return new e({data:o,size:[a,1],datatype:r._datatype})}}throw RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(rV(r)){var y=nZ(r);if(1===y.length){if(y[0]!==a)throw RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var v=0;v<a;v++)o[v]=[r[v]];return new e({data:o,size:[a,1]})}if(2===y.length){if(y[0]!==a||1!==y[1])throw RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var x=0;x<a;x++)o[x]=[r[x][0]];return new e({data:o,size:[a,1]})}throw RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}t=>{var{typed:e,config:r,Complex:n}=t;return e(ok,{number:function(t){return t>=0||r.predictable?nS(t):i(new n(t,0))},Complex:i,BigNumber:function(t){return!t.isNegative()||r.predictable?t.log(2):i(new n(t.toNumber(),0))},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))});function i(t){var e=Math.sqrt(t.re*t.re+t.im*t.im);return new n(Math.log2?Math.log2(e):Math.log(e)/Math.LN2,Math.atan2(t.im,t.re)/Math.LN2)}};var oO="lsolve",oI=/* #__PURE__ */nD(oO,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=t,u=oP({DenseMatrix:s});return e(oO,{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var r=(e=u(t,e,!0))._data,l=t._size[0],h=t._size[1],c=t._values,f=t._index,d=t._ptr,p=[],g=0;g<h;g++){var m=r[g][0]||0;if(o(m,0))p[g]=[0];else{for(var y=0,v=[],x=[],D=d[g],b=d[g+1],_=D;_<b;_++){var w=f[_];w===g?y=c[_]:w>g&&(v.push(c[_]),x.push(w))}if(o(y,0))throw Error("Linear system cannot be solved since matrix is singular");for(var C=n(m,y),A=0,S=x.length;A<S;A++){var F=x[A];r[F]=[a(r[F][0]||0,i(C,v[A]))]}p[g]=[C]}}return new s({data:p,size:[l,1]})}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return l(t,e)},"Array, Array | Matrix":function(t,e){return l(r(t),e).valueOf()}});function l(t,e){for(var r=(e=u(t,e,!0))._data,l=t._size[0],h=t._size[1],c=[],f=t._data,d=0;d<h;d++){var p=r[d][0]||0,g=void 0;if(o(p,0))g=0;else{var m=f[d][d];if(o(m,0))throw Error("Linear system cannot be solved since matrix is singular");g=n(p,m);for(var y=d+1;y<l;y++)r[y]=[a(r[y][0]||0,i(g,f[y][d]))]}c[d]=[g]}return new s({data:c,size:[l,1]})}}),oz=/* #__PURE__ */nD("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],t=>{var{typed:e,matrix:r,abs:n,addScalar:i,divideScalar:a,multiplyScalar:o,subtractScalar:s,larger:u,equalScalar:l,unaryMinus:h,DenseMatrix:c,SparseMatrix:f,Spa:d}=t;return e("lup",{DenseMatrix:function(t){return p(t)},SparseMatrix:function(t){return function(t){var e,r,i,s=t._size[0],c=t._size[1],p=Math.min(s,c),g=t._values,m=t._index,y=t._ptr,v=[],x=[],D=[],b=[s,p],_=[],w=[],C=[],A=[p,c],S=[],F=[];for(e=0;e<s;e++)S[e]=e,F[e]=e;var E=function(t,e){var r=F[t],n=F[e];S[r]=e,S[n]=t,F[t]=n,F[e]=r};for(r=0;r<c;r++)!function(){var t=new d;r<s&&(D.push(v.length),v.push(1),x.push(r)),C.push(_.length);var c=y[r],p=y[r+1];for(i=c;i<p;i++)e=m[i],t.set(S[e],g[i]);r>0&&t.forEach(0,r-1,function(e,r){f._forEachRow(e,v,x,D,function(n,i){n>e&&t.accumulate(n,h(o(i,r)))})});var F=r,M=t.get(r),N=n(M);t.forEach(r+1,s-1,function(t,e){var r=n(e);u(r,N)&&(F=t,N=r,M=e)}),r!==F&&(f._swapRows(r,F,b[1],v,x,D),f._swapRows(r,F,A[1],_,w,C),t.swap(r,F),E(r,F)),t.forEach(0,s-1,function(t,e){t<=r?(_.push(e),w.push(t)):l(e=a(e,M),0)||(v.push(e),x.push(t))})}();return C.push(_.length),D.push(v.length),{L:new f({values:v,index:x,ptr:D,size:b}),U:new f({values:_,index:w,ptr:C,size:A}),p:S,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}(t)},Array:function(t){var e=p(r(t));return{L:e.L.valueOf(),U:e.U.valueOf(),p:e.p}}});function p(t){var e,r,h,f=t._size[0],d=t._size[1],p=Math.min(f,d),g=ng(t._data),m=[],y=[f,p],v=[],x=[p,d],D=[];for(e=0;e<f;e++)D[e]=e;for(r=0;r<d;r++){if(r>0)for(e=0;e<f;e++){var b=Math.min(e,r),_=0;for(h=0;h<b;h++)_=i(_,o(g[e][h],g[h][r]));g[e][r]=s(g[e][r],_)}var w=r,C=0,A=0;for(e=r;e<f;e++){var S=g[e][r],F=n(S);u(F,C)&&(w=e,C=F,A=S)}if(r!==w&&(D[r]=[D[w],D[w]=D[r]][0],c._swapRows(r,w,g)),r<f)for(e=r+1;e<f;e++)l(g[e][r],0)||(g[e][r]=a(g[e][r],A))}for(r=0;r<d;r++)for(e=0;e<f;e++){if(0===r&&(e<d&&(v[e]=[]),m[e]=[]),e<r){e<d&&(v[e][r]=g[e][r]),r<f&&(m[e][r]=0);continue}if(e===r){e<d&&(v[e][r]=g[e][r]),r<f&&(m[e][r]=1);continue}e<d&&(v[e][r]=0),r<f&&(m[e][r]=g[e][r])}var E=new c({data:m,size:y}),M=new c({data:v,size:x}),N=[];for(e=0,p=D.length;e<p;e++)N[D[e]]=e;return{L:E,U:M,p:N,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}});function oR(t,e){var r,n=e.length,i=[];if(t)for(r=0;r<n;r++)i[t[r]]=e[r];else for(r=0;r<n;r++)i[r]=e[r];return i}var oU="lusolve",oL=/* #__PURE__ */nD(oU,["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],t=>{var{typed:e,matrix:r,lup:n,slu:i,usolve:a,lsolve:o,DenseMatrix:s}=t,u=oP({DenseMatrix:s});return e(oU,{"Array, Array | Matrix":function(t,e){var i=n(t=r(t));return h(i.L,i.U,i.p,null,e).valueOf()},"DenseMatrix, Array | Matrix":function(t,e){var r=n(t);return h(r.L,r.U,r.p,null,e)},"SparseMatrix, Array | Matrix":function(t,e){var r=n(t);return h(r.L,r.U,r.p,null,e)},"SparseMatrix, Array | Matrix, number, number":function(t,e,r,n){var a=i(t,r,n);return h(a.L,a.U,a.p,a.q,e)},"Object, Array | Matrix":function(t,e){return h(t.L,t.U,t.p,t.q,e)}});function l(t){if(rH(t))return t;if(rV(t))return r(t);throw TypeError("Invalid Matrix LU decomposition")}function h(t,e,r,n,i){t=l(t),e=l(e),r&&((i=u(t,i,!0))._data=oR(r,i._data));var s=a(e,o(t,i));return n&&(s._data=oR(n,s._data)),s}}),oG="matrix",oj=/* #__PURE__ */nD(oG,["typed","Matrix","DenseMatrix","SparseMatrix"],t=>{var{typed:e,Matrix:r,DenseMatrix:n,SparseMatrix:i}=t;return e(oG,{"":function(){return a([])},string:function(t){return a([],t)},"string, string":function(t,e){return a([],t,e)},Array:function(t){return a(t)},Matrix:function(t){return a(t,t.storage())},"Array | Matrix, string":a,"Array | Matrix, string, string":a});function a(t,e,r){if("dense"===e||"default"===e||void 0===e)return new n(t,r);if("sparse"===e)return new i(t,r);throw TypeError("Unknown matrix type "+JSON.stringify(e)+".")}}),oq=/* #__PURE__ */nD("Matrix",[],()=>{function t(){if(!(this instanceof t))throw SyntaxError("Constructor must be called with the new operator")}return t.prototype.type="Matrix",t.prototype.isMatrix=!0,t.prototype.storage=function(){throw Error("Cannot invoke storage on a Matrix interface")},t.prototype.datatype=function(){throw Error("Cannot invoke datatype on a Matrix interface")},t.prototype.create=function(t,e){throw Error("Cannot invoke create on a Matrix interface")},t.prototype.subset=function(t,e,r){throw Error("Cannot invoke subset on a Matrix interface")},t.prototype.get=function(t){throw Error("Cannot invoke get on a Matrix interface")},t.prototype.set=function(t,e,r){throw Error("Cannot invoke set on a Matrix interface")},t.prototype.resize=function(t,e){throw Error("Cannot invoke resize on a Matrix interface")},t.prototype.reshape=function(t,e){throw Error("Cannot invoke reshape on a Matrix interface")},t.prototype.clone=function(){throw Error("Cannot invoke clone on a Matrix interface")},t.prototype.size=function(){throw Error("Cannot invoke size on a Matrix interface")},t.prototype.map=function(t,e){throw Error("Cannot invoke map on a Matrix interface")},t.prototype.forEach=function(t){throw Error("Cannot invoke forEach on a Matrix interface")},t.prototype[Symbol.iterator]=function(){throw Error("Cannot iterate a Matrix interface")},t.prototype.toArray=function(){throw Error("Cannot invoke toArray on a Matrix interface")},t.prototype.valueOf=function(){throw Error("Cannot invoke valueOf on a Matrix interface")},t.prototype.format=function(t){throw Error("Cannot invoke format on a Matrix interface")},t.prototype.toString=function(){throw Error("Cannot invoke toString on a Matrix interface")},t},{isClass:!0}),oV="matrixFromColumns",oH=/* #__PURE__ */nD(oV,["typed","matrix","flatten","size"],t=>{var{typed:e,matrix:r,flatten:n,size:i}=t;return e(oV,{"...Array":function(t){return a(t)},"...Matrix":function(t){return r(a(t.map(t=>t.toArray())))}});function a(t){if(0===t.length)throw TypeError("At least one column is needed to construct a matrix.");for(var e=o(t[0]),r=[],i=0;i<e;i++)r[i]=[];for(var a of t){var s=o(a);if(s!==e)throw TypeError("The vectors had different length: "+(0|e)+" ≠ "+(0|s));for(var u=n(a),l=0;l<e;l++)r[l].push(u[l])}return r}function o(t){var e=i(t);if(1===e.length)return e[0];if(2===e.length){if(1===e[0])return e[1];if(1===e[1])return e[0];throw TypeError("At least one of the arguments is not a vector.")}throw TypeError("Only one- or two-dimensional vectors are supported.")}}),oW=(t=>{var{typed:e,add:r,divide:n}=t;return e("mean",{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(t,e){try{var i=ic(t,e,r),a=Array.isArray(t)?nZ(t):t.size();return n(i,a[e])}catch(t){throw aC(t,"mean")}},"...":function(t){if(iu(t))throw TypeError("Scalar values expected in function mean");return i(t)}});function i(t){var e,i=0;if(il(t,function(t){try{e=void 0===e?t:r(e,t),i++}catch(e){throw aC(e,"mean",t)}}),0===i)throw Error("Cannot calculate the mean of an empty array");return n(e,i)}},"median"),oK="multiply",oY=/* #__PURE__ */nD(oK,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],t=>{var{typed:e,matrix:r,addScalar:n,multiplyScalar:i,equalScalar:a,dot:o}=t,s=ij({typed:e,equalScalar:a}),u=iO({typed:e});function l(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}}var h=e("_multiplyMatrixVector",{"DenseMatrix, any":function(t,r){var a,o=t._data,s=t._size,u=t._datatype||t.getDataType(),l=r._data,h=r._datatype||r.getDataType(),c=s[0],f=s[1],d=n,p=i;u&&h&&u===h&&"string"==typeof u&&"mixed"!==u&&(a=u,d=e.find(n,[a,a]),p=e.find(i,[a,a]));for(var g=[],m=0;m<c;m++){for(var y=o[m],v=p(y[0],l[0]),x=1;x<f;x++)v=d(v,p(y[x],l[x]));g[m]=v}return t.createDenseMatrix({data:g,size:[c],datatype:u===t._datatype&&h===r._datatype?a:void 0})},"SparseMatrix, any":function(t,r){var o,s=t._values,u=t._index,l=t._ptr,h=t._datatype||void 0===t._data?t._datatype:t.getDataType();if(!s)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c=r._data,f=r._datatype||r.getDataType(),d=t._size[0],p=r._size[0],g=[],m=[],y=[],v=n,x=i,D=a,b=0;h&&f&&h===f&&"string"==typeof h&&"mixed"!==h&&(o=h,v=e.find(n,[o,o]),x=e.find(i,[o,o]),D=e.find(a,[o,o]),b=e.convert(0,o));var _=[],w=[];y[0]=0;for(var C=0;C<p;C++){var A=c[C];if(!D(A,b))for(var S=l[C],F=l[C+1],E=S;E<F;E++){var M=u[E];w[M]?_[M]=v(_[M],x(A,s[E])):(w[M]=!0,m.push(M),_[M]=x(A,s[E]))}}for(var N=m.length,B=0;B<N;B++){var T=m[B];g[B]=_[T]}return y[1]=m.length,t.createSparseMatrix({values:g,index:m,ptr:y,size:[d,1],datatype:h===t._datatype&&f===r._datatype?o:void 0})}}),c=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(t,r){var a,o=t._data,s=t._size,u=t._datatype||t.getDataType(),l=r._data,h=r._size,c=r._datatype||r.getDataType(),f=s[0],d=s[1],p=h[1],g=n,m=i;u&&c&&u===c&&"string"==typeof u&&"mixed"!==u&&"mixed"!==u&&(a=u,g=e.find(n,[a,a]),m=e.find(i,[a,a]));for(var y=[],v=0;v<f;v++){var x=o[v];y[v]=[];for(var D=0;D<p;D++){for(var b=m(x[0],l[0][D]),_=1;_<d;_++)b=g(b,m(x[_],l[_][D]));y[v][D]=b}}return t.createDenseMatrix({data:y,size:[f,p],datatype:u===t._datatype&&c===r._datatype?a:void 0})},"DenseMatrix, SparseMatrix":function(t,r){var o,s=t._data,u=t._size,l=t._datatype||t.getDataType(),h=r._values,c=r._index,f=r._ptr,d=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(!h)throw Error("Cannot multiply Dense Matrix times Pattern only Matrix");var g=u[0],m=d[1],y=n,v=i,x=a,D=0;l&&p&&l===p&&"string"==typeof l&&"mixed"!==l&&(o=l,y=e.find(n,[o,o]),v=e.find(i,[o,o]),x=e.find(a,[o,o]),D=e.convert(0,o));for(var b=[],_=[],w=[],C=r.createSparseMatrix({values:b,index:_,ptr:w,size:[g,m],datatype:l===t._datatype&&p===r._datatype?o:void 0}),A=0;A<m;A++){w[A]=_.length;var S=f[A],F=f[A+1];if(F>S)for(var E=0,M=0;M<g;M++){for(var N=M+1,B=void 0,T=S;T<F;T++){var k=c[T];E!==N?(B=v(s[M][k],h[T]),E=N):B=y(B,v(s[M][k],h[T]))}E!==N||x(B,D)||(_.push(M),b.push(B))}}return w[m]=_.length,C},"SparseMatrix, DenseMatrix":function(t,r){var o,s=t._values,u=t._index,l=t._ptr,h=t._datatype||void 0===t._data?t._datatype:t.getDataType();if(!s)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c=r._data,f=r._datatype||r.getDataType(),d=t._size[0],p=r._size[0],g=r._size[1],m=n,y=i,v=a,x=0;h&&f&&h===f&&"string"==typeof h&&"mixed"!==h&&(o=h,m=e.find(n,[o,o]),y=e.find(i,[o,o]),v=e.find(a,[o,o]),x=e.convert(0,o));for(var D=[],b=[],_=[],w=t.createSparseMatrix({values:D,index:b,ptr:_,size:[d,g],datatype:h===t._datatype&&f===r._datatype?o:void 0}),C=[],A=[],S=0;S<g;S++){_[S]=b.length;for(var F=S+1,E=0;E<p;E++){var M=c[E][S];if(!v(M,x))for(var N=l[E],B=l[E+1],T=N;T<B;T++){var k=u[T];A[k]!==F?(A[k]=F,b.push(k),C[k]=y(M,s[T])):C[k]=m(C[k],y(M,s[T]))}}for(var P=_[S],O=b.length,I=P;I<O;I++){var z=b[I];D[I]=C[z]}}return _[g]=b.length,w},"SparseMatrix, SparseMatrix":function(t,r){var a,o,s,u,l,h,c,f,d,p=t._values,g=t._index,m=t._ptr,y=t._datatype||void 0===t._data?t._datatype:t.getDataType(),v=r._values,x=r._index,D=r._ptr,b=r._datatype||void 0===r._data?r._datatype:r.getDataType(),_=t._size[0],w=r._size[1],C=p&&v,A=n,S=i;y&&b&&y===b&&"string"==typeof y&&"mixed"!==y&&(a=y,A=e.find(n,[a,a]),S=e.find(i,[a,a]));for(var F=C?[]:void 0,E=[],M=[],N=t.createSparseMatrix({values:F,index:E,ptr:M,size:[_,w],datatype:y===t._datatype&&b===r._datatype?a:void 0}),B=C?[]:void 0,T=[],k=0;k<w;k++){M[k]=E.length;var P=k+1;for(h=D[k],c=D[k+1],l=h;l<c;l++)if(d=x[l],C)for(s=m[d],u=m[d+1],o=s;o<u;o++)T[f=g[o]]!==P?(T[f]=P,E.push(f),B[f]=S(v[l],p[o])):B[f]=A(B[f],S(v[l],p[o]));else for(s=m[d],u=m[d+1],o=s;o<u;o++)T[f=g[o]]!==P&&(T[f]=P,E.push(f));if(C)for(var O=M[k],I=E.length,z=O;z<I;z++){var R=E[z];F[z]=B[R]}}return M[w]=E.length,N}});return e(oK,i,{"Array, Array":e.referTo("Matrix, Matrix",t=>(e,n)=>{l(nZ(e),nZ(n));var i=t(r(e),r(n));return rH(i)?i.valueOf():i}),"Matrix, Matrix":function(t,r){var a=t.size(),s=r.size();return(l(a,s),1===a.length)?1===s.length?function(t,e,r){if(0===r)throw Error("Cannot multiply two empty vectors");return o(t,e)}(t,r,a[0]):function(t,r){if("dense"!==r.storage())throw Error("Support for SparseMatrix not implemented");return function(t,r){var a,o=t._data,s=t._size,u=t._datatype||t.getDataType(),l=r._data,h=r._size,c=r._datatype||r.getDataType(),f=s[0],d=h[1],p=n,g=i;u&&c&&u===c&&"string"==typeof u&&"mixed"!==u&&(a=u,p=e.find(n,[a,a]),g=e.find(i,[a,a]));for(var m=[],y=0;y<d;y++){for(var v=g(o[0],l[0][y]),x=1;x<f;x++)v=p(v,g(o[x],l[x][y]));m[y]=v}return t.createDenseMatrix({data:m,size:[d],datatype:u===t._datatype&&c===r._datatype?a:void 0})}(t,r)}(t,r):1===s.length?h(t,r):c(t,r)},"Matrix, Array":e.referTo("Matrix,Matrix",t=>(e,n)=>t(e,r(n))),"Array, Matrix":e.referToSelf(t=>(e,n)=>t(r(e,n.storage()),n)),"SparseMatrix, any":function(t,e){return s(t,e,i,!1)},"DenseMatrix, any":function(t,e){return u(t,e,i,!1)},"any, SparseMatrix":function(t,e){return s(e,t,i,!0)},"any, DenseMatrix":function(t,e){return u(e,t,i,!0)},"Array, any":function(t,e){return u(r(t),e,i,!1).valueOf()},"any, Array":function(t,e){return u(r(e),t,i,!0).valueOf()},"any, any":i,"any, any, ...any":e.referToSelf(t=>(e,r,n)=>{for(var i=t(e,r),a=0;a<n.length;a++)i=t(i,n[a]);return i})})}),oX=/* #__PURE__ */nD("multiplyScalar",["typed"],t=>{var{typed:e}=t;return e("multiplyScalar",{"number, number":iD,"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"bigint, bigint":function(t,e){return t*e},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":(t,e)=>e.multiply(t),"Unit, number | Fraction | BigNumber | Complex | Unit":(t,e)=>t.multiply(e)})}),o$="norm",oZ=/* #__PURE__ */nD(o$,["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],t=>{var{typed:e,abs:r,add:n,pow:i,conj:a,sqrt:o,multiply:s,equalScalar:u,larger:l,smaller:h,matrix:c,ctranspose:f,eigs:d}=t;return e(o$,{number:Math.abs,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},boolean:function(t){return Math.abs(t)},Array:function(t){return p(c(t),2)},Matrix:function(t){return p(t,2)},"Array, number | BigNumber | string":function(t,e){return p(c(t),e)},"Matrix, number | BigNumber | string":function(t,e){return p(t,e)}});function p(t,e){var c=t.size();if(1===c.length)return function(t,e){if(e===Number.POSITIVE_INFINITY||"inf"===e)return a=0,t.forEach(function(t){var e=r(t);l(e,a)&&(a=e)},!0),a;if(e===Number.NEGATIVE_INFINITY||"-inf"===e)return t.forEach(function(t){var e=r(t);(!o||h(e,o))&&(o=e)},!0),o||0;if("fro"===e)return p(t,2);if("number"==typeof e&&!isNaN(e)){if(!u(e,0)){var a,o,s=0;return t.forEach(function(t){s=n(i(r(t),e),s)},!0),i(s,1/e)}return Number.POSITIVE_INFINITY}throw Error("Unsupported parameter value")}(t,e);if(2===c.length){if(c[0]&&c[1])return function(t,e){var i,u,h,c,p;if(1===e)return i=[],u=0,t.forEach(function(t,e){var a=e[1],o=n(i[a]||0,r(t));l(o,u)&&(u=o),i[a]=o},!0),u;if(e===Number.POSITIVE_INFINITY||"inf"===e)return h=[],c=0,t.forEach(function(t,e){var i=e[0],a=n(h[i]||0,r(t));l(a,c)&&(c=a),h[i]=a},!0),c;if("fro"===e)return p=0,t.forEach(function(t,e){p=n(p,s(t,a(t)))}),r(o(p));if(2===e)return function(t){var e=t.size();if(e[0]!==e[1])throw RangeError("Invalid matrix dimensions");var n=d(s(f(t),t)).values.toArray();return r(o(n[n.length-1]))}(t);throw Error("Unsupported parameter value "+e)}(t,e);throw RangeError("Invalid matrix dimensions")}}}),oJ=/* #__PURE__ */nD("number",["typed"],t=>{var{typed:e}=t,r=e("number",{"":function(){return 0},number:function(t){return t},string:function(t){if("NaN"===t)return NaN;var e,r,n=(r=(e=t).match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/))?{input:e,radix:({"0b":2,"0o":8,"0x":16})[r[1]],integerPart:r[2],fractionalPart:r[3]}:null;if(n)return function(t){for(var e=parseInt(t.integerPart,t.radix),r=0,n=0;n<t.fractionalPart.length;n++)r+=parseInt(t.fractionalPart[n],t.radix)/Math.pow(t.radix,n+1);var i=e+r;if(isNaN(i))throw SyntaxError('String "'+t.input+'" is not a valid number');return i}(n);var i=0,a=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);a&&(i=Number(a[2]),t=a[1]);var o=Number(t);if(isNaN(o))throw SyntaxError('String "'+t+'" is not a valid number');if(a){if(o>2**i-1)throw SyntaxError('String "'.concat(t,'" is out of range'));o>=2**(i-1)&&(o-=2**i)}return o},BigNumber:function(t){return t.toNumber()},bigint:function(t){return Number(t)},Fraction:function(t){return t.valueOf()},Unit:e.referToSelf(t=>e=>{var r=e.clone();return r.value=t(e.value),r}),null:function(t){return 0},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))});return r.fromJSON=function(t){return parseFloat(t.value)},r});function oQ(){throw Error('No "bignumber" implementation available')}function o0(){throw Error('No "fraction" implementation available')}function o1(){throw Error('No "matrix" implementation available')}var o2=/* #__PURE__ */nD("numeric",["number","?bignumber","?fraction"],t=>{var{number:e,bignumber:r,fraction:n}=t,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:t=>e(t),BigNumber:r?t=>r(t):oQ,bigint:t=>BigInt(t),Fraction:n?t=>n(t):o0};return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number",r=arguments.length>2?arguments[2]:void 0;if(void 0!==r)throw SyntaxError("numeric() takes one or two arguments");var n=np(t);if(!(n in i))throw TypeError("Cannot convert "+t+' of type "'+n+'"; valid input types are '+Object.keys(i).join(", "));if(!(e in a))throw TypeError("Cannot convert "+t+' to type "'+e+'"; valid output types are '+Object.keys(a).join(", "));return e===n?t:a[e](t)}});nD("oct",["typed","format"],t=>{var{typed:e,format:r}=t;return e("oct",{"number | BigNumber":function(t){return r(t,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(t,e){return r(t,{notation:"oct",wordSize:e})}})});var o5="partitionSelect";t=>{var{typed:e,isNumeric:r,isNaN:n,compare:i}=t,a=(t,e)=>-i(t,e);return e(o5,{"Array | Matrix, number":function(t,e){return o(t,e,i)},"Array | Matrix, number, string":function(t,e,r){if("asc"===r)return o(t,e,i);if("desc"===r)return o(t,e,a);throw Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":o});function o(t,e,r){if(!nw(e)||e<0)throw Error("k must be a non-negative integer");if(rH(t)){if(t.size().length>1)throw Error("Only one dimensional matrices supported");return s(t.valueOf(),e,r)}if(Array.isArray(t))return s(t,e,r)}function s(t,e,i){if(e>=t.length)throw Error("k out of bounds");for(var a=0;a<t.length;a++)if(r(t[a])&&n(t[a]))return t[a];for(var o=0,s=t.length-1;o<s;){for(var u=o,l=s,h=t[Math.floor(Math.random()*(s-o+1))+o];u<l;)if(i(t[u],h)>=0){var c=t[l];t[l]=t[u],t[u]=c,--l}else++u;i(t[u],h)>0&&--u,e<=u?s=u:o=u+1}return t[e]}};var o3={},o4=s("cmoHh"),o8=s("euRi5"),o6=s("hDsEw"),o9=s("3J2Zm"),o7=s("6Px8M"),st=s("lDm0S"),se={};!function(t,e,r){var n,i="random",a=r.pow(256,6),o=r.pow(2,52),u=2*o;function l(s,l,p){var g=[],m=f(function t(e,r){var n,i=[],a=typeof e;if(r&&"object"==a)for(n in e)try{i.push(t(e[n],r-1))}catch(t){}return i.length?i:"string"==a?e:e+"\0"}((l=!0==l?{entropy:!0}:l||{}).entropy?[s,d(e)]:null==s?function(){try{var r;return n&&(r=n.randomBytes)?r=r(256):(r=new Uint8Array(256),(t.crypto||t.msCrypto).getRandomValues(r)),d(r)}catch(r){var i=t.navigator,a=i&&i.plugins;return[+new Date,t,a,t.screen,d(e)]}}():s,3),g),y=new h(g),v=function(){for(var t=y.g(6),e=a,r=0;t<o;)t=(t+r)*256,e*=256,r=y.g(1);for(;t>=u;)t/=2,e/=2,r>>>=1;return(t+r)/e};return v.int32=function(){return 0|y.g(4)},v.quick=function(){return y.g(4)/0x100000000},v.double=v,f(d(y.S),e),(l.pass||p||function(t,e,n,a){return(a&&(a.S&&c(a,y),t.state=function(){return c(y,{})}),n)?(r[i]=t,e):t})(v,m,"global"in l?l.global:this==r,l.state)}function h(t){var e,r=t.length,n=this,i=0,a=n.i=n.j=0,o=n.S=[];for(r||(t=[r++]);i<256;)o[i]=i++;for(i=0;i<256;i++)o[i]=o[a=255&a+t[i%r]+(e=o[i])],o[a]=e;(n.g=function(t){for(var e,r=0,i=n.i,a=n.j,o=n.S;t--;)e=o[i=255&i+1],r=256*r+o[255&(o[i]=o[a=255&a+e])+(o[a]=e)];return n.i=i,n.j=a,r})(256)}function c(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function f(t,e){for(var r,n=t+"",i=0;i<n.length;)e[255&i]=255&(r^=19*e[255&i])+n.charCodeAt(i++);return d(e)}function d(t){return String.fromCharCode.apply(0,t)}if(f(r.random(),e),se){se=l;try{n=s("bx1Nf")}catch(t){}}else"function"==typeof define&&define.amd?define(function(){return l}):r["seed"+i]=l}("undefined"!=typeof self?self:se,[],Math),se.alea=o4,se.xor128=o8,se.xorwow=o6,se.xorshift7=o9,se.xor4096=o7,se.tychei=st;var sr=/* #__PURE__ *//*@__PURE__*/i(o3=se)(Date.now()),sn=/* #__PURE__ */nD("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],t=>{var{typed:e,config:r,identity:n,multiply:i,matrix:a,inv:o,number:s,fraction:u,Complex:l}=t;return e("pow",{"number, number":h,"Complex, Complex":function(t,e){return t.pow(e)},"BigNumber, BigNumber":function(t,e){return e.isInteger()||t>=0||r.predictable?t.pow(e):new l(t.toNumber(),0).pow(e.toNumber(),0)},"bigint, bigint":(t,e)=>t**e,"Fraction, Fraction":function(t,e){var n=t.pow(e);if(null!=n)return n;if(!r.predictable)return h(t.valueOf(),e.valueOf());throw Error("Result of pow is non-rational and cannot be expressed as a fraction")},"Array, number":c,"Array, BigNumber":function(t,e){return c(t,e.toNumber())},"Matrix, number":f,"Matrix, BigNumber":function(t,e){return f(t,e.toNumber())},"Unit, number | BigNumber":function(t,e){return t.pow(e)}});function h(t,e){if(r.predictable&&!nw(e)&&t<0)try{var n=u(e),i=s(n);if((e===i||1e-14>Math.abs((e-i)/e))&&n.d%2n===1n)return(n.n%2n===0n?1:-1)*Math.pow(-t,e)}catch(t){}return r.predictable&&(t<-1&&e===1/0||t>-1&&t<0&&e===-1/0)?NaN:nw(e)||t>=0||r.predictable?iF(t,e):t*t<1&&e===1/0||t*t>1&&e===-1/0?0:new l(t,0).pow(e,0)}function c(t,e){if(!nw(e))throw TypeError("For A^b, b must be an integer (value is "+e+")");var r=nZ(t);if(2!==r.length)throw Error("For A^b, A must be 2 dimensional (A has "+r.length+" dimensions)");if(r[0]!==r[1])throw Error("For A^b, A must be square (size is "+r[0]+"x"+r[1]+")");if(e<0)try{return c(o(t),-e)}catch(t){if("Cannot calculate inverse, determinant is zero"===t.message)throw TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+e+")");throw t}for(var a=n(r[0]).valueOf(),s=t;e>=1;)(1&e)==1&&(a=i(s,a)),e>>=1,s=i(s,s);return a}function f(t,e){return a(c(t.valueOf(),e))}}),si=/\$([\w.]+)/g,sa=(t=>{var{typed:e,config:r,multiplyScalar:n,numeric:i}=t;return e("prod",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(t,e){throw Error("prod(A, dim) is not yet supported")},"...":function(t){return a(t)}});function a(t){var e;if(il(t,function(t){try{e=void 0===e?t:n(e,t)}catch(e){throw aC(e,"prod",t)}}),"string"==typeof e&&(e=i(e,nC(e,r))),void 0===e)throw Error("Cannot calculate prod of an empty array");return e}},/* #__PURE__ */nD("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],t=>{var{typed:e,matrix:r,zeros:n,identity:a,isZero:o,equal:s,sign:u,sqrt:l,conj:h,unaryMinus:c,addScalar:f,divideScalar:d,multiplyScalar:p,subtractScalar:g,complex:m}=t;return /*@__PURE__*/i(rE)(e("qr",{DenseMatrix:function(t){return v(t)},SparseMatrix:function(t){return function(t){throw Error("qr not implemented for sparse matrices yet")}(0)},Array:function(t){var e=v(r(t));return{Q:e.Q.valueOf(),R:e.R.valueOf()}}}),{_denseQRimpl:y});function y(t){var e,r,i,m=t._size[0],y=t._size[1],v=a([m],"dense"),x=v._data,D=t.clone(),b=D._data,_=n([m],"");for(i=0;i<Math.min(y,m);++i){var w=b[i][i],C=c(s(w,0)?1:u(w)),A=h(C),S=0;for(e=i;e<m;e++)S=f(S,p(b[e][i],h(b[e][i])));var F=p(C,l(S));if(!o(F)){var E=g(w,F);for(_[i]=1,e=i+1;e<m;e++)_[e]=d(b[e][i],E);var M=c(h(d(E,F))),N=void 0;for(r=i;r<y;r++){for(N=0,e=i;e<m;e++)N=f(N,p(h(_[e]),b[e][r]));for(N=p(N,M),e=i;e<m;e++)b[e][r]=p(g(b[e][r],p(_[e],N)),A)}for(e=0;e<m;e++){for(N=0,r=i;r<m;r++)N=f(N,p(x[e][r],_[r]));for(N=p(N,M),r=i;r<m;++r)x[e][r]=d(g(x[e][r],p(N,h(_[r]))),A)}}}return{Q:v,R:D,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function v(t){var e=y(t),r=e.R._data;if(t._data.length>0)for(var n="Complex"===r[0][0].type?m(0):0,i=0;i<r.length;++i)for(var a=0;a<i&&a<(r[0]||[]).length;++a)r[i][a]=n;return e}})),so="range",ss=/* #__PURE__ */nD(so,["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],t=>{var{typed:e,config:r,matrix:n,bignumber:i,smaller:a,smallerEq:o,larger:s,largerEq:u,add:l,isPositive:h}=t;return e(so,{string:f,"string, boolean":f,"number, number":function(t,e){return c(d(t,e,1,!1))},"number, number, number":function(t,e,r){return c(d(t,e,r,!1))},"number, number, boolean":function(t,e,r){return c(d(t,e,1,r))},"number, number, number, boolean":function(t,e,r,n){return c(d(t,e,r,n))},"BigNumber, BigNumber":function(t,e){var r=t.constructor;return c(d(t,e,new r(1),!1))},"BigNumber, BigNumber, BigNumber":function(t,e,r){return c(d(t,e,r,!1))},"BigNumber, BigNumber, boolean":function(t,e,r){var n=t.constructor;return c(d(t,e,new n(1),r))},"BigNumber, BigNumber, BigNumber, boolean":function(t,e,r,n){return c(d(t,e,r,n))},"Unit, Unit, Unit":function(t,e,r){return c(d(t,e,r,!1))},"Unit, Unit, Unit, boolean":function(t,e,r,n){return c(d(t,e,r,n))}});function c(t){return"Matrix"===r.matrix?n?n(t):o1():t}function f(t,e){var n=function(t){var e=t.split(":").map(function(t){return Number(t)});if(e.some(function(t){return isNaN(t)}))return null;switch(e.length){case 2:return{start:e[0],end:e[1],step:1};case 3:return{start:e[0],end:e[2],step:e[1]};default:return null}}(t);if(!n)throw SyntaxError('String "'+t+'" is no valid range');return"BigNumber"===r.number?(void 0===i&&oQ(),c(d(i(n.start),i(n.end),i(n.step)),e)):c(d(n.start,n.end,n.step,e))}function d(t,e,r,n){for(var i=[],c=h(r)?n?o:a:n?u:s,f=t;c(f,e);)i.push(f),f=l(f,r);return i}}),su=/* #__PURE__ */nD("re",["typed"],t=>{var{typed:e}=t;return e("re",{"number | BigNumber | Fraction":t=>t,Complex:t=>t.re,"Array | Matrix":e.referToSelf(t=>e=>ih(e,t))})}),sl="reshape",sh=/* #__PURE__ */nD(sl,["typed","isInteger","matrix"],t=>{var{typed:e,isInteger:r}=t;return e(sl,{"Matrix, Array":function(t,e){return t.reshape(e,!0)},"Array, Array":function(t,e){return e.forEach(function(t){if(!r(t))throw TypeError("Invalid size for dimension: "+t)}),n5(t,e)}})}),sc=(t=>{var{typed:e,config:r,multiplyScalar:n,addScalar:i,unaryMinus:a,norm:o,BigNumber:s,matrix:u,DenseMatrix:l,SparseMatrix:h,cos:c,sin:f}=t;return e("rotationMatrix",{"":function(){return"Matrix"===r.matrix?u([]):[]},string:function(t){return u(t)},"number | BigNumber | Complex | Unit":function(t){return d(t,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(t,e){return d(t,e)},"number | BigNumber | Complex | Unit, Array":function(t,e){var r=u(e);return p(r),y(t,r,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(t,e){p(e);var n=e.storage()||("Matrix"===r.matrix?"dense":void 0);return y(t,e,n)},"number | BigNumber | Complex | Unit, Array, string":function(t,e,r){var n=u(e);return p(n),y(t,n,r)},"number | BigNumber | Complex | Unit, Matrix, string":function(t,e,r){return p(e),y(t,e,r)}});function d(t,e){var r=rR(t)?new s(-1):-1,i=c(t),a=f(t);return m([[i,n(r,a)],[a,i]],e)}function p(t){var e=t.size();if(e.length<1||3!==e[0])throw RangeError("Vector must be of dimensions 1x3")}function g(t){return t.reduce((t,e)=>n(t,e))}function m(t,e){if(e){if("sparse"===e)return new h(t);if("dense"===e)return new l(t);throw TypeError('Unknown matrix type "'.concat(e,'"'))}return t}function y(t,e,r){var n=o(e);if(0===n)throw RangeError("Rotation around zero vector");var u=rR(t)?s:null,l=u?new u(1):1,h=u?new u(-1):-1,d=u?new u(e.get([0])/n):e.get([0])/n,p=u?new u(e.get([1])/n):e.get([1])/n,y=u?new u(e.get([2])/n):e.get([2])/n,v=c(t),x=i(l,a(v)),D=f(t);return m([[i(v,g([d,d,x])),i(g([d,p,x]),g([h,y,D])),i(g([d,y,x]),g([p,D]))],[i(g([d,p,x]),g([y,D])),i(v,g([p,p,x])),i(g([p,y,x]),g([h,d,D]))],[i(g([d,y,x]),g([h,p,D])),i(g([p,y,x]),g([d,D])),i(v,g([y,y,x]))]],r)}},"Number of decimals in function round must be an integer"),sf="round",sd=/* #__PURE__ */nD(sf,["typed","config","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],t=>{var{typed:e,config:r,matrix:n,equalScalar:i,zeros:a,BigNumber:o,DenseMatrix:s}=t,u=ij({typed:e,equalScalar:i}),l=iX({typed:e,DenseMatrix:s}),h=iO({typed:e});function c(t){return Math.abs(nT(t).exponent)}return e(sf,{number:function(t){var e=iE(t,c(r.relTol));return iE(nz(t,e,r.relTol,r.absTol)?e:t)},"number, number":function(t,e){var n=c(r.relTol);if(e>=n)return iE(t,e);var i=iE(t,n);return iE(nz(t,i,r.relTol,r.absTol)?i:t,e)},"number, BigNumber":function(t,e){if(!e.isInteger())throw TypeError(sc);return new o(t).toDecimalPlaces(e.toNumber())},Complex:function(t){return t.round()},"Complex, number":function(t,e){if(e%1)throw TypeError(sc);return t.round(e)},"Complex, BigNumber":function(t,e){if(!e.isInteger())throw TypeError(sc);var r=e.toNumber();return t.round(r)},BigNumber:function(t){var e=new o(t).toDecimalPlaces(c(r.relTol));return(i4(t,e,r.relTol,r.absTol)?e:t).toDecimalPlaces(0)},"BigNumber, BigNumber":function(t,e){if(!e.isInteger())throw TypeError(sc);var n=c(r.relTol);if(e>=n)return t.toDecimalPlaces(e.toNumber());var i=t.toDecimalPlaces(n);return(i4(t,i,r.relTol,r.absTol)?i:t).toDecimalPlaces(e.toNumber())},Fraction:function(t){return t.round()},"Fraction, number":function(t,e){if(e%1)throw TypeError(sc);return t.round(e)},"Fraction, BigNumber":function(t,e){if(!e.isInteger())throw TypeError(sc);return t.round(e.toNumber())},"Unit, number, Unit":e.referToSelf(t=>function(e,r,n){var i=e.toNumeric(n);return n.multiply(t(i,r))}),"Unit, BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>t(e,r.toNumber(),n)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>ih(e,e=>t(e,r,n),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(t=>(e,r)=>t(e,0,r)),"Array | Matrix":e.referToSelf(t=>e=>ih(e,t,!0)),"SparseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>u(e,r,t,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>h(e,r,t,!1)),"Array, number | BigNumber":e.referToSelf(t=>(e,r)=>h(n(e),r,t,!1).valueOf()),"number | Complex | BigNumber | Fraction, SparseMatrix":e.referToSelf(t=>(e,r)=>i(e,0)?a(r.size(),r.storage()):l(r,e,t,!0)),"number | Complex | BigNumber | Fraction, DenseMatrix":e.referToSelf(t=>(e,r)=>i(e,0)?a(r.size(),r.storage()):h(r,e,t,!0)),"number | Complex | BigNumber | Fraction, Array":e.referToSelf(t=>(e,r)=>h(n(r),e,t,!0).valueOf())})}),sp="schur",sg=(t=>{var{typed:e,matrix:r,identity:n,multiply:i,qr:a,norm:o,subtract:s}=t;return e(sp,{Array:function(t){var e=u(r(t));return{U:e.U.valueOf(),T:e.T.valueOf()}},Matrix:function(t){return u(t)}});function u(t){var e,r=t.size()[0],u=t,l=n(r),h=0;do{e=u;var c=a(u),f=c.Q;if(u=i(c.R,f),l=i(l,f),h++>100)break}while(o(s(u,e))>1e-4)return{U:l,T:u}}},"setDifference");t=>{var{typed:e,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:o}=t;return e(sg,{"Array | Matrix, Array | Matrix":function(t,e){var s;if(0===n(r(t),new a(0)))s=[];else{if(0===n(r(e),new a(0)))return n6(t.toArray());var u,l=n9(n6(Array.isArray(t)?t:t.toArray()).sort(i)),h=n9(n6(Array.isArray(e)?e:e.toArray()).sort(i));s=[];for(var c=0;c<l.length;c++){u=!1;for(var f=0;f<h.length;f++)if(0===i(l[c].value,h[f].value)&&l[c].identifier===h[f].identifier){u=!0;break}u||s.push(l[c])}}return Array.isArray(t)&&Array.isArray(e)?n7(s):new o(n7(s))}})};var sm="sign",sy=/* #__PURE__ */nD(sm,["typed","BigNumber","Fraction","complex"],t=>{var{typed:e,BigNumber:r,complex:n,Fraction:i}=t;return e(sm,{number:iA,Complex:function(t){return 0===t.im?n(iA(t.re)):t.sign()},BigNumber:function(t){return new r(t.cmp(0))},bigint:function(t){return t>0n?1n:t<0n?-1n:0n},Fraction:function(t){return new i(t.s)},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t,!0)),Unit:e.referToSelf(t=>r=>{if(!r._isDerived()&&0!==r.units[0].unit.offset)throw TypeError("sign is ambiguous for units with offset");return e.find(t,r.valueType())(r.value)})})}),sv=/* #__PURE__ */nD("sin",["typed"],t=>{var{typed:e}=t,r=aD({typed:e});return e("sin",{number:Math.sin,"Complex | BigNumber":t=>t.sin()},r)}),sx="size",sD=/* #__PURE__ */nD(sx,["typed","config","?matrix"],t=>{var{typed:e,config:r,matrix:n}=t;return e(sx,{Matrix:function(t){return t.create(t.size(),"number")},Array:nZ,string:function(t){return"Array"===r.matrix?[t.length]:n([t.length],"dense","number")},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===r.matrix?[]:n?n([],"dense","number"):o1()}})});function sb(t,e,r,n,i,a,o){var s=0;for(r[o]=t;s>=0;){var u=r[o+s],l=r[n+u];-1===l?(s--,a[e++]=u):(r[n+u]=r[i+l],r[o+ ++s]=l)}return e}var s_=/* #__PURE__ */nD("csAmd",["add","multiply","transpose"],t=>{var{add:e,multiply:r,transpose:n}=t;return function(t,o){if(!o||t<=0||t>3)return null;var s,u,l,h,c,f,d,p,g,m,y,v,x,D,b,_,w=o._size,C=w[0],A=w[1],S=0,F=Math.max(16,10*Math.sqrt(A));F=Math.min(A-2,F);var E=function(t,i,a,o,s){var u=n(i);if(1===t&&o===a)return e(i,u);if(2===t){for(var l=u._index,h=u._ptr,c=0,f=0;f<a;f++){var d=h[f];if(h[f]=c,!(h[f+1]-d>s))for(var p=h[f+1];d<p;d++)l[c++]=l[d]}h[a]=c,i=n(u)}return r(u,i)}(t,o,C,A,F);!function(t,e,r){for(var n=t._values,i=t._index,a=t._ptr,o=t._size[1],s=0,u=0;u<o;u++){var l=a[u];for(a[u]=s;l<a[u+1];l++)e(i[l],u,n?n[l]:1,null)&&(i[s]=i[l],n&&(n[s]=n[l]),s++)}a[o]=s,i.splice(s,i.length-s),n&&n.splice(s,n.length-s)}(E,a,0);for(var M=E._index,N=E._ptr,B=N[A],T=[],k=[],P=A+1,O=2*(A+1),I=3*(A+1),z=4*(A+1),R=5*(A+1),U=6*(A+1),L=7*(A+1),G=function(t,e,r,n,a,o,s,u,l,h,c,f){for(var d=0;d<t;d++)r[0+d]=e[d+1]-e[d];r[0+t]=0;for(var p=0;p<=t;p++)r[a+p]=-1,o[p]=-1,r[s+p]=-1,r[u+p]=-1,r[l+p]=1,r[h+p]=1,r[c+p]=0,r[f+p]=r[n+p];var g=i(0,0,r,h,t);return r[c+t]=-2,e[t]=-1,r[h+t]=0,g}(A,N,k,0,I,T,O,L,P,U,z,R),j=function(t,e,r,n,i,a,o,s,u,l,h){for(var c=0,f=0;f<t;f++){var d=r[n+f];if(0===d)r[i+f]=-2,c++,e[f]=-1,r[a+f]=0;else if(d>o)r[s+f]=0,r[i+f]=-1,c++,e[f]=-t-2,r[s+t]++;else{var p=r[u+d];-1!==p&&(l[p]=f),r[h+f]=r[u+d],r[u+d]=f}}return c}(A,N,k,R,z,U,F,P,I,T,O),q=0;j<A;){for(l=-1;q<A&&-1===(l=k[I+q]);q++);-1!==k[O+l]&&(T[k[O+l]]=-1),k[I+q]=k[O+l];var V=k[z+l],H=k[P+l];j+=H;var W=0;k[P+l]=-H;var K=N[l],Y=0===V?K:B,X=Y;for(h=1;h<=V+1;h++){for(h>V?(f=l,d=K,p=k[0+l]-V):(d=N[f=M[K++]],p=k[0+f]),c=1;c<=p;c++)(g=k[P+(s=M[d++])])<=0||(W+=g,k[P+s]=-g,M[X++]=s,-1!==k[O+s]&&(T[k[O+s]]=T[s]),-1!==T[s]?k[O+T[s]]=k[O+s]:k[I+k[R+s]]=k[O+s]);f!==l&&(N[f]=-l-2,k[U+f]=0)}for(0!==V&&(B=X),k[R+l]=W,N[l]=Y,k[0+l]=X-Y,k[z+l]=-2,G=i(G,S,k,U,A),m=Y;m<X;m++)if(!((y=k[z+(s=M[m])])<=0)){var $=G-(g=-k[P+s]);for(K=N[s],v=N[s]+y-1;K<=v;K++)k[U+(f=M[K])]>=G?k[U+f]-=g:0!==k[U+f]&&(k[U+f]=k[R+f]+$)}for(m=Y;m<X;m++){for(b=0,x=(v=N[s=M[m]])+k[z+s]-1,D=v,_=0,K=v;K<=x;K++)if(0!==k[U+(f=M[K])]){var Z=k[U+f]-G;Z>0?(_+=Z,M[D++]=f,b+=f):(N[f]=-l-2,k[U+f]=0)}k[z+s]=D-v+1;var J=D,Q=v+k[0+s];for(K=x+1;K<Q;K++){var tt=k[P+(u=M[K])];tt<=0||(_+=tt,M[D++]=u,b+=u)}0===_?(N[s]=-l-2,W-=g=-k[P+s],H+=g,j+=g,k[P+s]=0,k[z+s]=-1):(k[R+s]=Math.min(k[R+s],_),M[D]=M[J],M[J]=M[v],M[v]=l,k[0+s]=D-v+1,b=(b<0?-b:b)%A,k[O+s]=k[L+b],k[L+b]=s,T[s]=b)}for(k[R+l]=W,G=i(G+(S=Math.max(S,W)),S,k,U,A),m=Y;m<X;m++)if(!(k[P+(s=M[m])]>=0))for(s=k[L+(b=T[s])],k[L+b]=-1;-1!==s&&-1!==k[O+s];s=k[O+s],G++){for(p=k[0+s],y=k[z+s],K=N[s]+1;K<=N[s]+p-1;K++)k[U+M[K]]=G;var te=s;for(u=k[O+s];-1!==u;){var tr=k[0+u]===p&&k[z+u]===y;for(K=N[u]+1;tr&&K<=N[u]+p-1;K++)k[U+M[K]]!==G&&(tr=0);tr?(N[u]=-s-2,k[P+s]+=k[P+u],k[P+u]=0,k[z+u]=-1,u=k[O+u],k[O+te]=u):(te=u,u=k[O+u])}}for(K=Y,m=Y;m<X;m++)(g=-k[P+(s=M[m])])<=0||(k[P+s]=g,_=Math.min(_=k[R+s]+W-g,A-j-g),-1!==k[I+_]&&(T[k[I+_]]=s),k[O+s]=k[I+_],T[s]=-1,k[I+_]=s,q=Math.min(q,_),k[R+s]=_,M[K++]=s);k[P+l]=H,0==(k[0+l]=K-Y)&&(N[l]=-1,k[U+l]=0),0!==V&&(B=K)}for(s=0;s<A;s++)N[s]=-N[s]-2;for(u=0;u<=A;u++)k[I+u]=-1;for(u=A;u>=0;u--)k[P+u]>0||(k[O+u]=k[I+N[u]],k[I+N[u]]=u);for(f=A;f>=0;f--)k[P+f]<=0||-1===N[f]||(k[O+f]=k[I+N[f]],k[I+N[f]]=f);for(l=0,s=0;s<=A;s++)-1===N[s]&&(l=sb(s,l,k,I,O,T,U));return T.splice(T.length-1,1),T};function i(t,e,r,n,i){if(t<2||t+e<0){for(var a=0;a<i;a++)0!==r[n+a]&&(r[n+a]=1);t=2}return t}function a(t,e){return t!==e}}),sw=/* #__PURE__ */nD("csCounts",["transpose"],t=>{var{transpose:e}=t;return function(t,r,n,i){if(!t||!r||!n)return null;var a,o,s,u,l,h,c,f=t._size,d=f[0],p=f[1],g=4*p+(i?p+d+1:0),m=[],y=2*p,v=3*p,x=4*p,D=5*p+1;for(s=0;s<g;s++)m[s]=-1;var b=[],_=e(t),w=_._index,C=_._ptr;for(s=0;s<p;s++)for(b[o=n[s]]=-1===m[v+o]?1:0;-1!==o&&-1===m[v+o];o=r[o])m[v+o]=s;if(i){for(s=0;s<p;s++)m[n[s]]=s;for(a=0;a<d;a++){for(s=p,h=C[a],c=C[a+1],l=h;l<c;l++)s=Math.min(s,m[w[l]]);m[D+a]=m[x+s],m[x+s]=a}}for(a=0;a<p;a++)m[0+a]=a;for(s=0;s<p;s++){for(-1!==r[o=n[s]]&&b[r[o]]--,u=i?m[x+s]:o;-1!==u;u=i?m[D+u]:-1)for(l=C[u];l<C[u+1];l++){var A=function(t,e,r,n,i,a,o){var s,u,l,h=0;if(t<=e||r[n+e]<=r[i+t])return -1;r[i+t]=r[n+e];var c=r[a+t];if(r[a+t]=e,-1===c)h=1,l=t;else{for(h=2,l=c;l!==r[0+l];l=r[0+l]);for(s=c;s!==l;s=u)u=r[0+s],r[o+s]=l}return{jleaf:h,q:l}}(a=w[l],o,m,v,p,y,0);A.jleaf>=1&&b[o]++,2===A.jleaf&&b[A.q]--}-1!==r[o]&&(m[0+o]=r[o])}for(o=0;o<p;o++)-1!==r[o]&&(b[r[o]]+=b[o]);return b}}),sC=/* #__PURE__ */nD("csSqr",["add","multiply","transpose"],t=>{var{add:e,multiply:r,transpose:n}=t,i=s_({add:e,multiply:r,transpose:n}),a=sw({transpose:n});return function(t,e,r){var n,o=e._ptr,s=e._size[1],u={};if(u.q=i(t,e),t&&!u.q)return null;if(r){var l=t?function(t,e,r,n){t._values;for(var i=t._index,a=t._ptr,o=t._size,s=t._datatype,u=o[0],l=o[1],h=[],c=[],f=0,d=0;d<l;d++){c[d]=f;for(var p=r?r[d]:d,g=a[p],m=a[p+1],y=g;y<m;y++){var v=i[y];h[f]=v,f++}}return c[l]=f,t.createSparseMatrix({values:null,index:h,ptr:c,size:[u,l],datatype:s})}(e,0,u.q,0):e;u.parent=function(t,e){if(!t)return null;var r,n,i=t._index,a=t._ptr,o=t._size,s=o[0],u=o[1],l=[],h=[];for(r=0;r<s;r++)h[u+r]=-1;for(var c=0;c<u;c++){l[c]=-1,h[0+c]=-1;for(var f=a[c],d=a[c+1],p=f;p<d;p++){var g=i[p];for(r=h[u+g];-1!==r&&r<c;r=n)n=h[0+r],h[0+r]=c,-1===n&&(l[r]=c);h[u+g]=c}}return l}(l,1);var h=function(t,e){if(!t)return null;var r,n=0,i=[],a=[],o=2*e;for(r=0;r<e;r++)a[0+r]=-1;for(r=e-1;r>=0;r--)-1!==t[r]&&(a[e+r]=a[0+t[r]],a[0+t[r]]=r);for(r=0;r<e;r++)-1===t[r]&&(n=sb(r,n,a,0,e,i,o));return i}(u.parent,s);if(u.cp=a(l,u.parent,h,1),l&&u.parent&&u.cp&&function(t,e){var r,n,i,a,o,s=t._ptr,u=t._index,l=t._size,h=l[0],c=l[1];e.pinv=[],e.leftmost=[];var f=e.parent,d=e.pinv,p=e.leftmost,g=[],m=h+c,y=h+2*c;for(n=0;n<c;n++)g[h+n]=-1,g[m+n]=-1,g[y+n]=0;for(r=0;r<h;r++)p[r]=-1;for(n=c-1;n>=0;n--)for(a=s[n],o=s[n+1],i=a;i<o;i++)p[u[i]]=n;for(r=h-1;r>=0;r--)d[r]=-1,-1!==(n=p[r])&&(0==g[y+n]++&&(g[m+n]=r),g[0+r]=g[h+n],g[h+n]=r);for(n=0,e.lnz=0,e.m2=h;n<c;n++)if(r=g[h+n],e.lnz++,r<0&&(r=e.m2++),d[r]=n,!(--y[n]<=0)){e.lnz+=g[y+n];var v=f[n];-1!==v&&(0===g[y+v]&&(g[m+v]=g[m+n]),g[0+g[m+n]]=g[h+v],g[h+v]=g[0+r],g[y+v]+=g[y+n])}for(r=0;r<h;r++)d[r]<0&&(d[r]=n++);return!0}(l,u))for(u.unz=0,n=0;n<s;n++)u.unz+=u.cp[n]}else u.unz=4*o[s]+s,u.lnz=u.unz;return u}});function sA(t,e){t[e]=-t[e]-2}function sS(t){return t<0?-t-2:t}var sF=/* #__PURE__ */nD("csSpsolve",["divideScalar","multiply","subtract"],t=>{var{divideScalar:e,multiply:r,subtract:n}=t;return function(t,i,a,o,s,u,l){var h,c,f,d,p=t._values,g=t._index,m=t._ptr,y=t._size[1],v=i._values,x=i._index,D=i._ptr,b=function(t,e,r,n,i){var a,o,s,u=t._ptr,l=t._size,h=e._index,c=e._ptr,f=l[1],d=f;for(o=c[r],s=c[r+1],a=o;a<s;a++){var p=h[a];u[p]<0||(d=function(t,e,r,n,i){var a,o,s,u=e._index,l=e._ptr,h=e._size[1],c=0;for(n[0]=t;c>=0;){t=n[c];var f=i?i[t]:t;l[t]<0||(sA(l,t),n[h+c]=f<0?0:sS(l[f]));var d=1;for(o=n[h+c],s=f<0?0:sS(l[f+1]);o<s;o++)if(!(l[a=u[o]]<0)){n[h+c]=o,n[++c]=a,d=0;break}d&&(c--,n[--r]=t)}return r}(p,t,d,n,i))}for(a=d;a<f;a++)sA(u,n[a]);return d}(t,i,a,o,u);for(h=b;h<y;h++)s[o[h]]=0;for(c=D[a],f=D[a+1],h=c;h<f;h++)s[x[h]]=v[h];for(var _=b;_<y;_++){var w=o[_],C=u?u[w]:w;if(!(C<0))for(c=m[C],f=m[C+1],s[w]=e(s[w],p[l?c:f-1]),h=l?c+1:c,d=l?f:f-1;h<d;h++){var A=g[h];s[A]=n(s[A],r(p[h],s[w]))}}return b}}),sE=/* #__PURE__ */nD("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],t=>{var{abs:e,divideScalar:r,multiply:n,subtract:i,larger:a,largerEq:o,SparseMatrix:s}=t,u=sF({divideScalar:r,multiply:n,subtract:i});return function(t,i,l){if(!t)return null;var h,c,f,d=t._size[1],p=100,g=100;i&&(h=i.q,p=i.lnz||p,g=i.unz||g);var m=[],y=[],v=[],x=new s({values:m,index:y,ptr:v,size:[d,d]}),D=[],b=[],_=[],w=new s({values:D,index:b,ptr:_,size:[d,d]}),C=[],A=[],S=[];for(c=0;c<d;c++)A[c]=0,C[c]=-1,v[c+1]=0;p=0,g=0;for(var F=0;F<d;F++){v[F]=p,_[F]=g;var E=h?h[F]:F,M=u(x,t,E,S,A,C,1),N=-1,B=-1;for(f=M;f<d;f++)if(C[c=S[f]]<0){var T=e(A[c]);a(T,B)&&(B=T,N=c)}else b[g]=C[c],D[g++]=A[c];if(-1===N||B<=0)return null;C[E]<0&&o(e(A[E]),n(B,l))&&(N=E);var k=A[N];for(b[g]=F,D[g++]=k,C[N]=F,y[p]=N,m[p++]=1,f=M;f<d;f++)C[c=S[f]]<0&&(y[p]=c,m[p++]=r(A[c],k)),A[c]=0}for(f=0,v[d]=p,_[d]=g;f<p;f++)y[f]=C[y[f]];return m.splice(p,m.length-p),y.splice(p,y.length-p),D.splice(g,D.length-g),b.splice(g,b.length-g),{L:x,U:w,pinv:C}}}),sM=/* #__PURE__ */nD("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],t=>{var{typed:e,abs:r,add:n,multiply:i,transpose:a,divideScalar:o,subtract:s,larger:u,largerEq:l,SparseMatrix:h}=t,c=sC({add:n,multiply:i,transpose:a}),f=sE({abs:r,divideScalar:o,multiply:i,subtract:s,larger:u,largerEq:l,SparseMatrix:h});return e("slu",{"SparseMatrix, number, number":function(t,e,r){if(!nw(e)||e<0||e>3)throw Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(r<0||r>1)throw Error("Partial pivoting threshold must be a number from 0 to 1");var n=c(e,t,!1),i=f(t,n,r);return{L:i.L,U:i.U,p:i.pinv,q:n.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})}),sN="smaller",sB=/* #__PURE__ */nD(sN,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=iY({typed:e}),u=i3({typed:e,SparseMatrix:o}),l=iX({typed:e,DenseMatrix:i}),h=iz({typed:e,matrix:n,concat:a}),c=ao({typed:e});return e(sN,sT({typed:e,config:r}),{"boolean, boolean":(t,e)=>t<e,"BigNumber, BigNumber":function(t,e){return t.lt(e)&&!i4(t,e,r.relTol,r.absTol)},"bigint, bigint":(t,e)=>t<e,"Fraction, Fraction":(t,e)=>-1===t.compare(e),"Complex, Complex":function(t,e){throw TypeError("No ordering relation is defined for complex numbers")}},c,h({SS:u,DS:s,Ss:l}))}),sT=/* #__PURE__ */nD(sN,["typed","config"],t=>{var{typed:e,config:r}=t;return e(sN,{"number, number":function(t,e){return t<e&&!nz(t,e,r.relTol,r.absTol)}})}),sk="smallerEq",sP=/* #__PURE__ */nD(sk,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=iY({typed:e}),u=i3({typed:e,SparseMatrix:o}),l=iX({typed:e,DenseMatrix:i}),h=iz({typed:e,matrix:n,concat:a}),c=ao({typed:e});return e(sk,sO({typed:e,config:r}),{"boolean, boolean":(t,e)=>t<=e,"BigNumber, BigNumber":function(t,e){return t.lte(e)||i4(t,e,r.relTol,r.absTol)},"bigint, bigint":(t,e)=>t<=e,"Fraction, Fraction":(t,e)=>1!==t.compare(e),"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},c,h({SS:u,DS:s,Ss:l}))}),sO=/* #__PURE__ */nD(sk,["typed","config"],t=>{var{typed:e,config:r}=t;return e(sk,{"number, number":function(t,e){return t<=e||nz(t,e,r.relTol,r.absTol)}})}),sI={},sz={},sR={};function sU(t){return(sR=sU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}).__esModule=!0,sR.default=sR,sU(t)}(sR=sU).__esModule=!0,sR.default=sR;var sL=sR.default,sG={},sj=sR.default;(sG=function(t,e){if("object"!=sj(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=sj(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}).__esModule=!0,sG.default=sG,(sz=function(t){var e=sG(t,"string");return"symbol"==sL(e)?e:e+""}).__esModule=!0,sz.default=sz,(sI=function(t,e,r){return(e=sz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}).__esModule=!0,sI.default=sI;var sq=/* #__PURE__ */nD("Spa",["addScalar","equalScalar","FibonacciHeap"],t=>{var{addScalar:e,equalScalar:r,FibonacciHeap:n}=t;function i(){if(!(this instanceof i))throw SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new n}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(t,e){if(this._values[t])this._values[t].value=e;else{var r=this._heap.insert(t,e);this._values[t]=r}},i.prototype.get=function(t){var e=this._values[t];return e?e.value:0},i.prototype.accumulate=function(t,r){var n=this._values[t];n?n.value=e(n.value,r):(n=this._heap.insert(t,r),this._values[t]=n)},i.prototype.forEach=function(t,e,n){var i=this._heap,a=this._values,o=[],s=i.extractMinimum();for(s&&o.push(s);s&&s.key<=e;)s.key>=t&&!r(s.value,0)&&n(s.key,s.value,this),(s=i.extractMinimum())&&o.push(s);for(var u=0;u<o.length;u++){var l=o[u];a[(s=i.insert(l.key,l.value)).key]=s}},i.prototype.swap=function(t,e){var r=this._values[t],n=this._values[e];if(!r&&n)r=this._heap.insert(t,n.value),this._heap.remove(n),this._values[t]=r,this._values[e]=void 0;else if(r&&!n)n=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=n,this._values[t]=void 0;else if(r&&n){var i=r.value;r.value=n.value,n.value=i}},i},{isClass:!0}),sV=/* #__PURE__ */nD("SparseMatrix",["typed","equalScalar","Matrix"],t=>{var{typed:e,equalScalar:r,Matrix:n}=t;function i(t,e){if(!(this instanceof i))throw SyntaxError("Constructor must be called with the new operator");if(e&&!rq(e))throw Error("Invalid datatype: "+e);if(rH(t))"SparseMatrix"===t.type?(this._values=t._values?ng(t._values):void 0,this._index=ng(t._index),this._ptr=ng(t._ptr),this._size=ng(t._size),this._datatype=e||t._datatype):a(this,t.valueOf(),e||t._datatype);else if(t&&rV(t.index)&&rV(t.ptr)&&rV(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(rV(t))a(this,t,e);else if(t)throw TypeError("Unsupported type of data ("+np(t)+")");else this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}function a(t,n,i){t._values=[],t._index=[],t._ptr=[],t._datatype=i;var a=n.length,o=0,s=r,u=0;if(rq(i)&&(s=e.find(r,[i,i])||r,u=e.convert(0,i)),a>0){var l=0;do{t._ptr.push(t._index.length);for(var h=0;h<a;h++){var c=n[h];if(rV(c)){if(0===l&&o<c.length&&(o=c.length),l<c.length){var f=c[l];s(f,u)||(t._values.push(f),t._index.push(h))}}else 0===l&&o<1&&(o=1),s(c,u)||(t._values.push(c),t._index.push(h))}l++}while(l<o)}t._ptr.push(t._index.length),t._size=[a,o]}function o(t,e,r,n){if(r-e==0)return r;for(var i=e;i<r;i++)if(n[i]===t)return i;return e}function s(t,e,r,n,i,a,o){i.splice(t,0,n),a.splice(t,0,e);for(var s=r+1;s<o.length;s++)o[s]++}function u(t,n,i,a){var o,s,u,l=a||0,h=r,c=0;rq(t._datatype)&&(h=e.find(r,[t._datatype,t._datatype])||r,c=e.convert(0,t._datatype),l=e.convert(l,t._datatype));var f=!h(l,c),d=t._size[0],p=t._size[1];if(i>p){for(s=p;s<i;s++)if(t._ptr[s]=t._values.length,f)for(o=0;o<d;o++)t._values.push(l),t._index.push(o);t._ptr[i]=t._values.length}else i<p&&(t._ptr.splice(i+1,p-i),t._values.splice(t._ptr[i],t._values.length),t._index.splice(t._ptr[i],t._index.length));if(p=i,n>d){if(f){var g=0;for(s=0;s<p;s++){t._ptr[s]=t._ptr[s]+g,u=t._ptr[s+1]+g;var m=0;for(o=d;o<n;o++,m++)t._values.splice(u+m,0,l),t._index.splice(u+m,0,o),g++}t._ptr[p]=t._values.length}}else if(n<d){var y=0;for(s=0;s<p;s++){t._ptr[s]=t._ptr[s]-y;var v=t._ptr[s],x=t._ptr[s+1]-y;for(u=v;u<x;u++)(o=t._index[u])>n-1&&(t._values.splice(u,1),t._index.splice(u,1),y++)}t._ptr[s]=t._values.length}return t._size[0]=n,t._size[1]=i,t}function l(t,e,r,n,i){var a,o,s=n[0],u=n[1],l=[];for(a=0;a<s;a++)for(o=0,l[a]=[];o<u;o++)l[a][o]=0;for(o=0;o<u;o++)for(var h=r[o],c=r[o+1],f=h;f<c;f++)l[a=e[f]][o]=t?i?ng(t[f]):t[f]:1;return l}return i.prototype=new n,i.prototype.createSparseMatrix=function(t,e){return new i(t,e)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return it(this._values,np)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(t,e){return new i(t,e)},i.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},i.prototype.subset=function(t,e,r){if(!this._values)throw Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(t,e){if(!r$(e))throw TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var r,n,a,o,s=e.size();if(s.length!==t._size.length)throw new n$(s.length,t._size.length);var u=e.min(),l=e.max();for(r=0,n=t._size.length;r<n;r++)n0(u[r],t._size[r]),n0(l[r],t._size[r]);var h=t._values,c=t._index,f=t._ptr,d=e.dimension(0),p=e.dimension(1),g=[],m=[];d.forEach(function(t,e){m[t]=e[0],g[t]=!0});var y=h?[]:void 0,v=[],x=[];return p.forEach(function(t){for(x.push(v.length),a=f[t],o=f[t+1];a<o;a++)!0===g[r=c[a]]&&(v.push(m[r]),y&&y.push(h[a]))}),x.push(v.length),new i({values:y,index:v,ptr:x,size:s,datatype:t._datatype})}(this,t);case 2:case 3:return function(t,e,r,n){if(!e||!0!==e.isIndex)throw TypeError("Invalid index");var i,a=e.size(),o=e.isScalar();if(rH(r)?(i=r.size(),r=r.toArray()):i=nZ(r),o){if(0!==i.length)throw TypeError("Scalar expected");t.set(e.min(),r,n)}else{if(1!==a.length&&2!==a.length)throw new n$(a.length,t._size.length,"<");if(i.length<a.length){for(var s=0,u=0;1===a[s]&&1===i[s];)s++;for(;1===a[s];)u++,s++;r=n8(r,a.length,u,i)}if(!ny(a,i))throw new n$(a,i,">");if(1===a.length)e.dimension(0).forEach(function(e,i){n0(e),t.set([e,0],r[i[0]],n)});else{var l=e.dimension(0),h=e.dimension(1);l.forEach(function(e,i){n0(e),h.forEach(function(a,o){n0(a),t.set([e,a],r[i[0]][o[0]],n)})})}}return t}(this,t,e,r);default:throw SyntaxError("Wrong number of arguments")}},i.prototype.get=function(t){if(!rV(t))throw TypeError("Array expected");if(t.length!==this._size.length)throw new n$(t.length,this._size.length);if(!this._values)throw Error("Cannot invoke get on a Pattern only matrix");var e=t[0],r=t[1];n0(e,this._size[0]),n0(r,this._size[1]);var n=o(e,this._ptr[r],this._ptr[r+1],this._index);return n<this._ptr[r+1]&&this._index[n]===e?this._values[n]:0},i.prototype.set=function(t,n,i){if(!rV(t))throw TypeError("Array expected");if(t.length!==this._size.length)throw new n$(t.length,this._size.length);if(!this._values)throw Error("Cannot invoke set on a Pattern only matrix");var a=t[0],l=t[1],h=this._size[0],c=this._size[1],f=r,d=0;rq(this._datatype)&&(f=e.find(r,[this._datatype,this._datatype])||r,d=e.convert(0,this._datatype)),(a>h-1||l>c-1)&&(u(this,Math.max(a+1,h),Math.max(l+1,c),i),h=this._size[0],c=this._size[1]),n0(a,h),n0(l,c);var p=o(a,this._ptr[l],this._ptr[l+1],this._index);return p<this._ptr[l+1]&&this._index[p]===a?f(n,d)?function(t,e,r,n,i){r.splice(t,1),n.splice(t,1);for(var a=e+1;a<i.length;a++)i[a]--}(p,l,this._values,this._index,this._ptr):this._values[p]=n:f(n,d)||s(p,a,l,n,this._values,this._index,this._ptr),this},i.prototype.resize=function(t,e,r){if(!rW(t))throw TypeError("Array or Matrix expected");var n=t.valueOf().map(t=>Array.isArray(t)&&1===t.length?t[0]:t);if(2!==n.length)throw Error("Only two dimensions matrix are supported");return n.forEach(function(t){if(!rz(t)||!nw(t)||t<0)throw TypeError("Invalid size, must contain positive integers (size: "+nW(n)+")")}),u(r?this.clone():this,n[0],n[1],e)},i.prototype.reshape=function(t,e){if(!rV(t))throw TypeError("Array expected");if(2!==t.length)throw Error("Sparse matrices can only be reshaped in two dimensions");t.forEach(function(e){if(!rz(e)||!nw(e)||e<=-2||0===e)throw TypeError("Invalid size, must contain positive integers or -1 (size: "+nW(t)+")")});var r=this._size[0]*this._size[1],n=(t=n3(t,r))[0]*t[1];if(r!==n)throw Error("Reshaping sparse matrix will result in the wrong number of elements");var i=e?this.clone():this;if(this._size[0]===t[0]&&this._size[1]===t[1])return i;for(var a=[],u=0;u<i._ptr.length;u++)for(var l=0;l<i._ptr[u+1]-i._ptr[u];l++)a.push(u);for(var h=i._values.slice(),c=i._index.slice(),f=0;f<i._index.length;f++){var d=c[f],p=a[f],g=d*i._size[1]+p;a[f]=g%t[1],c[f]=Math.floor(g/t[1])}i._values.length=0,i._index.length=0,i._ptr.length=t[1]+1,i._size=t.slice();for(var m=0;m<i._ptr.length;m++)i._ptr[m]=0;for(var y=0;y<h.length;y++){var v=c[y],x=a[y],D=h[y];s(o(v,i._ptr[x],i._ptr[x+1],i._index),v,x,D,i._values,i._index,i._ptr)}return i},i.prototype.clone=function(){return new i({values:this._values?ng(this._values):void 0,index:ng(this._index),ptr:ng(this._ptr),size:ng(this._size),datatype:this._datatype})},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(t,n){if(!this._values)throw Error("Cannot invoke map on a Pattern only matrix");var a=this,o=this._size[0],s=this._size[1],u=aS(t,a,"map");return function(t,n,a,o,s,u,l){var h=[],c=[],f=[],d=r,p=0;rq(t._datatype)&&(d=e.find(r,[t._datatype,t._datatype])||r,p=e.convert(0,t._datatype));for(var g=function(t,e,r){var n=u(t,e,r);d(n,p)||(h.push(n),c.push(e))},m=0;m<=s;m++){f.push(h.length);var y=t._ptr[m],v=t._ptr[m+1];if(l)for(var x=y;x<v;x++){var D=t._index[x];D>=0&&D<=a&&g(t._values[x],D-0,m-0)}else{for(var b={},_=y;_<v;_++)b[t._index[_]]=t._values[_];for(var w=n;w<=a;w++)g(w in b?b[w]:0,w-n,m-o)}}return f.push(h.length),new i({values:h,index:c,ptr:f,size:[a-n+1,s-o+1]})}(this,0,o-1,0,s-1,function(t,e,r){return u(t,[e,r],a)},n)},i.prototype.forEach=function(t,e){if(!this._values)throw Error("Cannot invoke forEach on a Pattern only matrix");for(var r=this._size[0],n=this._size[1],i=aS(t,this,"forEach"),a=0;a<n;a++){var o=this._ptr[a],s=this._ptr[a+1];if(e)for(var u=o;u<s;u++){var l=this._index[u];i(this._values[u],[l,a],this)}else{for(var h={},c=o;c<s;c++)h[this._index[c]]=this._values[c];for(var f=0;f<r;f++)i(f in h?h[f]:0,[f,a],this)}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw Error("Cannot iterate a Pattern only matrix");for(var t=this._size[1],e=0;e<t;e++)for(var r=this._ptr[e],n=this._ptr[e+1],i=r;i<n;i++){var a=this._index[i];yield{value:this._values[i],index:[a,e]}}},i.prototype.toArray=function(){return l(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return l(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(t){for(var e=this._size[0],r=this._size[1],n=this.density(),i="Sparse Matrix ["+nW(e,t)+" x "+nW(r,t)+"] density: "+nW(n,t)+"\n",a=0;a<r;a++)for(var o=this._ptr[a],s=this._ptr[a+1],u=o;u<s;u++)i+="\n    ("+nW(this._index[u],t)+", "+nW(a,t)+") ==> "+(this._values?nW(this._values[u],t):"X");return i},i.prototype.toString=function(){return nW(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(t){if(t){if(rR(t)&&(t=t.toNumber()),!rz(t)||!nw(t))throw TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,r=t<0?-t:0,n=this._size[0],a=this._size[1],o=Math.min(n-r,a-e),s=[],u=[],l=[];l[0]=0;for(var h=e;h<a&&s.length<o;h++)for(var c=this._ptr[h],f=this._ptr[h+1],d=c;d<f;d++){var p=this._index[d];if(p===h-e+r){s.push(this._values[d]),u[s.length-1]=p-r;break}}return l.push(s.length),new i({values:s,index:u,ptr:l,size:[o,1]})},i.fromJSON=function(t){return new i(t)},i.diagonal=function(t,n,a,o,s){if(!rV(t))throw TypeError("Array expected, size parameter");if(2!==t.length)throw Error("Only two dimensions matrix are supported");if(t=t.map(function(t){if(rR(t)&&(t=t.toNumber()),!rz(t)||!nw(t)||t<1)throw Error("Size values must be positive integers");return t}),a){if(rR(a)&&(a=a.toNumber()),!rz(a)||!nw(a))throw TypeError("The parameter k must be an integer number")}else a=0;var u,l=r,h=0;rq(s)&&(l=e.find(r,[s,s])||r,h=e.convert(0,s));var c=a>0?a:0,f=a<0?-a:0,d=t[0],p=t[1],g=Math.min(d-f,p-c);if(rV(n)){if(n.length!==g)throw Error("Invalid value array length");u=function(t){return n[t]}}else if(rH(n)){var m=n.size();if(1!==m.length||m[0]!==g)throw Error("Invalid matrix length");u=function(t){return n.get([t])}}else u=function(){return n};for(var y=[],v=[],x=[],D=0;D<p;D++){x.push(y.length);var b=D-c;if(b>=0&&b<g){var _=u(b);l(_,h)||(v.push(b+f),y.push(_))}}return x.push(y.length),new i({values:y,index:v,ptr:x,size:[d,p]})},i.prototype.swapRows=function(t,e){if(!rz(t)||!nw(t)||!rz(e)||!nw(e))throw Error("Row index must be positive integers");if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");return n0(t,this._size[0]),n0(e,this._size[0]),i._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(t,e,r,n,i){for(var a=n[t],o=n[t+1],s=a;s<o;s++)i(r[s],e[s])},i._swapRows=function(t,e,r,n,i,a){for(var s=0;s<r;s++){var u=a[s],l=a[s+1],h=o(t,u,l,i),c=o(e,u,l,i);if(h<l&&c<l&&i[h]===t&&i[c]===e){if(n){var f=n[h];n[h]=n[c],n[c]=f}continue}if(h<l&&i[h]===t&&(c>=l||i[c]!==e)){var d=n?n[h]:void 0;i.splice(c,0,e),n&&n.splice(c,0,d),i.splice(c<=h?h+1:h,1),n&&n.splice(c<=h?h+1:h,1);continue}if(c<l&&i[c]===e&&(h>=l||i[h]!==t)){var p=n?n[c]:void 0;i.splice(h,0,t),n&&n.splice(h,0,p),i.splice(h<=c?c+1:c,1),n&&n.splice(h<=c?c+1:c,1)}}},i},{isClass:!0}),sH=/* #__PURE__ */nD("sqrt",["config","typed","Complex"],t=>{var{config:e,typed:r,Complex:n}=t;return r("sqrt",{number:i,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():i(t.toNumber())},Unit:function(t){return t.pow(.5)}});function i(t){return isNaN(t)?NaN:t>=0||e.predictable?Math.sqrt(t):new n(t,0).sqrt()}}),sW="subset",sK=/* #__PURE__ */nD(sW,["typed","matrix","zeros","add"],t=>{var{typed:e,matrix:r,zeros:n,add:i}=t;return e(sW,{"Matrix, Index":function(t,e){return n1(e)?r():(nQ(t,e),t.subset(e))},"Array, Index":e.referTo("Matrix, Index",function(t){return function(e,n){var i=t(r(e),n);return n.isScalar()?i:i.valueOf()}}),"Object, Index":s$,"string, Index":sY,"Matrix, Index, any, any":function(t,e,r,a){return n1(e)?t:(nQ(t,e),t.clone().subset(e,function(t,e){if("string"==typeof t)throw Error("can't boradcast a string");if(e._isScalar)return t;var r=e.size();if(!r.every(t=>t>0))return t;try{return i(t,n(r))}catch(e){return t}}(r,e),a))},"Array, Index, any, any":e.referTo("Matrix, Index, any, any",function(t){return function(e,n,i,a){var o=t(r(e),n,i,a);return o.isMatrix?o.valueOf():o}}),"Array, Index, any":e.referTo("Matrix, Index, any, any",function(t){return function(e,n,i){return t(r(e),n,i,void 0).valueOf()}}),"Matrix, Index, any":e.referTo("Matrix, Index, any, any",function(t){return function(e,r,n){return t(e,r,n,void 0)}}),"string, Index, string":sX,"string, Index, string, string":sX,"Object, Index, any":sZ})});function sY(t,e){if(!r$(e))throw TypeError("Index expected");if(n1(e))return"";if(nQ(Array.from(t),e),1!==e.size().length)throw new n$(e.size().length,1);var r=t.length;n0(e.min()[0],r),n0(e.max()[0],r);var n=e.dimension(0),i="";return n.forEach(function(e){i+=t.charAt(e)}),i}function sX(t,e,r,n){if(!e||!0!==e.isIndex)throw TypeError("Index expected");if(n1(e))return t;if(nQ(Array.from(t),e),1!==e.size().length)throw new n$(e.size().length,1);if(void 0!==n){if("string"!=typeof n||1!==n.length)throw TypeError("Single character expected as defaultValue")}else n=" ";var i=e.dimension(0);if(i.size()[0]!==r.length)throw new n$(i.size()[0],r.length);var a=t.length;n0(e.min()[0]),n0(e.max()[0]);for(var o=[],s=0;s<a;s++)o[s]=t.charAt(s);if(i.forEach(function(t,e){o[t]=r.charAt(e[0])}),o.length>a)for(var u=a-1,l=o.length;u<l;u++)o[u]||(o[u]=n);return o.join("")}function s$(t,e){if(!n1(e)){if(1!==e.size().length)throw new n$(e.size(),1);var r=e.dimension(0);if("string"!=typeof r)throw TypeError("String expected as index to retrieve an object property");return rB(t,r)}}function sZ(t,e,r){if(n1(e))return t;if(1!==e.size().length)throw new n$(e.size(),1);var n=e.dimension(0);if("string"!=typeof n)throw TypeError("String expected as index to retrieve an object property");var i=ng(t);return rT(i,n,r),i}var sJ="subtract",sQ=/* #__PURE__ */nD(sJ,["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],t=>{var{typed:e,matrix:r,equalScalar:n,subtractScalar:i,unaryMinus:a,DenseMatrix:o,concat:s}=t,u=iB({typed:e}),l=iY({typed:e}),h=aa({typed:e,equalScalar:n}),c=ik({typed:e,DenseMatrix:o}),f=iX({typed:e,DenseMatrix:o}),d=iz({typed:e,matrix:r,concat:s});return e(sJ,{"any, any":i},d({elop:i,SS:h,DS:u,SD:l,Ss:f,sS:c}))}),s0="subtractScalar",s1=/* #__PURE__ */nD(s0,["typed"],t=>{var{typed:e}=t;return e(s0,{"number, number":ix,"Complex, Complex":function(t,e){return t.sub(e)},"BigNumber, BigNumber":function(t,e){return t.minus(e)},"bigint, bigint":function(t,e){return t-e},"Fraction, Fraction":function(t,e){return t.sub(e)},"Unit, Unit":e.referToSelf(t=>(r,n)=>{if(null===r.value||void 0===r.value)throw Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw Error("Units do not match");var i=r.clone();return i.value=e.find(t,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i})})}),s2=(t=>{var{typed:e,config:r,add:n,numeric:i}=t;return e("sum",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(t,e){try{return ic(t,e,n)}catch(t){throw aC(t,"sum")}},"...":function(t){if(iu(t))throw TypeError("Scalar values expected in function sum");return a(t)}});function a(t){var e;return il(t,function(t){try{e=void 0===e?t:n(e,t)}catch(e){throw aC(e,"sum",t)}}),void 0===e&&(e=i(0,r.number)),"string"==typeof e&&(e=i(e,nC(e,r))),e}},"sylvester"),s5="transpose",s3=/* #__PURE__ */nD(s5,["typed","matrix"],t=>{var{typed:e,matrix:r}=t;return e(s5,{Array:t=>n(r(t)).valueOf(),Matrix:n,any:ng});function n(t){var e,r=t.size();switch(r.length){case 1:e=t.clone();break;case 2:var n=r[0],i=r[1];if(0===i)throw RangeError("Cannot transpose a 2D matrix with no columns (size: "+nW(r)+")");switch(t.storage()){case"dense":e=function(t,e,r){for(var n,i=t._data,a=[],o=0;o<r;o++){n=a[o]=[];for(var s=0;s<e;s++)n[s]=ng(i[s][o])}return t.createDenseMatrix({data:a,size:[r,e],datatype:t._datatype})}(t,n,i);break;case"sparse":e=function(t,e,r){for(var n,i,a,o=t._values,s=t._index,u=t._ptr,l=o?[]:void 0,h=[],c=[],f=[],d=0;d<e;d++)f[d]=0;for(n=0,i=s.length;n<i;n++)f[s[n]]++;for(var p=0,g=0;g<e;g++)c.push(p),p+=f[g],f[g]=c[g];for(c.push(p),a=0;a<r;a++)for(var m=u[a],y=u[a+1],v=m;v<y;v++){var x=f[s[v]]++;h[x]=a,o&&(l[x]=ng(o[v]))}return t.createSparseMatrix({values:l,index:h,ptr:c,size:[r,e],datatype:t._datatype})}(t,n,i)}break;default:throw RangeError("Matrix must be a vector or two dimensional (size: "+nW(r)+")")}return e}}),s4=function(){return s4=/*@__PURE__*/i(aA).create,/*@__PURE__*/i(aA)},s8=/* #__PURE__ */nD("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],function(t){var{BigNumber:e,Complex:r,DenseMatrix:n,Fraction:i}=t,a=s4();return a.clear(),a.addTypes([{name:"number",test:rz},{name:"Complex",test:rL},{name:"BigNumber",test:rR},{name:"bigint",test:rU},{name:"Fraction",test:rG},{name:"Unit",test:rj},{name:"identifier",test:t=>rq&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(t)},{name:"string",test:rq},{name:"Chain",test:nd},{name:"Array",test:rV},{name:"Matrix",test:rH},{name:"DenseMatrix",test:rK},{name:"SparseMatrix",test:rY},{name:"Range",test:rX},{name:"Index",test:r$},{name:"boolean",test:rZ},{name:"ResultSet",test:rJ},{name:"Help",test:rQ},{name:"function",test:r0},{name:"Date",test:r1},{name:"RegExp",test:r2},{name:"null",test:r4},{name:"undefined",test:r8},{name:"AccessorNode",test:r6},{name:"ArrayNode",test:r9},{name:"AssignmentNode",test:r7},{name:"BlockNode",test:nt},{name:"ConditionalNode",test:ne},{name:"ConstantNode",test:nr},{name:"FunctionNode",test:ni},{name:"FunctionAssignmentNode",test:nn},{name:"IndexNode",test:na},{name:"Node",test:no},{name:"ObjectNode",test:ns},{name:"OperatorNode",test:nu},{name:"ParenthesisNode",test:nl},{name:"RangeNode",test:nh},{name:"RelationalNode",test:nc},{name:"SymbolNode",test:nf},{name:"Map",test:r3},{name:"Object",test:r5}]),a.addConversions([{from:"number",to:"BigNumber",convert:function(t){if(e||s6(t),t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e(t)}},{from:"number",to:"Complex",convert:function(t){return r||s9(t),new r(t,0)}},{from:"BigNumber",to:"Complex",convert:function(t){return r||s9(t),new r(t.toNumber(),0)}},{from:"bigint",to:"number",convert:function(t){if(t>Number.MAX_SAFE_INTEGER)throw TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+t+")");return Number(t)}},{from:"bigint",to:"BigNumber",convert:function(t){return e||s6(t),new e(t.toString())}},{from:"bigint",to:"Fraction",convert:function(t){return i||s7(t),new i(t)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return r||s9(t),new r(t.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(t){i||s7(t);var e=new i(t);if(e.valueOf()!==t)throw TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw Error('Cannot convert "'+t+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(t){e||s6(t);try{return new e(t)}catch(e){throw Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(t){try{return BigInt(t)}catch(e){throw Error('Cannot convert "'+t+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(t){i||s7(t);try{return new i(t)}catch(e){throw Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){r||s9(t);try{return new r(t)}catch(e){throw Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(t){return e||s6(t),new e(+t)}},{from:"boolean",to:"bigint",convert:function(t){return BigInt(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return i||s7(t),new i(+t)}},{from:"boolean",to:"string",convert:function(t){return String(t)}},{from:"Array",to:"Matrix",convert:function(t){return n||function(){throw Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new n(t)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}]),a.onMismatch=(t,e,r)=>{var n=a.createError(t,e,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&rW(e[0])&&r.some(t=>!t.params.includes(","))){var i=TypeError("Function '".concat(t,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(t,")'."));throw i.data=n.data,i}throw n},a.onMismatch=(t,e,r)=>{var n=a.createError(t,e,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&rW(e[0])&&r.some(t=>!t.params.includes(","))){var i=TypeError("Function '".concat(t,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(t,")'."));throw i.data=n.data,i}throw n},a});function s6(t){throw Error("Cannot convert value ".concat(t," into a BigNumber: no class 'BigNumber' provided"))}function s9(t){throw Error("Cannot convert value ".concat(t," into a Complex number: no class 'Complex' provided"))}function s7(t){throw Error("Cannot convert value ".concat(t," into a Fraction, no class 'Fraction' provided."))}var ut="typeOf",ue=(t=>{var{typed:e}=t;return e(ut,{any:np})},"unaryMinus"),ur=/* #__PURE__ */nD(ue,["typed"],t=>{var{typed:e}=t;return e(ue,{number:ib,"Complex | BigNumber | Fraction":t=>t.neg(),bigint:t=>-t,Unit:e.referToSelf(t=>r=>{var n=r.clone();return n.value=e.find(t,n.valueType())(r.value),n}),"Array | Matrix":e.referToSelf(t=>e=>ih(e,t,!0))})}),un=(t=>{var{typed:e,config:r,numeric:n}=t;return e("unaryPlus",{number:i_,Complex:function(t){return t},BigNumber:function(t){return t},bigint:function(t){return t},Fraction:function(t){return t},Unit:function(t){return t.clone()},"Array | Matrix":e.referToSelf(t=>e=>ih(e,t,!0)),boolean:function(t){return n(t?1:0,r.number)},string:function(t){return n(t,nC(t,r))}})},"unequal");function ui(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function ua(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ui(Object(r),!0).forEach(function(e){/*@__PURE__*/i(sI)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ui(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}nD(un,["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return e(un,{"any, any":function(t,e){return null===t?null!==e:null===e?null!==t:void 0===t?void 0!==e:void 0===e?void 0!==t:!r(t,e)}})});var uo="usolve",us=/* #__PURE__ */nD(uo,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=t,u=oP({DenseMatrix:s});return e(uo,{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var r=(e=u(t,e,!0))._data,l=t._size[0],h=t._size[1],c=t._values,f=t._index,d=t._ptr,p=[],g=h-1;g>=0;g--){var m=r[g][0]||0;if(o(m,0))p[g]=[0];else{for(var y=0,v=[],x=[],D=d[g],b=d[g+1],_=b-1;_>=D;_--){var w=f[_];w===g?y=c[_]:w<g&&(v.push(c[_]),x.push(w))}if(o(y,0))throw Error("Linear system cannot be solved since matrix is singular");for(var C=n(m,y),A=0,S=x.length;A<S;A++){var F=x[A];r[F]=[a(r[F][0],i(C,v[A]))]}p[g]=[C]}}return new s({data:p,size:[l,1]})}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return l(t,e)},"Array, Array | Matrix":function(t,e){return l(r(t),e).valueOf()}});function l(t,e){for(var r=(e=u(t,e,!0))._data,l=t._size[0],h=t._size[1],c=[],f=t._data,d=h-1;d>=0;d--){var p=r[d][0]||0,g=void 0;if(o(p,0))g=0;else{var m=f[d][d];if(o(m,0))throw Error("Linear system cannot be solved since matrix is singular");g=n(p,m);for(var y=d-1;y>=0;y--)r[y]=[a(r[y][0]||0,i(g,f[y][d]))]}c[d]=[g]}return new s({data:c,size:[l,1]})}}),uu="usolveAll",ul=/* #__PURE__ */nD(uu,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=t,u=oP({DenseMatrix:s});return e(uu,{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var r=[u(t,e,!0)._data.map(t=>t[0])],l=t._size[0],h=t._size[1],c=t._values,f=t._index,d=t._ptr,p=h-1;p>=0;p--)for(var g=r.length,m=0;m<g;m++){for(var y=r[m],v=[],x=[],D=d[p],b=d[p+1],_=0,w=b-1;w>=D;w--){var C=f[w];C===p?_=c[w]:C<p&&(v.push(c[w]),x.push(C))}if(o(_,0)){if(o(y[p],0)){if(0===m){var A=[...y];A[p]=1;for(var S=0,F=x.length;S<F;S++){var E=x[S];A[E]=a(A[E],v[S])}r.push(A)}}else{if(0===m)return[];r.splice(m,1),m-=1,g-=1}}else{y[p]=n(y[p],_);for(var M=0,N=x.length;M<N;M++){var B=x[M];y[B]=a(y[B],i(y[p],v[M]))}}}return r.map(t=>new s({data:t.map(t=>[t]),size:[l,1]}))}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return l(t,e)},"Array, Array | Matrix":function(t,e){return l(r(t),e).map(t=>t.valueOf())}});function l(t,e){for(var r=[u(t,e,!0)._data.map(t=>t[0])],l=t._data,h=t._size[0],c=t._size[1],f=c-1;f>=0;f--)for(var d=r.length,p=0;p<d;p++){var g=r[p];if(o(l[f][f],0)){if(o(g[f],0)){if(0===p){var m=[...g];m[f]=1;for(var y=f-1;y>=0;y--)m[y]=a(m[y],l[y][f]);r.push(m)}}else{if(0===p)return[];r.splice(p,1),p-=1,d-=1}}else{g[f]=n(g[f],l[f][f]);for(var v=f-1;v>=0;v--)g[v]=a(g[v],i(g[f],l[v][f]))}}return r.map(t=>new s({data:t.map(t=>[t]),size:[h,1]}))}}),uh="unbiased",uc=(t=>{var{typed:e,add:r,subtract:n,multiply:i,divide:a,apply:o,isNaN:s}=t;return e("variance",{"Array | Matrix":function(t){return u(t,uh)},"Array | Matrix, string":u,"Array | Matrix, number | BigNumber":function(t,e){return l(t,e,uh)},"Array | Matrix, number | BigNumber, string":l,"...":function(t){return u(t,uh)}});function u(t,e){var o,u=0;if(0===t.length)throw SyntaxError("Function variance requires one or more parameters (0 provided)");if(il(t,function(t){try{o=void 0===o?t:r(o,t),u++}catch(e){throw aC(e,"variance",t)}}),0===u)throw Error("Cannot calculate variance of an empty array");var l=a(o,u);if(o=void 0,il(t,function(t){var e=n(t,l);o=void 0===o?i(e,e):r(o,i(e,e))}),s(o))return o;switch(e){case"uncorrected":return a(o,u);case"biased":return a(o,u+1);case"unbiased":var h=rR(o)?o.mul(0):0;return 1===u?h:a(o,u-1);default:throw Error('Unknown normalization "'+e+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function l(t,e,r){try{if(0===t.length)throw SyntaxError("Function variance requires one or more parameters (0 provided)");return o(t,e,t=>u(t,r))}catch(t){throw aC(t,"variance")}}},"xgcd"),uf="zeros",ud=/* #__PURE__ */nD(uf,["typed","config","matrix","BigNumber"],t=>{var{typed:e,config:r,matrix:n,BigNumber:i}=t;return e(uf,{"":function(){return"Array"===r.matrix?a([]):a([],"default")},"...number | BigNumber | string":function(t){if("string"==typeof t[t.length-1]){var e=t.pop();return a(t,e)}return"Array"===r.matrix?a(t):a(t,"default")},Array:a,Matrix:function(t){var e=t.storage();return a(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return a(t.valueOf(),e)}});function a(t,e){var r,a=(r=!1,t.forEach(function(t,e,n){rR(t)&&(r=!0,n[e]=t.toNumber())}),r)?new i(0):0;if(function(t){t.forEach(function(t){if("number"!=typeof t||!nw(t)||t<0)throw Error("Parameters in function zeros must be positive integers")})}(t),e){var o=n(e);return t.length>0?o.resize(t,a):o}var s=[];return t.length>0?n2(s,t,a):s}}),up=/* #__PURE__ */iQ({config:nx}),ug=/* #__PURE__ */ag({}),um=/* #__PURE__ */a8({}),uy=/* #__PURE__ */oq({}),uv=/* #__PURE__ */aE({Matrix:uy}),ux=/* #__PURE__ */s8({BigNumber:up,Complex:ug,DenseMatrix:uv,Fraction:um}),uD=/* #__PURE__ */iM({typed:ux}),ub=/* #__PURE__ */iL({typed:ux}),u_=/* #__PURE__ */iK({typed:ux}),uw=/* #__PURE__ */ad({Complex:ug,typed:ux}),uC=/* #__PURE__ */ax({typed:ux}),uA=/* #__PURE__ */ab({typed:ux}),uS=/* #__PURE__ */aY({config:nx,typed:ux}),uF=/* #__PURE__ */aQ({typed:ux}),uE=/* #__PURE__ */oo({typed:ux}),uM=/* #__PURE__ */ol({typed:ux}),uN=/* #__PURE__ */om({typed:ux}),uB=/* #__PURE__ */oC({config:nx,typed:ux}),uT=/* #__PURE__ */oS({equalScalar:uS,typed:ux}),uk=/* #__PURE__ */oX({typed:ux}),uP=/* #__PURE__ */oJ({typed:ux}),uO=/* #__PURE__ */su({typed:ux}),uI=/* #__PURE__ */sy({BigNumber:up,Fraction:um,complex:uw,typed:ux}),uz=/* #__PURE__ */sv({typed:ux}),uR=/* #__PURE__ */sV({Matrix:uy,equalScalar:uS,typed:ux}),uU=/* #__PURE__ */s1({typed:ux}),uL=/* #__PURE__ */iZ({BigNumber:up,typed:ux}),uG=/* #__PURE__ */sH({Complex:ug,config:nx,typed:ux}),uj=/* #__PURE__ */ur({typed:ux}),uq=/* #__PURE__ */a3({Fraction:um,typed:ux}),uV=/* #__PURE__ */oj({DenseMatrix:uv,Matrix:uy,SparseMatrix:uR,typed:ux}),uH=/* #__PURE__ */o2({bignumber:uL,fraction:uq,number:uP}),uW=/* #__PURE__ */sh({isInteger:uN,matrix:uV,typed:ux}),uK=/* #__PURE__ */sD({matrix:uV,config:nx,typed:ux}),uY=/* #__PURE__ */s3({matrix:uV,typed:ux}),uX=/* #__PURE__ */ud({BigNumber:up,config:nx,matrix:uV,typed:ux}),u$=/* #__PURE__ */ay({isInteger:uN,matrix:uV,typed:ux}),uZ=/* #__PURE__ */aw({conj:uC,transpose:uY,typed:ux}),uJ=/* #__PURE__ */aB({DenseMatrix:uv,SparseMatrix:uR,matrix:uV,typed:ux}),uQ=/* #__PURE__ */ak({numeric:uH,typed:ux}),u0=/* #__PURE__ */aH({DenseMatrix:uv,SparseMatrix:uR,concat:u$,equalScalar:uS,matrix:uV,typed:ux}),u1=/* #__PURE__ */ou({BigNumber:up,DenseMatrix:uv,SparseMatrix:uR,config:nx,matrix:uV,typed:ux}),u2=/* #__PURE__ */oB({DenseMatrix:uv,SparseMatrix:uR,concat:u$,config:nx,matrix:uV,typed:ux}),u5=/* #__PURE__ */oI({DenseMatrix:uv,divideScalar:uQ,equalScalar:uS,matrix:uV,multiplyScalar:uk,subtractScalar:uU,typed:ux}),u3=/* #__PURE__ */oH({flatten:uF,matrix:uV,size:uK,typed:ux}),u4=/* #__PURE__ */sa({addScalar:ub,complex:uw,conj:uC,divideScalar:uQ,equal:u0,identity:u1,isZero:uT,matrix:uV,multiplyScalar:uk,sign:uI,sqrt:uG,subtractScalar:uU,typed:ux,unaryMinus:uj,zeros:uX}),u8=/* #__PURE__ */sd({BigNumber:up,DenseMatrix:uv,config:nx,equalScalar:uS,matrix:uV,typed:ux,zeros:uX}),u6=/* #__PURE__ */sB({DenseMatrix:uv,SparseMatrix:uR,concat:u$,config:nx,matrix:uV,typed:ux}),u9=/* #__PURE__ */sQ({DenseMatrix:uv,concat:u$,equalScalar:uS,matrix:uV,subtractScalar:uU,typed:ux,unaryMinus:uj}),u7=/* #__PURE__ */us({DenseMatrix:uv,divideScalar:uQ,equalScalar:uS,matrix:uV,multiplyScalar:uk,subtractScalar:uU,typed:ux}),lt=/* #__PURE__ */iR({DenseMatrix:uv,SparseMatrix:uR,addScalar:ub,concat:u$,equalScalar:uS,matrix:uV,typed:ux}),le=/* #__PURE__ */au({BigNumber:up,DenseMatrix:uv,Fraction:um,concat:u$,config:nx,equalScalar:uS,matrix:uV,typed:ux}),lr=/* #__PURE__ */aP({addScalar:ub,conj:uC,multiplyScalar:uk,size:uK,typed:ux}),ln=/* #__PURE__ */of({ImmutableDenseMatrix:/* #__PURE__ */oh({DenseMatrix:uv,smaller:u6}),getMatrixDataType:uE}),li=/* #__PURE__ */oE({DenseMatrix:uv,SparseMatrix:uR,concat:u$,config:nx,matrix:uV,typed:ux}),la=/* #__PURE__ */oY({addScalar:ub,dot:lr,equalScalar:uS,matrix:uV,multiplyScalar:uk,typed:ux}),lo=/* #__PURE__ */sM({SparseMatrix:uR,abs:uD,add:lt,divideScalar:uQ,larger:li,largerEq:u2,multiply:la,subtract:u9,transpose:uY,typed:ux}),ls=/* #__PURE__ */ul({DenseMatrix:uv,divideScalar:uQ,equalScalar:uS,matrix:uV,multiplyScalar:uk,subtractScalar:uU,typed:ux}),lu=/* #__PURE__ */aM({divideScalar:uQ,isZero:uT,matrix:uV,multiply:la,subtractScalar:uU,typed:ux,unaryMinus:uj}),ll=/* #__PURE__ */a$({larger:li,smaller:u6}),lh=/* #__PURE__ */sP({DenseMatrix:uv,SparseMatrix:uR,concat:u$,config:nx,matrix:uV,typed:ux}),lc=/* #__PURE__ */ss({bignumber:uL,matrix:uV,add:lt,config:nx,isPositive:uB,larger:li,largerEq:u2,smaller:u6,smallerEq:lh,typed:ux}),lf=/* #__PURE__ */sq({FibonacciHeap:ll,addScalar:ub,equalScalar:uS}),ld=/* #__PURE__ */at({Index:ln,matrix:uV,range:lc,typed:ux}),lp=/* #__PURE__ */op({abs:uD,addScalar:ub,det:lu,divideScalar:uQ,identity:u1,matrix:uV,multiply:la,typed:ux,unaryMinus:uj}),lg=/* #__PURE__ */oz({DenseMatrix:uv,Spa:lf,SparseMatrix:uR,abs:uD,addScalar:ub,divideScalar:uQ,equalScalar:uS,larger:li,matrix:uV,multiplyScalar:uk,subtractScalar:uU,typed:ux,unaryMinus:uj}),lm=/* #__PURE__ */sn({Complex:ug,config:nx,fraction:uq,identity:u1,inv:lp,matrix:uV,multiply:la,number:uP,typed:ux}),ly=/* #__PURE__ */oL({DenseMatrix:uv,lsolve:u5,lup:lg,matrix:uV,slu:lo,typed:ux,usolve:u7}),lv=/* #__PURE__ */aq({abs:uD,add:lt,addScalar:ub,atan:u_,bignumber:uL,column:ld,complex:uw,config:nx,cos:uA,diag:uJ,divideScalar:uQ,dot:lr,equal:u0,flatten:uF,im:uM,inv:lp,larger:li,matrix:uV,matrixFromColumns:u3,multiply:la,multiplyScalar:uk,number:uP,qr:u4,re:uO,reshape:uW,sin:uz,size:uK,smaller:u6,sqrt:uG,subtract:u9,typed:ux,usolve:u7,usolveAll:ls});let lx=window.innerWidth,lD=window.innerHeight;var lb=new/*@__PURE__*/(i(l)).Stage({container:"container",width:lx,height:lD});let l_=new/*@__PURE__*/(i(l)).Layer,lw=[],lC=null,lA=[],lS=[],lF=[],lE=!1,lM=[],lN={},lB=1;function lT(t,e){t.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(e)}`}function lk(t,e){if(e[0]<60||60>Math.abs(lx-e[0])||e[1]<60||60>Math.abs(lD-e[1]))return!0;if(t!==lC){let r=Math.abs(lC.x()-e[0]),n=Math.abs(lC.y()-e[1]);if(t.horizontal){if(r<=90&&n<=30)return!0}else if(!t.horizontal&&r<=30&&n<=90)return!0}for(let r of lw){if(null==r||t.ID==r.ID)continue;let n=r.x(),i=r.y(),a=Math.abs(n-e[0]),o=Math.abs(i-e[1]);if(t.horizontal&&r.horizontal){if(a<=90&&o<=30)return!0}else if(t.horizontal||r.horizontal){if(a<=90&&o<=90)return!0}else if(a<=30&&o<=90)return!0}return!1}function lP(t){for(let e of lw){if(null==e)continue;let r=e.x(),n=e.y(),i=Math.abs(r-t[0]),a=Math.abs(n-t[1]);if(e.horizontal){if(i<=90&&a<=30)return!0}else if(i<=90&&a<=90)return!0}return!1}function lO(t){return 30*Math.round(t/30)}function lI(t){0===t.rotation()&&(lF[t.node1.right.index].occupied=!0,lF[lF[t.node1.right.index].right.index].occupied=!0),90===t.rotation()&&(lF[t.node1.bottom.index].occupied=!0,lF[lF[t.node1.bottom.index].bottom.index].occupied=!0),180===t.rotation()&&(lF[t.node2.right.index].occupied=!0,lF[lF[t.node2.right.index].right.index].occupied=!0),270===t.rotation()&&(lF[t.node2.bottom.index].occupied=!0,lF[lF[t.node2.bottom.index].bottom.index].occupied=!0)}function lz(t){0===t.rotation()&&(lF[t.node1.right.index].occupied=!1,lF[lF[t.node1.right.index].right.index].occupied=!1),90===t.rotation()&&(lF[t.node1.bottom.index].occupied=!1,lF[lF[t.node1.bottom.index].bottom.index].occupied=!1),180===t.rotation()&&(lF[t.node2.right.index].occupied=!1,lF[lF[t.node2.right.index].right.index].occupied=!1),270===t.rotation()&&(lF[t.node2.bottom.index].occupied=!1,lF[lF[t.node2.bottom.index].bottom.index].occupied=!1)}function lR(t,e){let r=parseInt((lb.width()-30)/30),n=parseInt(1.5+2*r+1),i=parseInt(4.5+2*r+1);t.x(75),t.y(90),t.image(e),t.width(90),t.draggable(!0),t.rotation(0),t.offsetX(t.width()/2),t.offsetY(t.height()/2),t.node1=lF[n],t.node2=lF[i],lF[t.node1.right.index].occupied=!0,lF[lF[t.node1.right.index].right.index].occupied=!0}function lU(t){let e=new/*@__PURE__*/(i(l)).Text({x:t.x(),y:t.y()-40,text:`${t.name} ${t.getValue()}${t.unit}`,fontSize:20,fontFamily:"Calibri",fill:"black",align:"center",weight:"bold",listening:!1});return e.offsetX(e.width()/2),e.offsetY(e.height()/2),e.x(t.x()),e.y(e.y()),t.on("mouseover",()=>{document.body.style.cursor="pointer"}),t.on("mouseout",()=>{document.body.style.cursor="default"}),e}function lL(t,e){t.text=e,l_.add(t),lw.push(t),l_.add(t.text),l_.draw();let r=[t.x(),t.y()];t.on("dragstart",()=>{t.text.hide()}),t.on("dragend",()=>{let e=[];e=t.horizontal?[lO(t.x())-15,lO(t.y())]:[lO(t.x()),lO(t.y())-15],function(t,e,r){if(lk(t,e)){t.position({x:r[0],y:r[1]}),lj(t,t.text);return}lz(t),r[0]=e[0],r[1]=e[1],t.position({x:r[0],y:r[1]}),lG(t),lI(t),lj(t)}(t,e,r),l_.batchDraw()}),t.on("dblclick",()=>{if(lE)return;!function(t){let e=`
    <div id="editProperties">
        <h2>${t.type}</h2>
        <label for="componentval">${t.type} Value = </label>
            <div class="direction">
                <input type="number" name="componentval" id="componentval" min="0" value=${t.value}>
                <div class="datalist-container" style="margin-right:20px;">
                    <input type="text" list="metric-prefixes" id="prefix" value="${t.prefix}">
                    <datalist id="metric-prefixes">
                        <option value="p">
                        <option value="n">
                        <option value="\xb5">
                        <option value="m">
                        <option value="c">
                        <option value=" ">
                        <option value="k">
                        <option value="M">
                        <option value="G">
                        <option value="T">
                    </datalist>
                </div>
            <span>${t.unit}</span>
        </div>
        <div class="rotation-labels">
            <label for="rotation">Rotation</label>
            <select name="rotatesel" id="rotation" ${t.isConnected?"disabled":""}>
            <option value="0" ${0===t.rotation()?"selected":""}>0</option>
            <option value="90" ${90===t.rotation()?"selected":""}>90</option>
            <option value="180" ${180===t.rotation()?"selected":""}>180</option>
            <option value="270" ${270===t.rotation()?"selected":""}>270</option>
            </select>
        </div>
        <div class="checkbox-container">
            <label for="showtext">Show Value</label>
            <select name="showntext" id="showtext">
            <option value="true" ${!0===t.shownText?"selected":""}>On</option>
            <option value="false" ${!1===t.shownText?"selected":""}>Off</option>
            </select>
        </div>
         <button class="mybutton" id="deleteBtn">delete</button>
        <button class="button" id="submitBtn">submit</button>
    </div>

        `,r=document.createElement("div");r.id="popupDiv",r.innerHTML=e,document.body.appendChild(r)}(t);let n=t.rotation();document.getElementsByClassName("rotation").value=n;let i=document.getElementById("deleteBtn"),a=document.getElementById("submitBtn"),o=document.getElementById("popupDiv");document.body.addEventListener("click",t=>{o.contains(t.target)||(t.preventDefault(),t.stopPropagation())}),window.addEventListener("keydown",t=>{"Escape"===t.key&&o.remove()}),i.addEventListener("click",()=>{let r;o.remove(),r=1,lw.forEach(e=>{null!==e&&e.type===t.type&&e!==t&&e.name!==`${e.getSymbol()}${r++}`&&(e.name=`${e.getSymbol()}${r-1}`,e.text.text(`${e.name} ${t.getValue()} ${t.prefix}${t.unit}`))}),t.decreaseCount(),lw[t.ID]=null,t.remove(),e.remove(),l_.batchDraw()}),a.addEventListener("click",()=>{let n=document.getElementById("componentval"),i=document.getElementById("prefix"),a=document.getElementById("rotation");if(t.setValue(n.value),t.setPrefix(i.value),t.node1Connected||t.node2Connected){let t=document.getElementById("disconnect");t.style.display="block",setTimeout(()=>{t.style.display="none"},2e3)}else{let n=t.horizontal,i=t.rotation();t.setRotationvalue(a.value),i==t.rotation()||180==Math.abs(i-t.rotation())||(0===t.rotation()||180===t.rotation()?(t.horizontal=!0,lk(t,[lO(t.x())-15,lO(t.y())])?(t.horizontal=!1,t.setRotationvalue(i),lH(document.getElementById("norotate"))):(n||t.position({x:lO(t.x())-15,y:lO(t.y())}),r=[t.x(),t.y()])):(t.horizontal=!1,lk(t,[lO(t.x()),lO(t.y())-15])?(t.horizontal=!0,t.setRotationvalue(i),lH(document.getElementById("norotate"))):(n&&t.position({x:lO(t.x()),y:lO(t.y())-15}),r=[t.x(),t.y()]))),lj(t,e),lz(t),lG(t),lI(t)}let s=document.getElementById("showtext");"true"==s.value?t.shownText=!0:"false"==s.value&&(t.shownText=!1),o.remove(),lj(t,e),l_.batchDraw()})})}function lG(t){let e=t.rotation(),r=lb.width();lb.height();let n=parseInt((r-30)/30);if(0===e){let e=(t.y()-30)/30,r=(t.x()-t.width()/2-30)/30+e*(n+1),i=(t.y()-30)/30,a=(t.x()+t.width()/2-30)/30+i*(n+1);t.node1=lF[r],t.node2=lF[a]}else if(90==e){let e=(t.y()-t.height()/2-30)/30,r=(t.x()-30)/30+e*(n+1),i=(t.y()+t.height()/2-30)/30,a=(t.x()-30)/30+i*(n+1);t.node1=lF[r],t.node2=lF[a]}else if(180==e){let e=(t.y()-30)/30,r=(t.x()+t.width()/2-30)/30+e*(n+1),i=(t.y()-30)/30,a=(t.x()-t.width()/2-30)/30+i*(n+1);t.node1=lF[r],t.node2=lF[a]}else if(270==e){let e=(t.y()+t.height()/2-30)/30,r=(t.x()-30)/30+e*(n+1),i=(t.y()-t.height()/2-30)/30,a=(t.x()-30)/30+i*(n+1);t.node1=lF[r],t.node2=lF[a]}}function lj(t){t.text.offsetX(t.text.width()/2),t.text.offsetY(t.text.height()/2),0===t.rotation()?(t.text.rotation(0),t.text.position({x:t.x(),y:t.y()-40})):90===t.rotation()?(t.text.rotation(90),t.text.position({x:t.x()+40,y:t.y()})):180===t.rotation()?(t.text.rotation(180),t.text.position({x:t.x(),y:t.y()+40})):270===t.rotation()&&(t.text.rotation(270),t.text.position({x:t.x()-40,y:t.y()})),t.text.text(`${t.name} ${t.getValue()}${" "===t.prefix?"":t.prefix}${t.unit}`),t.text.hide(),t.shownText&&t.text.show()}function lq(){lA.forEach(t=>{t.remove()}),lA=[],l_.batchDraw()}function lV(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function lH(t){t.style.display="block",setTimeout(()=>{t.style.display="none"},2e3)}function lW(t,e){let r=t.width();t.height();let n=parseInt((r-30)/30),a=(e[0].y()-30)/30,o=(e[0].x()-30)/30+a*(n+1),s=(e[1].y()-30)/30,u=(e[1].x()-30)/30+s*(n+1);lA.forEach(t=>{let e=(t.y()-30)/30,r=(t.x()-30)/30+e*(n+1);r!=o&&r!=u&&(lF[r].occupied=!0)});let h=function(t,e){let r=[t],n=[];for(lF.forEach(t=>{t.g=1/0,t.h=0,t.f=t.g+t.h,t.parent=null}),t.g=0,t.h=lV(t.position,e.position),t.f=t.g+t.h;r.length>0;){let t=r.reduce((t,e)=>t.f<e.f?t:e);if(t===e)return function(t){let e=[];for(;t;)e.push(t),t=t.parent;return e.reverse()}(t);r=r.filter(e=>e!==t),n.push(t),["left","top","right","bottom"].forEach(i=>{if(!t[i])return;let a=lF[t[i].index];if(!a||a.occupied||n.includes(a))return;let o=t.g+1;if(r.includes(a)){if(o>=a.g)return}else r.push(a);a.g=o,a.h=lV(a.position,e.position),a.f=a.g+a.h,a.parent=t})}return null}(lF[o],lF[u]);if(!h)return!1;let c=new rF;c.gridPoints=h;for(let t=0;t<h.length-1;t++){let e=new/*@__PURE__*/(i(l)).Line({points:[h[t].position.x,h[t].position.y,h[t+1].position.x,h[t+1].position.y],stroke:"black",strokeWidth:2,listening:!0});l_.add(e),c.drawnLines.push(e)}lS.push(c),lA.forEach(t=>{let e=(t.y()-30)/30;lF[(t.x()-30)/30+e*(n+1)].occupied=!1}),lq(),c.drawnLines.forEach(t=>{t.on("dblclick",()=>{console.log(lS),lE||(c.drawnLines.forEach(t=>{t.remove()}),lS[c.ID]=null,console.log(lS))})})}function lK(){lw.forEach(t=>{null!==t&&t.draggable(!0)}),lC.draggable(!0)}lb.add(l_),function(t,e,r){var n;let a=t.width(),o=t.height();for(let t=0;t<=a;t+=30){let r=new/*@__PURE__*/(i(l)).Line({points:[t,0,t,o],stroke:"lightgray",strokeWidth:1,listening:!1});e.add(r)}for(let t=0;t<=o;t+=30){let r=new/*@__PURE__*/(i(l)).Line({points:[0,t,a,t],stroke:"lightgray",strokeWidth:1,listening:!1});e.add(r)}for(let t=0;t<=o;t+=30)for(let n=0;n<=a;n+=r){let r=new/*@__PURE__*/(i(l)).Circle({x:n,y:t,radius:1,fill:"darkgray",listening:!1});if(e.add(r),n>0&&t>0){let e={},r=parseInt((a-30)/30),i=(t-30)/30;e.index=(n-30)/30+i*(r+1),e.occupied=!1,e.position={x:n,y:t},30!==n&&(e.left={index:(n-60)/30+i*(r+1)}),30!==t&&(e.top={index:(n-30)/30+(i-1)*(r+1)}),n!==a-30&&(e.right={index:n/30+i*(r+1)}),t!==o-30&&(e.bottom={index:(n-30)/30+(i+1)*(r+1)}),lF.push(e)}}console.log(lF),lT(n=new Image,`<svg xmlns="http://www.w3.org/2000/svg" width="60" height="30" viewBox="0 0 60 30">
  <!-- Vertical line coming from above -->
  <line x1="30" y1="0" x2="30" y2="15" stroke="black" stroke-width="2"/>
  <!-- Top horizontal line -->
  <line x1="14" y1="15" x2="46" y2="15" stroke="black" stroke-width="2"/>
  <!-- Middle horizontal line -->
  <line x1="20" y1="20" x2="40" y2="20" stroke="black" stroke-width="2"/>
  <!-- Bottom horizontal line -->
  <line x1="24" y1="25" x2="36" y2="25" stroke="black" stroke-width="2"/>
</svg>`),n.onload=function(){let t=lb.width(),e=parseInt((t-30)/30);var r=new rw({});r.x(lO(t-60)),r.y(60),r.image(n),r.width(60),r.draggable(!0),r.rotation(0),r.offsetX(r.width()/2);let i=parseInt((r.x()+r.offsetX()-30)/30+1*e);r.node=lF[i],lF[r.node.bottom.index].occupied=!0,l_.add(r),lC=r,r.on("mouseover",()=>{document.body.style.cursor="pointer"}),r.on("mouseout",()=>{document.body.style.cursor="default"});let a=[r.x(),r.y()];r.on("dragend",()=>{let t=[lO(r.x()),lO(r.y())];if(lk(r,t))r.position({x:a[0],y:a[1]}),l_.batchDraw();else{lF[r.node.bottom.index].occupied=!1,a[0]=t[0],a[1]=t[1],r.position({x:a[0],y:a[1]});let n=(r.y()-30)/30,i=(r.x()-30)/30+n*(e+1);r.node=lF[i],lF[r.node.bottom.index].occupied=!0}})},e.draw()}(lb,l_,30),document.getElementById("resistance").addEventListener("click",()=>{if(console.log(lE),!lE){if(lP([75,90])){lH(document.getElementById("atOriginalert"));return}var t=new Image;lT(t,`
    <svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 90 30">
    <line x1="0" y1="15" x2="15" y2="15" stroke="black" stroke-width="2"/>
    <polyline points="15,15 20,5 30,25 40,5 50,25 60,5 70,25 75,15" fill="none" stroke="black" stroke-width="2"/>
    <line x1="75" y1="15" x2="90" y2="15" stroke="black" stroke-width="2"/>
    </svg>
    `),t.onload=function(){var e=new rC({});lR(e,t);let r=lU(e);lL(e,r)}}}),document.getElementById("dcBattery").addEventListener("click",()=>{if(!lE){if(lP([75,90])){let t=document.getElementById("atOriginalert");t.style.display="block",setTimeout(()=>{t.style.display="none"},2e3);return}var t=new Image;lT(t,`
    <svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 90 90">
    <!-- Outer Circle (radius 25) -->
    <circle cx="45" cy="45" r="25" stroke="black" stroke-width="2" fill="none"/>
    <!-- Left Terminal (outside the circle) -->
    <line x1="0" y1="45" x2="20" y2="45" stroke="black" stroke-width="2"/>
    <!-- Right Terminal (outside the circle) -->
    <line x1="70" y1="45" x2="90" y2="45" stroke="black" stroke-width="2"/>
    <!-- Positive Sign inside the circle -->
    <line x1="35" y1="45" x2="40" y2="45" stroke="black" stroke-width="2"/>
    <line x1="37.5" y1="40" x2="37.5" y2="50" stroke="black" stroke-width="2"/>
  <!-- Negative Sign inside the circle -->
  <line x1="50" y1="45" x2="55" y2="45" stroke="black" stroke-width="2"/>
  </svg>
  
  `),t.onload=function(){var e=new rA({});lR(e,t);let r=lU(e);lL(e,r)}}}),document.getElementById("dcCurrentSource").addEventListener("click",()=>{if(!lE){if(lP([75,90])){let t=document.getElementById("atOriginalert");t.style.display="block",setTimeout(()=>{t.style.display="none"},2e3);return}var t=new Image;lT(t,`<svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 90 90">
  <!-- Outer Circle (radius 25) -->
  <circle cx="45" cy="45" r="25" stroke="black" stroke-width="2" fill="none"/>
  <!-- Left Terminal (outside the circle) -->
  <line x1="0" y1="45" x2="20" y2="45" stroke="black" stroke-width="2"/>
  <!-- Right Terminal (outside the circle) -->
  <line x1="70" y1="45" x2="90" y2="45" stroke="black" stroke-width="2"/>
  <!-- Arrow inside the circle (pointing left) -->
  <line x1="55" y1="45" x2="35" y2="45" stroke="black" stroke-width="2"/>
  <polygon points="35,45 40,40 40,50" fill="black"/>
</svg>

`),t.onload=function(){var e=new rS({});lR(e,t);let r=lU(e);lL(e,r)}}});let lY=[];document.getElementById("wire").addEventListener("click",()=>{if(lE)return;lE=!0,lw.forEach(t=>{null!==t&&t.draggable(!1)}),lC.draggable(!1);let t=document.getElementById("wirealert");t.style.display="block",setTimeout(()=>{t.style.display="none"},2e3),function(){let t=new/*@__PURE__*/(i(l)).Circle({x:lC.node.position.x,y:lC.node.position.y,radius:4,fill:"#772F1A"});lA.push(t),lw.forEach(t=>{if(null!=t){let e=new/*@__PURE__*/(i(l)).Circle({x:t.node1.position.x,y:t.node1.position.y,radius:4,fill:"#772F1A"});lA.push(e);let r=new/*@__PURE__*/(i(l)).Circle({x:t.node2.position.x,y:t.node2.position.y,radius:4,fill:"#772F1A"});lA.push(r)}lS.forEach(t=>{null!=t&&t.gridPoints.forEach(t=>{let e=!0;if(lA.forEach(r=>{r.x()==t.position.x&&r.y()==t.position.y&&(e=!1)}),!e)return;let r=new/*@__PURE__*/(i(l)).Circle({x:t.position.x,y:t.position.y,radius:4,fill:"#772F1A"});lA.push(r)})})}),lA.forEach(t=>{t.on("mouseover",()=>{document.body.style.cursor="pointer"}),t.on("mouseout",()=>{document.body.style.cursor="default"}),t.on("click",()=>{t.fill("green")}),l_.add(t)}),l_.batchDraw()}(),window.addEventListener("keydown",e=>{if("Escape"===e.key){t.style.display="none",lE=!1,lK(),lq(),lY=[];return}})}),document.body.addEventListener("click",t=>{if(lE){let e=!1;lA.forEach(r=>{5>Math.abs(t.x-r.x())&&5>Math.abs(t.y-r.y())&&(e=!0)}),e||(t.preventDefault(),t.stopPropagation());let r=document.getElementById("differentnode");lA.forEach(e=>{if(4>Math.abs(t.x-e.x())&&4>Math.abs(t.y-e.y())){if(lY.length<2&&(lY.find(t=>t===e)?lH(r):lY.push(e)),console.log(lY.length),console.log(lY),2===lY.length)lY[0].x()===lY[1].x()&&lY[0].y()===lY[1].y()?lY.pop():(lE=!1,lK(),lW(lb,lY),lY=[]);else if(lY.length>2){let t=lY.length;if(lY[0]==lY[1])for(let e=1;e<t;e++)lY.pop();else{for(let e=2;e<t;e++)lY.pop();lE=!1,lK(),lW(lb,lY),lY=[]}}}})}}),document.getElementById("run").addEventListener("click",()=>{!function(){!function(){lN={},tempNodes={},lB=1;let t=1;lS.forEach(t=>{if(null!=t){for(let e=1;e<lB;e++)for(let r=0;r<t.gridPoints.length;r++)if(lN[`N${e}`][`${t.gridPoints[r].index}`]){for(let r=0;r<t.gridPoints.length;r++)lN[`N${e}`][`${t.gridPoints[r].index}`]=!0;return}lN[`N${lB}`]||(lN[`N${lB}`]={});for(let e=0;e<t.gridPoints.length;e++)lN[`N${lB}`][`${t.gridPoints[e].index}`]=!0;lB++}});for(let e=1;e<lB;e++){let r=!1;for(let t=e+1;t<lB;t++)(function(t,e){let r=Object.keys(t),n=Object.keys(e),i=new Set(r);for(let t of n)if(i.has(t))return!0;return!1})(lN[`N${e}`],lN[`N${t}`])&&(r=!0,lN[`N${e}`]={...lN[`N${e}`],...lN[`N${t}`]},lN[`N${t}`]={});r&&(tempNodes[`N${t++}`]=lN[`N${e}`]),r||0===Object.keys(lN[`N${e}`]).length||(tempNodes[`N${t++}`]=lN[`N${e}`])}lB=t,lN=tempNodes,lw.forEach(t=>{if(null==t)return;let e=!1,r=!1;for(let n=1;n<lB;n++)lN[`N${n}`][`${t.node1.index}`]&&(e=!0),lN[`N${n}`][`${t.node2.index}`]&&(r=!0);!e&&(lN[`N${lB}`]={},lN[`N${lB}`][`${t.node1.index}`]=!0,lB++),!r&&(lN[`N${lB}`]={},lN[`N${lB}`][`${t.node2.index}`]=!0,lB++)});for(let t=1;t<lB;t++)if(lN[`N${t}`][`${lC.node.index}`]){lN.GND=lN[`N${t}`];let e=t;for(;e<lB-1;e++)lN[`N${e}`]=lN[`N${e+1}`];delete lN[`N${e}`],lB--;break}lN.GND||(lN.GND={},lN.GND[`${lC.node.index}`]=!0)}();let t=[];lw.forEach(e=>{let r,n;if(null===e)return;for(let t of Object.keys(lN))lN[t][`${e.node1.index}`]&&(r=t);for(let t of Object.keys(lN))lN[t][`${e.node2.index}`]&&(n=t);let i={type:e.getSymbol(),Node1:r,Node2:n,Value:e.value,exponent:function(t){switch(t){case"p":return 1e-12;case"n":return 1e-9;case"µ":return 1e-6;case"m":return .001;case"c":return .01;case" ":return 1;case"k":return 1e3;case"M":return 1e6;case"G":return 1e9;case"T":return 1e12;default:throw Error(`Unknown prefix: ${t}`)}}(e.prefix)};t.push(i)}),console.log(t);let e=Object.keys(lN).length-1,r=0,n=[];for(let e=0;e<t.length;e++)"Vs"===t[e].type&&(r++,n.push(e));let a=e+r,o=Array(a),s=Array(a);s.fill(0);for(let t=0;t<a;t++)o[t]=Array(a),o[t].fill(0);for(let e=0;e<t.length;e++)if("R"===t[e].type){let r=parseInt(t[e].Node1.slice(1)),n=parseInt(t[e].Node2.slice(1));Number.isNaN(r)||(o[r-1][r-1]+=1/(parseInt(t[e].Value)*t[e].exponent)),Number.isNaN(n)||(o[n-1][n-1]+=1/(parseInt(t[e].Value)*t[e].exponent)),Number.isNaN(r)||Number.isNaN(n)||(o[r-1][n-1]-=1/(parseInt(t[e].Value)*t[e].exponent),o[n-1][r-1]-=1/(parseInt(t[e].Value)*t[e].exponent))}else if("Cs"===t[e].type){let r=parseInt(t[e].Node1.slice(1)),n=parseInt(t[e].Node2.slice(1));Number.isNaN(r)||(s[r-1]+=parseInt(t[e].Value*t[e].exponent)),Number.isNaN(n)||(s[n-1]-=parseInt(t[e].Value*t[e].exponent))}for(let r=0;r<n.length;r++){let i=t[n[r]],a=parseInt(i.Node1.slice(1)),u=parseInt(i.Node2.slice(1));Number.isNaN(a)||(console.log(a-1),console.log(e+r),console.log(o),o[a-1][e+r]+=1,o[e+r][a-1]+=1),Number.isNaN(u)||(o[u-1][e+r]-=1,o[e+r][u-1]-=1),s[e+r]+=parseInt(i.Value*i.exponent)}for(let t=0;t<e;t++)console.log(o[t]);console.log(s);let u=ly(o,s);console.log(u);let h=[];for(let t=0;t<u.length-r;t++){let e=lF[parseInt(Object.keys(lN[`N${t+1}`])[0])],r=function(t){let e;let r=()=>{let t=Math.floor(128*Math.random()),e=Math.floor(128*Math.random()),r=Math.floor(128*Math.random());return`#${t.toString(16).padStart(2,"0")}${e.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}`};do e=r();while(t.includes(e))return e}(h),n=new/*@__PURE__*/(i(l)).Circle({x:e.position.x,y:e.position.y,radius:4,fill:r});l_.add(n),h.push(r),lM.push(n)}(function(t,e,r){t.length;let n=new/*@__PURE__*/(i(l)).Group({x:50,y:50,draggable:!0}),a=new/*@__PURE__*/(i(l)).Rect({x:50,y:50,width:100,height:40,fill:"lightgray",stroke:"black",strokeWidth:1});n.add(a);let o=new/*@__PURE__*/(i(l)).Text({x:60,y:60,text:"Node",fontSize:16,fontFamily:"Calibri",fill:"black"});n.add(o);let s=new/*@__PURE__*/(i(l)).Rect({x:150,y:50,width:100,height:40,fill:"lightgray",stroke:"black",strokeWidth:1});n.add(s);let u=new/*@__PURE__*/(i(l)).Text({x:160,y:60,text:"Voltage",fontSize:16,fontFamily:"Calibri",fill:"black"});n.add(u),console.log(t.length-e);for(let a=0;a<t.length-e;a++){let e=new/*@__PURE__*/(i(l)).Rect({x:50,y:(a+1)*40+50,width:100,height:40,fill:"white",stroke:"black",strokeWidth:1});n.add(e);let o=new/*@__PURE__*/(i(l)).Text({x:60,y:(a+1)*40+60,text:`N${a+1}`,fontSize:16,fontFamily:"Calibri",fill:r[a]});n.add(o);let s=new/*@__PURE__*/(i(l)).Rect({x:150,y:50+(a+1)*40,width:100,height:40,fill:"white",stroke:"black",strokeWidth:1});n.add(s);let u=new/*@__PURE__*/(i(l)).Text({x:160,y:(a+1)*40+60,text:`${function(t){if(Math.abs(Number(t))>=1e12)return(Number(t)/1e12).toFixed(3)+" T";if(Math.abs(Number(t))>=1e9)return(Number(t)/1e9).toFixed(3)+" G";if(Math.abs(Number(t))>=1e6)return(Number(t)/1e6).toFixed(3)+" M";if(Math.abs(Number(t))>=1e3)return(Number(t)/1e3).toFixed(3)+" k";if(Math.abs(Number(t))>=1)return Number(t).toFixed(3);if(Math.abs(Number(t))>=.001)return(1e3*Number(t)).toFixed(3)+" m";if(Math.abs(Number(t))>=1e-6)return(1e6*Number(t)).toFixed(3)+" μ";else if(Math.abs(Number(t))>=1e-9)return(1e9*Number(t)).toFixed(3)+" n";else if(Math.abs(Number(t))>=1e-12)return(1e12*Number(t)).toFixed(3)+" p";else return"0.000"}(t[a])}V`,fontSize:16,fontFamily:"Calibri",fill:"black"});n.add(u)}l_.add(n),lb.on("click",t=>{let e=n.getClientRect(),r=t.evt.clientX,i=t.evt.clientY;r>=e.x&&r<=e.x+e.width&&i>=e.y&&i<=e.y+e.height||(lM.forEach(t=>t.remove()),n.remove(),lM=[])})})(u,r,h),l_.batchDraw()}()});
//# sourceMappingURL=index.34d254c5.js.map
