let t,e,r;function n(t){return t&&t.__esModule?t.default:t}var i=globalThis,a={},o={},s=i.parcelRequire94c2;null==s&&((s=function(t){if(t in a)return a[t].exports;if(t in o){var e=o[t];delete o[t];var r={id:t,exports:{}};return a[t]=r,e.call(r.exports,r,r.exports),r.exports}var n=Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,e){o[t]=e},i.parcelRequire94c2=s);var u=s.register;u("cmoHh",function(t,e){!function(t,e,r){function n(t){var e,r=this,n=(e=0xefc8249d,function(t){t=String(t);for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));e=n>>>0,n-=e,n*=e,e=n>>>0,n-=e,e+=0x100000000*n}return(e>>>0)*23283064365386963e-26});r.next=function(){var t=2091639*r.s0+23283064365386963e-26*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(t),r.s0<0&&(r.s0+=1),r.s1-=n(t),r.s1<0&&(r.s1+=1),r.s2-=n(t),r.s2<0&&(r.s2+=1)}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function a(t,e){var r=new n(t),a=e&&e.state,o=r.next;return o.int32=function(){return 0x100000000*r.next()|0},o.double=function(){return o()+(2097152*o()|0)*11102230246251565e-32},o.quick=o,a&&("object"==typeof a&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.alea=a}(0,t,"function"==typeof define&&define)}),u("euRi5",function(t,e){!function(t,e,r){function n(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function a(t,e){var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&("object"==typeof a&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a}(0,t,"function"==typeof define&&define)}),u("hDsEw",function(t,e){!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^(t^t<<1))|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function a(t,e){var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&("object"==typeof a&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a}(0,t,"function"==typeof define&&define)}),u("3J2Zm",function(t,e){!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.x,i=e.i;return t=n[i],t^=t>>>7,r=t^t<<24^((t=n[i+1&7])^t>>>10)^((t=n[i+3&7])^t>>>3)^((t=n[i+4&7])^t<<7),t=n[i+7&7],t^=t<<13,r^=t^t<<9,n[i]=r,e.i=i+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(r=0,e=""+e;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function a(t,e){null==t&&(t=+new Date);var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&(a.x&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a}(0,t,"function"==typeof define&&define)}),u("6Px8M",function(t,e){!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.w,i=e.X,a=e.i;return e.w=n=n+0x61c88647|0,r=i[a+34&127],t=i[a=a+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=i[a]=r^t,e.i=a,r+(n^n>>>16)|0},function(t,e){var r,n,i,a,o,s=[],u=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(n^=e.charCodeAt((a+32)%e.length)),0===a&&(o=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,a>=0&&(o=o+0x61c88647|0,i=0==(r=s[127&a]^=n+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)n=s[i+34&127],r=s[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,s[i]=n^r;t.w=o,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function a(t,e){null==t&&(t=+new Date);var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&(a.X&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a}(0,t,"function"==typeof define&&define)}),u("lDm0S",function(t,e){!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,i=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-0x61c88647,e.d=0x517cc1b7,t===Math.floor(t)?(e.a=t/0x100000000|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function a(t,e){var r=new n(t),a=e&&e.state,o=function(){return(r.next()>>>0)/0x100000000};return o.double=function(){do var t=r.next()>>>11,e=(r.next()>>>0)/0x100000000,n=(t+e)/2097152;while(0===n)return n},o.int32=r.next,o.quick=o,a&&("object"==typeof a&&i(a,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a}(0,t,"function"==typeof define&&define)}),u("bx1Nf",function(t,e){});var l={};Object.defineProperty(l,"__esModule",{value:!0});var h={};Object.defineProperty(h,"__esModule",{value:!0}),h.Konva=void 0;var c={};Object.defineProperty(c,"__esModule",{value:!0}),c.Konva=void 0;var f={};Object.defineProperty(f,"__esModule",{value:!0}),f._registerNode=f.Konva=f.glob=void 0;const d=Math.PI/180;f.glob=void 0!==i?i:"undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:{},f.Konva={_global:f.glob,version:"9.3.16",isBrowser:"undefined"!=typeof window&&("[object Window]"===({}).toString.call(window)||"[object global]"===({}).toString.call(window)),isUnminified:/param/.test((function(t){}).toString()),dblClickWindow:400,getAngle:t=>f.Konva.angleDeg?t*d:t,enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:()=>f.Konva.DD.isDragging,isTransforming(){var t;return null===(t=f.Konva.Transformer)||void 0===t?void 0:t.isTransforming()},isDragReady:()=>!!f.Konva.DD.node,releaseCanvasOnDestroy:!0,document:f.glob.document,_injectGlobal(t){f.glob.Konva=t}},f._registerNode=t=>{f.Konva[t.prototype.getClassName()]=t},f.Konva._injectGlobal(f.Konva);var p={};Object.defineProperty(p,"__esModule",{value:!0}),p.Util=p.Transform=void 0;class g{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new g(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){let e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){let e=Math.cos(t),r=Math.sin(t),n=this.m[0]*e+this.m[2]*r,i=this.m[1]*e+this.m[3]*r,a=-(this.m[0]*r)+this.m[2]*e,o=-(this.m[1]*r)+this.m[3]*e;return this.m[0]=n,this.m[1]=i,this.m[2]=a,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){let r=this.m[0]+this.m[2]*e,n=this.m[1]+this.m[3]*e,i=this.m[2]+this.m[0]*t,a=this.m[3]+this.m[1]*t;return this.m[0]=r,this.m[1]=n,this.m[2]=i,this.m[3]=a,this}multiply(t){let e=this.m[0]*t.m[0]+this.m[2]*t.m[1],r=this.m[1]*t.m[0]+this.m[3]*t.m[1],n=this.m[0]*t.m[2]+this.m[2]*t.m[3],i=this.m[1]*t.m[2]+this.m[3]*t.m[3],a=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=r,this.m[2]=n,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}invert(){let t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,r=-this.m[1]*t,n=-this.m[2]*t,i=this.m[0]*t,a=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=r,this.m[2]=n,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}getMatrix(){return this.m}decompose(){let t=this.m[0],e=this.m[1],r=this.m[2],n=this.m[3],i=this.m[4],a=this.m[5],o=t*n-e*r,s={x:i,y:a,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=t||0!=e){let i=Math.sqrt(t*t+e*e);s.rotation=e>0?Math.acos(t/i):-Math.acos(t/i),s.scaleX=i,s.scaleY=o/i,s.skewX=(t*r+e*n)/o,s.skewY=0}else if(0!=r||0!=n){let i=Math.sqrt(r*r+n*n);s.rotation=Math.PI/2-(n>0?Math.acos(-r/i):-Math.acos(r/i)),s.scaleX=o/i,s.scaleY=i,s.skewX=0,s.skewY=(t*r+e*n)/o}return s.rotation=p.Util._getRotation(s.rotation),s}}p.Transform=g;let m=Math.PI/180,v=180/Math.PI,y="Konva error: ",x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,D=[];const _="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||function(t){setTimeout(t,60)};p.Util={_isElement:t=>!!(t&&1==t.nodeType),_isFunction:t=>!!(t&&t.constructor&&t.call&&t.apply),_isPlainObject:t=>!!t&&t.constructor===Object,_isArray:t=>"[object Array]"===Object.prototype.toString.call(t),_isNumber:t=>"[object Number]"===Object.prototype.toString.call(t)&&!isNaN(t)&&isFinite(t),_isString:t=>"[object String]"===Object.prototype.toString.call(t),_isBoolean:t=>"[object Boolean]"===Object.prototype.toString.call(t),isObject:t=>t instanceof Object,isValidSelector(t){if("string"!=typeof t)return!1;let e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign:t=>0===t?1:t>0?1:-1,requestAnimFrame(t){D.push(t),1===D.length&&_(function(){let t=D;D=[],t.forEach(function(t){t()})})},createCanvasElement(){let t=document.createElement("canvas");try{t.style=t.style||{}}catch(t){}return t},createImageElement:()=>document.createElement("img"),_isInDocument(t){for(;t=t.parentNode;)if(t==document)return!0;return!1},_urlToImage(t,e){let r=p.Util.createImageElement();r.onload=function(){e(r)},r.src=t},_rgbToHex:(t,e,r)=>(0x1000000+(t<<16)+(e<<8)+r).toString(16).slice(1),_hexToRgb(t){let e=parseInt(t=t.replace("#",""),16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor(){let t=(0xffffff*Math.random()<<0).toString(16);for(;t.length<6;)t="0"+t;return"#"+t},getRGB(t){let e;return t in x?{r:(e=x[t])[0],g:e[1],b:e[2]}:"#"===t[0]?this._hexToRgb(t.substring(1)):"rgb("===t.substr(0,4)?{r:parseInt((e=b.exec(t.replace(/ /g,"")))[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}:{r:0,g:0,b:0}},colorToRGBA:t=>(t=t||"black",p.Util._namedColorToRBA(t)||p.Util._hex3ColorToRGBA(t)||p.Util._hex4ColorToRGBA(t)||p.Util._hex6ColorToRGBA(t)||p.Util._hex8ColorToRGBA(t)||p.Util._rgbColorToRGBA(t)||p.Util._rgbaColorToRGBA(t)||p.Util._hslColorToRGBA(t)),_namedColorToRBA(t){let e=x[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(t){if(0===t.indexOf("rgb(")){let e=(t=t.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(t){if(0===t.indexOf("rgba(")){let e=(t=t.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map((t,e)=>"%"===t.slice(-1)?3===e?parseInt(t)/100:parseInt(t)/100*255:Number(t));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(t){if("#"===t[0]&&9===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:parseInt(t.slice(7,9),16)/255}},_hex6ColorToRGBA(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex4ColorToRGBA(t){if("#"===t[0]&&5===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:parseInt(t[4]+t[4],16)/255}},_hex3ColorToRGBA(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){let e,r,n;let[i,...a]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),o=Number(a[0])/360,s=Number(a[1])/100,u=Number(a[2])/100;if(0===s)return{r:Math.round(n=255*u),g:Math.round(n),b:Math.round(n),a:1};e=u<.5?u*(1+s):u+s-u*s;let l=2*u-e,h=[0,0,0];for(let t=0;t<3;t++)(r=o+-(1/3*(t-1)))<0&&r++,r>1&&r--,n=6*r<1?l+(e-l)*6*r:2*r<1?e:3*r<2?l+(e-l)*(2/3-r)*6:l,h[t]=255*n;return{r:Math.round(h[0]),g:Math.round(h[1]),b:Math.round(h[2]),a:1}}},haveIntersection:(t,e)=>!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y),cloneObject(t){let e={};for(let r in t)this._isPlainObject(t[r])?e[r]=this.cloneObject(t[r]):this._isArray(t[r])?e[r]=this.cloneArray(t[r]):e[r]=t[r];return e},cloneArray:t=>t.slice(0),degToRad:t=>t*m,radToDeg:t=>t*v,_degToRad:t=>(p.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),p.Util.degToRad(t)),_radToDeg:t=>(p.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),p.Util.radToDeg(t)),_getRotation:t=>f.Konva.angleDeg?p.Util.radToDeg(t):t,_capitalize:t=>t.charAt(0).toUpperCase()+t.slice(1),throw(t){throw Error(y+t)},error(t){console.error(y+t)},warn(t){f.Konva.showWarnings&&console.warn("Konva warning: "+t)},each(t,e){for(let r in t)e(r,t[r])},_inRange:(t,e,r)=>e<=t&&t<r,_getProjectionToSegment(t,e,r,n,i,a){let o,s,u;let l=(t-r)*(t-r)+(e-n)*(e-n);if(0==l)o=t,s=e,u=(i-r)*(i-r)+(a-n)*(a-n);else{let h=((i-t)*(r-t)+(a-e)*(n-e))/l;h<0?(o=t,s=e,u=(t-i)*(t-i)+(e-a)*(e-a)):h>1?(o=r,s=n,u=(r-i)*(r-i)+(n-a)*(n-a)):u=((o=t+h*(r-t))-i)*(o-i)+((s=e+h*(n-e))-a)*(s-a)}return[o,s,u]},_getProjectionToLine(t,e,r){let n=p.Util.cloneObject(t),i=Number.MAX_VALUE;return e.forEach(function(a,o){if(!r&&o===e.length-1)return;let s=e[(o+1)%e.length],u=p.Util._getProjectionToSegment(a.x,a.y,s.x,s.y,t.x,t.y),l=u[0],h=u[1],c=u[2];c<i&&(n.x=l,n.y=h,i=c)}),n},_prepareArrayForTween(t,e,r){let n,i=[],a=[];if(t.length>e.length){let r=e;e=t,t=r}for(n=0;n<t.length;n+=2)i.push({x:t[n],y:t[n+1]});for(n=0;n<e.length;n+=2)a.push({x:e[n],y:e[n+1]});let o=[];return a.forEach(function(t){let e=p.Util._getProjectionToLine(t,i,r);o.push(e.x),o.push(e.y)}),o},_prepareToStringify(t){let e;for(let r in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(r)&&t[r]&&"object"==typeof t[r]){if(e=Object.getOwnPropertyDescriptor(t,r),t[r].visitedByCircularReferenceRemoval||p.Util._isElement(t[r])){if(!e.configurable)return null;delete t[r]}else if(null===p.Util._prepareToStringify(t[r])){if(!e.configurable)return null;delete t[r]}}return delete t.visitedByCircularReferenceRemoval,t},_assign(t,e){for(let r in e)t[r]=e[r];return t},_getFirstPointerId:t=>t.touches?t.changedTouches[0].identifier:t.pointerId||999,releaseCanvas(...t){f.Konva.releaseCanvasOnDestroy&&t.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(t,e,r,n){let i=0,a=0,o=0,s=0;"number"==typeof n?i=a=o=s=Math.min(n,e/2,r/2):(i=Math.min(n[0]||0,e/2,r/2),a=Math.min(n[1]||0,e/2,r/2),s=Math.min(n[2]||0,e/2,r/2),o=Math.min(n[3]||0,e/2,r/2)),t.moveTo(i,0),t.lineTo(e-a,0),t.arc(e-a,a,a,3*Math.PI/2,0,!1),t.lineTo(e,r-s),t.arc(e-s,r-s,s,0,Math.PI/2,!1),t.lineTo(o,r),t.arc(o,r-o,o,Math.PI/2,Math.PI,!1),t.lineTo(0,i),t.arc(i,i,i,Math.PI,3*Math.PI/2,!1)}};var w={};Object.defineProperty(w,"__esModule",{value:!0}),w.Node=void 0;var E={};Object.defineProperty(E,"__esModule",{value:!0}),E.Factory=void 0;var C={};function S(t){return p.Util._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)||p.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}Object.defineProperty(C,"__esModule",{value:!0}),C.RGBComponent=function(t){return t>255?255:t<0?0:Math.round(t)},C.alphaComponent=function(t){return t>1?1:t<1e-4?1e-4:t},C.getNumberValidator=function(){if(f.Konva.isUnminified)return function(t,e){return p.Util._isNumber(t)||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}},C.getNumberOrArrayOfNumbersValidator=function(t){if(f.Konva.isUnminified)return function(e,r){let n=p.Util._isNumber(e),i=p.Util._isArray(e)&&e.length==t;return n||i||p.Util.warn(S(e)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+t+")"),e}},C.getNumberOrAutoValidator=function(){if(f.Konva.isUnminified)return function(t,e){let r=p.Util._isNumber(t),n="auto"===t;return r||n||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}},C.getStringValidator=function(){if(f.Konva.isUnminified)return function(t,e){return p.Util._isString(t)||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}},C.getStringOrGradientValidator=function(){if(f.Konva.isUnminified)return function(t,e){let r=p.Util._isString(t),n="[object CanvasGradient]"===Object.prototype.toString.call(t)||t&&t.addColorStop;return r||n||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}},C.getFunctionValidator=function(){if(f.Konva.isUnminified)return function(t,e){return p.Util._isFunction(t)||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}},C.getNumberArrayValidator=function(){if(f.Konva.isUnminified)return function(t,e){let r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&t instanceof r||(p.Util._isArray(t)?t.forEach(function(t){p.Util._isNumber(t)||p.Util.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")}):p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}},C.getBooleanValidator=function(){if(f.Konva.isUnminified)return function(t,e){return!0===t||!1===t||p.Util.warn(S(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}},C.getComponentValidator=function(t){if(f.Konva.isUnminified)return function(e,r){return null==e||p.Util.isObject(e)||p.Util.warn(S(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}},E.Factory={addGetterSetter(t,e,r,n,i){E.Factory.addGetter(t,e,r),E.Factory.addSetter(t,e,n,i),E.Factory.addOverloadedGetterSetter(t,e)},addGetter(t,e,r){let n="get"+p.Util._capitalize(e);t.prototype[n]=t.prototype[n]||function(){let t=this.attrs[e];return void 0===t?r:t}},addSetter(t,e,r,n){let i="set"+p.Util._capitalize(e);t.prototype[i]||E.Factory.overWriteSetter(t,e,r,n)},overWriteSetter(t,e,r,n){let i="set"+p.Util._capitalize(e);t.prototype[i]=function(t){return r&&null!=t&&(t=r.call(this,t,e)),this._setAttr(e,t),n&&n.call(this),this}},addComponentsGetterSetter(t,e,r,n,i){let a=r.length,o=p.Util._capitalize,s="get"+o(e),u="set"+o(e),l,h;t.prototype[s]=function(){let t={};for(l=0;l<a;l++)t[h=r[l]]=this.getAttr(e+o(h));return t};let c=(0,C.getComponentValidator)(r);t.prototype[u]=function(t){let a=this.attrs[e],s;for(s in n&&(t=n.call(this,t)),c&&c.call(this,t,e),t)t.hasOwnProperty(s)&&this._setAttr(e+o(s),t[s]);return t||r.forEach(t=>{this._setAttr(e+o(t),void 0)}),this._fireChangeEvent(e,a,t),i&&i.call(this),this},E.Factory.addOverloadedGetterSetter(t,e)},addOverloadedGetterSetter(t,e){let r=p.Util._capitalize(e),n="set"+r,i="get"+r;t.prototype[e]=function(){return arguments.length?(this[n](arguments[0]),this):this[i]()}},addDeprecatedGetterSetter(t,e,r,n){p.Util.error("Adding deprecated "+e);let i="get"+p.Util._capitalize(e),a=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[i]=function(){p.Util.error(a);let t=this.attrs[e];return void 0===t?r:t},E.Factory.addSetter(t,e,n,function(){p.Util.error(a)}),E.Factory.addOverloadedGetterSetter(t,e)},backCompat(t,e){p.Util.each(e,function(e,r){let n=t.prototype[r],i="get"+p.Util._capitalize(e),a="set"+p.Util._capitalize(e);function o(){n.apply(this,arguments),p.Util.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+r+'" instead.')}t.prototype[e]=o,t.prototype[i]=o,t.prototype[a]=o})},afterSetFilter(){this._filterUpToDate=!1}};var A={};Object.defineProperty(A,"__esModule",{value:!0}),A.HitCanvas=A.SceneCanvas=A.Canvas=void 0;var F={};Object.defineProperty(F,"__esModule",{value:!0}),F.HitContext=F.SceneContext=F.Context=void 0;const N=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];class M{constructor(t){this.canvas=t,f.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){let r=this.traceArr,n=r.length,i="",a,o,s,u;for(a=0;a<n;a++)(s=(o=r[a]).method)?(u=o.args,i+=s,t?i+="()":p.Util._isArray(u[0])?i+="(["+u.join(",")+"])":(e&&(u=u.map(t=>"number"==typeof t?Math.floor(t):t)),i+="("+u.join(",")+")")):(i+=o.property,t||(i+="="+o.val)),i+=";";return i}clearTrace(){this.traceArr=[]}_trace(t){let e=this.traceArr;e.push(t),e.length>=100&&e.shift()}reset(){let t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){let e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){let e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){let e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){let e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,r,n,i,a){this._context.arc(t,e,r,n,i,a)}arcTo(t,e,r,n,i){this._context.arcTo(t,e,r,n,i)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,r,n,i,a){this._context.bezierCurveTo(t,e,r,n,i,a)}clearRect(t,e,r,n){this._context.clearRect(t,e,r,n)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){let r=arguments;return 2===r.length?this._context.createImageData(t,e):1===r.length?this._context.createImageData(t):void 0}createLinearGradient(t,e,r,n){return this._context.createLinearGradient(t,e,r,n)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,r,n,i,a){return this._context.createRadialGradient(t,e,r,n,i,a)}drawImage(t,e,r,n,i,a,o,s,u){let l=arguments,h=this._context;3===l.length?h.drawImage(t,e,r):5===l.length?h.drawImage(t,e,r,n,i):9===l.length&&h.drawImage(t,e,r,n,i,a,o,s,u)}ellipse(t,e,r,n,i,a,o,s){this._context.ellipse(t,e,r,n,i,a,o,s)}isPointInPath(t,e,r,n){return r?this._context.isPointInPath(r,t,e,n):this._context.isPointInPath(t,e,n)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,r,n){this._context.fillRect(t,e,r,n)}strokeRect(t,e,r,n){this._context.strokeRect(t,e,r,n)}fillText(t,e,r,n){n?this._context.fillText(t,e,r,n):this._context.fillText(t,e,r)}measureText(t){return this._context.measureText(t)}getImageData(t,e,r,n){return this._context.getImageData(t,e,r,n)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,r,n){this._context.rect(t,e,r,n)}roundRect(t,e,r,n,i){this._context.roundRect(t,e,r,n,i)}putImageData(t,e,r){this._context.putImageData(t,e,r)}quadraticCurveTo(t,e,r,n){this._context.quadraticCurveTo(t,e,r,n)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,r,n,i,a){this._context.setTransform(t,e,r,n,i,a)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,r,n){this._context.strokeText(t,e,r,n)}transform(t,e,r,n,i,a){this._context.transform(t,e,r,n,i,a)}translate(t,e){this._context.translate(t,e)}_enableTrace(){let t=this,e=N.length,r=this.setAttr,n,i,a=function(e){let r=t[e],n;t[e]=function(){return i=function(t){let e=[],r=t.length,n=p.Util,i,a;for(i=0;i<r;i++)a=t[i],n._isNumber(a)?a=Math.round(1e3*a)/1e3:n._isString(a)||(a+=""),e.push(a);return e}(Array.prototype.slice.call(arguments,0)),n=r.apply(t,arguments),t._trace({method:e,args:i}),n}};for(n=0;n<e;n++)a(N[n]);t.setAttr=function(){r.apply(t,arguments);let e=arguments[0],n=arguments[1];("shadowOffsetX"===e||"shadowOffsetY"===e||"shadowBlur"===e)&&(n/=this.canvas.getPixelRatio()),t._trace({property:e,val:n})}}_applyGlobalCompositeOperation(t){let e=t.attrs.globalCompositeOperation;e&&"source-over"!==e&&this.setAttr("globalCompositeOperation",e)}}F.Context=M,["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach(function(t){Object.defineProperty(M.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})}),F.SceneContext=class extends M{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){let e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){let e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){let e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){let e=t.fill(),r=t.getFillPriority();if(e&&"color"===r){this._fillColor(t);return}let n=t.getFillPatternImage();if(n&&"pattern"===r){this._fillPattern(t);return}let i=t.getFillLinearGradientColorStops();if(i&&"linear-gradient"===r){this._fillLinearGradient(t);return}let a=t.getFillRadialGradientColorStops();if(a&&"radial-gradient"===r){this._fillRadialGradient(t);return}e?this._fillColor(t):n?this._fillPattern(t):i?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)}_strokeLinearGradient(t){let e=t.getStrokeLinearGradientStartPoint(),r=t.getStrokeLinearGradientEndPoint(),n=t.getStrokeLinearGradientColorStops(),i=this.createLinearGradient(e.x,e.y,r.x,r.y);if(n){for(let t=0;t<n.length;t+=2)i.addColorStop(n[t],n[t+1]);this.setAttr("strokeStyle",i)}}_stroke(t){let e=t.dash(),r=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!r){this.save();let t=this.getCanvas().getPixelRatio();this.setTransform(t,0,0,t,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),r||this.restore()}}_applyShadow(t){var e,r,n;let i=null!==(e=t.getShadowRGBA())&&void 0!==e?e:"black",a=null!==(r=t.getShadowBlur())&&void 0!==r?r:5,o=null!==(n=t.getShadowOffset())&&void 0!==n?n:{x:0,y:0},s=t.getAbsoluteScale(),u=this.canvas.getPixelRatio(),l=s.x*u,h=s.y*u;this.setAttr("shadowColor",i),this.setAttr("shadowBlur",a*Math.min(Math.abs(l),Math.abs(h))),this.setAttr("shadowOffsetX",o.x*l),this.setAttr("shadowOffsetY",o.y*h)}},F.HitContext=class extends M{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){let e=t.getStrokeScaleEnabled();if(!e){this.save();let t=this.getCanvas().getPixelRatio();this.setTransform(t,0,0,t,0,0)}this._applyLineCap(t);let r=t.hitStrokeWidth(),n="auto"===r?t.strokeWidth():r;this.setAttr("lineWidth",n),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}};class T{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let r=(e||{}).pixelRatio||f.Konva.pixelRatio||function(){if(t)return t;let e=p.Util.createCanvasElement(),r=e.getContext("2d");return t=(f.Konva._global.devicePixelRatio||1)/(r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1),p.Util.releaseCanvas(e),t}();this.pixelRatio=r,this._canvas=p.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){let e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";let e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";let e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch(t){try{return this._canvas.toDataURL()}catch(t){return p.Util.error("Unable to get data URL. "+t.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}A.Canvas=T,E.Factory.addGetterSetter(T,"pixelRatio",void 0,(0,C.getNumberValidator)()),A.SceneCanvas=class extends T{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new F.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}},A.HitCanvas=class extends T{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new F.HitContext(this),this.setSize(t.width,t.height)}};var B={};Object.defineProperty(B,"__esModule",{value:!0}),B.DD=void 0,B.DD={get isDragging(){let t=!1;return B.DD._dragElements.forEach(e=>{"dragging"===e.dragStatus&&(t=!0)}),t},justDragged:!1,get node(){let t;return B.DD._dragElements.forEach(e=>{t=e.node}),t},_dragElements:new Map,_drag(t){let e=[];B.DD._dragElements.forEach((r,n)=>{let{node:i}=r,a=i.getStage();a.setPointersPositions(t),void 0===r.pointerId&&(r.pointerId=p.Util._getFirstPointerId(t));let o=a._changedPointerPositions.find(t=>t.id===r.pointerId);if(o){if("dragging"!==r.dragStatus){let e=i.dragDistance();if(Math.max(Math.abs(o.x-r.startPointerPos.x),Math.abs(o.y-r.startPointerPos.y))<e||(i.startDrag({evt:t}),!i.isDragging()))return}i._setDragPosition(t,r),e.push(i)}}),e.forEach(e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:t},!0)})},_endDragBefore(t){let e=[];B.DD._dragElements.forEach(r=>{let{node:n}=r,i=n.getStage();if(t&&i.setPointersPositions(t),!i._changedPointerPositions.find(t=>t.id===r.pointerId))return;("dragging"===r.dragStatus||"stopped"===r.dragStatus)&&(B.DD.justDragged=!0,f.Konva._mouseListenClick=!1,f.Konva._touchListenClick=!1,f.Konva._pointerListenClick=!1,r.dragStatus="stopped");let a=r.node.getLayer()||r.node instanceof f.Konva.Stage&&r.node;a&&-1===e.indexOf(a)&&e.push(a)}),e.forEach(t=>{t.draw()})},_endDragAfter(t){B.DD._dragElements.forEach((e,r)=>{"stopped"===e.dragStatus&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:t},!0),"dragging"!==e.dragStatus&&B.DD._dragElements.delete(r)})}},f.Konva.isBrowser&&(window.addEventListener("mouseup",B.DD._endDragBefore,!0),window.addEventListener("touchend",B.DD._endDragBefore,!0),window.addEventListener("touchcancel",B.DD._endDragBefore,!0),window.addEventListener("mousemove",B.DD._drag),window.addEventListener("touchmove",B.DD._drag),window.addEventListener("mouseup",B.DD._endDragAfter,!1),window.addEventListener("touchend",B.DD._endDragAfter,!1),window.addEventListener("touchcancel",B.DD._endDragAfter,!1));const O="absoluteOpacity",k="allEventListeners",P="absoluteTransform",R="absoluteScale",I="canvas",z="listening",U="mouseenter",L="mouseleave",G="Shape",q="stage",j="transform",V="visible";let H=1;class Y{constructor(t){this._id=H++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===j||t===P)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){let r=this._cache.get(t),n=t===j||t===P;return(void 0===r||n&&!0===r.dirty)&&(r=e.call(this),this._cache.set(t,r)),r}_calculate(t,e,r){if(!this._attachedDepsListeners.get(t)){let r=e.map(t=>t+"Change.konva").join(" ");this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,r)}_getCanvasCache(){return this._cache.get(I)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===P&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(I)){let{scene:t,filter:e,hit:r}=this._cache.get(I);p.Util.releaseCanvas(t,e,r),this._cache.delete(I)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){let e=t||{},r={};(void 0===e.x||void 0===e.y||void 0===e.width||void 0===e.height)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let n=Math.ceil(e.width||r.width),i=Math.ceil(e.height||r.height),a=e.pixelRatio,o=void 0===e.x?Math.floor(r.x):e.x,s=void 0===e.y?Math.floor(r.y):e.y,u=e.offset||0,l=e.drawBorder||!1,h=e.hitCanvasPixelRatio||1;if(!n||!i){p.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}let c=Math.abs(Math.round(r.x)-o)>.5?1:0,f=Math.abs(Math.round(r.y)-s)>.5?1:0;n+=2*u+c,i+=2*u+f,o-=u,s-=u;let d=new A.SceneCanvas({pixelRatio:a,width:n,height:i}),g=new A.SceneCanvas({pixelRatio:a,width:0,height:0,willReadFrequently:!0}),m=new A.HitCanvas({pixelRatio:h,width:n,height:i}),v=d.getContext(),y=m.getContext();return m.isCache=!0,d.isCache=!0,this._cache.delete(I),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(d.getContext()._context.imageSmoothingEnabled=!1,g.getContext()._context.imageSmoothingEnabled=!1),v.save(),y.save(),v.translate(-o,-s),y.translate(-o,-s),this._isUnderCache=!0,this._clearSelfAndDescendantCache(O),this._clearSelfAndDescendantCache(R),this.drawScene(d,this),this.drawHit(m,this),this._isUnderCache=!1,v.restore(),y.restore(),l&&(v.save(),v.beginPath(),v.rect(0,0,n,i),v.closePath(),v.setAttr("strokeStyle","red"),v.setAttr("lineWidth",5),v.stroke(),v.restore()),this._cache.set(I,{scene:d,filter:g,hit:m,x:o,y:s}),this._requestDraw(),this}isCached(){return this._cache.has(I)}getClientRect(t){throw Error('abstract "getClientRect" method call')}_transformedRect(t,e){let r=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],n=1/0,i=1/0,a=-1/0,o=-1/0,s=this.getAbsoluteTransform(e);return r.forEach(function(t){let e=s.point(t);void 0===n&&(n=a=e.x,i=o=e.y),n=Math.min(n,e.x),i=Math.min(i,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y)}),{x:n,y:i,width:a-n,height:o-i}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);let e=this._getCanvasCache();t.translate(e.x,e.y);let r=this._getCachedSceneCanvas(),n=r.pixelRatio;t.drawImage(r._canvas,0,0,r.width/n,r.height/n),t.restore()}_drawCachedHitCanvas(t){let e=this._getCanvasCache(),r=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),e=this._getCanvasCache(),r=e.scene,n=e.filter,i=n.getContext(),a,o,s,u;if(t){if(!this._filterUpToDate){let e=r.pixelRatio;n.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(a=t.length,i.clear(),i.drawImage(r._canvas,0,0,r.getWidth()/e,r.getHeight()/e),o=i.getImageData(0,0,n.getWidth(),n.getHeight()),s=0;s<a;s++){if(u=t[s],"function"!=typeof u){p.Util.error("Filter should be type of function, but got "+typeof u+" instead. Please check correct filters");continue}u.call(this,o),i.putImageData(o,0,0)}}catch(t){p.Util.error("Unable to apply filter. "+t.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return n}return r}on(t,e){if(this._cache&&this._cache.delete(k),3==arguments.length)return this._delegate.apply(this,arguments);let r=t.split(" "),n=r.length,i,a,o,s;for(i=0;i<n;i++)o=(a=r[i].split("."))[0],s=a[1]||"",this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:s,handler:e});return this}off(t,e){let r=(t||"").split(" "),n=r.length,i,a,o,s,u;if(this._cache&&this._cache.delete(k),!t)for(a in this.eventListeners)this._off(a);for(i=0;i<n;i++)if(s=(o=r[i].split("."))[0],u=o[1],s)this.eventListeners[s]&&this._off(s,u,e);else for(a in this.eventListeners)this._off(a,u,e);return this}dispatchEvent(t){let e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(t){e.call(this,t.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,r){let n=this;this.on(t,function(t){let i=t.target.findAncestors(e,!0,n);for(let e=0;e<i.length;e++)(t=p.Util.cloneObject(t)).currentTarget=i[e],r.call(i[e],t)})}remove(){return this.isDragging()&&this.stopDrag(),B.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(P),this._clearSelfAndDescendantCache(O),this._clearSelfAndDescendantCache(R),this._clearSelfAndDescendantCache(q),this._clearSelfAndDescendantCache(V),this._clearSelfAndDescendantCache(z)}_remove(){this._clearCaches();let t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){let e="get"+p.Util._capitalize(t);return p.Util._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){let t=this.getParent(),e=[];for(;t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let e,r;if(!t)return this;for(e in t)"children"!==e&&(r="set"+p.Util._capitalize(e),p.Util._isFunction(this[r])?this[r](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(z,this._isListening)}_isListening(t){if(!this.listening())return!1;let e=this.getParent();return!e||e===t||this===t||e._isListening(t)}isVisible(){return this._getCache(V,this._isVisible)}_isVisible(t){if(!this.visible())return!1;let e=this.getParent();return!e||e===t||this===t||e._isVisible(t)}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);let r=this.getLayer(),n=!1;B.DD._dragElements.forEach(t=>{"dragging"===t.dragStatus&&("Stage"===t.node.nodeType?n=!0:t.node.getLayer()===r&&(n=!0))});let i=!e&&!f.Konva.hitOnDragEnabled&&(n||f.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!i}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),e=this,r=0,n,i,a,o,s=this.getStage();return"Stage"!==e.nodeType&&s&&function s(u){for(a=0,n=[],i=u.length;a<i;a++)o=u[a],r++,o.nodeType!==G&&(n=n.concat(o.getChildren().slice())),o._id===e._id&&(a=i);n.length>0&&n[0].getDepth()<=t&&s(n)}(s.getChildren()),r}getDepth(){let t=0,e=this.parent;for(;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(j),this._clearSelfAndDescendantCache(P)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let t=this.getStage();if(!t)return null;let e=t.getPointerPosition();if(!e)return null;let r=this.getAbsoluteTransform().copy();return r.invert(),r.point(e)}getAbsolutePosition(t){let e=!1,r=this.parent;for(;r;){if(r.isCached()){e=!0;break}r=r.parent}e&&!t&&(t=!0);let n=this.getAbsoluteTransform(t).getMatrix(),i=new p.Transform,a=this.offset();return i.m=n.slice(),i.translate(a.x,a.y),i.getTranslation()}setAbsolutePosition(t){let{x:e,y:r,...n}=this._clearTransform();this.attrs.x=e,this.attrs.y=r,this._clearCache(j);let i=this._getAbsoluteTransform().copy();return i.invert(),i.translate(t.x,t.y),t={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this._setTransform(n),this.setPosition({x:t.x,y:t.y}),this._clearCache(j),this._clearSelfAndDescendantCache(P),this}_setTransform(t){let e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){let t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let e=t.x,r=t.y,n=this.x(),i=this.y();return void 0!==e&&(n+=e),void 0!==r&&(i+=r),this.setPosition({x:n,y:i}),this}_eachAncestorReverse(t,e){let r=[],n=this.getParent(),i,a;if(!e||e._id!==this._id){for(r.unshift(this);n&&(!e||n._id!==e._id);)r.unshift(n),n=n.parent;for(a=0,i=r.length;a<i;a++)t(r[a])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return p.Util.warn("Node has no parent. moveToTop function is ignored."),!1;let t=this.index;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0)}moveUp(){if(!this.parent)return p.Util.warn("Node has no parent. moveUp function is ignored."),!1;let t=this.index;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return p.Util.warn("Node has no parent. moveDown function is ignored."),!1;let t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return p.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;let t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(t){if(!this.parent)return p.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&p.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");let e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(O,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),e,r,n,i,a={attrs:{},className:this.getClassName()};for(e in t)r=t[e],(!p.Util.isObject(r)||p.Util._isPlainObject(r)||p.Util._isArray(r))&&(n="function"==typeof this[e]&&this[e],delete t[e],i=n?n.call(this):null,t[e]=r,i!==r&&(a.attrs[e]=r));return p.Util._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,r){let n=[];e&&this._isMatch(t)&&n.push(this);let i=this.parent;for(;i&&i!==r;)i._isMatch(t)&&n.push(i),i=i.parent;return n}isAncestorOf(t){return!1}findAncestor(t,e,r){return this.findAncestors(t,e,r)[0]}_isMatch(t){if(!t)return!1;if("function"==typeof t)return t(this);let e=t.replace(/ /g,"").split(","),r=e.length,n,i;for(n=0;n<r;n++)if(i=e[n],p.Util.isValidSelector(i)||(p.Util.warn('Selector "'+i+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),p.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),p.Util.warn("Konva is awesome, right?")),"#"===i.charAt(0)){if(this.id()===i.slice(1))return!0}else if("."===i.charAt(0)){if(this.hasName(i.slice(1)))return!0}else if(this.className===i||this.nodeType===i)return!0;return!1}getLayer(){let t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(q,this._getStage)}_getStage(){let t=this.getParent();return t?t.getStage():null}fire(t,e={},r){return e.target=e.target||this,r?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(P,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let e;if(t)return e=new p.Transform,this._eachAncestorReverse(function(t){let r=t.transformsEnabled();"all"===r?e.multiply(t.getTransform()):"position"===r&&e.translate(t.x()-t.offsetX(),t.y()-t.offsetY())},t),e;{e=this._cache.get(P)||new p.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();let t=this.transformsEnabled();if("all"===t)e.multiply(this.getTransform());else if("position"===t){let t=this.attrs.x||0,r=this.attrs.y||0,n=this.attrs.offsetX||0,i=this.attrs.offsetY||0;e.translate(t-n,r-i)}return e.dirty=!1,e}}getAbsoluteScale(t){let e=this;for(;e;)e._isUnderCache&&(t=e),e=e.getParent();let r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(j,this._getTransform)}_getTransform(){var t,e;let r=this._cache.get(j)||new p.Transform;r.reset();let n=this.x(),i=this.y(),a=f.Konva.getAngle(this.rotation()),o=null!==(t=this.attrs.scaleX)&&void 0!==t?t:1,s=null!==(e=this.attrs.scaleY)&&void 0!==e?e:1,u=this.attrs.skewX||0,l=this.attrs.skewY||0,h=this.attrs.offsetX||0,c=this.attrs.offsetY||0;return(0!==n||0!==i)&&r.translate(n,i),0!==a&&r.rotate(a),(0!==u||0!==l)&&r.skew(u,l),(1!==o||1!==s)&&r.scale(o,s),(0!==h||0!==c)&&r.translate(-1*h,-1*c),r.dirty=!1,r}clone(t){let e=p.Util.cloneObject(this.attrs),r,n,i,a,o;for(r in t)e[r]=t[r];let s=new this.constructor(e);for(r in this.eventListeners)for(a=0,i=(n=this.eventListeners[r]).length;a<i;a++)0>(o=n[a]).name.indexOf("konva")&&(s.eventListeners[r]||(s.eventListeners[r]=[]),s.eventListeners[r].push(o));return s}_toKonvaCanvas(t){t=t||{};let e=this.getClientRect(),r=this.getStage(),n=void 0!==t.x?t.x:Math.floor(e.x),i=void 0!==t.y?t.y:Math.floor(e.y),a=t.pixelRatio||1,o=new A.SceneCanvas({width:t.width||Math.ceil(e.width)||(r?r.width():0),height:t.height||Math.ceil(e.height)||(r?r.height():0),pixelRatio:a}),s=o.getContext(),u=new A.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(n),height:o.height/o.pixelRatio+Math.abs(i),pixelRatio:o.pixelRatio});return!1===t.imageSmoothingEnabled&&(s._context.imageSmoothingEnabled=!1),s.save(),(n||i)&&s.translate(-1*n,-1*i),this.drawScene(o,void 0,u),s.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){let e=(t=t||{}).mimeType||null,r=t.quality||null,n=this._toKonvaCanvas(t).toDataURL(e,r);return t.callback&&t.callback(n),n}toImage(t){return new Promise((e,r)=>{try{let r=null==t?void 0:t.callback;r&&delete t.callback,p.Util._urlToImage(this.toDataURL(t),function(t){e(t),null==r||r(t)})}catch(t){r(t)}})}toBlob(t){return new Promise((e,r)=>{try{let r=null==t?void 0:t.callback;r&&delete t.callback,this.toCanvas(t).toBlob(t=>{e(t),null==r||r(t)},null==t?void 0:t.mimeType,null==t?void 0:t.quality)}catch(t){r(t)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():f.Konva.dragDistance}_off(t,e,r){let n=this.eventListeners[t],i,a,o;for(i=0;i<n.length;i++)if(a=n[i].name,o=n[i].handler,("konva"!==a||"konva"===e)&&(!e||a===e)&&(!r||r===o)){if(n.splice(i,1),0===n.length){delete this.eventListeners[t];break}i--}}_fireChangeEvent(t,e,r){this._fire(t+"Change",{oldVal:e,newVal:r})}addName(t){if(!this.hasName(t)){let e=this.name();this.name(e?e+" "+t:t)}return this}hasName(t){if(!t)return!1;let e=this.name();return!!e&&-1!==(e||"").split(/\s/g).indexOf(t)}removeName(t){let e=(this.name()||"").split(/\s/g),r=e.indexOf(t);return -1!==r&&(e.splice(r,1),this.name(e.join(" "))),this}setAttr(t,e){let r=this["set"+p.Util._capitalize(t)];return p.Util._isFunction(r)?r.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(f.Konva.autoDrawEnabled){let t=this.getLayer()||this.getStage();null==t||t.batchDraw()}}_setAttr(t,e){let r=this.attrs[t];(r!==e||p.Util.isObject(e))&&(null==e?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,r,e),this._requestDraw())}_setComponentAttr(t,e,r){let n;void 0!==r&&((n=this.attrs[t])||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=r,this._fireChangeEvent(t,n,r))}_fireAndBubble(t,e,r){if(e&&this.nodeType===G&&(e.target=this),!((t===U||t===L)&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||"Stage"===this.nodeType&&!r))){this._fire(t,e);let n=(t===U||t===L)&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!n&&(r&&r.parent?this._fireAndBubble.call(this.parent,t,e,r):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,r,n;let i=null!==(e=this._cache.get(k))&&void 0!==e?e:{},a=null==i?void 0:i[t];if(void 0===a){a=[];let e=Object.getPrototypeOf(this);for(;e;){let i=null!==(n=null===(r=e.eventListeners)||void 0===r?void 0:r[t])&&void 0!==n?n:[];a.push(...i),e=Object.getPrototypeOf(e)}i[t]=a,this._cache.set(k,i)}return a}_fire(t,e){(e=e||{}).currentTarget=this,e.type=t;let r=this._getProtoListeners(t);if(r)for(var n=0;n<r.length;n++)r[n].handler.call(this,e);let i=this.eventListeners[t];if(i)for(var n=0;n<i.length;n++)i[n].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){let e=t?t.pointerId:void 0,r=this.getStage(),n=this.getAbsolutePosition();if(!r)return;let i=r._getPointerById(e)||r._changedPointerPositions[0]||n;B.DD._dragElements.set(this._id,{node:this,startPointerPos:i,offset:{x:i.x-n.x,y:i.y-n.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){B.DD._dragElements.has(this._id)||this._createDragElement(t),B.DD._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){let r=this.getStage()._getPointerById(e.pointerId);if(!r)return;let n={x:r.x-e.offset.x,y:r.y-e.offset.y},i=this.dragBoundFunc();if(void 0!==i){let e=i.call(this,n,t);e?n=e:p.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===n.x&&this._lastPos.y===n.y||(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}stopDrag(t){let e=B.DD._dragElements.get(this._id);e&&(e.dragStatus="stopped"),B.DD._endDragBefore(t),B.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){let t=B.DD._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(void 0!==t.evt.button)||f.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let e=!1;B.DD._dragElements.forEach(t=>{this.isAncestorOf(t.node)&&(e=!0)}),e||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;let t=B.DD._dragElements.get(this._id),e=t&&"dragging"===t.dragStatus,r=t&&"ready"===t.dragStatus;e?this.stopDrag():r&&B.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){let e=this.getStage();if(!e)return!1;let r={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return p.Util.haveIntersection(r,this.getClientRect())}static create(t,e){return p.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){let r=Y.prototype.getClassName.call(t),n=t.children,i,a,o;if(e&&(t.attrs.container=e),f.Konva[r]||(p.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape"),i=new f.Konva[r](t.attrs),n)for(o=0,a=n.length;o<a;o++)i.add(Y._createNode(n[o]));return i}}w.Node=Y,Y.prototype.nodeType="Node",Y.prototype._attrsAffectingSize=[],Y.prototype.eventListeners={},Y.prototype.on.call(Y.prototype,"xChange.konva yChange.konva scaleXChange.konva scaleYChange.konva skewXChange.konva skewYChange.konva rotationChange.konva offsetXChange.konva offsetYChange.konva transformsEnabledChange.konva",function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(j),this._clearSelfAndDescendantCache(P)}),Y.prototype.on.call(Y.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(V)}),Y.prototype.on.call(Y.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(z)}),Y.prototype.on.call(Y.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(O)});const W=E.Factory.addGetterSetter;W(Y,"zIndex"),W(Y,"absolutePosition"),W(Y,"position"),W(Y,"x",0,(0,C.getNumberValidator)()),W(Y,"y",0,(0,C.getNumberValidator)()),W(Y,"globalCompositeOperation","source-over",(0,C.getStringValidator)()),W(Y,"opacity",1,(0,C.getNumberValidator)()),W(Y,"name","",(0,C.getStringValidator)()),W(Y,"id","",(0,C.getStringValidator)()),W(Y,"rotation",0,(0,C.getNumberValidator)()),E.Factory.addComponentsGetterSetter(Y,"scale",["x","y"]),W(Y,"scaleX",1,(0,C.getNumberValidator)()),W(Y,"scaleY",1,(0,C.getNumberValidator)()),E.Factory.addComponentsGetterSetter(Y,"skew",["x","y"]),W(Y,"skewX",0,(0,C.getNumberValidator)()),W(Y,"skewY",0,(0,C.getNumberValidator)()),E.Factory.addComponentsGetterSetter(Y,"offset",["x","y"]),W(Y,"offsetX",0,(0,C.getNumberValidator)()),W(Y,"offsetY",0,(0,C.getNumberValidator)()),W(Y,"dragDistance",null,(0,C.getNumberValidator)()),W(Y,"width",0,(0,C.getNumberValidator)()),W(Y,"height",0,(0,C.getNumberValidator)()),W(Y,"listening",!0,(0,C.getBooleanValidator)()),W(Y,"preventDefault",!0,(0,C.getBooleanValidator)()),W(Y,"filters",null,function(t){return this._filterUpToDate=!1,t}),W(Y,"visible",!0,(0,C.getBooleanValidator)()),W(Y,"transformsEnabled","all",(0,C.getStringValidator)()),W(Y,"size"),W(Y,"dragBoundFunc"),W(Y,"draggable",!1,(0,C.getBooleanValidator)()),E.Factory.backCompat(Y,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var $={};Object.defineProperty($,"__esModule",{value:!0}),$.Container=void 0;class K extends w.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];let e=this.children||[],r=[];return e.forEach(function(e){t(e)&&r.push(e)}),r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(0===t.length)return this;if(t.length>1){for(let e=0;e<t.length;e++)this.add(t[e]);return this}let e=t[0];return e.getParent()?e.moveTo(this):(this._validateAdd(e),e.index=this.getChildren().length,e.parent=this,e._clearCaches(),this.getChildren().push(e),this._fire("add",{child:e}),this._requestDraw()),this}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){let e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){let r=[];return this._descendants(n=>{let i=n._isMatch(t);return i&&r.push(n),!!i&&!!e}),r}_descendants(t){for(let e of this.getChildren())if(t(e)||e.hasChildren()&&e._descendants(t))return!0;return!1}toObject(){let t=w.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){let e=t.getParent();for(;e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){let e=w.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(t){e.add(t.clone())}),e}getAllIntersections(t){let e=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(t)&&e.push(r)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),this.isCached()||null===(e=this.children)||void 0===e||e.forEach(function(e){e._clearSelfAndDescendantCache(t)})}_setChildrenIndices(){var t;null===(t=this.children)||void 0===t||t.forEach(function(t,e){t.index=e}),this._requestDraw()}drawScene(t,e,r){let n=this.getLayer(),i=t||n&&n.getCanvas(),a=i&&i.getContext(),o=this._getCanvasCache(),s=o&&o.scene,u=i&&i.isCache;if(!this.isVisible()&&!u)return this;if(s){a.save();let t=this.getAbsoluteTransform(e).getMatrix();a.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this._drawCachedSceneCanvas(a),a.restore()}else this._drawChildren("drawScene",i,e,r);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;let r=this.getLayer(),n=t||r&&r.hitCanvas,i=n&&n.getContext(),a=this._getCanvasCache();if(a&&a.hit){i.save();let t=this.getAbsoluteTransform(e).getMatrix();i.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this._drawCachedHitCanvas(i),i.restore()}else this._drawChildren("drawHit",n,e);return this}_drawChildren(t,e,r,n){var i;let a=e&&e.getContext(),o=this.clipWidth(),s=this.clipHeight(),u=this.clipFunc(),l="number"==typeof o&&"number"==typeof s||u,h=r===this;if(l){let t;a.save();let e=this.getAbsoluteTransform(r),n=e.getMatrix();if(a.transform(n[0],n[1],n[2],n[3],n[4],n[5]),a.beginPath(),u)t=u.call(this,a,this);else{let t=this.clipX(),e=this.clipY();a.rect(t||0,e||0,o,s)}a.clip.apply(a,t),n=e.copy().invert().getMatrix(),a.transform(n[0],n[1],n[2],n[3],n[4],n[5])}let c=!h&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===t;c&&(a.save(),a._applyGlobalCompositeOperation(this)),null===(i=this.children)||void 0===i||i.forEach(function(i){i[t](e,r,n)}),c&&a.restore(),l&&a.restore()}getClientRect(t={}){var e;let r,n,i,a;let o=t.skipTransform,s=t.relativeTo,u={x:1/0,y:1/0,width:0,height:0},l=this;null===(e=this.children)||void 0===e||e.forEach(function(e){if(!e.visible())return;let o=e.getClientRect({relativeTo:l,skipShadow:t.skipShadow,skipStroke:t.skipStroke});(0!==o.width||0!==o.height)&&(void 0===r?(r=o.x,n=o.y,i=o.x+o.width,a=o.y+o.height):(r=Math.min(r,o.x),n=Math.min(n,o.y),i=Math.max(i,o.x+o.width),a=Math.max(a,o.y+o.height)))});let h=this.find("Shape"),c=!1;for(let t=0;t<h.length;t++)if(h[t]._isVisible(this)){c=!0;break}return(u=c&&void 0!==r?{x:r,y:n,width:i-r,height:a-n}:{x:0,y:0,width:0,height:0},o)?u:this._transformedRect(u,s)}}$.Container=K,E.Factory.addComponentsGetterSetter(K,"clip",["x","y","width","height"]),E.Factory.addGetterSetter(K,"clipX",void 0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(K,"clipY",void 0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(K,"clipWidth",void 0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(K,"clipHeight",void 0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(K,"clipFunc");var X={};Object.defineProperty(X,"__esModule",{value:!0}),X.Stage=X.stages=void 0;var Z={};Object.defineProperty(Z,"__esModule",{value:!0}),Z.getCapturedShape=function(t){return J.get(t)},Z.createEvent=tt,Z.hasPointerCapture=function(t,e){return J.get(t)===e},Z.setPointerCapture=function(t,e){te(t),e.getStage()&&(J.set(t,e),Q&&e._fire("gotpointercapture",tt(new PointerEvent("gotpointercapture"))))},Z.releaseCapture=te;const J=new Map,Q=void 0!==f.Konva._global.PointerEvent;function tt(t){return{evt:t,pointerId:t.pointerId}}function te(t,e){let r=J.get(t);if(!r)return;let n=r.getStage();n&&n.content,J.delete(t),Q&&r._fire("lostpointercapture",tt(new PointerEvent("lostpointercapture")))}const tr="mouseleave",tn="mouseover",ti="mouseenter",ta="mousemove",to="mousedown",ts="mouseup",tu="pointermove",tl="pointerdown",th="pointerup",tc="pointercancel",tf="pointerout",td="pointerleave",tp="pointerover",tg="pointerenter",tm="contextmenu",tv="touchstart",ty="touchend",tx="touchmove",tb="touchcancel",tD="wheel",t_=[[ti,"_pointerenter"],[to,"_pointerdown"],[ta,"_pointermove"],[ts,"_pointerup"],[tr,"_pointerleave"],[tv,"_pointerdown"],[tx,"_pointermove"],[ty,"_pointerup"],[tb,"_pointercancel"],[tn,"_pointerover"],[tD,"_wheel"],[tm,"_contextmenu"],[tl,"_pointerdown"],[tu,"_pointermove"],[th,"_pointerup"],[tc,"_pointercancel"],["lostpointercapture","_lostpointercapture"]],tw={mouse:{[tf]:"mouseout",[td]:tr,[tp]:tn,[tg]:ti,[tu]:ta,[tl]:to,[th]:ts,[tc]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[tf]:"touchout",[td]:"touchleave",[tp]:"touchover",[tg]:"touchenter",[tu]:tx,[tl]:tv,[th]:ty,[tc]:tb,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[tf]:tf,[td]:td,[tp]:tp,[tg]:tg,[tu]:tu,[tl]:tl,[th]:th,[tc]:tc,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},tE=t=>t.indexOf("pointer")>=0?"pointer":t.indexOf("touch")>=0?"touch":"mouse",tC=t=>{let e=tE(t);return"pointer"===e?f.Konva.pointerEventsEnabled&&tw.pointer:"touch"===e?tw.touch:"mouse"===e?tw.mouse:void 0};function tS(t={}){return(t.clipFunc||t.clipWidth||t.clipHeight)&&p.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}X.stages=[];class tA extends $.Container{constructor(t){super(tS(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),X.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{tS(this.attrs)}),this._checkVisibility()}_validateAdd(t){let e="Layer"===t.getType(),r="FastLayer"===t.getType();e||r||p.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;let t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if("string"==typeof t){if("."===t.charAt(0)){let e=t.slice(1);t=document.getElementsByClassName(e)[0]}else{var e;e="#"!==t.charAt(0)?t:t.slice(1),t=document.getElementById(e)}if(!t)throw"Can not find container in document with id "+e}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let t=this.children,e=t.length,r;for(r=0;r<e;r++)t[r].clear();return this}clone(t){return t||(t={}),t.container="undefined"!=typeof document&&document.createElement("div"),$.Container.prototype.clone.call(this,t)}destroy(){super.destroy();let t=this.content;t&&p.Util._isInDocument(t)&&this.container().removeChild(t);let e=X.stages.indexOf(this);return e>-1&&X.stages.splice(e,1),p.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(p.Util.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)}_getPointerById(t){return this._pointerPositions.find(e=>e.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){(t=t||{}).x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();let e=new A.SceneCanvas({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),r=e.getContext()._context,n=this.children;return(t.x||t.y)&&r.translate(-1*t.x,-1*t.y),n.forEach(function(e){if(!e.isVisible())return;let n=e._toKonvaCanvas(t);r.drawImage(n._canvas,t.x,t.y,n.getWidth()/n.getPixelRatio(),n.getHeight()/n.getPixelRatio())}),e}getIntersection(t){if(!t)return null;let e=this.children,r;for(r=e.length-1;r>=0;r--){let n=e[r].getIntersection(t);if(n)return n}return null}_resizeDOM(){let t=this.width(),e=this.height();this.content&&(this.content.style.width=t+"px",this.content.style.height=e+"px"),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach(r=>{r.setSize({width:t,height:e}),r.draw()})}add(t,...e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}super.add(t);let r=this.children.length;return r>5&&p.Util.warn("The stage has "+r+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),f.Konva.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Z.hasPointerCapture(t,this)}setPointerCapture(t){Z.setPointerCapture(t,this)}releaseCapture(t){Z.releaseCapture(t,this)}getLayers(){return this.children}_bindContentEvents(){f.Konva.isBrowser&&t_.forEach(([t,e])=>{this.content.addEventListener(t,t=>{this[e](t)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);let e=tC(t.type);e&&this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);let e=tC(t.type);e&&this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){let e=tC(t.type),r=tE(t.type);if(!e)return;this.setPointersPositions(t);let n=this._getTargetShape(r),i=!(f.Konva.isDragging()||f.Konva.isTransforming())||f.Konva.hitOnDragEnabled;n&&i?(n._fireAndBubble(e.pointerout,{evt:t}),n._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[r+"targetShape"]=null):i&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){let e=tC(t.type),r=tE(t.type);if(!e)return;this.setPointersPositions(t);let n=!1;this._changedPointerPositions.forEach(i=>{let a=this.getIntersection(i);if(B.DD.justDragged=!1,f.Konva["_"+r+"ListenClick"]=!0,!a||!a.isListening()){this[r+"ClickStartShape"]=void 0;return}f.Konva.capturePointerEventsEnabled&&a.setPointerCapture(i.id),this[r+"ClickStartShape"]=a,a._fireAndBubble(e.pointerdown,{evt:t,pointerId:i.id}),n=!0;let o=t.type.indexOf("touch")>=0;a.preventDefault()&&t.cancelable&&o&&t.preventDefault()}),n||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){let e=tC(t.type),r=tE(t.type);if(!e||(f.Konva.isDragging()&&B.DD.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t),!(!(f.Konva.isDragging()||f.Konva.isTransforming())||f.Konva.hitOnDragEnabled)))return;let n={},i=!1,a=this._getTargetShape(r);this._changedPointerPositions.forEach(o=>{let s=Z.getCapturedShape(o.id)||this.getIntersection(o),u=o.id,l={evt:t,pointerId:u},h=a!==s;if(h&&a&&(a._fireAndBubble(e.pointerout,{...l},s),a._fireAndBubble(e.pointerleave,{...l},s)),s){if(n[s._id])return;n[s._id]=!0}s&&s.isListening()?(i=!0,h&&(s._fireAndBubble(e.pointerover,{...l},a),s._fireAndBubble(e.pointerenter,{...l},a),this[r+"targetShape"]=s),s._fireAndBubble(e.pointermove,{...l})):a&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:u}),this[r+"targetShape"]=null)}),i||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){let e=tC(t.type),r=tE(t.type);if(!e)return;this.setPointersPositions(t);let n=this[r+"ClickStartShape"],i=this[r+"ClickEndShape"],a={},o=!1;this._changedPointerPositions.forEach(s=>{let u=Z.getCapturedShape(s.id)||this.getIntersection(s);if(u){if(u.releaseCapture(s.id),a[u._id])return;a[u._id]=!0}let l=s.id,h={evt:t,pointerId:l},c=!1;f.Konva["_"+r+"InDblClickWindow"]?(c=!0,clearTimeout(this[r+"DblTimeout"])):B.DD.justDragged||(f.Konva["_"+r+"InDblClickWindow"]=!0,clearTimeout(this[r+"DblTimeout"])),this[r+"DblTimeout"]=setTimeout(function(){f.Konva["_"+r+"InDblClickWindow"]=!1},f.Konva.dblClickWindow),u&&u.isListening()?(o=!0,this[r+"ClickEndShape"]=u,u._fireAndBubble(e.pointerup,{...h}),f.Konva["_"+r+"ListenClick"]&&n&&n===u&&(u._fireAndBubble(e.pointerclick,{...h}),c&&i&&i===u&&u._fireAndBubble(e.pointerdblclick,{...h}))):(this[r+"ClickEndShape"]=null,f.Konva["_"+r+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:l}),c&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:l}))}),o||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),f.Konva["_"+r+"ListenClick"]=!1,t.cancelable&&"touch"!==r&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);let e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(tm,{evt:t}):this._fire(tm,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);let e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(tD,{evt:t}):this._fire(tD,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);let e=Z.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(th,Z.createEvent(t)),Z.releaseCapture(t.pointerId)}_lostpointercapture(t){Z.releaseCapture(t.pointerId)}setPointersPositions(t){let e=this._getContentPosition(),r=null,n=null;void 0!==(t=t||window.event).touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,t=>{this._pointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,t=>{this._changedPointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})})):(r=(t.clientX-e.left)/e.scaleX,n=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:r,y:n},this._pointerPositions=[{x:r,y:n,id:p.Util._getFirstPointerId(t)}],this._changedPointerPositions=[{x:r,y:n,id:p.Util._getFirstPointerId(t)}])}_setPointerPosition(t){p.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new A.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new A.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!f.Konva.isBrowser)return;let t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return p.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}}X.Stage=tA,tA.prototype.nodeType="Stage",(0,f._registerNode)(tA),E.Factory.addGetterSetter(tA,"container"),f.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{X.stages.forEach(t=>{t.batchDraw()})});var tF={};Object.defineProperty(tF,"__esModule",{value:!0}),tF.Layer=void 0;var tN={};Object.defineProperty(tN,"__esModule",{value:!0}),tN.Shape=tN.shapes=void 0;const tM="hasShadow",tT="shadowRGBA",tB="patternImage",tO="linearGradient",tk="radialGradient";function tP(){return e||(e=p.Util.createCanvasElement().getContext("2d"))}tN.shapes={};class tR extends w.Node{constructor(t){let e;for(super(t);!(e=p.Util.getRandomColor())||e in tN.shapes;);this.colorKey=e,tN.shapes[e]=this}getContext(){return p.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return p.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(tM,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(tB,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let t=tP().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(t&&t.setTransform){let e=new p.Transform;e.translate(this.fillPatternX(),this.fillPatternY()),e.rotate(f.Konva.getAngle(this.fillPatternRotation())),e.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),e.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let r=e.getMatrix(),n="undefined"==typeof DOMMatrix?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);t.setTransform(n)}return t}}_getLinearGradient(){return this._getCache(tO,this.__getLinearGradient)}__getLinearGradient(){let t=this.fillLinearGradientColorStops();if(t){let e=tP(),r=this.fillLinearGradientStartPoint(),n=this.fillLinearGradientEndPoint(),i=e.createLinearGradient(r.x,r.y,n.x,n.y);for(let e=0;e<t.length;e+=2)i.addColorStop(t[e],t[e+1]);return i}}_getRadialGradient(){return this._getCache(tk,this.__getRadialGradient)}__getRadialGradient(){let t=this.fillRadialGradientColorStops();if(t){let e=tP(),r=this.fillRadialGradientStartPoint(),n=this.fillRadialGradientEndPoint(),i=e.createRadialGradient(r.x,r.y,this.fillRadialGradientStartRadius(),n.x,n.y,this.fillRadialGradientEndRadius());for(let e=0;e<t.length;e+=2)i.addColorStop(t[e],t[e+1]);return i}}getShadowRGBA(){return this._getCache(tT,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let t=p.Util.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let t=this.hitStrokeWidth();return"auto"===t?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){let e=this.getStage();if(!e)return!1;let r=e.bufferHitCanvas;return r.getContext().clear(),this.drawHit(r,void 0,!0),r.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return w.Node.prototype.destroy.call(this),delete tN.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!(null===(e=this.attrs.perfectDrawEnabled)||void 0===e||e))return!1;let r=t||this.hasFill(),n=this.hasStroke(),i=1!==this.getAbsoluteOpacity();if(r&&n&&i)return!0;let a=this.hasShadow(),o=this.shadowForStrokeEnabled();return!!r&&!!n&&!!a&&!!o}setStrokeHitEnabled(t){p.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){let t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let e=!1,r=this.getParent();for(;r;){if(r.isCached()){e=!0;break}r=r.getParent()}let n=t.skipTransform,i=t.relativeTo||e&&this.getStage()||void 0,a=this.getSelfRect(),o=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,s=a.width+o,u=a.height+o,l=!t.skipShadow&&this.hasShadow(),h=l?this.shadowOffsetX():0,c=l?this.shadowOffsetY():0,f=s+Math.abs(h),d=u+Math.abs(c),p=l&&this.shadowBlur()||0,g={width:f+2*p,height:d+2*p,x:-(o/2+p)+Math.min(h,0)+a.x,y:-(o/2+p)+Math.min(c,0)+a.y};return n?g:this._transformedRect(g,i)}drawScene(t,e,r){let n=this.getLayer(),i=t||n.getCanvas(),a=i.getContext(),o=this._getCanvasCache(),s=this.getSceneFunc(),u=this.hasShadow(),l,h,c=i.isCache,f=e===this;if(!this.isVisible()&&!f)return this;if(o){a.save();let t=this.getAbsoluteTransform(e).getMatrix();return a.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this._drawCachedSceneCanvas(a),a.restore(),this}if(!s)return this;if(a.save(),this._useBufferCanvas()&&!c){l=this.getStage();let t=r||l.bufferCanvas;(h=t.getContext()).clear(),h.save(),h._applyLineJoin(this);var d=this.getAbsoluteTransform(e).getMatrix();h.transform(d[0],d[1],d[2],d[3],d[4],d[5]),s.call(this,h,this),h.restore();let n=t.pixelRatio;u&&a._applyShadow(this),a._applyOpacity(this),a._applyGlobalCompositeOperation(this),a.drawImage(t._canvas,0,0,t.width/n,t.height/n)}else{if(a._applyLineJoin(this),!f){var d=this.getAbsoluteTransform(e).getMatrix();a.transform(d[0],d[1],d[2],d[3],d[4],d[5]),a._applyOpacity(this),a._applyGlobalCompositeOperation(this)}u&&a._applyShadow(this),s.call(this,a,this)}return a.restore(),this}drawHit(t,e,r=!1){if(!this.shouldDrawHit(e,r))return this;let n=this.getLayer(),i=t||n.hitCanvas,a=i&&i.getContext(),o=this.hitFunc()||this.sceneFunc(),s=this._getCanvasCache(),u=s&&s.hit;if(this.colorKey||p.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),u){a.save();let t=this.getAbsoluteTransform(e).getMatrix();return a.transform(t[0],t[1],t[2],t[3],t[4],t[5]),this._drawCachedHitCanvas(a),a.restore(),this}if(!o)return this;if(a.save(),a._applyLineJoin(this),this!==e){let t=this.getAbsoluteTransform(e).getMatrix();a.transform(t[0],t[1],t[2],t[3],t[4],t[5])}return o.call(this,a,this),a.restore(),this}drawHitFromCache(t=0){let e=this._getCanvasCache(),r=this._getCachedSceneCanvas(),n=e.hit,i=n.getContext(),a=n.getWidth(),o=n.getHeight(),s,u,l,h,c;i.clear(),i.drawImage(r._canvas,0,0,a,o);try{for(c=0,l=(u=(s=i.getImageData(0,0,a,o)).data).length,h=p.Util._hexToRgb(this.colorKey);c<l;c+=4)u[c+3]>t?(u[c]=h.r,u[c+1]=h.g,u[c+2]=h.b,u[c+3]=255):u[c+3]=0;i.putImageData(s,0,0)}catch(t){p.Util.error("Unable to draw hit graph from cached scene canvas. "+t.message)}return this}hasPointerCapture(t){return Z.hasPointerCapture(t,this)}setPointerCapture(t){Z.setPointerCapture(t,this)}releaseCapture(t){Z.releaseCapture(t,this)}}tN.Shape=tR,tR.prototype._fillFunc=function(t){let e=this.attrs.fillRule;e?t.fill(e):t.fill()},tR.prototype._strokeFunc=function(t){t.stroke()},tR.prototype._fillFuncHit=function(t){let e=this.attrs.fillRule;e?t.fill(e):t.fill()},tR.prototype._strokeFuncHit=function(t){t.stroke()},tR.prototype._centroid=!1,tR.prototype.nodeType="Shape",(0,f._registerNode)(tR),tR.prototype.eventListeners={},tR.prototype.on.call(tR.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",function(){this._clearCache(tM)}),tR.prototype.on.call(tR.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",function(){this._clearCache(tT)}),tR.prototype.on.call(tR.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",function(){this._clearCache(tB)}),tR.prototype.on.call(tR.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",function(){this._clearCache(tO)}),tR.prototype.on.call(tR.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",function(){this._clearCache(tk)}),E.Factory.addGetterSetter(tR,"stroke",void 0,(0,C.getStringOrGradientValidator)()),E.Factory.addGetterSetter(tR,"strokeWidth",2,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(tR,"fillAfterStrokeEnabled",!1),E.Factory.addGetterSetter(tR,"hitStrokeWidth","auto",(0,C.getNumberOrAutoValidator)()),E.Factory.addGetterSetter(tR,"strokeHitEnabled",!0,(0,C.getBooleanValidator)()),E.Factory.addGetterSetter(tR,"perfectDrawEnabled",!0,(0,C.getBooleanValidator)()),E.Factory.addGetterSetter(tR,"shadowForStrokeEnabled",!0,(0,C.getBooleanValidator)()),E.Factory.addGetterSetter(tR,"lineJoin"),E.Factory.addGetterSetter(tR,"lineCap"),E.Factory.addGetterSetter(tR,"sceneFunc"),E.Factory.addGetterSetter(tR,"hitFunc"),E.Factory.addGetterSetter(tR,"dash"),E.Factory.addGetterSetter(tR,"dashOffset",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(tR,"shadowColor",void 0,(0,C.getStringValidator)()),E.Factory.addGetterSetter(tR,"shadowBlur",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(tR,"shadowOpacity",1,(0,C.getNumberValidator)()),E.Factory.addComponentsGetterSetter(tR,"shadowOffset",["x","y"]),E.Factory.addGetterSetter(tR,"shadowOffsetX",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(tR,"shadowOffsetY",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(tR,"fillPatternImage"),E.Factory.addGetterSetter(tR,"fill",void 0,(0,C.getStringOrGradientValidator)()),E.Factory.addGetterSetter(tR,"fillPatternX",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(tR,"fillPatternY",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(tR,"fillLinearGradientColorStops"),E.Factory.addGetterSetter(tR,"strokeLinearGradientColorStops"),E.Factory.addGetterSetter(tR,"fillRadialGradientStartRadius",0),E.Factory.addGetterSetter(tR,"fillRadialGradientEndRadius",0),E.Factory.addGetterSetter(tR,"fillRadialGradientColorStops"),E.Factory.addGetterSetter(tR,"fillPatternRepeat","repeat"),E.Factory.addGetterSetter(tR,"fillEnabled",!0),E.Factory.addGetterSetter(tR,"strokeEnabled",!0),E.Factory.addGetterSetter(tR,"shadowEnabled",!0),E.Factory.addGetterSetter(tR,"dashEnabled",!0),E.Factory.addGetterSetter(tR,"strokeScaleEnabled",!0),E.Factory.addGetterSetter(tR,"fillPriority","color"),E.Factory.addComponentsGetterSetter(tR,"fillPatternOffset",["x","y"]),E.Factory.addGetterSetter(tR,"fillPatternOffsetX",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(tR,"fillPatternOffsetY",0,(0,C.getNumberValidator)()),E.Factory.addComponentsGetterSetter(tR,"fillPatternScale",["x","y"]),E.Factory.addGetterSetter(tR,"fillPatternScaleX",1,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(tR,"fillPatternScaleY",1,(0,C.getNumberValidator)()),E.Factory.addComponentsGetterSetter(tR,"fillLinearGradientStartPoint",["x","y"]),E.Factory.addComponentsGetterSetter(tR,"strokeLinearGradientStartPoint",["x","y"]),E.Factory.addGetterSetter(tR,"fillLinearGradientStartPointX",0),E.Factory.addGetterSetter(tR,"strokeLinearGradientStartPointX",0),E.Factory.addGetterSetter(tR,"fillLinearGradientStartPointY",0),E.Factory.addGetterSetter(tR,"strokeLinearGradientStartPointY",0),E.Factory.addComponentsGetterSetter(tR,"fillLinearGradientEndPoint",["x","y"]),E.Factory.addComponentsGetterSetter(tR,"strokeLinearGradientEndPoint",["x","y"]),E.Factory.addGetterSetter(tR,"fillLinearGradientEndPointX",0),E.Factory.addGetterSetter(tR,"strokeLinearGradientEndPointX",0),E.Factory.addGetterSetter(tR,"fillLinearGradientEndPointY",0),E.Factory.addGetterSetter(tR,"strokeLinearGradientEndPointY",0),E.Factory.addComponentsGetterSetter(tR,"fillRadialGradientStartPoint",["x","y"]),E.Factory.addGetterSetter(tR,"fillRadialGradientStartPointX",0),E.Factory.addGetterSetter(tR,"fillRadialGradientStartPointY",0),E.Factory.addComponentsGetterSetter(tR,"fillRadialGradientEndPoint",["x","y"]),E.Factory.addGetterSetter(tR,"fillRadialGradientEndPointX",0),E.Factory.addGetterSetter(tR,"fillRadialGradientEndPointY",0),E.Factory.addGetterSetter(tR,"fillPatternRotation",0),E.Factory.addGetterSetter(tR,"fillRule",void 0,(0,C.getStringValidator)()),E.Factory.backCompat(tR,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const tI=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],tz=tI.length;class tU extends $.Container{constructor(t){super(t),this.canvas=new A.SceneCanvas,this.hitCanvas=new A.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);let e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){w.Node.prototype.moveToTop.call(this);let t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!w.Node.prototype.moveUp.call(this))return!1;let t=this.getStage();return!!t&&!!t.content&&(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(w.Node.prototype.moveDown.call(this)){let t=this.getStage();if(t){let e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(w.Node.prototype.moveToBottom.call(this)){let t=this.getStage();if(t){let e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let t=this.getNativeCanvasElement();return w.Node.prototype.remove.call(this),t&&t.parentNode&&p.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){let e=t.getType();"Group"!==e&&"Shape"!==e&&p.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return(t=t||{}).width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=void 0!==t.x?t.x:this.x(),t.y=void 0!==t.y?t.y:this.y(),w.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){p.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){p.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,p.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let e=1,r=!1;for(;;){for(let n=0;n<tz;n++){let i=tI[n],a=this._getIntersection({x:t.x+i.x*e,y:t.y+i.y*e}),o=a.shape;if(o)return o;if(r=!!a.antialiased,!a.antialiased)break}if(!r)return null;e+=1}}_getIntersection(t){let e=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,n=r[3];if(255===n){let t=p.Util._rgbToHex(r[0],r[1],r[2]),e=tN.shapes["#"+t];return e?{shape:e}:{antialiased:!0}}return n>0?{antialiased:!0}:{}}drawScene(t,e){let r=this.getLayer(),n=t||r&&r.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),$.Container.prototype.drawScene.call(this,n,e),this._fire("draw",{node:this}),this}drawHit(t,e){let r=this.getLayer(),n=t||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),$.Container.prototype.drawHit.call(this,n,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){p.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return p.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let t=this.parent;this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return p.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}tF.Layer=tU,tU.prototype.nodeType="Layer",(0,f._registerNode)(tU),E.Factory.addGetterSetter(tU,"imageSmoothingEnabled",!0),E.Factory.addGetterSetter(tU,"clearBeforeDraw",!0),E.Factory.addGetterSetter(tU,"hitGraphEnabled",!0,(0,C.getBooleanValidator)());var tL={};Object.defineProperty(tL,"__esModule",{value:!0}),tL.FastLayer=void 0;class tG extends tF.Layer{constructor(t){super(t),this.listening(!1),p.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}tL.FastLayer=tG,tG.prototype.nodeType="FastLayer",(0,f._registerNode)(tG);var tq={};Object.defineProperty(tq,"__esModule",{value:!0}),tq.Group=void 0;class tj extends $.Container{_validateAdd(t){let e=t.getType();"Group"!==e&&"Shape"!==e&&p.Util.throw("You may only add groups and shapes to groups.")}}tq.Group=tj,tj.prototype.nodeType="Group",(0,f._registerNode)(tj);var tV={};Object.defineProperty(tV,"__esModule",{value:!0}),tV.Animation=void 0;const tH=f.glob.performance&&f.glob.performance.now?function(){return f.glob.performance.now()}:function(){return new Date().getTime()};class tY{constructor(t,e){this.id=tY.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:tH(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){let e=this.layers,r=e.length;for(let n=0;n<r;n++)if(e[n]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){let t=tY.animations,e=t.length;for(let r=0;r<e;r++)if(t[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=tH(),tY._addAnimation(this),this}stop(){return tY._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){let e=t.id,r=this.animations,n=r.length;for(let t=0;t<n;t++)if(r[t].id===e){this.animations.splice(t,1);break}}static _runFrames(){let t={},e=this.animations;for(let r=0;r<e.length;r++){let n=e[r],i=n.layers,a=n.func;n._updateFrameObject(tH());let o=i.length;if(!a||!1!==a.call(n,n.frame))for(let e=0;e<o;e++){let r=i[e];void 0!==r._id&&(t[r._id]=r)}}for(let e in t)t.hasOwnProperty(e)&&t[e].batchDraw()}static _animationLoop(){tY.animations.length?(tY._runFrames(),p.Util.requestAnimFrame(tY._animationLoop)):tY.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,p.Util.requestAnimFrame(this._animationLoop))}}tV.Animation=tY,tY.animations=[],tY.animIdCounter=0,tY.animRunning=!1;var tW={};Object.defineProperty(tW,"__esModule",{value:!0}),tW.Easings=tW.Tween=void 0;let t$={node:1,duration:1,easing:1,onFinish:1,yoyo:1},tK=0,tX=["fill","stroke","shadowColor"];class tZ{constructor(t,e,r,n,i,a,o){this.prop=t,this.propFunc=e,this.begin=n,this._pos=n,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=r,this._change=i-this.begin,this.pause()}fire(t){let e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){let t=this.getTimer()-this._startTime;2===this.state?this.setTime(t):3===this.state&&this.setTime(this.duration-t)}pause(){this.state=1,this.fire("onPause")}getTimer(){return new Date().getTime()}}class tJ{constructor(t){let e=this,r=t.node,n=r._id,i,a=t.easing||tW.Easings.Linear,o=!!t.yoyo,s;i=void 0===t.duration?.3:0===t.duration?.001:t.duration,this.node=r,this._id=tK++;let u=r.getLayer()||(r instanceof f.Konva.Stage?r.getLayers():null);for(s in u||p.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new tV.Animation(function(){e.tween.onEnterFrame()},u),this.tween=new tZ(s,function(t){e._tweenFunc(t)},a,0,1,1e3*i,o),this._addListeners(),tJ.attrs[n]||(tJ.attrs[n]={}),tJ.attrs[n][this._id]||(tJ.attrs[n][this._id]={}),tJ.tweens[n]||(tJ.tweens[n]={}),t)void 0===t$[s]&&this._addAttr(s,t[s]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){let r=this.node,n=r._id,i,a,o,s,u,l,h,c;if((o=tJ.tweens[n][t])&&delete tJ.attrs[n][o][t],i=r.getAttr(t),p.Util._isArray(e)){if(a=[],u=Math.max(e.length,i.length),"points"===t&&e.length!==i.length&&(e.length>i.length?(h=i,i=p.Util._prepareArrayForTween(i,e,r.closed())):(l=e,e=p.Util._prepareArrayForTween(e,i,r.closed()))),0===t.indexOf("fill"))for(s=0;s<u;s++)if(s%2==0)a.push(e[s]-i[s]);else{let t=p.Util.colorToRGBA(i[s]);c=p.Util.colorToRGBA(e[s]),i[s]=t,a.push({r:c.r-t.r,g:c.g-t.g,b:c.b-t.b,a:c.a-t.a})}else for(s=0;s<u;s++)a.push(e[s]-i[s])}else -1!==tX.indexOf(t)?(i=p.Util.colorToRGBA(i),a={r:(c=p.Util.colorToRGBA(e)).r-i.r,g:c.g-i.g,b:c.b-i.b,a:c.a-i.a}):a=e-i;tJ.attrs[n][this._id][t]={start:i,diff:a,end:e,trueEnd:l,trueStart:h},tJ.tweens[n][t]=this._id}_tweenFunc(t){let e=this.node,r=tJ.attrs[e._id][this._id],n,i,a,o,s,u,l,h;for(n in r){if(a=(i=r[n]).start,o=i.diff,h=i.end,p.Util._isArray(a)){if(s=[],l=Math.max(a.length,h.length),0===n.indexOf("fill"))for(u=0;u<l;u++)u%2==0?s.push((a[u]||0)+o[u]*t):s.push("rgba("+Math.round(a[u].r+o[u].r*t)+","+Math.round(a[u].g+o[u].g*t)+","+Math.round(a[u].b+o[u].b*t)+","+(a[u].a+o[u].a*t)+")");else for(u=0;u<l;u++)s.push((a[u]||0)+o[u]*t)}else s=-1!==tX.indexOf(n)?"rgba("+Math.round(a.r+o.r*t)+","+Math.round(a.g+o.g*t)+","+Math.round(a.b+o.b*t)+","+(a.a+o.a*t)+")":a+o*t;e.setAttr(n,s)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let t=this.node,e=tJ.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let t=this.node,e=tJ.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(1e3*t),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let t=this.node._id,e=this._id,r=tJ.tweens[t],n;for(n in this.pause(),r)delete tJ.tweens[t][n];delete tJ.attrs[t][e]}}tW.Tween=tJ,tJ.attrs={},tJ.tweens={},w.Node.prototype.to=function(t){let e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()},new tJ(t).play()},tW.Easings={BackEaseIn:(t,e,r,n)=>r*(t/=n)*t*(2.70158*t-1.70158)+e,BackEaseOut:(t,e,r,n)=>r*((t=t/n-1)*t*(2.70158*t+1.70158)+1)+e,BackEaseInOut(t,e,r,n){let i=1.70158;return(t/=n/2)<1?r/2*(t*t*(((i*=1.525)+1)*t-i))+e:r/2*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)+e},ElasticEaseIn(t,e,r,n,i,a){let o=0;return 0===t?e:1==(t/=n)?e+r:(a||(a=.3*n),!i||i<Math.abs(r)?(i=r,o=a/4):o=a/(2*Math.PI)*Math.asin(r/i),-(i*Math.pow(2,10*(t-=1))*Math.sin(2*Math.PI*(t*n-o)/a))+e)},ElasticEaseOut(t,e,r,n,i,a){let o=0;return 0===t?e:1==(t/=n)?e+r:(a||(a=.3*n),!i||i<Math.abs(r)?(i=r,o=a/4):o=a/(2*Math.PI)*Math.asin(r/i),i*Math.pow(2,-10*t)*Math.sin(2*Math.PI*(t*n-o)/a)+r+e)},ElasticEaseInOut(t,e,r,n,i,a){let o=0;return 0===t?e:2==(t/=n/2)?e+r:(a||(a=.3*1.5*n),!i||i<Math.abs(r)?(i=r,o=a/4):o=a/(2*Math.PI)*Math.asin(r/i),t<1)?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin(2*Math.PI*(t*n-o)/a))+e:i*Math.pow(2,-10*(t-=1))*Math.sin(2*Math.PI*(t*n-o)/a)*.5+r+e},BounceEaseOut:(t,e,r,n)=>(t/=n)<1/2.75?7.5625*t*t*r+e:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+e:r*(7.5625*(t-=2.625/2.75)*t+.984375)+e,BounceEaseIn:(t,e,r,n)=>r-tW.Easings.BounceEaseOut(n-t,0,r,n)+e,BounceEaseInOut:(t,e,r,n)=>t<n/2?.5*tW.Easings.BounceEaseIn(2*t,0,r,n)+e:.5*tW.Easings.BounceEaseOut(2*t-n,0,r,n)+.5*r+e,EaseIn:(t,e,r,n)=>r*(t/=n)*t+e,EaseOut:(t,e,r,n)=>-r*(t/=n)*(t-2)+e,EaseInOut:(t,e,r,n)=>(t/=n/2)<1?r/2*t*t+e:-r/2*(--t*(t-2)-1)+e,StrongEaseIn:(t,e,r,n)=>r*(t/=n)*t*t*t*t+e,StrongEaseOut:(t,e,r,n)=>r*((t=t/n-1)*t*t*t*t+1)+e,StrongEaseInOut:(t,e,r,n)=>(t/=n/2)<1?r/2*t*t*t*t*t+e:r/2*((t-=2)*t*t*t*t+2)+e,Linear:(t,e,r,n)=>r*t/n+e},c.Konva=p.Util._assign(f.Konva,{Util:p.Util,Transform:p.Transform,Node:w.Node,Container:$.Container,Stage:X.Stage,stages:X.stages,Layer:tF.Layer,FastLayer:tL.FastLayer,Group:tq.Group,DD:B.DD,Shape:tN.Shape,shapes:tN.shapes,Animation:tV.Animation,Tween:tW.Tween,Easings:tW.Easings,Context:F.Context,Canvas:A.Canvas}),c.default=c.Konva;var tQ={};Object.defineProperty(tQ,"__esModule",{value:!0}),tQ.Arc=void 0;class t0 extends tN.Shape{_sceneFunc(t){let e=f.Konva.getAngle(this.angle()),r=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,r),t.arc(0,0,this.innerRadius(),e,0,!r),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){let t=this.innerRadius(),e=this.outerRadius(),r=this.clockwise(),n=f.Konva.getAngle(r?360-this.angle():this.angle()),i=Math.cos(Math.min(n,Math.PI)),a=Math.sin(Math.min(Math.max(Math.PI,n),3*Math.PI/2)),o=Math.sin(Math.min(n,Math.PI/2)),s=i*(i>0?t:e),u=a*(a>0?t:e),l=o*(o>0?e:t);return{x:s,y:r?-1*l:u,width:1*e-s,height:l-u}}}tQ.Arc=t0,t0.prototype._centroid=!0,t0.prototype.className="Arc",t0.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,f._registerNode)(t0),E.Factory.addGetterSetter(t0,"innerRadius",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(t0,"outerRadius",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(t0,"angle",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(t0,"clockwise",!1,(0,C.getBooleanValidator)());var t1={};Object.defineProperty(t1,"__esModule",{value:!0}),t1.Arrow=void 0;var t2={};function t5(t,e,r,n,i,a,o){let s=Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),u=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),l=o*s/(s+u),h=o*u/(s+u);return[r-l*(i-t),n-l*(a-e),r+h*(i-t),n+h*(a-e)]}function t3(t,e){let r=t.length,n=[];for(let i=2;i<r-2;i+=2){let r=t5(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e);isNaN(r[0])||(n.push(r[0]),n.push(r[1]),n.push(t[i]),n.push(t[i+1]),n.push(r[2]),n.push(r[3]))}return n}Object.defineProperty(t2,"__esModule",{value:!0}),t2.Line=void 0;class t4 extends tN.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){let e=this.points(),r=e.length,n=this.tension(),i=this.closed(),a=this.bezier(),o,s,u;if(r){if(t.beginPath(),t.moveTo(e[0],e[1]),0!==n&&r>4){for(s=(o=this.getTensionPoints()).length,u=i?0:4,i||t.quadraticCurveTo(o[0],o[1],o[2],o[3]);u<s-2;)t.bezierCurveTo(o[u++],o[u++],o[u++],o[u++],o[u++],o[u++]);i||t.quadraticCurveTo(o[s-2],o[s-1],e[r-2],e[r-1])}else if(a)for(u=2;u<r;)t.bezierCurveTo(e[u++],e[u++],e[u++],e[u++],e[u++],e[u++]);else for(u=2;u<r;u+=2)t.lineTo(e[u],e[u+1]);i?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():t3(this.points(),this.tension())}_getTensionPointsClosed(){let t=this.points(),e=t.length,r=this.tension(),n=t5(t[e-2],t[e-1],t[0],t[1],t[2],t[3],r),i=t5(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],r),a=t3(t,r);return[n[2],n[3]].concat(a).concat([i[0],i[1],t[e-2],t[e-1],i[2],i[3],n[0],n[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t,e,r=this.points();if(r.length<4)return{x:r[0]||0,y:r[1]||0,width:0,height:0};let n=(r=0!==this.tension()?[r[0],r[1],...this._getTensionPoints(),r[r.length-2],r[r.length-1]]:this.points())[0],i=r[0],a=r[1],o=r[1];for(let s=0;s<r.length/2;s++)t=r[2*s],e=r[2*s+1],n=Math.min(n,t),i=Math.max(i,t),a=Math.min(a,e),o=Math.max(o,e);return{x:n,y:a,width:i-n,height:o-a}}}t2.Line=t4,t4.prototype.className="Line",t4.prototype._attrsAffectingSize=["points","bezier","tension"],(0,f._registerNode)(t4),E.Factory.addGetterSetter(t4,"closed",!1),E.Factory.addGetterSetter(t4,"bezier",!1),E.Factory.addGetterSetter(t4,"tension",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(t4,"points",[],(0,C.getNumberArrayValidator)());var t8={};Object.defineProperty(t8,"__esModule",{value:!0}),t8.Path=void 0;var t6={};Object.defineProperty(t6,"__esModule",{value:!0}),t6.t2length=t6.getQuadraticArcLength=t6.getCubicArcLength=t6.binomialCoefficients=t6.cValues=t6.tValues=void 0,t6.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t6.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t6.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]],t6.getCubicArcLength=(t,e,r)=>{let n,i;let a=r/2;n=0;for(let r=0;r<20;r++)i=a*t6.tValues[20][r]+a,n+=t6.cValues[20][r]*function(t,e,r){let n=t9(1,r,t),i=t9(1,r,e);return Math.sqrt(n*n+i*i)}(t,e,i);return a*n},t6.getQuadraticArcLength=(t,e,r)=>{void 0===r&&(r=1);let n=t[0]-2*t[1]+t[2],i=e[0]-2*e[1]+e[2],a=2*t[1]-2*t[0],o=2*e[1]-2*e[0],s=4*(n*n+i*i);if(0===s)return r*Math.sqrt(Math.pow(t[2]-t[0],2)+Math.pow(e[2]-e[0],2));let u=4*(n*a+i*o)/(2*s),l=r+u,h=(a*a+o*o)/s-u*u,c=l*l+h>0?Math.sqrt(l*l+h):0,f=u*u+h>0?Math.sqrt(u*u+h):0,d=u+Math.sqrt(u*u+h)!==0?h*Math.log(Math.abs((l+c)/(u+f))):0;return Math.sqrt(s)/2*(l*c-u*f+d)};const t9=(t,e,r)=>{let n,i;let a=r.length-1;if(0===a)return 0;if(0===t){i=0;for(let t=0;t<=a;t++)i+=t6.binomialCoefficients[a][t]*Math.pow(1-e,a-t)*Math.pow(e,t)*r[t];return i}n=Array(a);for(let t=0;t<a;t++)n[t]=a*(r[t+1]-r[t]);return t9(t-1,e,n)};t6.t2length=(t,e,r)=>{let n=1,i=t/e,a=(t-r(i))/e,o=0;for(;n>.001;){let s=Math.abs(t-r(i+a))/e;if(s<n)n=s,i+=a;else{let o=Math.abs(t-r(i-a))/e;o<n?(n=o,i-=a):a/=2}if(++o>500)break}return i};class t7 extends tN.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=t7.parsePathData(this.data()),this.pathLength=t7.getPathLength(this.dataArray)}_sceneFunc(t){let e=this.dataArray;t.beginPath();let r=!1;for(let p=0;p<e.length;p++){let g=e[p].command,m=e[p].points;switch(g){case"L":t.lineTo(m[0],m[1]);break;case"M":t.moveTo(m[0],m[1]);break;case"C":t.bezierCurveTo(m[0],m[1],m[2],m[3],m[4],m[5]);break;case"Q":t.quadraticCurveTo(m[0],m[1],m[2],m[3]);break;case"A":var n=m[0],i=m[1],a=m[2],o=m[3],s=m[4],u=m[5],l=m[6],h=m[7],c=a>o?a:o,f=a>o?1:a/o,d=a>o?o/a:1;t.translate(n,i),t.rotate(l),t.scale(f,d),t.arc(0,0,c,s,s+u,1-h),t.scale(1/f,1/d),t.rotate(-l),t.translate(-n,-i);break;case"z":r=!0,t.closePath()}}r||this.hasFill()?t.fillStrokeShape(this):t.strokeShape(this)}getSelfRect(){let t,e,r=[];this.dataArray.forEach(function(t){if("A"===t.command){let e=t.points[4],n=t.points[5],i=t.points[4]+n,a=Math.PI/180;if(Math.abs(e-i)<a&&(a=Math.abs(e-i)),n<0)for(let n=e-a;n>i;n-=a){let e=t7.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],n,0);r.push(e.x,e.y)}else for(let n=e+a;n<i;n+=a){let e=t7.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],n,0);r.push(e.x,e.y)}}else if("C"===t.command)for(let e=0;e<=1;e+=.01){let n=t7.getPointOnCubicBezier(e,t.start.x,t.start.y,t.points[0],t.points[1],t.points[2],t.points[3],t.points[4],t.points[5]);r.push(n.x,n.y)}else r=r.concat(t.points)});let n=r[0],i=r[0],a=r[1],o=r[1];for(let s=0;s<r.length/2;s++)t=r[2*s],e=r[2*s+1],isNaN(t)||(n=Math.min(n,t),i=Math.max(i,t)),isNaN(e)||(a=Math.min(a,e),o=Math.max(o,e));return{x:n,y:a,width:i-n,height:o-a}}getLength(){return this.pathLength}getPointAtLength(t){return t7.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,r,n){return Math.sqrt((r-t)*(r-t)+(n-e)*(n-e))}static getPathLength(t){let e=0;for(let r=0;r<t.length;++r)e+=t[r].pathLength;return e}static getPointAtLengthOfDataArray(t,e){let r,n=0,i=e.length;if(!i)return null;for(;n<i&&t>e[n].pathLength;)t-=e[n].pathLength,++n;if(n===i)return{x:(r=e[n-1].points.slice(-2))[0],y:r[1]};if(t<.01)return{x:(r=e[n].points.slice(0,2))[0],y:r[1]};let a=e[n],o=a.points;switch(a.command){case"L":return t7.getPointOnLine(t,a.start.x,a.start.y,o[0],o[1]);case"C":return t7.getPointOnCubicBezier((0,t6.t2length)(t,t7.getPathLength(e),t=>(0,t6.getCubicArcLength)([a.start.x,o[0],o[2],o[4]],[a.start.y,o[1],o[3],o[5]],t)),a.start.x,a.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return t7.getPointOnQuadraticBezier((0,t6.t2length)(t,t7.getPathLength(e),t=>(0,t6.getQuadraticArcLength)([a.start.x,o[0],o[2]],[a.start.y,o[1],o[3]],t)),a.start.x,a.start.y,o[0],o[1],o[2],o[3]);case"A":var s=o[0],u=o[1],l=o[2],h=o[3],c=o[4],f=o[5],d=o[6];return c+=f*t/a.pathLength,t7.getPointOnEllipticalArc(s,u,l,h,c,d)}return null}static getPointOnLine(t,e,r,n,i,a,o){a=null!=a?a:e,o=null!=o?o:r;let s=this.getLineLength(e,r,n,i);if(s<1e-10)return{x:e,y:r};if(n===e)return{x:a,y:o+(i>r?t:-t)};let u=(i-r)/(n-e),l=Math.sqrt(t*t/(1+u*u))*(n<e?-1:1);if(1e-10>Math.abs(o-r-u*(a-e)))return{x:a+l,y:o+u*l};let h=((a-e)*(n-e)+(o-r)*(i-r))/(s*s),c=e+h*(n-e),f=r+h*(i-r),d=this.getLineLength(a,o,c,f),p=Math.sqrt(t*t-d*d),g=Math.sqrt(p*p/(1+u*u))*(n<e?-1:1);return{x:c+g,y:f+u*g}}static getPointOnCubicBezier(t,e,r,n,i,a,o,s,u){function l(t){return 3*t*(1-t)*(1-t)}return{x:t*t*t*s+3*t*t*(1-t)*a+n*l(t)+(1-t)*(1-t)*(1-t)*e,y:t*t*t*u+3*t*t*(1-t)*o+i*l(t)+(1-t)*(1-t)*(1-t)*r}}static getPointOnQuadraticBezier(t,e,r,n,i,a,o){return{x:t*t*a+2*t*(1-t)*n+(1-t)*(1-t)*e,y:t*t*o+2*t*(1-t)*i+(1-t)*(1-t)*r}}static getPointOnEllipticalArc(t,e,r,n,i,a){let o=Math.cos(a),s=Math.sin(a),u={x:r*Math.cos(i),y:n*Math.sin(i)};return{x:t+(u.x*o-u.y*s),y:e+(u.x*s+u.y*o)}}static parsePathData(t){let e;if(!t)return[];let r=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(RegExp(" ","g"),",");for(var i=0;i<n.length;i++)r=r.replace(RegExp(n[i],"g"),"|"+n[i]);let a=r.split("|"),o=[],s=[],u=0,l=0,h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(i=1;i<a.length;i++){let t=a[i],r=t.charAt(0);for(t=t.slice(1),s.length=0;e=h.exec(t);)s.push(e[0]);let n=[];for(let t=0,e=s.length;t<e;t++){if("00"===s[t]){n.push(0,0);continue}let e=parseFloat(s[t]);isNaN(e)?n.push(0):n.push(e)}for(;n.length>0&&!isNaN(n[0]);){let t="",e=[],i=u,a=l;switch(r){case"l":u+=n.shift(),l+=n.shift(),t="L",e.push(u,l);break;case"L":u=n.shift(),l=n.shift(),e.push(u,l);break;case"m":var c,f,d,p,g,m,v,y,x,b,D=n.shift(),_=n.shift();if(u+=D,l+=_,t="M",o.length>2&&"z"===o[o.length-1].command){for(let t=o.length-2;t>=0;t--)if("M"===o[t].command){u=o[t].points[0]+D,l=o[t].points[1]+_;break}}e.push(u,l),r="l";break;case"M":u=n.shift(),l=n.shift(),t="M",e.push(u,l),r="L";break;case"h":u+=n.shift(),t="L",e.push(u,l);break;case"H":u=n.shift(),t="L",e.push(u,l);break;case"v":l+=n.shift(),t="L",e.push(u,l);break;case"V":l=n.shift(),t="L",e.push(u,l);break;case"C":e.push(n.shift(),n.shift(),n.shift(),n.shift()),u=n.shift(),l=n.shift(),e.push(u,l);break;case"c":e.push(u+n.shift(),l+n.shift(),u+n.shift(),l+n.shift()),u+=n.shift(),l+=n.shift(),t="C",e.push(u,l);break;case"S":f=u,d=l,"C"===(c=o[o.length-1]).command&&(f=u+(u-c.points[2]),d=l+(l-c.points[3])),e.push(f,d,n.shift(),n.shift()),u=n.shift(),l=n.shift(),t="C",e.push(u,l);break;case"s":f=u,d=l,"C"===(c=o[o.length-1]).command&&(f=u+(u-c.points[2]),d=l+(l-c.points[3])),e.push(f,d,u+n.shift(),l+n.shift()),u+=n.shift(),l+=n.shift(),t="C",e.push(u,l);break;case"Q":e.push(n.shift(),n.shift()),u=n.shift(),l=n.shift(),e.push(u,l);break;case"q":e.push(u+n.shift(),l+n.shift()),u+=n.shift(),l+=n.shift(),t="Q",e.push(u,l);break;case"T":f=u,d=l,"Q"===(c=o[o.length-1]).command&&(f=u+(u-c.points[0]),d=l+(l-c.points[1])),u=n.shift(),l=n.shift(),t="Q",e.push(f,d,u,l);break;case"t":f=u,d=l,"Q"===(c=o[o.length-1]).command&&(f=u+(u-c.points[0]),d=l+(l-c.points[1])),u+=n.shift(),l+=n.shift(),t="Q",e.push(f,d,u,l);break;case"A":p=n.shift(),g=n.shift(),m=n.shift(),v=n.shift(),y=n.shift(),x=u,b=l,u=n.shift(),l=n.shift(),t="A",e=this.convertEndpointToCenterParameterization(x,b,u,l,v,y,p,g,m);break;case"a":p=n.shift(),g=n.shift(),m=n.shift(),v=n.shift(),y=n.shift(),x=u,b=l,u+=n.shift(),l+=n.shift(),t="A",e=this.convertEndpointToCenterParameterization(x,b,u,l,v,y,p,g,m)}o.push({command:t||r,points:e,start:{x:i,y:a},pathLength:this.calcLength(i,a,t||r,e)})}("z"===r||"Z"===r)&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(t,e,r,n){let i,a,o,s;switch(r){case"L":return t7.getLineLength(t,e,n[0],n[1]);case"C":return(0,t6.getCubicArcLength)([t,n[0],n[2],n[4]],[e,n[1],n[3],n[5]],1);case"Q":return(0,t6.getQuadraticArcLength)([t,n[0],n[2]],[e,n[1],n[3]],1);case"A":i=0;var u=n[4],l=n[5],h=n[4]+l,c=Math.PI/180;if(Math.abs(u-h)<c&&(c=Math.abs(u-h)),a=t7.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],u,0),l<0)for(s=u-c;s>h;s-=c)o=t7.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],s,0),i+=t7.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(s=u+c;s<h;s+=c)o=t7.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],s,0),i+=t7.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=t7.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),i+=t7.getLineLength(a.x,a.y,o.x,o.y)}return 0}static convertEndpointToCenterParameterization(t,e,r,n,i,a,o,s,u){let l=Math.PI/180*u,h=Math.cos(l)*(t-r)/2+Math.sin(l)*(e-n)/2,c=-1*Math.sin(l)*(t-r)/2+Math.cos(l)*(e-n)/2,f=h*h/(o*o)+c*c/(s*s);f>1&&(o*=Math.sqrt(f),s*=Math.sqrt(f));let d=Math.sqrt((o*o*(s*s)-o*o*(c*c)-s*s*(h*h))/(o*o*(c*c)+s*s*(h*h)));i===a&&(d*=-1),isNaN(d)&&(d=0);let p=d*o*c/s,g=-(d*s)*h/o,m=(t+r)/2+Math.cos(l)*p-Math.sin(l)*g,v=(e+n)/2+Math.sin(l)*p+Math.cos(l)*g,y=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},x=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(y(t)*y(e))},b=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(x(t,e))},D=b([1,0],[(h-p)/o,(c-g)/s]),_=[(h-p)/o,(c-g)/s],w=[(-1*h-p)/o,(-1*c-g)/s],E=b(_,w);return -1>=x(_,w)&&(E=Math.PI),x(_,w)>=1&&(E=0),0===a&&E>0&&(E-=2*Math.PI),1===a&&E<0&&(E+=2*Math.PI),[m,v,o,s,D,E,l,a]}}t8.Path=t7,t7.prototype.className="Path",t7.prototype._attrsAffectingSize=["data"],(0,f._registerNode)(t7),E.Factory.addGetterSetter(t7,"data");class et extends t2.Line{_sceneFunc(t){let e,r;super._sceneFunc(t);let n=2*Math.PI,i=this.points(),a=i,o=0!==this.tension()&&i.length>4;o&&(a=this.getTensionPoints());let s=this.pointerLength(),u=i.length;if(o){let t=[a[a.length-4],a[a.length-3],a[a.length-2],a[a.length-1],i[u-2],i[u-1]],n=t8.Path.calcLength(a[a.length-4],a[a.length-3],"C",t),o=t8.Path.getPointOnQuadraticBezier(Math.min(1,1-s/n),t[0],t[1],t[2],t[3],t[4],t[5]);e=i[u-2]-o.x,r=i[u-1]-o.y}else e=i[u-2]-i[u-4],r=i[u-1]-i[u-3];let l=(Math.atan2(r,e)+n)%n,h=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[u-2],i[u-1]),t.rotate(l),t.moveTo(0,0),t.lineTo(-s,h/2),t.lineTo(-s,-h/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),o?(e=(a[0]+a[2])/2-i[0],r=(a[1]+a[3])/2-i[1]):(e=i[2]-i[0],r=i[3]-i[1]),t.rotate((Math.atan2(-r,-e)+n)%n),t.moveTo(0,0),t.lineTo(-s,h/2),t.lineTo(-s,-h/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){let e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){let t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e}}}t1.Arrow=et,et.prototype.className="Arrow",(0,f._registerNode)(et),E.Factory.addGetterSetter(et,"pointerLength",10,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(et,"pointerWidth",10,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(et,"pointerAtBeginning",!1),E.Factory.addGetterSetter(et,"pointerAtEnding",!0);var ee={};Object.defineProperty(ee,"__esModule",{value:!0}),ee.Circle=void 0;class er extends tN.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}ee.Circle=er,er.prototype._centroid=!0,er.prototype.className="Circle",er.prototype._attrsAffectingSize=["radius"],(0,f._registerNode)(er),E.Factory.addGetterSetter(er,"radius",0,(0,C.getNumberValidator)());var en={};Object.defineProperty(en,"__esModule",{value:!0}),en.Ellipse=void 0;class ei extends tN.Shape{_sceneFunc(t){let e=this.radiusX(),r=this.radiusY();t.beginPath(),t.save(),e!==r&&t.scale(1,r/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}en.Ellipse=ei,ei.prototype.className="Ellipse",ei.prototype._centroid=!0,ei.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,f._registerNode)(ei),E.Factory.addComponentsGetterSetter(ei,"radius",["x","y"]),E.Factory.addGetterSetter(ei,"radiusX",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ei,"radiusY",0,(0,C.getNumberValidator)());var ea={};Object.defineProperty(ea,"__esModule",{value:!0}),ea.Image=void 0;class eo extends tN.Shape{constructor(t){super(t),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let t=this.image();t&&t.complete||t&&4===t.readyState||!t||!t.addEventListener||t.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){let t=!!this.cornerRadius(),e=this.hasShadow();return!!t&&!!e||super._useBufferCanvas(!0)}_sceneFunc(t){let e;let r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;if(a){let t=this.attrs.cropWidth,i=this.attrs.cropHeight;e=t&&i?[a,this.cropX(),this.cropY(),t,i,0,0,r,n]:[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(t.beginPath(),i?p.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)),a&&(i&&t.clip(),t.drawImage.apply(t,e))}_hitFunc(t){let e=this.width(),r=this.height(),n=this.cornerRadius();t.beginPath(),n?p.Util.drawRoundedRectPath(t,e,r,n):t.rect(0,0,e,r),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return null!==(t=this.attrs.width)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.width}getHeight(){var t,e;return null!==(t=this.attrs.height)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.height}static fromURL(t,e,r=null){let n=p.Util.createImageElement();n.onload=function(){e(new eo({image:n}))},n.onerror=r,n.crossOrigin="Anonymous",n.src=t}}ea.Image=eo,eo.prototype.className="Image",(0,f._registerNode)(eo),E.Factory.addGetterSetter(eo,"cornerRadius",0,(0,C.getNumberOrArrayOfNumbersValidator)(4)),E.Factory.addGetterSetter(eo,"image"),E.Factory.addComponentsGetterSetter(eo,"crop",["x","y","width","height"]),E.Factory.addGetterSetter(eo,"cropX",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(eo,"cropY",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(eo,"cropWidth",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(eo,"cropHeight",0,(0,C.getNumberValidator)());var es={};Object.defineProperty(es,"__esModule",{value:!0}),es.Tag=es.Label=void 0;const eu=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],el="right",eh="down",ec="left",ef=eu.length;class ed extends tq.Group{constructor(t){super(t),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let e=this,r,n=function(){e._sync()};for(r=0;r<ef;r++)t.on(eu[r]+"Change.konva",n)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),e=this.getTag(),r,n,i,a,o,s,u;if(t&&e){switch(r=t.width(),n=t.height(),i=e.pointerDirection(),a=e.pointerWidth(),u=e.pointerHeight(),o=0,s=0,i){case"up":o=r/2,s=-1*u;break;case el:o=r+a,s=n/2;break;case eh:o=r/2,s=n+u;break;case ec:o=-1*a,s=n/2}e.setAttrs({x:-1*o,y:-1*s,width:r,height:n}),t.setAttrs({x:-1*o,y:-1*s})}}}es.Label=ed,ed.prototype.className="Label",(0,f._registerNode)(ed);class ep extends tN.Shape{_sceneFunc(t){let e=this.width(),r=this.height(),n=this.pointerDirection(),i=this.pointerWidth(),a=this.pointerHeight(),o=this.cornerRadius(),s=0,u=0,l=0,h=0;"number"==typeof o?s=u=l=h=Math.min(o,e/2,r/2):(s=Math.min(o[0]||0,e/2,r/2),u=Math.min(o[1]||0,e/2,r/2),h=Math.min(o[2]||0,e/2,r/2),l=Math.min(o[3]||0,e/2,r/2)),t.beginPath(),t.moveTo(s,0),"up"===n&&(t.lineTo((e-i)/2,0),t.lineTo(e/2,-1*a),t.lineTo((e+i)/2,0)),t.lineTo(e-u,0),t.arc(e-u,u,u,3*Math.PI/2,0,!1),n===el&&(t.lineTo(e,(r-a)/2),t.lineTo(e+i,r/2),t.lineTo(e,(r+a)/2)),t.lineTo(e,r-h),t.arc(e-h,r-h,h,0,Math.PI/2,!1),n===eh&&(t.lineTo((e+i)/2,r),t.lineTo(e/2,r+a),t.lineTo((e-i)/2,r)),t.lineTo(l,r),t.arc(l,r-l,l,Math.PI/2,Math.PI,!1),n===ec&&(t.lineTo(0,(r+a)/2),t.lineTo(-1*i,r/2),t.lineTo(0,(r-a)/2)),t.lineTo(0,s),t.arc(s,s,s,Math.PI,3*Math.PI/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,e=0,r=this.pointerWidth(),n=this.pointerHeight(),i=this.pointerDirection(),a=this.width(),o=this.height();return"up"===i?(e-=n,o+=n):i===eh?o+=n:i===ec?(t-=1.5*r,a+=r):i===el&&(a+=1.5*r),{x:t,y:e,width:a,height:o}}}es.Tag=ep,ep.prototype.className="Tag",(0,f._registerNode)(ep),E.Factory.addGetterSetter(ep,"pointerDirection","none"),E.Factory.addGetterSetter(ep,"pointerWidth",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ep,"pointerHeight",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ep,"cornerRadius",0,(0,C.getNumberOrArrayOfNumbersValidator)(4));var eg={};Object.defineProperty(eg,"__esModule",{value:!0}),eg.Rect=void 0;class em extends tN.Shape{_sceneFunc(t){let e=this.cornerRadius(),r=this.width(),n=this.height();t.beginPath(),e?p.Util.drawRoundedRectPath(t,r,n,e):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}}eg.Rect=em,em.prototype.className="Rect",(0,f._registerNode)(em),E.Factory.addGetterSetter(em,"cornerRadius",0,(0,C.getNumberOrArrayOfNumbersValidator)(4));var ev={};Object.defineProperty(ev,"__esModule",{value:!0}),ev.RegularPolygon=void 0;class ey extends tN.Shape{_sceneFunc(t){let e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let r=1;r<e.length;r++)t.lineTo(e[r].x,e[r].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){let t=this.attrs.sides,e=this.attrs.radius||0,r=[];for(let n=0;n<t;n++)r.push({x:e*Math.sin(2*n*Math.PI/t),y:-1*e*Math.cos(2*n*Math.PI/t)});return r}getSelfRect(){let t=this._getPoints(),e=t[0].x,r=t[0].y,n=t[0].x,i=t[0].y;return t.forEach(t=>{e=Math.min(e,t.x),r=Math.max(r,t.x),n=Math.min(n,t.y),i=Math.max(i,t.y)}),{x:e,y:n,width:r-e,height:i-n}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}ev.RegularPolygon=ey,ey.prototype.className="RegularPolygon",ey.prototype._centroid=!0,ey.prototype._attrsAffectingSize=["radius"],(0,f._registerNode)(ey),E.Factory.addGetterSetter(ey,"radius",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ey,"sides",0,(0,C.getNumberValidator)());var ex={};Object.defineProperty(ex,"__esModule",{value:!0}),ex.Ring=void 0;const eb=2*Math.PI;class eD extends tN.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,eb,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),eb,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}ex.Ring=eD,eD.prototype.className="Ring",eD.prototype._centroid=!0,eD.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,f._registerNode)(eD),E.Factory.addGetterSetter(eD,"innerRadius",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(eD,"outerRadius",0,(0,C.getNumberValidator)());var e_={};Object.defineProperty(e_,"__esModule",{value:!0}),e_.Sprite=void 0;class ew extends tN.Shape{constructor(t){super(t),this._updated=!0,this.anim=new tV.Animation(()=>{let t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){let e=this.animation(),r=this.frameIndex(),n=4*r,i=this.animations()[e],a=this.frameOffsets(),o=i[n+0],s=i[n+1],u=i[n+2],l=i[n+3],h=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,u,l),t.closePath(),t.fillStrokeShape(this)),h){if(a){let n=a[e],i=2*r;t.drawImage(h,o,s,u,l,n[i+0],n[i+1],u,l)}else t.drawImage(h,o,s,u,l,0,0,u,l)}}_hitFunc(t){let e=this.animation(),r=this.frameIndex(),n=4*r,i=this.animations()[e],a=this.frameOffsets(),o=i[n+2],s=i[n+3];if(t.beginPath(),a){let n=a[e],i=2*r;t.rect(n[i+0],n[i+1],o,s)}else t.rect(0,0,o,s);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let t=this.frameIndex(),e=this.animation();t<this.animations()[e].length/4-1?this.frameIndex(t+1):this.frameIndex(0)}}e_.Sprite=ew,ew.prototype.className="Sprite",(0,f._registerNode)(ew),E.Factory.addGetterSetter(ew,"animation"),E.Factory.addGetterSetter(ew,"animations"),E.Factory.addGetterSetter(ew,"frameOffsets"),E.Factory.addGetterSetter(ew,"image"),E.Factory.addGetterSetter(ew,"frameIndex",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ew,"frameRate",17,(0,C.getNumberValidator)()),E.Factory.backCompat(ew,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var eE={};Object.defineProperty(eE,"__esModule",{value:!0}),eE.Star=void 0;class eC extends tN.Shape{_sceneFunc(t){let e=this.innerRadius(),r=this.outerRadius(),n=this.numPoints();t.beginPath(),t.moveTo(0,0-r);for(let i=1;i<2*n;i++){let a=i%2==0?r:e,o=a*Math.sin(i*Math.PI/n),s=-1*a*Math.cos(i*Math.PI/n);t.lineTo(o,s)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}eE.Star=eC,eC.prototype.className="Star",eC.prototype._centroid=!0,eC.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,f._registerNode)(eC),E.Factory.addGetterSetter(eC,"numPoints",5,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(eC,"innerRadius",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(eC,"outerRadius",0,(0,C.getNumberValidator)());var eS={};function eA(t){return[...t].reduce((t,e,r,n)=>(/\p{Emoji_Modifier_Base}\p{Emoji_Modifier}?(?:\u200D\p{Emoji_Presentation})+/u.test(e)?t.push(e):/\p{Regional_Indicator}{2}/u.test(e+(n[r+1]||""))?t.push(e+n[r+1]):r>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(e)?t[t.length-1]+=e:t.push(e),t),[])}Object.defineProperty(eS,"__esModule",{value:!0}),eS.Text=void 0,eS.stringToArray=eA;const eF="auto",eN="inherit",eM="justify",eT="left",eB="middle",eO="normal",ek="none",eP=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],eR=eP.length;function eI(){return r||(r=p.Util.createCanvasElement().getContext("2d"))}class ez extends tN.Shape{constructor(t){var e;super(((e=(e=t)||{}).fillLinearGradientColorStops||e.fillRadialGradientColorStops||e.fillPatternImage||(e.fill=e.fill||"black"),e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<eR;t++)this.on(eP[t]+"Change.konva",this._setTextData);this._setTextData()}_sceneFunc(t){let e=this.textArr,r=e.length;if(!this.text())return;let n=this.padding(),i=this.fontSize(),a=this.lineHeight()*i,o=this.verticalAlign(),s=this.direction(),u=0,l=this.align(),h=this.getWidth(),c=this.letterSpacing(),d=this.fill(),p=this.textDecoration(),g=-1!==p.indexOf("underline"),m=-1!==p.indexOf("line-through"),v;s=s===eN?t.direction:s;let y=a/2,x=eB;if(f.Konva._fixTextRendering){let t=this.measureSize("M");x="alphabetic",y=(t.fontBoundingBoxAscent-t.fontBoundingBoxDescent)/2+a/2}var b=0,D=0;for("rtl"===s&&t.setAttr("direction",s),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",x),t.setAttr("textAlign",eT),o===eB?u=(this.getHeight()-r*a-2*n)/2:"bottom"===o&&(u=this.getHeight()-r*a-2*n),t.translate(n,u+n),v=0;v<r;v++){var _,w,E,b=0,D=0,C=e[v],S=C.text,A=C.width,F=C.lastInParagraph;if(t.save(),"right"===l?b+=h-A-2*n:"center"===l&&(b+=(h-A-2*n)/2),g){t.save(),t.beginPath();let e=f.Konva._fixTextRendering?Math.round(i/4):Math.round(i/2),r=b,a=y+D+e;t.moveTo(r,a),w=0==(_=S.split(" ").length-1),E=l!==eM||F?A:h-2*n,t.lineTo(r+Math.round(E),a),t.lineWidth=i/15;let o=this._getLinearGradient();t.strokeStyle=o||d,t.stroke(),t.restore()}if(m){t.save(),t.beginPath();let e=f.Konva._fixTextRendering?-Math.round(i/4):0;t.moveTo(b,y+D+e),w=0==(_=S.split(" ").length-1),E=l===eM&&F&&!w?h-2*n:A,t.lineTo(b+Math.round(E),y+D+e),t.lineWidth=i/15;let r=this._getLinearGradient();t.strokeStyle=r||d,t.stroke(),t.restore()}if("rtl"!==s&&(0!==c||l===eM)){_=S.split(" ").length-1;let e=eA(S);for(let r=0;r<e.length;r++){let i=e[r];" "!==i||F||l!==eM||(b+=(h-2*n-A)/_),this._partialTextX=b,this._partialTextY=y+D,this._partialText=i,t.fillStrokeShape(this),b+=this.measureSize(i).width+c}}else 0!==c&&t.setAttr("letterSpacing",`${c}px`),this._partialTextX=b,this._partialTextY=y+D,this._partialText=S,t.fillStrokeShape(this);t.restore(),r>1&&(y+=a)}}_hitFunc(t){let e=this.getWidth(),r=this.getHeight();t.beginPath(),t.rect(0,0,e,r),t.closePath(),t.fillStrokeShape(this)}setText(t){let e=p.Util._isString(t)?t:null==t?"":t+"";return this._setAttr("text",e),this}getWidth(){return this.attrs.width===eF||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){return this.attrs.height===eF||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return p.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,r,n,i,a,o,s,u,l,h,c;let f=eI(),d=this.fontSize(),p;f.save(),f.font=this._getContextFont(),p=f.measureText(t),f.restore();let g=d/100;return{actualBoundingBoxAscent:null!==(e=p.actualBoundingBoxAscent)&&void 0!==e?e:71.58203125*g,actualBoundingBoxDescent:null!==(r=p.actualBoundingBoxDescent)&&void 0!==r?r:0,actualBoundingBoxLeft:null!==(n=p.actualBoundingBoxLeft)&&void 0!==n?n:-7.421875*g,actualBoundingBoxRight:null!==(i=p.actualBoundingBoxRight)&&void 0!==i?i:75.732421875*g,alphabeticBaseline:null!==(a=p.alphabeticBaseline)&&void 0!==a?a:0,emHeightAscent:null!==(o=p.emHeightAscent)&&void 0!==o?o:100*g,emHeightDescent:null!==(s=p.emHeightDescent)&&void 0!==s?s:-20*g,fontBoundingBoxAscent:null!==(u=p.fontBoundingBoxAscent)&&void 0!==u?u:91*g,fontBoundingBoxDescent:null!==(l=p.fontBoundingBoxDescent)&&void 0!==l?l:21*g,hangingBaseline:null!==(h=p.hangingBaseline)&&void 0!==h?h:72.80000305175781*g,ideographicBaseline:null!==(c=p.ideographicBaseline)&&void 0!==c?c:-21*g,width:p.width,height:d}}_getContextFont(){return this.fontStyle()+" "+this.fontVariant()+" "+this.fontSize()+"px "+this.fontFamily().split(",").map(t=>{let e=(t=t.trim()).indexOf(" ")>=0,r=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!r&&(t=`"${t}"`),t}).join(", ")}_addTextLine(t){this.align()===eM&&(t=t.trim());let e=this._getTextWidth(t);return this.textArr.push({text:t,width:e,lastInParagraph:!1})}_getTextWidth(t){let e=this.letterSpacing(),r=t.length;return eI().measureText(t).width+(r?e*(r-1):0)}_setTextData(){let t=this.text().split("\n"),e=+this.fontSize(),r=0,n=this.lineHeight()*e,i=this.attrs.width,a=this.attrs.height,o=i!==eF&&void 0!==i,s=a!==eF&&void 0!==a,u=this.padding(),l=i-2*u,h=a-2*u,c=0,f=this.wrap(),d="char"!==f&&f!==ek,p=this.ellipsis();this.textArr=[],eI().font=this._getContextFont();let g=p?this._getTextWidth("…"):0;for(let e=0,i=t.length;e<i;++e){let a=t[e],u=this._getTextWidth(a);if(o&&u>l)for(;a.length>0;){let t=0,e=a.length,i="",o=0;for(;t<e;){let r=t+e>>>1,n=a.slice(0,r+1),s=this._getTextWidth(n)+g;s<=l?(t=r+1,i=n,o=s):e=r}if(i){if(d){var m;let e=a[i.length];(m=(" "===e||"-"===e)&&o<=l?i.length:Math.max(i.lastIndexOf(" "),i.lastIndexOf("-"))+1)>0&&(t=m,i=i.slice(0,t),o=this._getTextWidth(i))}if(i=i.trimRight(),this._addTextLine(i),r=Math.max(r,o),c+=n,this._shouldHandleEllipsis(c)){this._tryToAddEllipsisToLastLine();break}if((a=(a=a.slice(t)).trimLeft()).length>0&&(u=this._getTextWidth(a))<=l){this._addTextLine(a),c+=n,r=Math.max(r,u);break}}else break}else this._addTextLine(a),c+=n,r=Math.max(r,u),this._shouldHandleEllipsis(c)&&e<i-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),s&&c+n>h)break}this.textHeight=e,this.textWidth=r}_shouldHandleEllipsis(t){let e=+this.fontSize(),r=this.lineHeight()*e,n=this.attrs.height,i=this.padding();return!(this.wrap()!==ek)||n!==eF&&void 0!==n&&t+r>n-2*i}_tryToAddEllipsisToLastLine(){let t=this.attrs.width,e=this.padding(),r=this.ellipsis(),n=this.textArr[this.textArr.length-1];n&&r&&(t===eF||void 0===t||this._getTextWidth(n.text+"…")<t-2*e||(n.text=n.text.slice(0,n.text.length-3)),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(n.text+"…"))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let t=-1!==this.textDecoration().indexOf("underline")||-1!==this.textDecoration().indexOf("line-through"),e=this.hasShadow();return!!t&&!!e||super._useBufferCanvas()}}eS.Text=ez,ez.prototype._fillFunc=function(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)},ez.prototype._strokeFunc=function(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)},ez.prototype.className="Text",ez.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,f._registerNode)(ez),E.Factory.overWriteSetter(ez,"width",(0,C.getNumberOrAutoValidator)()),E.Factory.overWriteSetter(ez,"height",(0,C.getNumberOrAutoValidator)()),E.Factory.addGetterSetter(ez,"direction",eN),E.Factory.addGetterSetter(ez,"fontFamily","Arial"),E.Factory.addGetterSetter(ez,"fontSize",12,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ez,"fontStyle",eO),E.Factory.addGetterSetter(ez,"fontVariant",eO),E.Factory.addGetterSetter(ez,"padding",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ez,"align",eT),E.Factory.addGetterSetter(ez,"verticalAlign","top"),E.Factory.addGetterSetter(ez,"lineHeight",1,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ez,"wrap","word"),E.Factory.addGetterSetter(ez,"ellipsis",!1,(0,C.getBooleanValidator)()),E.Factory.addGetterSetter(ez,"letterSpacing",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ez,"text","",(0,C.getStringValidator)()),E.Factory.addGetterSetter(ez,"textDecoration","");var eU={};Object.defineProperty(eU,"__esModule",{value:!0}),eU.TextPath=void 0;const eL="normal";function eG(t){t.fillText(this.partialText,0,0)}function eq(t){t.strokeText(this.partialText,0,0)}class ej extends tN.Shape{constructor(t){super(t),this.dummyCanvas=p.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return t8.Path.getPathLength(this.dataArray)}_getPointAtLength(t){return!this.attrs.data||t-1>this.pathLength?null:t8.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=t8.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();let e=this.textDecoration(),r=this.fill(),n=this.fontSize(),i=this.glyphInfo;"underline"===e&&t.beginPath();for(let r=0;r<i.length;r++){t.save();let a=i[r].p0;t.translate(a.x,a.y),t.rotate(i[r].rotation),this.partialText=i[r].text,t.fillStrokeShape(this),"underline"===e&&(0===r&&t.moveTo(0,n/2+1),t.lineTo(n,n/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=r,t.lineWidth=n/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();let e=this.glyphInfo;if(e.length>=1){let r=e[0].p0;t.moveTo(r.x,r.y)}for(let r=0;r<e.length;r++){let n=e[r].p1;t.lineTo(n.x,n.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return p.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return eS.Text.prototype.setText.call(this,t)}_getContextFont(){return eS.Text.prototype._getContextFont.call(this)}_getTextSize(t){let e=this.dummyCanvas.getContext("2d");e.save(),e.font=this._getContextFont();let r=e.measureText(t);return e.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let{width:t,height:e}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=e,this.glyphInfo=[],!this.attrs.data)return null;let r=this.letterSpacing(),n=this.align(),i=this.kerningFunc(),a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0),o=0;"center"===n&&(o=Math.max(0,this.pathLength/2-a/2)),"right"===n&&(o=Math.max(0,this.pathLength-a));let s=(0,eS.stringToArray)(this.text()),u=o;for(let t=0;t<s.length;t++){let e=this._getPointAtLength(u);if(!e)return;let o=this._getTextSize(s[t]).width+r;if(" "===s[t]&&"justify"===n){let t=this.text().split(" ").length-1;o+=(this.pathLength-a)/t}let l=this._getPointAtLength(u+o);if(!l)return;let h=t8.Path.getLineLength(e.x,e.y,l.x,l.y),c=0;if(i)try{c=i(s[t-1],s[t])*this.fontSize()}catch(t){c=0}e.x+=c,l.x+=c,this.textWidth+=c;let f=t8.Path.getPointOnLine(c+h/2,e.x,e.y,l.x,l.y),d=Math.atan2(l.y-e.y,l.x-e.x);this.glyphInfo.push({transposeX:f.x,transposeY:f.y,text:s[t],rotation:d,p0:e,p1:l}),u+=o}}getSelfRect(){let t,e;if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let r=[];this.glyphInfo.forEach(function(t){r.push(t.p0.x),r.push(t.p0.y),r.push(t.p1.x),r.push(t.p1.y)});let n=r[0]||0,i=r[0]||0,a=r[1]||0,o=r[1]||0;for(let s=0;s<r.length/2;s++)t=r[2*s],e=r[2*s+1],n=Math.min(n,t),i=Math.max(i,t),a=Math.min(a,e),o=Math.max(o,e);let s=this.fontSize();return{x:n-s/2,y:a-s/2,width:i-n+s,height:o-a+s}}destroy(){return p.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}eU.TextPath=ej,ej.prototype._fillFunc=eG,ej.prototype._strokeFunc=eq,ej.prototype._fillFuncHit=eG,ej.prototype._strokeFuncHit=eq,ej.prototype.className="TextPath",ej.prototype._attrsAffectingSize=["text","fontSize","data"],(0,f._registerNode)(ej),E.Factory.addGetterSetter(ej,"data"),E.Factory.addGetterSetter(ej,"fontFamily","Arial"),E.Factory.addGetterSetter(ej,"fontSize",12,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ej,"fontStyle",eL),E.Factory.addGetterSetter(ej,"align","left"),E.Factory.addGetterSetter(ej,"letterSpacing",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(ej,"textBaseline","middle"),E.Factory.addGetterSetter(ej,"fontVariant",eL),E.Factory.addGetterSetter(ej,"text",""),E.Factory.addGetterSetter(ej,"textDecoration",null),E.Factory.addGetterSetter(ej,"kerningFunc",null);var eV={};Object.defineProperty(eV,"__esModule",{value:!0}),eV.Transformer=void 0;const eH="tr-konva",eY=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${eH}`).join(" "),eW="nodesRect",e$=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],eK={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},eX="ontouchstart"in f.Konva._global,eZ=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function eJ(t,e,r){let n=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),i=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:n,y:i}}let eQ=0;class e0 extends tq.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(eY,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return p.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return eH+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();let e=t.filter(t=>!t.isAncestorOf(this)||(p.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1));return this._nodes=t=e,1===t.length&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(t=>{let e=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),this._transforming||this.isDragging()||this.update()},r=t._attrsAffectingSize.map(t=>t+"Change."+this._getEventNamespace()).join(" ");t.on(r,e),t.on(e$.map(t=>t+`.${this._getEventNamespace()}`).join(" "),e),t.on(`absoluteTransformChange.${this._getEventNamespace()}`,e),this._proxyDrag(t)}),this._resetTransformCache(),this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,r=>{e=t.getAbsolutePosition(),this.isDragging()||t===this.findOne(".back")||this.startDrag(r,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!e)return;let n=t.getAbsolutePosition(),i=n.x-e.x,a=n.y-e.y;this.nodes().forEach(e=>{if(e===t||e.isDragging())return;let n=e.getAbsolutePosition();e.setAbsolutePosition({x:n.x+i,y:n.y+a}),e.startDrag(r)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(eW),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(eW,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),r){let n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),i=t.getAbsoluteScale(r),a=t.getAbsolutePosition(r),o=n.x*i.x-t.offsetX()*i.x,s=n.y*i.y-t.offsetY()*i.y,u=(f.Konva.getAngle(t.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI);return eJ({x:a.x+o*Math.cos(u)+s*Math.sin(-u),y:a.y+s*Math.cos(u)+o*Math.sin(u),width:n.width*i.x,height:n.height*i.y,rotation:u},-f.Konva.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};let t=[];this.nodes().map(e=>{let r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),n=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],i=e.getAbsoluteTransform();n.forEach(function(e){let r=i.point(e);t.push(r)})});let e=new p.Transform;e.rotate(-f.Konva.getAngle(this.rotation()));let r=1/0,n=1/0,i=-1/0,a=-1/0;t.forEach(function(t){let o=e.point(t);void 0===r&&(r=i=o.x,n=a=o.y),r=Math.min(r,o.x),n=Math.min(n,o.y),i=Math.max(i,o.x),a=Math.max(a,o.y)}),e.invert();let o=e.point({x:r,y:n});return{x:o.x,y:o.y,width:i-r,height:a-n,rotation:f.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),eZ.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){let e=new eg.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:eX?10:"auto"}),r=this;e.on("mousedown touchstart",function(t){r._handleMouseDown(t)}),e.on("dragstart",t=>{e.stopDrag(),t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),e.on("mouseenter",()=>{let r=function(t,e,r){if("rotater"===t)return r;e+=p.Util.degToRad(eK[t]||0);let n=(p.Util.radToDeg(e)%360+360)%360;return p.Util._inRange(n,337.5,360)||p.Util._inRange(n,0,22.5)?"ns-resize":p.Util._inRange(n,22.5,67.5)?"nesw-resize":p.Util._inRange(n,67.5,112.5)?"ew-resize":p.Util._inRange(n,112.5,157.5)?"nwse-resize":p.Util._inRange(n,157.5,202.5)?"ns-resize":p.Util._inRange(n,202.5,247.5)?"nesw-resize":p.Util._inRange(n,247.5,292.5)?"ew-resize":p.Util._inRange(n,292.5,337.5)?"nwse-resize":(p.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}(t,f.Konva.getAngle(this.rotation()),this.rotateAnchorCursor());e.getStage().content&&(e.getStage().content.style.cursor=r),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){let t=new tN.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(t,e){let r=e.getParent(),n=r.padding();t.beginPath(),t.rect(-n,-n,e.width()+2*n,e.height()+2*n),t.moveTo(e.width()/2,-n),r.rotateEnabled()&&r.rotateLineVisible()&&t.lineTo(e.width()/2,-r.rotateAnchorOffset()*p.Util._sign(e.height())-n),t.fillStrokeShape(e)},hitFunc:(t,e)=>{if(!this.shouldOverdrawWholeArea())return;let r=this.padding();t.beginPath(),t.rect(-r,-r,e.width()+2*r,e.height()+2*r),t.fillStrokeShape(e)}});this.add(t),this._proxyDrag(t),t.on("dragstart",t=>{t.cancelBubble=!0}),t.on("dragmove",t=>{t.cancelBubble=!0}),t.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];let e=this._getNodeRect(),r=e.width,n=e.height,i=Math.sqrt(Math.pow(r,2)+Math.pow(n,2));this.sin=Math.abs(n/i),this.cos=Math.abs(r/i),"undefined"!=typeof window&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;let a=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-a.x,y:o.y-a.y},eQ++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(e=>{e._fire("transformstart",{evt:t.evt,target:e})})}_handleMouseMove(t){let e,r,n,i;let a=this.findOne("."+this._movingAnchorName),o=a.getStage();o.setPointersPositions(t);let s=o.getPointerPosition(),u={x:s.x-this._anchorDragOffset.x,y:s.y-this._anchorDragOffset.y},l=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(l,u,t)),a.setAbsolutePosition(u);let h=a.getAbsolutePosition();if(l.x===h.x&&l.y===h.y)return;if("rotater"===this._movingAnchorName){let n=this._getNodeRect();e=a.x()-n.width/2;let i=Math.atan2(-(r=-a.y()+n.height/2),e)+Math.PI/2;n.height<0&&(i-=Math.PI);let o=f.Konva.getAngle(this.rotation())+i,s=f.Konva.getAngle(this.rotationSnapTolerance()),u=function(t,e,r){let n=e;for(let i=0;i<t.length;i++){let a=f.Konva.getAngle(t[i]),o=Math.abs(a-e)%(2*Math.PI);Math.min(o,2*Math.PI-o)<r&&(n=a)}return n}(this.rotationSnaps(),o,s)-n.rotation,l=function(t,e){let r={x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)};return eJ(t,e,r)}(n,u);this._fitNodesInto(l,t);return}let c=this.shiftBehavior();i="inverted"===c?this.keepRatio()&&!t.shiftKey:"none"===c?this.keepRatio():this.keepRatio()||t.shiftKey;var d=this.centeredScaling()||t.altKey;if("top-left"===this._movingAnchorName){if(i){var p=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};n=Math.sqrt(Math.pow(p.x-a.x(),2)+Math.pow(p.y-a.y(),2));var g=this.findOne(".top-left").x()>p.x?-1:1,m=this.findOne(".top-left").y()>p.y?-1:1;e=n*this.cos*g,r=n*this.sin*m,this.findOne(".top-left").x(p.x-e),this.findOne(".top-left").y(p.y-r)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(a.y());else if("top-right"===this._movingAnchorName){if(i){var p=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};n=Math.sqrt(Math.pow(a.x()-p.x,2)+Math.pow(p.y-a.y(),2));var g=this.findOne(".top-right").x()<p.x?-1:1,m=this.findOne(".top-right").y()>p.y?-1:1;e=n*this.cos*g,r=n*this.sin*m,this.findOne(".top-right").x(p.x+e),this.findOne(".top-right").y(p.y-r)}var v=a.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if("middle-left"===this._movingAnchorName)this.findOne(".top-left").x(a.x());else if("middle-right"===this._movingAnchorName)this.findOne(".bottom-right").x(a.x());else if("bottom-left"===this._movingAnchorName){if(i){var p=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};n=Math.sqrt(Math.pow(p.x-a.x(),2)+Math.pow(a.y()-p.y,2));var g=p.x<a.x()?-1:1,m=a.y()<p.y?-1:1;e=n*this.cos*g,r=n*this.sin*m,a.x(p.x-e),a.y(p.y+r)}v=a.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if("bottom-center"===this._movingAnchorName)this.findOne(".bottom-right").y(a.y());else if("bottom-right"===this._movingAnchorName){if(i){var p=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};n=Math.sqrt(Math.pow(a.x()-p.x,2)+Math.pow(a.y()-p.y,2));var g=this.findOne(".bottom-right").x()<p.x?-1:1,m=this.findOne(".bottom-right").y()<p.y?-1:1;e=n*this.cos*g,r=n*this.sin*m,this.findOne(".bottom-right").x(p.x+e),this.findOne(".bottom-right").y(p.y+r)}}else console.error(Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var d=this.centeredScaling()||t.altKey;if(d){let t=this.findOne(".top-left"),e=this.findOne(".bottom-right"),r=t.x(),n=t.y(),i=this.getWidth()-e.x(),a=this.getHeight()-e.y();e.move({x:-r,y:-n}),t.move({x:i,y:a})}let y=this.findOne(".top-left").getAbsolutePosition();e=y.x,r=y.y;let x=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),b=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:r,width:x,height:b,rotation:f.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var e;if(this._transforming){this._transforming=!1,"undefined"!=typeof window&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));let r=this.getNode();eQ--,this._fire("transformend",{evt:t,target:r}),null===(e=this.getLayer())||void 0===e||e.batchDraw(),r&&this._nodes.forEach(e=>{var r;e._fire("transformend",{evt:t,target:e}),null===(r=e.getLayer())||void 0===r||r.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,e){let r=this._getNodeRect();if(p.Util._inRange(t.width,-(2*this.padding())-1,1)||p.Util._inRange(t.height,-(2*this.padding())-1,1)){this.update();return}let n=new p.Transform;if(n.rotate(f.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){let e=n.point({x:-(2*this.padding()),y:0});t.x+=e.x,t.y+=e.y,t.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){let e=n.point({x:2*this.padding(),y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.width+=2*this.padding()}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){let e=n.point({x:0,y:-(2*this.padding())});t.x+=e.x,t.y+=e.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding()}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){let e=n.point({x:0,y:2*this.padding()});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding()}if(this.boundBoxFunc()){let e=this.boundBoxFunc()(r,t);e?t=e:p.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}let i=new p.Transform;i.translate(r.x,r.y),i.rotate(r.rotation),i.scale(r.width/1e7,r.height/1e7);let a=new p.Transform,o=t.width/1e7,s=t.height/1e7;!1===this.flipEnabled()?(a.translate(t.x,t.y),a.rotate(t.rotation),a.translate(t.width<0?t.width:0,t.height<0?t.height:0),a.scale(Math.abs(o),Math.abs(s))):(a.translate(t.x,t.y),a.rotate(t.rotation),a.scale(o,s));let u=a.multiply(i.invert());this._nodes.forEach(t=>{var e;let r=t.getParent().getAbsoluteTransform(),n=t.getTransform().copy();n.translate(t.offsetX(),t.offsetY());let i=new p.Transform;i.multiply(r.copy().invert()).multiply(u).multiply(r).multiply(n);let a=i.decompose();t.setAttrs(a),null===(e=t.getLayer())||void 0===e||e.batchDraw()}),this.rotation(p.Util._getRotation(t.rotation)),this._nodes.forEach(t=>{this._fire("transform",{evt:e,target:t}),t._fire("transform",{evt:e,target:t})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t;let e=this._getNodeRect();this.rotation(p.Util._getRotation(e.rotation));let r=e.width,n=e.height,i=this.enabledAnchors(),a=this.resizeEnabled(),o=this.padding(),s=this.anchorSize(),u=this.find("._anchor");u.forEach(t=>{t.setAttrs({width:s,height:s,offsetX:s/2,offsetY:s/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:s/2+o,offsetY:s/2+o,visible:a&&i.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:s/2+o,visible:a&&i.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:s/2-o,offsetY:s/2+o,visible:a&&i.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:n/2,offsetX:s/2+o,visible:a&&i.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:n/2,offsetX:s/2-o,visible:a&&i.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:n,offsetX:s/2+o,offsetY:s/2-o,visible:a&&i.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:n,offsetY:s/2-o,visible:a&&i.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:n,offsetX:s/2-o,offsetY:s/2-o,visible:a&&i.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*p.Util._sign(n)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:n,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});let l=this.anchorStyleFunc();l&&u.forEach(t=>{l(t)}),null===(t=this.getLayer())||void 0===t||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),tq.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return w.Node.prototype.toObject.call(this)}clone(t){return w.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}eV.Transformer=e0,e0.isTransforming=()=>eQ>0,e0.prototype.className="Transformer",(0,f._registerNode)(e0),E.Factory.addGetterSetter(e0,"enabledAnchors",eZ,function(t){return t instanceof Array||p.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(t){-1===eZ.indexOf(t)&&p.Util.warn("Unknown anchor name: "+t+". Available names are: "+eZ.join(", "))}),t||[]}),E.Factory.addGetterSetter(e0,"flipEnabled",!0,(0,C.getBooleanValidator)()),E.Factory.addGetterSetter(e0,"resizeEnabled",!0),E.Factory.addGetterSetter(e0,"anchorSize",10,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(e0,"rotateEnabled",!0),E.Factory.addGetterSetter(e0,"rotateLineVisible",!0),E.Factory.addGetterSetter(e0,"rotationSnaps",[]),E.Factory.addGetterSetter(e0,"rotateAnchorOffset",50,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(e0,"rotateAnchorCursor","crosshair"),E.Factory.addGetterSetter(e0,"rotationSnapTolerance",5,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(e0,"borderEnabled",!0),E.Factory.addGetterSetter(e0,"anchorStroke","rgb(0, 161, 255)"),E.Factory.addGetterSetter(e0,"anchorStrokeWidth",1,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(e0,"anchorFill","white"),E.Factory.addGetterSetter(e0,"anchorCornerRadius",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(e0,"borderStroke","rgb(0, 161, 255)"),E.Factory.addGetterSetter(e0,"borderStrokeWidth",1,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(e0,"borderDash"),E.Factory.addGetterSetter(e0,"keepRatio",!0),E.Factory.addGetterSetter(e0,"shiftBehavior","default"),E.Factory.addGetterSetter(e0,"centeredScaling",!1),E.Factory.addGetterSetter(e0,"ignoreStroke",!1),E.Factory.addGetterSetter(e0,"padding",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(e0,"node"),E.Factory.addGetterSetter(e0,"nodes"),E.Factory.addGetterSetter(e0,"boundBoxFunc"),E.Factory.addGetterSetter(e0,"anchorDragBoundFunc"),E.Factory.addGetterSetter(e0,"anchorStyleFunc"),E.Factory.addGetterSetter(e0,"shouldOverdrawWholeArea",!1),E.Factory.addGetterSetter(e0,"useSingleNodeRotation",!0),E.Factory.backCompat(e0,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var e1={};Object.defineProperty(e1,"__esModule",{value:!0}),e1.Wedge=void 0;class e2 extends tN.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,f.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}e1.Wedge=e2,e2.prototype.className="Wedge",e2.prototype._centroid=!0,e2.prototype._attrsAffectingSize=["radius"],(0,f._registerNode)(e2),E.Factory.addGetterSetter(e2,"radius",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(e2,"angle",0,(0,C.getNumberValidator)()),E.Factory.addGetterSetter(e2,"clockwise",!1),E.Factory.backCompat(e2,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var e5={};function e3(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}Object.defineProperty(e5,"__esModule",{value:!0}),e5.Blur=void 0;const e4=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],e8=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];e5.Blur=function(t){let e=Math.round(this.blurRadius());e>0&&function(t,e){let r,n,i,a,o,s,u,l,h,c,f,d,p,g,m,v,y,x,b,D,_,w,E,C;let S=t.data,A=t.width,F=t.height,N=e+e+1,M=A-1,T=F-1,B=e+1,O=B*(B+1)/2,k=new e3,P=null,R=k,I=null,z=null,U=e4[e],L=e8[e];for(i=1;i<N;i++)R=R.next=new e3,i===B&&(P=R);for(n=0,R.next=k,u=s=0;n<F;n++){for(v=y=x=b=l=h=c=f=0,d=B*(D=S[s]),p=B*(_=S[s+1]),g=B*(w=S[s+2]),m=B*(E=S[s+3]),l+=O*D,h+=O*_,c+=O*w,f+=O*E,R=k,i=0;i<B;i++)R.r=D,R.g=_,R.b=w,R.a=E,R=R.next;for(i=1;i<B;i++)a=s+((M<i?M:i)<<2),l+=(R.r=D=S[a])*(C=B-i),h+=(R.g=_=S[a+1])*C,c+=(R.b=w=S[a+2])*C,f+=(R.a=E=S[a+3])*C,v+=D,y+=_,x+=w,b+=E,R=R.next;for(r=0,I=k,z=P;r<A;r++)S[s+3]=E=f*U>>L,0!==E?(E=255/E,S[s]=(l*U>>L)*E,S[s+1]=(h*U>>L)*E,S[s+2]=(c*U>>L)*E):S[s]=S[s+1]=S[s+2]=0,l-=d,h-=p,c-=g,f-=m,d-=I.r,p-=I.g,g-=I.b,m-=I.a,a=u+((a=r+e+1)<M?a:M)<<2,v+=I.r=S[a],y+=I.g=S[a+1],x+=I.b=S[a+2],b+=I.a=S[a+3],l+=v,h+=y,c+=x,f+=b,I=I.next,d+=D=z.r,p+=_=z.g,g+=w=z.b,m+=E=z.a,v-=D,y-=_,x-=w,b-=E,z=z.next,s+=4;u+=A}for(r=0;r<A;r++){for(y=x=b=v=h=c=f=l=0,d=B*(D=S[s=r<<2]),p=B*(_=S[s+1]),g=B*(w=S[s+2]),m=B*(E=S[s+3]),l+=O*D,h+=O*_,c+=O*w,f+=O*E,R=k,i=0;i<B;i++)R.r=D,R.g=_,R.b=w,R.a=E,R=R.next;for(i=1,o=A;i<=e;i++)s=o+r<<2,l+=(R.r=D=S[s])*(C=B-i),h+=(R.g=_=S[s+1])*C,c+=(R.b=w=S[s+2])*C,f+=(R.a=E=S[s+3])*C,v+=D,y+=_,x+=w,b+=E,R=R.next,i<T&&(o+=A);for(n=0,s=r,I=k,z=P;n<F;n++)S[(a=s<<2)+3]=E=f*U>>L,E>0?(E=255/E,S[a]=(l*U>>L)*E,S[a+1]=(h*U>>L)*E,S[a+2]=(c*U>>L)*E):S[a]=S[a+1]=S[a+2]=0,l-=d,h-=p,c-=g,f-=m,d-=I.r,p-=I.g,g-=I.b,m-=I.a,a=r+((a=n+B)<T?a:T)*A<<2,l+=v+=I.r=S[a],h+=y+=I.g=S[a+1],c+=x+=I.b=S[a+2],f+=b+=I.a=S[a+3],I=I.next,d+=D=z.r,p+=_=z.g,g+=w=z.b,m+=E=z.a,v-=D,y-=_,x-=w,b-=E,z=z.next,s+=A}}(t,e)},E.Factory.addGetterSetter(w.Node,"blurRadius",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var e6={};Object.defineProperty(e6,"__esModule",{value:!0}),e6.Brighten=void 0,e6.Brighten=function(t){let e=255*this.brightness(),r=t.data,n=r.length,i;for(i=0;i<n;i+=4)r[i]+=e,r[i+1]+=e,r[i+2]+=e},E.Factory.addGetterSetter(w.Node,"brightness",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var e9={};Object.defineProperty(e9,"__esModule",{value:!0}),e9.Contrast=void 0,e9.Contrast=function(t){let e=Math.pow((this.contrast()+100)/100,2),r=t.data,n=r.length,i=150,a=150,o=150,s;for(s=0;s<n;s+=4)i=r[s],a=r[s+1],o=r[s+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,o=o<0?0:o>255?255:o,r[s]=i,r[s+1]=a,r[s+2]=o},E.Factory.addGetterSetter(w.Node,"contrast",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var e7={};Object.defineProperty(e7,"__esModule",{value:!0}),e7.Emboss=void 0,e7.Emboss=function(t){let e=10*this.embossStrength(),r=255*this.embossWhiteLevel(),n=this.embossDirection(),i=this.embossBlend(),a=0,o=0,s=t.data,u=t.width,l=t.height,h=4*u,c=l;switch(n){case"top-left":a=-1,o=-1;break;case"top":a=-1,o=0;break;case"top-right":a=-1,o=1;break;case"right":a=0,o=1;break;case"bottom-right":a=1,o=1;break;case"bottom":a=1,o=0;break;case"bottom-left":a=1,o=-1;break;case"left":a=0,o=-1;break;default:p.Util.error("Unknown emboss direction: "+n)}do{let t=(c-1)*h,n=a;c+n<1&&(n=0),c+n>l&&(n=0);let f=(c-1+n)*u*4,d=u;do{let n=t+(d-1)*4,a=o;d+a<1&&(a=0),d+a>u&&(a=0);let l=f+(d-1+a)*4,h=s[n]-s[l],c=s[n+1]-s[l+1],p=s[n+2]-s[l+2],g=h,m=g>0?g:-g,v=p>0?p:-p;if((c>0?c:-c)>m&&(g=c),v>m&&(g=p),g*=e,i){let t=s[n]+g,e=s[n+1]+g,r=s[n+2]+g;s[n]=t>255?255:t<0?0:t,s[n+1]=e>255?255:e<0?0:e,s[n+2]=r>255?255:r<0?0:r}else{let t=r-g;t<0?t=0:t>255&&(t=255),s[n]=s[n+1]=s[n+2]=t}}while(--d)}while(--c)},E.Factory.addGetterSetter(w.Node,"embossStrength",.5,(0,C.getNumberValidator)(),E.Factory.afterSetFilter),E.Factory.addGetterSetter(w.Node,"embossWhiteLevel",.5,(0,C.getNumberValidator)(),E.Factory.afterSetFilter),E.Factory.addGetterSetter(w.Node,"embossDirection","top-left",null,E.Factory.afterSetFilter),E.Factory.addGetterSetter(w.Node,"embossBlend",!1,null,E.Factory.afterSetFilter);var rt={};function re(t,e,r,n,i){let a=r-e,o=i-n;return 0===a?n+o/2:0===o?n:(t-e)/a*o+n}Object.defineProperty(rt,"__esModule",{value:!0}),rt.Enhance=void 0,rt.Enhance=function(t){let e,r,n,i,a,o,s,u,l,h=t.data,c=h.length,f=h[0],d=f,p,g=h[1],m=g,v,y=h[2],x=y,b,D,_=this.enhance();if(0!==_){for(D=0;D<c;D+=4)(p=h[D+0])<f?f=p:p>d&&(d=p),(v=h[D+1])<g?g=v:v>m&&(m=v),(b=h[D+2])<y?y=b:b>x&&(x=b);for(d===f&&(d=255,f=0),m===g&&(m=255,g=0),x===y&&(x=255,y=0),_>0?(r=d+_*(255-d),n=f-_*(f-0),a=m+_*(255-m),o=g-_*(g-0),u=x+_*(255-x),l=y-_*(y-0)):(e=(d+f)*.5,r=d+_*(d-e),n=f+_*(f-e),i=(m+g)*.5,a=m+_*(m-i),o=g+_*(g-i),s=(x+y)*.5,u=x+_*(x-s),l=y+_*(y-s)),D=0;D<c;D+=4)h[D+0]=re(h[D+0],f,d,n,r),h[D+1]=re(h[D+1],g,m,o,a),h[D+2]=re(h[D+2],y,x,l,u)}},E.Factory.addGetterSetter(w.Node,"enhance",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var rr={};Object.defineProperty(rr,"__esModule",{value:!0}),rr.Grayscale=void 0,rr.Grayscale=function(t){let e=t.data,r=e.length,n,i;for(n=0;n<r;n+=4)i=.34*e[n]+.5*e[n+1]+.16*e[n+2],e[n]=i,e[n+1]=i,e[n+2]=i};var rn={};Object.defineProperty(rn,"__esModule",{value:!0}),rn.HSL=void 0,E.Factory.addGetterSetter(w.Node,"hue",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter),E.Factory.addGetterSetter(w.Node,"saturation",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter),E.Factory.addGetterSetter(w.Node,"luminance",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter),rn.HSL=function(t){let e,r,n,i,a=t.data,o=a.length,s=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,l=127*this.luminance(),h,c=1*s*Math.cos(u*Math.PI/180),f=1*s*Math.sin(u*Math.PI/180),d=.299+.701*c+.167*f,p=.587-.587*c+.33*f,g=.114-.114*c-.497*f,m=.299-.299*c-.328*f,v=.587+.413*c+.035*f,y=.114-.114*c+.293*f,x=.299-.3*c+1.25*f,b=.587-.586*c-1.05*f,D=.114+.886*c-.2*f;for(h=0;h<o;h+=4)e=a[h+0],r=a[h+1],n=a[h+2],i=a[h+3],a[h+0]=d*e+p*r+g*n+l,a[h+1]=m*e+v*r+y*n+l,a[h+2]=x*e+b*r+D*n+l,a[h+3]=i};var ri={};Object.defineProperty(ri,"__esModule",{value:!0}),ri.HSV=void 0,ri.HSV=function(t){let e,r,n,i;let a=t.data,o=a.length,s=Math.pow(2,this.value()),u=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,h=s*u*Math.cos(l*Math.PI/180),c=s*u*Math.sin(l*Math.PI/180),f=.299*s+.701*h+.167*c,d=.587*s-.587*h+.33*c,p=.114*s-.114*h-.497*c,g=.299*s-.299*h-.328*c,m=.587*s+.413*h+.035*c,v=.114*s-.114*h+.293*c,y=.299*s-.3*h+1.25*c,x=.587*s-.586*h-1.05*c,b=.114*s+.886*h-.2*c;for(let t=0;t<o;t+=4)e=a[t+0],r=a[t+1],n=a[t+2],i=a[t+3],a[t+0]=f*e+d*r+p*n,a[t+1]=g*e+m*r+v*n,a[t+2]=y*e+x*r+b*n,a[t+3]=i},E.Factory.addGetterSetter(w.Node,"hue",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter),E.Factory.addGetterSetter(w.Node,"saturation",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter),E.Factory.addGetterSetter(w.Node,"value",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var ra={};Object.defineProperty(ra,"__esModule",{value:!0}),ra.Invert=void 0,ra.Invert=function(t){let e=t.data,r=e.length,n;for(n=0;n<r;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]};var ro={};Object.defineProperty(ro,"__esModule",{value:!0}),ro.Kaleidoscope=void 0;const rs=function(t,e,r){let n,i,a=t.data,o=e.data,s=t.width,u=t.height,l=r.polarCenterX||s/2,h=r.polarCenterY||u/2,c,f,d,p=0,g=0,m=0,v=0,y,x=Math.sqrt(l*l+h*h);x=(y=Math.sqrt((f=s-l)*f+(d=u-h)*d))>x?y:x;let b=360/s*Math.PI/180,D,_;for(i=0;i<s;i+=1)for(n=0,D=Math.sin(i*b),_=Math.cos(i*b);n<u;n+=1)f=Math.floor(l+x*n/u*_),p=a[(c=((d=Math.floor(h+x*n/u*D))*s+f)*4)+0],g=a[c+1],m=a[c+2],v=a[c+3],o[(c=(i+n*s)*4)+0]=p,o[c+1]=g,o[c+2]=m,o[c+3]=v},ru=function(t,e,r){let n,i=t.data,a=e.data,o=t.width,s=t.height,u=r.polarCenterX||o/2,l=r.polarCenterY||s/2,h,c,f,d,p,g=0,m=0,v=0,y=0,x,b=Math.sqrt(u*u+l*l);b=(x=Math.sqrt((c=o-u)*c+(f=s-l)*f))>b?x:b;let D,_=r.polarRotation||0;for(c=0;c<o;c+=1)for(f=0;f<s;f+=1)D=Math.sqrt((d=c-u)*d+(p=f-l)*p)*s/b,n=Math.floor((180*Math.atan2(p,d)/Math.PI+360+_)%360*o/360),g=i[(h=(Math.floor(D)*o+n)*4)+0],m=i[h+1],v=i[h+2],y=i[h+3],a[(h=(f*o+c)*4)+0]=g,a[h+1]=m,a[h+2]=v,a[h+3]=y};ro.Kaleidoscope=function(t){let e,r,n,i,a,o,s,u,l,h;let c=t.width,f=t.height,d=Math.round(this.kaleidoscopePower()),g=Math.floor(Math.round(this.kaleidoscopeAngle())%360*c/360);if(d<1)return;let m=p.Util.createCanvasElement();m.width=c,m.height=f;let v=m.getContext("2d").getImageData(0,0,c,f);p.Util.releaseCanvas(m),rs(t,v,{polarCenterX:c/2,polarCenterY:f/2});let y=c/Math.pow(2,d);for(;y<=8;)y*=2,d-=1;let x=y=Math.ceil(y),b=0,D=x,_=1;for(g+y>c&&(b=x,D=0,_=-1),r=0;r<f;r+=1)for(e=b;e!==D;e+=_)n=Math.round(e+g)%c,l=(c*r+n)*4,a=v.data[l+0],o=v.data[l+1],s=v.data[l+2],u=v.data[l+3],h=(c*r+e)*4,v.data[h+0]=a,v.data[h+1]=o,v.data[h+2]=s,v.data[h+3]=u;for(r=0;r<f;r+=1)for(i=0,x=Math.floor(y);i<d;i+=1){for(e=0;e<x+1;e+=1)l=(c*r+e)*4,a=v.data[l+0],o=v.data[l+1],s=v.data[l+2],u=v.data[l+3],h=(c*r+2*x-e-1)*4,v.data[h+0]=a,v.data[h+1]=o,v.data[h+2]=s,v.data[h+3]=u;x*=2}ru(v,t,{polarRotation:0})},E.Factory.addGetterSetter(w.Node,"kaleidoscopePower",2,(0,C.getNumberValidator)(),E.Factory.afterSetFilter),E.Factory.addGetterSetter(w.Node,"kaleidoscopeAngle",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var rl={};function rh(t,e,r){let n=(r*t.width+e)*4,i=[];return i.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),i}function rc(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}Object.defineProperty(rl,"__esModule",{value:!0}),rl.Mask=void 0,rl.Mask=function(t){let e=function(t,e){let r=rh(t,0,0),n=rh(t,t.width-1,0),i=rh(t,0,t.height-1),a=rh(t,t.width-1,t.height-1),o=e||10;if(rc(r,n)<o&&rc(n,a)<o&&rc(a,i)<o&&rc(i,r)<o){let e=function(t){let e=[0,0,0];for(let r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}([n,r,a,i]),s=[];for(let r=0;r<t.width*t.height;r++){let n=rc(e,[t.data[4*r],t.data[4*r+1],t.data[4*r+2]]);s[r]=n<o?0:255}return s}}(t,this.threshold());return e&&(e=function(t,e,r){let n=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),o=[];for(let s=0;s<r;s++)for(let u=0;u<e;u++){let l=s*e+u,h=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++){let c=s+o-a,f=u+l-a;if(c>=0&&c<r&&f>=0&&f<e){let r=c*e+f,a=n[o*i+l];h+=t[r]*a}}o[l]=h}return o}(e=function(t,e,r){let n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),o=[];for(let s=0;s<r;s++)for(let u=0;u<e;u++){let l=s*e+u,h=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++){let c=s+o-a,f=u+l-a;if(c>=0&&c<r&&f>=0&&f<e){let r=c*e+f,a=n[o*i+l];h+=t[r]*a}}o[l]=h>=1020?255:0}return o}(e=function(t,e,r){let n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),o=[];for(let s=0;s<r;s++)for(let u=0;u<e;u++){let l=s*e+u,h=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++){let c=s+o-a,f=u+l-a;if(c>=0&&c<r&&f>=0&&f<e){let r=c*e+f,a=n[o*i+l];h+=t[r]*a}}o[l]=2040===h?255:0}return o}(e,t.width,t.height),t.width,t.height),t.width,t.height),function(t,e){for(let r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}(t,e)),t},E.Factory.addGetterSetter(w.Node,"threshold",0,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var rf={};Object.defineProperty(rf,"__esModule",{value:!0}),rf.Noise=void 0,rf.Noise=function(t){let e=255*this.noise(),r=t.data,n=r.length,i=e/2;for(let t=0;t<n;t+=4)r[t+0]+=i-2*i*Math.random(),r[t+1]+=i-2*i*Math.random(),r[t+2]+=i-2*i*Math.random()},E.Factory.addGetterSetter(w.Node,"noise",.2,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var rd={};Object.defineProperty(rd,"__esModule",{value:!0}),rd.Pixelate=void 0,rd.Pixelate=function(t){let e=Math.ceil(this.pixelSize()),r=t.width,n=t.height,i,a,o,s,u,l,h,c=Math.ceil(r/e),f=Math.ceil(n/e),d,g,m,v,y,x,b,D=t.data;if(e<=0){p.Util.error("pixelSize value can not be <= 0");return}for(y=0;y<c;y+=1)for(x=0;x<f;x+=1){for(s=0,u=0,l=0,h=0,g=(d=y*e)+e,v=(m=x*e)+e,b=0,i=d;i<g;i+=1)if(!(i>=r))for(a=m;a<v;a+=1)a>=n||(s+=D[(o=(r*a+i)*4)+0],u+=D[o+1],l+=D[o+2],h+=D[o+3],b+=1);for(s/=b,u/=b,l/=b,h/=b,i=d;i<g;i+=1)if(!(i>=r))for(a=m;a<v;a+=1)a>=n||(D[(o=(r*a+i)*4)+0]=s,D[o+1]=u,D[o+2]=l,D[o+3]=h)}},E.Factory.addGetterSetter(w.Node,"pixelSize",8,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var rp={};Object.defineProperty(rp,"__esModule",{value:!0}),rp.Posterize=void 0,rp.Posterize=function(t){let e=Math.round(254*this.levels())+1,r=t.data,n=r.length,i=255/e,a;for(a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i},E.Factory.addGetterSetter(w.Node,"levels",.5,(0,C.getNumberValidator)(),E.Factory.afterSetFilter);var rg={};Object.defineProperty(rg,"__esModule",{value:!0}),rg.RGB=void 0,rg.RGB=function(t){let e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue(),o,s;for(o=0;o<r;o+=4)s=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255,e[o]=s*n,e[o+1]=s*i,e[o+2]=s*a,e[o+3]=e[o+3]},E.Factory.addGetterSetter(w.Node,"red",0,function(t){return(this._filterUpToDate=!1,t>255)?255:t<0?0:Math.round(t)}),E.Factory.addGetterSetter(w.Node,"green",0,function(t){return(this._filterUpToDate=!1,t>255)?255:t<0?0:Math.round(t)}),E.Factory.addGetterSetter(w.Node,"blue",0,C.RGBComponent,E.Factory.afterSetFilter);var rm={};Object.defineProperty(rm,"__esModule",{value:!0}),rm.RGBA=void 0,rm.RGBA=function(t){let e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue(),o=this.alpha();for(let t=0;t<r;t+=4){let r=1-o;e[t]=n*o+e[t]*r,e[t+1]=i*o+e[t+1]*r,e[t+2]=a*o+e[t+2]*r}},E.Factory.addGetterSetter(w.Node,"red",0,function(t){return(this._filterUpToDate=!1,t>255)?255:t<0?0:Math.round(t)}),E.Factory.addGetterSetter(w.Node,"green",0,function(t){return(this._filterUpToDate=!1,t>255)?255:t<0?0:Math.round(t)}),E.Factory.addGetterSetter(w.Node,"blue",0,C.RGBComponent,E.Factory.afterSetFilter),E.Factory.addGetterSetter(w.Node,"alpha",1,function(t){return(this._filterUpToDate=!1,t>1)?1:t<0?0:t});var rv={};Object.defineProperty(rv,"__esModule",{value:!0}),rv.Sepia=void 0,rv.Sepia=function(t){let e=t.data,r=e.length,n,i,a,o;for(n=0;n<r;n+=4)i=e[n+0],a=e[n+1],o=e[n+2],e[n+0]=Math.min(255,.393*i+.769*a+.189*o),e[n+1]=Math.min(255,.349*i+.686*a+.168*o),e[n+2]=Math.min(255,.272*i+.534*a+.131*o)};var ry={};Object.defineProperty(ry,"__esModule",{value:!0}),ry.Solarize=void 0,ry.Solarize=function(t){let e=t.data,r=t.width,n=t.height,i=4*r,a=n;do{let t=(a-1)*i,n=r;do{let r=t+(n-1)*4,i=e[r],a=e[r+1],o=e[r+2];i>127&&(i=255-i),a>127&&(a=255-a),o>127&&(o=255-o),e[r]=i,e[r+1]=a,e[r+2]=o}while(--n)}while(--a)};var rx={};Object.defineProperty(rx,"__esModule",{value:!0}),rx.Threshold=void 0,rx.Threshold=function(t){let e=255*this.threshold(),r=t.data,n=r.length;for(let t=0;t<n;t+=1)r[t]=r[t]<e?0:255},E.Factory.addGetterSetter(w.Node,"threshold",.5,(0,C.getNumberValidator)(),E.Factory.afterSetFilter),h.Konva=c.Konva.Util._assign(c.Konva,{Arc:tQ.Arc,Arrow:t1.Arrow,Circle:ee.Circle,Ellipse:en.Ellipse,Image:ea.Image,Label:es.Label,Tag:es.Tag,Line:t2.Line,Path:t8.Path,Rect:eg.Rect,RegularPolygon:ev.RegularPolygon,Ring:ex.Ring,Sprite:e_.Sprite,Star:eE.Star,Text:eS.Text,TextPath:eU.TextPath,Transformer:eV.Transformer,Wedge:e1.Wedge,Filters:{Blur:e5.Blur,Brighten:e6.Brighten,Contrast:e9.Contrast,Emboss:e7.Emboss,Enhance:rt.Enhance,Grayscale:rr.Grayscale,HSL:rn.HSL,HSV:ri.HSV,Invert:ra.Invert,Kaleidoscope:ro.Kaleidoscope,Mask:rl.Mask,Noise:rf.Noise,Pixelate:rd.Pixelate,Posterize:rp.Posterize,RGB:rg.RGB,RGBA:rm.RGBA,Sepia:rv.Sepia,Solarize:ry.Solarize,Threshold:rx.Threshold}}),l=h.Konva;let rb=-1,rD=0;class r_ extends /*@__PURE__*/n(l).Image{constructor(t){super(t),this.name="",this.node1=null,this.node2=null,this.horizontal=!0,this.type="",this.value=1,this.ID=rb++,this.prefix=" ",this.shownText=!0,this.unit="",this.text=null}getFirstNode(){return this.node1}getSecondNode(){return this.node2}setValue(t){Number.isFinite(parseFloat(t))&&t>=0&&(this.value=parseFloat(t))}setPrefix(t){["p","n","µ","m","c"," ","k","M","G","T"].includes(t)&&(this.prefix=t)}setRotationvalue(t){Number.isFinite(parseInt(t))&&(0==parseInt(t)||90==parseInt(t)||180==parseInt(t)||270==parseInt(t))&&this.rotation(parseInt(t))}getValue(){return this.value}}class rw extends r_{constructor(t){super(t),this.type="Ground",this.node=null,this.name="GND"}getSymbol(){return"GND"}}class rE extends r_{static count=1;constructor(t){super(t),this.type="Resistance",this.unit="Ω",this.name=`R${rE.count++}`}getSymbol(){return"R"}decreaseCount(){rE.count--}}class rC extends r_{static count=1;constructor(t){super(t),this.type="DC Voltage Source",this.unit="V",this.name=`Vs${rC.count++}`}getSymbol(){return"Vs"}decreaseCount(){rC.count--}}const rS={CURRENT:"current",VOLTAGE:"voltage"};class rA extends r_{static count=1;constructor(t){super(t),this.dependent=!0,this.type="Dependednt DC Voltage Source",this.controlsource=rS.VOLTAGE,this.gain=1,this.dependency=null,this.unit="V",this.name=`DVs${rA.count++}`}getSymbol(){return"DVs"}decreaseCount(){rA.count--}setGain(t){Number.isFinite(parseFloat(t))&&(this.gain=parseFloat(t))}setControlSource(t){t===rS.CURRENT?(this.controlsource=rS.VOLTAGE,alert("No support for CCVS currently")):(rS.VOLTAGE,this.controlsource=rS.VOLTAGE)}}class rF extends r_{static count=1;constructor(t){super(t),this.dependent=!0,this.type="Dependednt DC Current Source",this.controlsource=rS.VOLTAGE,this.gain=1,this.dependency=null,this.unit="V",this.name=`DCs${rF.count++}`}getSymbol(){return"DCs"}decreaseCount(){rF.count--}setGain(t){Number.isFinite(parseFloat(t))&&(this.gain=parseFloat(t))}setControlSource(t){t===rS.CURRENT?(this.controlsource=rS.VOLTAGE,alert("No support for CCVS currently")):(rS.VOLTAGE,this.controlsource=rS.VOLTAGE)}}class rN extends r_{static count=1;constructor(t){super(t),this.type="DC Current Source",this.unit="A",this.name=`Cs${rN.count++}`}getSymbol(){return"Cs"}decreaseCount(){rN.count--}}class rM{constructor(){this.ID=rD++,this.type="Wire",this.gridPoints=[],this.drawnLines=[]}}function rT(t){var e=typeof t;if("number"===e||"bigint"===e||"string"===e||"boolean"===e||null==t)return t;if("function"==typeof t.clone)return t.clone();if(Array.isArray(t))return t.map(function(t){return rT(t)});if(t instanceof Date)return new Date(t.valueOf());if(rq(t))return t;if(r6(t))return function(t,e){var r={};for(var n in t)rk(t,n)&&(r[n]=e(t[n]));return r}(t,rT);if("function"===e)return t;throw TypeError("Cannot clone: unknown type of value (value: ".concat(t,")"))}function rB(t,e){for(var r in e)rk(e,r)&&(t[r]=e[r]);return t}function rO(t,e){var r,n,i;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;n++)if(!rO(t[n],e[n]))return!1;return!0}if("function"==typeof t||!(t instanceof Object))return t===e;if(Array.isArray(e)||!(e instanceof Object))return!1;for(r in t)if(!(r in e)||!rO(t[r],e[r]))return!1;for(r in e)if(!(r in t))return!1;return!0}function rk(t,e){return t&&Object.hasOwnProperty.call(t,e)}function rP(t,e){if(rI(t,e))return t[e];if("function"==typeof t[e]&&!(null==t||"function"!=typeof t[e]||rk(t,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(t))&&(rk(rU,e)||!(e in Object.prototype)&&!(e in Function.prototype)))throw Error('Cannot access method "'+e+'" as a property');throw Error('No access to property "'+e+'"')}function rR(t,e,r){if(rI(t,e))return t[e]=r,r;throw Error('No access to property "'+e+'"')}function rI(t,e){return!!("object"==typeof t&&t&&t.constructor===Object||Array.isArray(t))&&(!!rk(rz,e)||!(e in Object.prototype)&&!(e in Function.prototype))}var rz={length:!0,name:!0},rU={toString:!0,valueOf:!0,toLocaleString:!0};class rL{constructor(t){this.wrappedObject=t,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter(t=>this.has(t)).values()}get(t){return rP(this.wrappedObject,t)}set(t,e){return rR(this.wrappedObject,t,e),this}has(t){return rI(this.wrappedObject,t)&&t in this.wrappedObject}entries(){var t,e;return t=this.keys(),e=t=>[t,this.get(t)],{next:()=>{var r=t.next();return r.done?r:{value:e(r.value),done:!1}}}}forEach(t){for(var e of this.keys())t(this.get(e),e,this)}delete(t){rI(this.wrappedObject,t)&&delete this.wrappedObject[t]}clear(){for(var t of this.keys())this.delete(t)}get size(){return Object.keys(this.wrappedObject).length}}function rG(t){return"number"==typeof t}function rq(t){return!!t&&"object"==typeof t&&"function"==typeof t.constructor&&(!0===t.isBigNumber&&"object"==typeof t.constructor.prototype&&!0===t.constructor.prototype.isBigNumber||"function"==typeof t.constructor.isDecimal&&!0===t.constructor.isDecimal(t))}function rj(t){return"bigint"==typeof t}function rV(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isComplex||!1}function rH(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isFraction||!1}function rY(t){return t&&!0===t.constructor.prototype.isUnit||!1}function rW(t){return"string"==typeof t}var r$=Array.isArray;function rK(t){return t&&!0===t.constructor.prototype.isMatrix||!1}function rX(t){return Array.isArray(t)||rK(t)}function rZ(t){return t&&t.isDenseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function rJ(t){return t&&t.isSparseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function rQ(t){return t&&!0===t.constructor.prototype.isRange||!1}function r0(t){return t&&!0===t.constructor.prototype.isIndex||!1}function r1(t){return"boolean"==typeof t}function r2(t){return t&&!0===t.constructor.prototype.isResultSet||!1}function r5(t){return t&&!0===t.constructor.prototype.isHelp||!1}function r3(t){return"function"==typeof t}function r4(t){return t instanceof Date}function r8(t){return t instanceof RegExp}function r6(t){return!!(t&&"object"==typeof t&&t.constructor===Object&&!rV(t)&&!rH(t))}function r9(t){return!!t&&(t instanceof Map||t instanceof rL||"function"==typeof t.set&&"function"==typeof t.get&&"function"==typeof t.keys&&"function"==typeof t.has)}function r7(t){return null===t}function nt(t){return void 0===t}function ne(t){return t&&!0===t.isAccessorNode&&!0===t.constructor.prototype.isNode||!1}function nr(t){return t&&!0===t.isArrayNode&&!0===t.constructor.prototype.isNode||!1}function nn(t){return t&&!0===t.isAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function ni(t){return t&&!0===t.isBlockNode&&!0===t.constructor.prototype.isNode||!1}function na(t){return t&&!0===t.isConditionalNode&&!0===t.constructor.prototype.isNode||!1}function no(t){return t&&!0===t.isConstantNode&&!0===t.constructor.prototype.isNode||!1}function ns(t){return t&&!0===t.isFunctionAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function nu(t){return t&&!0===t.isFunctionNode&&!0===t.constructor.prototype.isNode||!1}function nl(t){return t&&!0===t.isIndexNode&&!0===t.constructor.prototype.isNode||!1}function nh(t){return t&&!0===t.isNode&&!0===t.constructor.prototype.isNode||!1}function nc(t){return t&&!0===t.isObjectNode&&!0===t.constructor.prototype.isNode||!1}function nf(t){return t&&!0===t.isOperatorNode&&!0===t.constructor.prototype.isNode||!1}function nd(t){return t&&!0===t.isParenthesisNode&&!0===t.constructor.prototype.isNode||!1}function np(t){return t&&!0===t.isRangeNode&&!0===t.constructor.prototype.isNode||!1}function ng(t){return t&&!0===t.isRelationalNode&&!0===t.constructor.prototype.isNode||!1}function nm(t){return t&&!0===t.isSymbolNode&&!0===t.constructor.prototype.isNode||!1}function nv(t){return t&&!0===t.constructor.prototype.isChain||!1}function ny(t){var e=typeof t;return"object"===e?null===t?"null":rq(t)?"BigNumber":t.constructor&&t.constructor.name?t.constructor.name:"Object":e}var nx={};function nb(){return(nx=nb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).__esModule=!0,nx.default=nx,nb.apply(null,arguments)}(nx=nb).__esModule=!0,nx.default=nx;var nD={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null},n_=function(t){if(t)throw Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(nD)};/*@__PURE__*/n(nx)(n_,nD,{MATRIX_OPTIONS:["Matrix","Array"],NUMBER_OPTIONS:["number","BigNumber","Fraction"]});var nw={};function nE(t,e,r,n){function i(n){var i=function(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n],a=t[i];void 0!==a&&(r[i]=a)}return r}(n,e.map(nC));return function(t,e,r){if(!e.filter(t=>!(t&&"?"===t[0])).every(t=>void 0!==r[t])){var n=e.filter(t=>void 0===r[t]);throw Error('Cannot create function "'.concat(t,'", ')+"some dependencies are missing: ".concat(n.map(t=>'"'.concat(t,'"')).join(", "),"."))}}(t,e,n),r(i)}return i.isFactory=!0,i.fn=t,i.dependencies=e.slice().sort(),n&&(i.meta=n),i}function nC(t){return t&&"?"===t[0]?t.slice(1):t}!function(t){/*!
   *  decimal.js v10.4.3
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   */var e,r,n,i,a="0123456789abcdef",o="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",s="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",u={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-9e15,maxE:9e15,crypto:!1},l=!0,h="[DecimalError] ",c=h+"Invalid argument: ",f=h+"Precision limit exceeded",d=h+"crypto unavailable",p="[object Decimal]",g=Math.floor,m=Math.pow,v=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,y=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,x=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,b=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,D=o.length-1,_=s.length-1,w={toStringTag:p};function E(t){var e,r,n,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,e=1;e<i;e++)(r=7-(n=t[e]+"").length)&&(a+=P(r)),a+=n;(r=7-(n=(o=t[e])+"").length)&&(a+=P(r))}else if(0===o)return"0";for(;o%10==0;)o/=10;return a+o}function C(t,e,r){if(t!==~~t||t<e||t>r)throw Error(c+t)}function S(t,e,r,n){var i,a,o,s;for(a=t[0];a>=10;a/=10)--e;return--e<0?(e+=7,i=0):(i=Math.ceil((e+1)/7),e%=7),a=m(10,7-e),s=t[i]%a|0,null==n?e<3?(0==e?s=s/100|0:1==e&&(s=s/10|0),o=r<4&&99999==s||r>3&&49999==s||5e4==s||0==s):o=(r<4&&s+1==a||r>3&&s+1==a/2)&&(t[i+1]/a/100|0)==m(10,e-2)-1||(s==a/2||0==s)&&(t[i+1]/a/100|0)==0:e<4?(0==e?s=s/1e3|0:1==e?s=s/100|0:2==e&&(s=s/10|0),o=(n||r<4)&&9999==s||!n&&r>3&&4999==s):o=((n||r<4)&&s+1==a||!n&&r>3&&s+1==a/2)&&(t[i+1]/a/1e3|0)==m(10,e-3)-1,o}function A(t,e,r){for(var n,i,o=[0],s=0,u=t.length;s<u;){for(i=o.length;i--;)o[i]*=e;for(o[0]+=a.indexOf(t.charAt(s++)),n=0;n<o.length;n++)o[n]>r-1&&(void 0===o[n+1]&&(o[n+1]=0),o[n+1]+=o[n]/r|0,o[n]%=r)}return o.reverse()}w.absoluteValue=w.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),N(t)},w.ceil=function(){return N(new this.constructor(this),this.e+1,2)},w.clampedTo=w.clamp=function(t,e){var r=this.constructor;if(t=new r(t),e=new r(e),!t.s||!e.s)return new r(NaN);if(t.gt(e))throw Error(c+e);return 0>this.cmp(t)?t:this.cmp(e)>0?e:new r(this)},w.comparedTo=w.cmp=function(t){var e,r,n,i,a=this.d,o=(t=new this.constructor(t)).d,s=this.s,u=t.s;if(!a||!o)return s&&u?s!==u?s:a===o?0:!a^s<0?1:-1:NaN;if(!a[0]||!o[0])return a[0]?s:o[0]?-u:0;if(s!==u)return s;if(this.e!==t.e)return this.e>t.e^s<0?1:-1;for(e=0,r=(n=a.length)<(i=o.length)?n:i;e<r;++e)if(a[e]!==o[e])return a[e]>o[e]^s<0?1:-1;return n===i?0:n>i^s<0?1:-1},w.cosine=w.cos=function(){var t,e,r=this,n=r.constructor;return r.d?r.d[0]?(t=n.precision,e=n.rounding,n.precision=t+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(t,e){var r,n,i;if(e.isZero())return e;(n=e.d.length)<32?i=(1/V(4,r=Math.ceil(n/3))).toString():(r=16,i="2.3283064365386962890625e-10"),t.precision+=r,e=j(t,1,e.times(i),new t(1));for(var a=r;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return t.precision-=r,e}(n,H(n,r)),n.precision=t,n.rounding=e,N(2==i||3==i?r.neg():r,t,e,!0)):new n(1):new n(NaN)},w.cubeRoot=w.cbrt=function(){var t,e,r,n,i,a,o,s,u,h,c=this.constructor;if(!this.isFinite()||this.isZero())return new c(this);for(l=!1,(a=this.s*m(this.s*this,1/3))&&Math.abs(a)!=1/0?n=new c(a.toString()):(r=E(this.d),(a=((t=this.e)-r.length+1)%3)&&(r+=1==a||-2==a?"0":"00"),a=m(r,1/3),t=g((t+1)/3)-(t%3==(t<0?-1:2)),(n=new c(r=a==1/0?"5e"+t:(r=a.toExponential()).slice(0,r.indexOf("e")+1)+t)).s=this.s),o=(t=c.precision)+3;;)if(n=F((h=(u=(s=n).times(s).times(s)).plus(this)).plus(this).times(s),h.plus(u),o+2,1),E(s.d).slice(0,o)===(r=E(n.d)).slice(0,o)){if("9999"!=(r=r.slice(o-3,o+1))&&(i||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(N(n,t+1,1),e=!n.times(n).times(n).eq(this));break}if(!i&&(N(s,t+1,0),s.times(s).times(s).eq(this))){n=s;break}o+=4,i=1}return l=!0,N(n,t,c.rounding,e)},w.decimalPlaces=w.dp=function(){var t,e=this.d,r=NaN;if(e){if(r=((t=e.length-1)-g(this.e/7))*7,t=e[t])for(;t%10==0;t/=10)r--;r<0&&(r=0)}return r},w.dividedBy=w.div=function(t){return F(this,new this.constructor(t))},w.dividedToIntegerBy=w.divToInt=function(t){var e=this.constructor;return N(F(this,new e(t),0,1,1),e.precision,e.rounding)},w.equals=w.eq=function(t){return 0===this.cmp(t)},w.floor=function(){return N(new this.constructor(this),this.e+1,3)},w.greaterThan=w.gt=function(t){return this.cmp(t)>0},w.greaterThanOrEqualTo=w.gte=function(t){var e=this.cmp(t);return 1==e||0===e},w.hyperbolicCosine=w.cosh=function(){var t,e,r,n,i,a=this,o=a.constructor,s=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return s;r=o.precision,n=o.rounding,o.precision=r+Math.max(a.e,a.sd())+4,o.rounding=1,(i=a.d.length)<32?e=(1/V(4,t=Math.ceil(i/3))).toString():(t=16,e="2.3283064365386962890625e-10"),a=j(o,1,a.times(e),new o(1),!0);for(var u,l=t,h=new o(8);l--;)u=a.times(a),a=s.minus(u.times(h.minus(u.times(h))));return N(a,o.precision=r,o.rounding=n,!0)},w.hyperbolicSine=w.sinh=function(){var t,e,r,n,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,r=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,(n=i.d.length)<3)i=j(a,2,i,i,!0);else{t=(t=1.4*Math.sqrt(n))>16?16:0|t,i=j(a,2,i=i.times(1/V(5,t)),i,!0);for(var o,s=new a(5),u=new a(16),l=new a(20);t--;)o=i.times(i),i=i.times(s.plus(o.times(u.times(o).plus(l))))}return a.precision=e,a.rounding=r,N(i,e,r,!0)},w.hyperbolicTangent=w.tanh=function(){var t,e,r=this.constructor;return this.isFinite()?this.isZero()?new r(this):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,F(this.sinh(),this.cosh(),r.precision=t,r.rounding=e)):new r(this.s)},w.inverseCosine=w.acos=function(){var t,e=this,r=e.constructor,n=e.abs().cmp(1),i=r.precision,a=r.rounding;return -1!==n?0===n?e.isNeg()?O(r,i,a):new r(0):new r(NaN):e.isZero()?O(r,i+4,a).times(.5):(r.precision=i+6,r.rounding=1,e=e.asin(),t=O(r,i+4,a).times(.5),r.precision=i,r.rounding=a,t.minus(e))},w.inverseHyperbolicCosine=w.acosh=function(){var t,e,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(t=n.precision,e=n.rounding,n.precision=t+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,l=!1,r=r.times(r).minus(1).sqrt().plus(r),l=!0,n.precision=t,n.rounding=e,r.ln()):new n(r)},w.inverseHyperbolicSine=w.asinh=function(){var t,e,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,l=!1,r=r.times(r).plus(1).sqrt().plus(r),l=!0,n.precision=t,n.rounding=e,r.ln())},w.inverseHyperbolicTangent=w.atanh=function(){var t,e,r,n,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=a.precision,e=a.rounding,Math.max(n=i.sd(),t)<-(2*i.e)-1)?N(new a(i),t,e,!0):(a.precision=r=n-i.e,i=F(i.plus(1),new a(1).minus(i),r+t,1),a.precision=t+4,a.rounding=1,i=i.ln(),a.precision=t,a.rounding=e,i.times(.5)):new a(NaN)},w.inverseSine=w.asin=function(){var t,e,r,n,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),r=a.precision,n=a.rounding,-1!==e)?0===e?((t=O(a,r+4,n).times(.5)).s=i.s,t):new a(NaN):(a.precision=r+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=r,a.rounding=n,i.times(2))},w.inverseTangent=w.atan=function(){var t,e,r,n,i,a,o,s,u,h=this,c=h.constructor,f=c.precision,d=c.rounding;if(h.isFinite()){if(h.isZero())return new c(h);if(h.abs().eq(1)&&f+4<=_)return(o=O(c,f+4,d).times(.25)).s=h.s,o}else{if(!h.s)return new c(NaN);if(f+4<=_)return(o=O(c,f+4,d).times(.5)).s=h.s,o}for(c.precision=s=f+10,c.rounding=1,t=r=Math.min(28,s/7+2|0);t;--t)h=h.div(h.times(h).plus(1).sqrt().plus(1));for(l=!1,e=Math.ceil(s/7),n=1,u=h.times(h),o=new c(h),i=h;-1!==t;)if(i=i.times(u),a=o.minus(i.div(n+=2)),i=i.times(u),void 0!==(o=a.plus(i.div(n+=2))).d[e])for(t=e;o.d[t]===a.d[t]&&t--;);return r&&(o=o.times(2<<r-1)),l=!0,N(o,c.precision=f,c.rounding=d,!0)},w.isFinite=function(){return!!this.d},w.isInteger=w.isInt=function(){return!!this.d&&g(this.e/7)>this.d.length-2},w.isNaN=function(){return!this.s},w.isNegative=w.isNeg=function(){return this.s<0},w.isPositive=w.isPos=function(){return this.s>0},w.isZero=function(){return!!this.d&&0===this.d[0]},w.lessThan=w.lt=function(t){return 0>this.cmp(t)},w.lessThanOrEqualTo=w.lte=function(t){return 1>this.cmp(t)},w.logarithm=w.log=function(t){var e,r,n,i,a,o,s,u=this.constructor,h=u.precision,c=u.rounding;if(null==t)t=new u(10),e=!0;else{if(r=(t=new u(t)).d,t.s<0||!r||!r[0]||t.eq(1))return new u(NaN);e=t.eq(10)}if(r=this.d,this.s<0||!r||!r[0]||this.eq(1))return new u(r&&!r[0]?-1/0:1!=this.s?NaN:r?0:1/0);if(e){if(r.length>1)i=!0;else{for(n=r[0];n%10==0;)n/=10;i=1!==n}}if(l=!1,S((s=F(L(this,o=h+5),e?B(u,o+10):L(t,o),o,1)).d,n=h,c))do if(o+=10,s=F(L(this,o),e?B(u,o+10):L(t,o),o,1),!i){+E(s.d).slice(n+1,n+15)+1==1e14&&(s=N(s,h+1,0));break}while(S(s.d,n+=10,c))return l=!0,N(s,h,c)},w.minus=w.sub=function(t){var e,r,n,i,a,o,s,u,h,c,f,d,p=this.constructor;if(t=new p(t),!this.d||!t.d)return this.s&&t.s?this.d?t.s=-t.s:t=new p(t.d||this.s!==t.s?this:NaN):t=new p(NaN),t;if(this.s!=t.s)return t.s=-t.s,this.plus(t);if(h=this.d,d=t.d,s=p.precision,u=p.rounding,!h[0]||!d[0]){if(d[0])t.s=-t.s;else{if(!h[0])return new p(3===u?-0:0);t=new p(this)}return l?N(t,s,u):t}if(r=g(t.e/7),c=g(this.e/7),h=h.slice(),a=c-r){for((f=a<0)?(e=h,a=-a,o=d.length):(e=d,r=c,o=h.length),a>(n=Math.max(Math.ceil(s/7),o)+2)&&(a=n,e.length=1),e.reverse(),n=a;n--;)e.push(0);e.reverse()}else{for((f=(n=h.length)<(o=d.length))&&(o=n),n=0;n<o;n++)if(h[n]!=d[n]){f=h[n]<d[n];break}a=0}for(f&&(e=h,h=d,d=e,t.s=-t.s),o=h.length,n=d.length-o;n>0;--n)h[o++]=0;for(n=d.length;n>a;){if(h[--n]<d[n]){for(i=n;i&&0===h[--i];)h[i]=1e7-1;--h[i],h[n]+=1e7}h[n]-=d[n]}for(;0===h[--o];)h.pop();for(;0===h[0];h.shift())--r;return h[0]?(t.d=h,t.e=T(h,r),l?N(t,s,u):t):new p(3===u?-0:0)},w.modulo=w.mod=function(t){var e,r=this.constructor;return(t=new r(t),this.d&&t.s&&(!t.d||t.d[0]))?t.d&&(!this.d||this.d[0])?(l=!1,9==r.modulo?(e=F(this,t.abs(),0,3,1),e.s*=t.s):e=F(this,t,0,r.modulo,1),e=e.times(t),l=!0,this.minus(e)):N(new r(this),r.precision,r.rounding):new r(NaN)},w.naturalExponential=w.exp=function(){return U(this)},w.naturalLogarithm=w.ln=function(){return L(this)},w.negated=w.neg=function(){var t=new this.constructor(this);return t.s=-t.s,N(t)},w.plus=w.add=function(t){var e,r,n,i,a,o,s,u,h,c,f=this.constructor;if(t=new f(t),!this.d||!t.d)return this.s&&t.s?this.d||(t=new f(t.d||this.s===t.s?this:NaN)):t=new f(NaN),t;if(this.s!=t.s)return t.s=-t.s,this.minus(t);if(h=this.d,c=t.d,s=f.precision,u=f.rounding,!h[0]||!c[0])return c[0]||(t=new f(this)),l?N(t,s,u):t;if(a=g(this.e/7),n=g(t.e/7),h=h.slice(),i=a-n){for(i<0?(r=h,i=-i,o=c.length):(r=c,n=a,o=h.length),i>(o=(a=Math.ceil(s/7))>o?a+1:o+1)&&(i=o,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for((o=h.length)-(i=c.length)<0&&(i=o,r=c,c=h,h=r),e=0;i;)e=(h[--i]=h[i]+c[i]+e)/1e7|0,h[i]%=1e7;for(e&&(h.unshift(e),++n),o=h.length;0==h[--o];)h.pop();return t.d=h,t.e=T(h,n),l?N(t,s,u):t},w.precision=w.sd=function(t){var e;if(void 0!==t&&!!t!==t&&1!==t&&0!==t)throw Error(c+t);return this.d?(e=k(this.d),t&&this.e+1>e&&(e=this.e+1)):e=NaN,e},w.round=function(){var t=this.constructor;return N(new t(this),this.e+1,t.rounding)},w.sine=w.sin=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(t,e){var r,n=e.d.length;if(n<3)return e.isZero()?e:j(t,2,e,e);r=(r=1.4*Math.sqrt(n))>16?16:0|r,e=j(t,2,e=e.times(1/V(5,r)),e);for(var i,a=new t(5),o=new t(16),s=new t(20);r--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(s))));return e}(n,H(n,r)),n.precision=t,n.rounding=e,N(i>2?r.neg():r,t,e,!0)):new n(NaN)},w.squareRoot=w.sqrt=function(){var t,e,r,n,i,a,o=this.d,s=this.e,u=this.s,h=this.constructor;if(1!==u||!o||!o[0])return new h(!u||u<0&&(!o||o[0])?NaN:o?this:1/0);for(l=!1,0==(u=Math.sqrt(+this))||u==1/0?(((e=E(o)).length+s)%2==0&&(e+="0"),u=Math.sqrt(e),s=g((s+1)/2)-(s<0||s%2),n=new h(e=u==1/0?"5e"+s:(e=u.toExponential()).slice(0,e.indexOf("e")+1)+s)):n=new h(u.toString()),r=(s=h.precision)+3;;)if(n=(a=n).plus(F(this,a,r+2,1)).times(.5),E(a.d).slice(0,r)===(e=E(n.d)).slice(0,r)){if("9999"!=(e=e.slice(r-3,r+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(N(n,s+1,1),t=!n.times(n).eq(this));break}if(!i&&(N(a,s+1,0),a.times(a).eq(this))){n=a;break}r+=4,i=1}return l=!0,N(n,s,h.rounding,t)},w.tangent=w.tan=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+10,n.rounding=1,(r=r.sin()).s=1,r=F(r,new n(1).minus(r.times(r)).sqrt(),t+10,0),n.precision=t,n.rounding=e,N(2==i||4==i?r.neg():r,t,e,!0)):new n(NaN)},w.times=w.mul=function(t){var e,r,n,i,a,o,s,u,h,c=this.constructor,f=this.d,d=(t=new c(t)).d;if(t.s*=this.s,!f||!f[0]||!d||!d[0])return new c(t.s&&(!f||f[0]||d)&&(!d||d[0]||f)?f&&d?0*t.s:t.s/0:NaN);for(r=g(this.e/7)+g(t.e/7),(u=f.length)<(h=d.length)&&(a=f,f=d,d=a,o=u,u=h,h=o),a=[],n=o=u+h;n--;)a.push(0);for(n=h;--n>=0;){for(e=0,i=u+n;i>n;)s=a[i]+d[n]*f[i-n-1]+e,a[i--]=s%1e7|0,e=s/1e7|0;a[i]=(a[i]+e)%1e7|0}for(;!a[--o];)a.pop();return e?++r:a.shift(),t.d=a,t.e=T(a,r),l?N(t,c.precision,c.rounding):t},w.toBinary=function(t,e){return Y(this,2,t,e)},w.toDecimalPlaces=w.toDP=function(t,e){var r=this,n=r.constructor;return(r=new n(r),void 0===t)?r:(C(t,0,1e9),void 0===e?e=n.rounding:C(e,0,8),N(r,t+r.e+1,e))},w.toExponential=function(t,e){var r,n=this,i=n.constructor;return void 0===t?r=M(n,!0):(C(t,0,1e9),void 0===e?e=i.rounding:C(e,0,8),r=M(n=N(new i(n),t+1,e),!0,t+1)),n.isNeg()&&!n.isZero()?"-"+r:r},w.toFixed=function(t,e){var r,n,i=this.constructor;return void 0===t?r=M(this):(C(t,0,1e9),void 0===e?e=i.rounding:C(e,0,8),r=M(n=N(new i(this),t+this.e+1,e),!1,t+n.e+1)),this.isNeg()&&!this.isZero()?"-"+r:r},w.toFraction=function(t){var e,r,n,i,a,o,s,u,h,f,d,p,g=this.d,v=this.constructor;if(!g)return new v(this);if(h=r=new v(1),n=u=new v(0),o=(a=(e=new v(n)).e=k(g)-this.e-1)%7,e.d[0]=m(10,o<0?7+o:o),null==t)t=a>0?e:h;else{if(!(s=new v(t)).isInt()||s.lt(h))throw Error(c+s);t=s.gt(e)?a>0?e:h:s}for(l=!1,s=new v(E(g)),f=v.precision,v.precision=a=14*g.length;d=F(s,e,0,1,1),1!=(i=r.plus(d.times(n))).cmp(t);)r=n,n=i,i=h,h=u.plus(d.times(i)),u=i,i=e,e=s.minus(d.times(i)),s=i;return i=F(t.minus(r),n,0,1,1),u=u.plus(i.times(h)),r=r.plus(i.times(n)),u.s=h.s=this.s,p=1>F(h,n,a,1).minus(this).abs().cmp(F(u,r,a,1).minus(this).abs())?[h,n]:[u,r],v.precision=f,l=!0,p},w.toHexadecimal=w.toHex=function(t,e){return Y(this,16,t,e)},w.toNearest=function(t,e){var r=this,n=r.constructor;if(r=new n(r),null==t){if(!r.d)return r;t=new n(1),e=n.rounding}else{if(t=new n(t),void 0===e?e=n.rounding:C(e,0,8),!r.d)return t.s?r:t;if(!t.d)return t.s&&(t.s=r.s),t}return t.d[0]?(l=!1,r=F(r,t,0,e,1).times(t),l=!0,N(r)):(t.s=r.s,r=t),r},w.toNumber=function(){return+this},w.toOctal=function(t,e){return Y(this,8,t,e)},w.toPower=w.pow=function(t){var e,r,n,i,a,o,s=this,u=s.constructor,h=+(t=new u(t));if(!s.d||!t.d||!s.d[0]||!t.d[0])return new u(m(+s,h));if((s=new u(s)).eq(1))return s;if(n=u.precision,a=u.rounding,t.eq(1))return N(s,n,a);if((e=g(t.e/7))>=t.d.length-1&&(r=h<0?-h:h)<=0x1fffffffffffff)return i=R(u,s,r,n),t.s<0?new u(1).div(i):N(i,n,a);if((o=s.s)<0){if(e<t.d.length-1)return new u(NaN);if((1&t.d[e])==0&&(o=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=o,s}return(e=0!=(r=m(+s,h))&&isFinite(r)?new u(r+"").e:g(h*(Math.log("0."+E(s.d))/Math.LN10+s.e+1)))>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(l=!1,u.rounding=s.s=1,r=Math.min(12,(e+"").length),(i=U(t.times(L(s,n+r)),n)).d&&S((i=N(i,n+5,1)).d,n,a)&&(e=n+10,+E((i=N(U(t.times(L(s,e+r)),e),e+5,1)).d).slice(n+1,n+15)+1==1e14&&(i=N(i,n+1,0))),i.s=o,l=!0,u.rounding=a,N(i,n,a))},w.toPrecision=function(t,e){var r,n=this,i=n.constructor;return void 0===t?r=M(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(C(t,1,1e9),void 0===e?e=i.rounding:C(e,0,8),r=M(n=N(new i(n),t,e),t<=n.e||n.e<=i.toExpNeg,t)),n.isNeg()&&!n.isZero()?"-"+r:r},w.toSignificantDigits=w.toSD=function(t,e){var r=this.constructor;return void 0===t?(t=r.precision,e=r.rounding):(C(t,1,1e9),void 0===e?e=r.rounding:C(e,0,8)),N(new r(this),t,e)},w.toString=function(){var t=this.constructor,e=M(this,this.e<=t.toExpNeg||this.e>=t.toExpPos);return this.isNeg()&&!this.isZero()?"-"+e:e},w.truncated=w.trunc=function(){return N(new this.constructor(this),this.e+1,1)},w.valueOf=w.toJSON=function(){var t=this.constructor,e=M(this,this.e<=t.toExpNeg||this.e>=t.toExpPos);return this.isNeg()?"-"+e:e};var F=function(){function t(t,e,r){var n,i=0,a=t.length;for(t=t.slice();a--;)n=t[a]*e+i,t[a]=n%r|0,i=n/r|0;return i&&t.unshift(i),t}function e(t,e,r,n){var i,a;if(r!=n)a=r>n?1:-1;else for(i=a=0;i<r;i++)if(t[i]!=e[i]){a=t[i]>e[i]?1:-1;break}return a}function n(t,e,r,n){for(var i=0;r--;)t[r]-=i,i=t[r]<e[r]?1:0,t[r]=i*n+t[r]-e[r];for(;!t[0]&&t.length>1;)t.shift()}return function(i,a,o,s,u,l){var h,c,f,d,p,m,v,y,x,b,D,_,w,E,C,S,A,F,M,T,B=i.constructor,O=i.s==a.s?1:-1,k=i.d,P=a.d;if(!k||!k[0]||!P||!P[0])return new B(i.s&&a.s&&(k?!P||k[0]!=P[0]:P)?k&&0==k[0]||!P?0*O:O/0:NaN);for(l?(p=1,c=i.e-a.e):(l=1e7,p=7,c=g(i.e/p)-g(a.e/p)),M=P.length,A=k.length,b=(x=new B(O)).d=[],f=0;P[f]==(k[f]||0);f++);if(P[f]>(k[f]||0)&&c--,null==o?(E=o=B.precision,s=B.rounding):E=u?o+(i.e-a.e)+1:o,E<0)b.push(1),m=!0;else{if(E=E/p+2|0,f=0,1==M){for(d=0,P=P[0],E++;(f<A||d)&&E--;f++)C=d*l+(k[f]||0),b[f]=C/P|0,d=C%P|0;m=d||f<A}else{for((d=l/(P[0]+1)|0)>1&&(P=t(P,d,l),k=t(k,d,l),M=P.length,A=k.length),S=M,_=(D=k.slice(0,M)).length;_<M;)D[_++]=0;(T=P.slice()).unshift(0),F=P[0],P[1]>=l/2&&++F;do d=0,(h=e(P,D,M,_))<0?(w=D[0],M!=_&&(w=w*l+(D[1]||0)),(d=w/F|0)>1?(d>=l&&(d=l-1),y=(v=t(P,d,l)).length,_=D.length,1==(h=e(v,D,y,_))&&(d--,n(v,M<y?T:P,y,l))):(0==d&&(h=d=1),v=P.slice()),(y=v.length)<_&&v.unshift(0),n(D,v,_,l),-1==h&&(_=D.length,(h=e(P,D,M,_))<1&&(d++,n(D,M<_?T:P,_,l))),_=D.length):0===h&&(d++,D=[0]),b[f++]=d,h&&D[0]?D[_++]=k[S]||0:(D=[k[S]],_=1);while((S++<A||void 0!==D[0])&&E--)m=void 0!==D[0]}b[0]||b.shift()}if(1==p)x.e=c,r=m;else{for(f=1,d=b[0];d>=10;d/=10)f++;x.e=f+c*p-1,N(x,u?o+x.e+1:o,s,m)}return x}}();function N(t,e,r,n){var i,a,o,s,u,h,c,f,d,p=t.constructor;t:if(null!=e){if(!(f=t.d))return t;for(i=1,s=f[0];s>=10;s/=10)i++;if((a=e-i)<0)a+=7,o=e,u=(c=f[d=0])/m(10,i-o-1)%10|0;else if((d=Math.ceil((a+1)/7))>=(s=f.length)){if(n){for(;s++<=d;)f.push(0);c=u=0,i=1,a%=7,o=a-7+1}else break t}else{for(i=1,c=s=f[d];s>=10;s/=10)i++;a%=7,u=(o=a-7+i)<0?0:c/m(10,i-o-1)%10|0}if(n=n||e<0||void 0!==f[d+1]||(o<0?c:c%m(10,i-o-1)),h=r<4?(u||n)&&(0==r||r==(t.s<0?3:2)):u>5||5==u&&(4==r||n||6==r&&(a>0?o>0?c/m(10,i-o):0:f[d-1])%10&1||r==(t.s<0?8:7)),e<1||!f[0])return f.length=0,h?(e-=t.e+1,f[0]=m(10,(7-e%7)%7),t.e=-e||0):f[0]=t.e=0,t;if(0==a?(f.length=d,s=1,d--):(f.length=d+1,s=m(10,7-a),f[d]=o>0?(c/m(10,i-o)%m(10,o)|0)*s:0),h)for(;;)if(0==d){for(a=1,o=f[0];o>=10;o/=10)a++;for(o=f[0]+=s,s=1;o>=10;o/=10)s++;a!=s&&(t.e++,1e7==f[0]&&(f[0]=1));break}else{if(f[d]+=s,1e7!=f[d])break;f[d--]=0,s=1}for(a=f.length;0===f[--a];)f.pop()}return l&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function M(t,e,r){if(!t.isFinite())return G(t);var n,i=t.e,a=E(t.d),o=a.length;return e?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+P(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):i<0?(a="0."+P(-i-1)+a,r&&(n=r-o)>0&&(a+=P(n))):i>=o?(a+=P(i+1-o),r&&(n=r-i-1)>0&&(a=a+"."+P(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(a+="."),a+=P(n))),a}function T(t,e){var r=t[0];for(e*=7;r>=10;r/=10)e++;return e}function B(t,e,r){if(e>D)throw l=!0,r&&(t.precision=r),Error(f);return N(new t(o),e,1,!0)}function O(t,e,r){if(e>_)throw Error(f);return N(new t(s),e,r,!0)}function k(t){var e=t.length-1,r=7*e+1;if(e=t[e]){for(;e%10==0;e/=10)r--;for(e=t[0];e>=10;e/=10)r++}return r}function P(t){for(var e="";t--;)e+="0";return e}function R(t,e,r,n){var i,a=new t(1),o=Math.ceil(n/7+4);for(l=!1;;){if(r%2&&W((a=a.times(e)).d,o)&&(i=!0),0===(r=g(r/2))){r=a.d.length-1,i&&0===a.d[r]&&++a.d[r];break}W((e=e.times(e)).d,o)}return l=!0,a}function I(t){return 1&t.d[t.d.length-1]}function z(t,e,r){for(var n,i=new t(e[0]),a=0;++a<e.length;)if((n=new t(e[a])).s)i[r](n)&&(i=n);else{i=n;break}return i}function U(t,e){var r,n,i,a,o,s,u,h=0,c=0,f=0,d=t.constructor,p=d.rounding,g=d.precision;if(!t.d||!t.d[0]||t.e>17)return new d(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:0/0);for(null==e?(l=!1,u=g):u=e,s=new d(.03125);t.e>-2;)t=t.times(s),f+=5;for(u+=n=Math.log(m(2,f))/Math.LN10*2+5|0,r=a=o=new d(1),d.precision=u;;){if(a=N(a.times(t),u,1),r=r.times(++c),E((s=o.plus(F(a,r,u,1))).d).slice(0,u)===E(o.d).slice(0,u)){for(i=f;i--;)o=N(o.times(o),u,1);if(null!=e)return d.precision=g,o;if(!(h<3&&S(o.d,u-n,p,h)))return N(o,d.precision=g,p,l=!0);d.precision=u+=10,r=a=s=new d(1),c=0,h++}o=s}}function L(t,e){var r,n,i,a,o,s,u,h,c,f,d,p=1,g=t,m=g.d,v=g.constructor,y=v.rounding,x=v.precision;if(g.s<0||!m||!m[0]||!g.e&&1==m[0]&&1==m.length)return new v(m&&!m[0]?-1/0:1!=g.s?NaN:m?0:g);if(null==e?(l=!1,c=x):c=e,v.precision=c+=10,n=(r=E(m)).charAt(0),!(15e14>Math.abs(a=g.e)))return h=B(v,c+2,x).times(a+""),g=L(new v(n+"."+r.slice(1)),c-10).plus(h),v.precision=x,null==e?N(g,x,y,l=!0):g;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=E((g=g.times(t)).d)).charAt(0),p++;for(a=g.e,n>1?(g=new v("0."+r),a++):g=new v(n+"."+r.slice(1)),f=g,u=o=g=F(g.minus(1),g.plus(1),c,1),d=N(g.times(g),c,1),i=3;;){if(o=N(o.times(d),c,1),E((h=u.plus(F(o,new v(i),c,1))).d).slice(0,c)===E(u.d).slice(0,c)){if(u=u.times(2),0!==a&&(u=u.plus(B(v,c+2,x).times(a+""))),u=F(u,new v(p),c,1),null!=e)return v.precision=x,u;if(!S(u.d,c-10,y,s))return N(u,v.precision=x,y,l=!0);v.precision=c+=10,h=o=g=F(f.minus(1),f.plus(1),c,1),d=N(g.times(g),c,1),i=s=1}u=h,i+=2}}function G(t){return String(t.s*t.s/0)}function q(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;48===e.charCodeAt(n);n++);for(i=e.length;48===e.charCodeAt(i-1);--i);if(e=e.slice(n,i)){if(i-=n,t.e=r=r-n-1,t.d=[],n=(r+1)%7,r<0&&(n+=7),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=7;n<i;)t.d.push(+e.slice(n,n+=7));n=7-(e=e.slice(n)).length}else n-=i;for(;n--;)e+="0";t.d.push(+e),l&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function j(t,e,r,n,i){var a,o,s,u,h=t.precision,c=Math.ceil(h/7);for(l=!1,u=r.times(r),s=new t(n);;){if(o=F(s.times(u),new t(e++*e++),h,1),s=i?n.plus(o):n.minus(o),n=F(o.times(u),new t(e++*e++),h,1),void 0!==(o=s.plus(n)).d[c]){for(a=c;o.d[a]===s.d[a]&&a--;);if(-1==a)break}a=s,s=n,n=o,o=a}return l=!0,o.d.length=c+1,o}function V(t,e){for(var r=t;--e;)r*=t;return r}function H(t,e){var r,n=e.s<0,a=O(t,t.precision,1),o=a.times(.5);if((e=e.abs()).lte(o))return i=n?4:1,e;if((r=e.divToInt(a)).isZero())i=n?3:2;else{if((e=e.minus(r.times(a))).lte(o))return i=I(r)?n?2:3:n?4:1,e;i=I(r)?n?1:4:n?3:2}return e.minus(a).abs()}function Y(t,e,n,i){var o,s,u,l,h,c,f,d,p,g=t.constructor,m=void 0!==n;if(m?(C(n,1,1e9),void 0===i?i=g.rounding:C(i,0,8)):(n=g.precision,i=g.rounding),t.isFinite()){for(u=(f=M(t)).indexOf("."),m?(o=2,16==e?n=4*n-3:8==e&&(n=3*n-2)):o=e,u>=0&&(f=f.replace(".",""),(p=new g(1)).e=f.length-u,p.d=A(M(p),10,o),p.e=p.d.length),s=h=(d=A(f,10,o)).length;0==d[--h];)d.pop();if(d[0]){if(u<0?s--:((t=new g(t)).d=d,t.e=s,d=(t=F(t,p,n,i,0,o)).d,s=t.e,c=r),u=d[n],l=o/2,c=c||void 0!==d[n+1],c=i<4?(void 0!==u||c)&&(0===i||i===(t.s<0?3:2)):u>l||u===l&&(4===i||c||6===i&&1&d[n-1]||i===(t.s<0?8:7)),d.length=n,c)for(;++d[--n]>o-1;)d[n]=0,n||(++s,d.unshift(1));for(h=d.length;!d[h-1];--h);for(u=0,f="";u<h;u++)f+=a.charAt(d[u]);if(m){if(h>1){if(16==e||8==e){for(u=16==e?4:3,--h;h%u;h++)f+="0";for(h=(d=A(f,o,e)).length;!d[h-1];--h);for(u=1,f="1.";u<h;u++)f+=a.charAt(d[u])}else f=f.charAt(0)+"."+f.slice(1)}f=f+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)f="0"+f;f="0."+f}else if(++s>h)for(s-=h;s--;)f+="0";else s<h&&(f=f.slice(0,s)+"."+f.slice(s))}else f=m?"0p+0":"0";f=(16==e?"0x":2==e?"0b":8==e?"0o":"")+f}else f=G(t);return t.s<0?"-"+f:f}function W(t,e){if(t.length>e)return t.length=e,!0}function $(t){return new this(t).abs()}function K(t){return new this(t).acos()}function X(t){return new this(t).acosh()}function Z(t,e){return new this(t).plus(e)}function J(t){return new this(t).asin()}function Q(t){return new this(t).asinh()}function tt(t){return new this(t).atan()}function te(t){return new this(t).atanh()}function tr(t,e){t=new this(t),e=new this(e);var r,n=this.precision,i=this.rounding,a=n+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(r=e.s<0?O(this,n,i):new this(0)).s=t.s:!t.d||e.isZero()?(r=O(this,a,1).times(.5)).s=t.s:e.s<0?(this.precision=a,this.rounding=1,r=this.atan(F(t,e,a,1)),e=O(this,a,1),this.precision=n,this.rounding=i,r=t.s<0?r.minus(e):r.plus(e)):r=this.atan(F(t,e,a,1)):(r=O(this,a,1).times(e.s>0?.25:.75)).s=t.s:r=new this(NaN),r}function tn(t){return new this(t).cbrt()}function ti(t){return N(t=new this(t),t.e+1,2)}function ta(t,e,r){return new this(t).clamp(e,r)}function to(t){if(!t||"object"!=typeof t)throw Error(h+"Object expected");var e,r,n,i=!0===t.defaults,a=["precision",1,1e9,"rounding",0,8,"toExpNeg",-9e15,0,"toExpPos",0,9e15,"maxE",0,9e15,"minE",-9e15,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(r=a[e],i&&(this[r]=u[r]),void 0!==(n=t[r])){if(g(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(c+r+": "+n)}if(r="crypto",i&&(this[r]=u[r]),void 0!==(n=t[r])){if(!0===n||!1===n||0===n||1===n){if(n){if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[r]=!0;else throw Error(d)}else this[r]=!1}else throw Error(c+r+": "+n)}return this}function ts(t){return new this(t).cos()}function tu(t){return new this(t).cosh()}function tl(t,e){return new this(t).div(e)}function th(t){return new this(t).exp()}function tc(t){return N(t=new this(t),t.e+1,3)}function tf(){var t,e,r=new this(0);for(t=0,l=!1;t<arguments.length;)if(e=new this(arguments[t++]),e.d)r.d&&(r=r.plus(e.times(e)));else{if(e.s)return l=!0,new this(1/0);r=e}return l=!0,r.sqrt()}function td(t){return t instanceof e||t&&t.toStringTag===p||!1}function tp(t){return new this(t).ln()}function tg(t,e){return new this(t).log(e)}function tm(t){return new this(t).log(2)}function tv(t){return new this(t).log(10)}function ty(){return z(this,arguments,"lt")}function tx(){return z(this,arguments,"gt")}function tb(t,e){return new this(t).mod(e)}function tD(t,e){return new this(t).mul(e)}function t_(t,e){return new this(t).pow(e)}function tw(t){var e,r,n,i,a=0,o=new this(1),s=[];if(void 0===t?t=this.precision:C(t,1,1e9),n=Math.ceil(t/7),this.crypto){if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(n));a<n;)(i=e[a])>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:s[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(n*=4);a<n;)(i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((127&e[a+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,a):(s.push(i%1e7),a+=4);a=n/4}else throw Error(d)}else for(;a<n;)s[a++]=1e7*Math.random()|0;for(n=s[--a],t%=7,n&&t&&(i=m(10,7-t),s[a]=(n/i|0)*i);0===s[a];a--)s.pop();if(a<0)r=0,s=[0];else{for(r=-1;0===s[0];r-=7)s.shift();for(n=1,i=s[0];i>=10;i/=10)n++;n<7&&(r-=7-n)}return o.e=r,o.d=s,o}function tE(t){return N(t=new this(t),t.e+1,this.rounding)}function tC(t){return(t=new this(t)).d?t.d[0]?t.s:0*t.s:t.s||NaN}function tS(t){return new this(t).sin()}function tA(t){return new this(t).sinh()}function tF(t){return new this(t).sqrt()}function tN(t,e){return new this(t).sub(e)}function tM(){var t=0,e=arguments,r=new this(e[0]);for(l=!1;r.s&&++t<e.length;)r=r.plus(e[t]);return l=!0,N(r,this.precision,this.rounding)}function tT(t){return new this(t).tan()}function tB(t){return new this(t).tanh()}function tO(t){return N(t=new this(t),t.e+1,1)}(e=function t(r){var n,i,a;function o(t){var r,n,i;if(!(this instanceof o))return new o(t);if(this.constructor=o,td(t)){this.s=t.s,l?!t.d||t.e>o.maxE?(this.e=NaN,this.d=null):t.e<o.minE?(this.e=0,this.d=[0]):(this.e=t.e,this.d=t.d.slice()):(this.e=t.e,this.d=t.d?t.d.slice():t.d);return}if("number"==(i=typeof t)){if(0===t){this.s=1/t<0?-1:1,this.e=0,this.d=[0];return}if(t<0?(t=-t,this.s=-1):this.s=1,t===~~t&&t<1e7){for(r=0,n=t;n>=10;n/=10)r++;l?r>o.maxE?(this.e=NaN,this.d=null):r<o.minE?(this.e=0,this.d=[0]):(this.e=r,this.d=[t]):(this.e=r,this.d=[t]);return}if(0*t!=0){t||(this.s=NaN),this.e=NaN,this.d=null;return}return q(this,t.toString())}if("string"!==i)throw Error(c+t);return 45===(n=t.charCodeAt(0))?(t=t.slice(1),this.s=-1):(43===n&&(t=t.slice(1)),this.s=1),b.test(t)?q(this,t):function(t,r){var n,i,a,o,s,u,h,f,d;if(r.indexOf("_")>-1){if(r=r.replace(/(\d)_(?=\d)/g,"$1"),b.test(r))return q(t,r)}else if("Infinity"===r||"NaN"===r)return+r||(t.s=NaN),t.e=NaN,t.d=null,t;if(y.test(r))n=16,r=r.toLowerCase();else if(v.test(r))n=2;else if(x.test(r))n=8;else throw Error(c+r);for((o=r.search(/p/i))>0?(h=+r.slice(o+1),r=r.substring(2,o)):r=r.slice(2),s=(o=r.indexOf("."))>=0,i=t.constructor,s&&(o=(u=(r=r.replace(".","")).length)-o,a=R(i,new i(n),o,2*o)),o=d=(f=A(r,n,1e7)).length-1;0===f[o];--o)f.pop();return o<0?new i(0*t.s):(t.e=T(f,d),t.d=f,l=!1,s&&(t=F(t,a,4*u)),h&&(t=t.times(54>Math.abs(h)?m(2,h):e.pow(2,h))),l=!0,t)}(this,t)}if(o.prototype=w,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=to,o.clone=t,o.isDecimal=td,o.abs=$,o.acos=K,o.acosh=X,o.add=Z,o.asin=J,o.asinh=Q,o.atan=tt,o.atanh=te,o.atan2=tr,o.cbrt=tn,o.ceil=ti,o.clamp=ta,o.cos=ts,o.cosh=tu,o.div=tl,o.exp=th,o.floor=tc,o.hypot=tf,o.ln=tp,o.log=tg,o.log10=tv,o.log2=tm,o.max=ty,o.min=tx,o.mod=tb,o.mul=tD,o.pow=t_,o.random=tw,o.round=tE,o.sign=tC,o.sin=tS,o.sinh=tA,o.sqrt=tF,o.sub=tN,o.sum=tM,o.tan=tT,o.tanh=tB,o.trunc=tO,void 0===r&&(r={}),r&&!0!==r.defaults)for(n=0,a=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"];n<a.length;)r.hasOwnProperty(i=a[n++])||(r[i]=this[i]);return o.config(r),o}(u)).prototype.constructor=e,e.default=e.Decimal=e,o=new e(o),s=new e(s),"function"==typeof define&&define.amd?define(function(){return e}):nw?("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(w[Symbol.for("nodejs.util.inspect.custom")]=w.toString,w[Symbol.toStringTag]="Decimal"),nw=e):(t||(t="undefined"!=typeof self&&self&&self.self==self?self:window),n=t.Decimal,e.noConflict=function(){return t.Decimal=n,e},t.Decimal=e)}(nw);var nS=/* #__PURE__ */nE("BigNumber",["?on","config"],t=>{var{on:e,config:r}=t,i=/*@__PURE__*/n(nw).clone({precision:r.precision,modulo:/*@__PURE__*/n(nw).EUCLID});return i.prototype=Object.create(i.prototype),i.prototype.type="BigNumber",i.prototype.isBigNumber=!0,i.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},i.fromJSON=function(t){return new i(t.value)},e&&e("config",function(t,e){t.precision!==e.precision&&i.config({precision:t.precision})}),i},{isClass:!0}),nA={};function nF(t){return"boolean"==typeof t||!!isFinite(t)&&t===Math.round(t)}function nN(t,e){return"bigint"!==e.number||/^-?\d+$/.test(t)?e.number:e.numberFallback}!function(t){function e(t,e){if(null==t)u.re=u.im=0;else if(void 0!==e)u.re=t,u.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)u.re=t.re,u.im=t.im;else if("abs"in t&&"arg"in t){if(!isFinite(t.abs)&&isFinite(t.arg))return a.INFINITY;u.re=t.abs*Math.cos(t.arg),u.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!isFinite(t.r)&&isFinite(t.phi))return a.INFINITY;u.re=t.r*Math.cos(t.phi),u.im=t.r*Math.sin(t.phi)}else 2===t.length?(u.re=t[0],u.im=t[1]):r();break;case"string":u.im=u.re=0,t=t.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),e=1;let n=0;null===t&&r();for(let i=0;i<t.length;i++){let a=t[i];" "!==a&&"	"!==a&&"\n"!==a&&("+"===a?e++:"-"===a?n++:("i"===a||"I"===a?(0===e+n&&r()," "===t[i+1]||isNaN(t[i+1])?u.im+=parseFloat((n%2?"-":"")+"1"):(u.im+=parseFloat((n%2?"-":"")+t[i+1]),i++)):((0===e+n||isNaN(a))&&r(),"i"===t[i+1]||"I"===t[i+1]?(u.im+=parseFloat((n%2?"-":"")+a),i++):u.re+=parseFloat((n%2?"-":"")+a)),e=n=0))}0<e+n&&r();break;case"number":u.im=0,u.re=t;break;default:r()}return u}function r(){throw SyntaxError("Invalid Param")}function n(t,e){return((t=Math.abs(t))<(e=Math.abs(e))&&([t,e]=[e,t]),1e8>t)?Math.sqrt(t*t+e*e):(e/=t,t*Math.sqrt(1+e*e))}function i(t,e){let r=Math.abs(t),n=Math.abs(e);return 0===t?Math.log(n):0===e?Math.log(r):3e3>r&&3e3>n?.5*Math.log(t*t+e*e):.5*Math.log((t*=.5)*t+(e*=.5)*e)+Math.LN2}function a(t,r){if(!(this instanceof a))return new a(t,r);t=e(t,r),this.re=t.re,this.im=t.im}let o=Math.cosh||function(t){return 1e-9>Math.abs(t)?1-t:.5*(Math.exp(t)+Math.exp(-t))},s=Math.sinh||function(t){return 1e-9>Math.abs(t)?t:.5*(Math.exp(t)-Math.exp(-t))},u={re:0,im:0};a.prototype={re:0,im:0,sign:function(){let t=n(this.re,this.im);return new a(this.re/t,this.im/t)},add:function(t,r){t=e(t,r),r=this.isInfinite();let n=!(isFinite(t.re)&&isFinite(t.im));return r||n?r&&n?a.NAN:a.INFINITY:new a(this.re+t.re,this.im+t.im)},sub:function(t,r){t=e(t,r),r=this.isInfinite();let n=!(isFinite(t.re)&&isFinite(t.im));return r||n?r&&n?a.NAN:a.INFINITY:new a(this.re-t.re,this.im-t.im)},mul:function(t,r){t=e(t,r),r=this.isInfinite();let n=!(isFinite(t.re)&&isFinite(t.im)),i=0===this.re&&0===this.im,o=0===t.re&&0===t.im;return r&&o||n&&i?a.NAN:r||n?a.INFINITY:0===t.im&&0===this.im?new a(this.re*t.re,0):new a(this.re*t.re-this.im*t.im,this.re*t.im+this.im*t.re)},div:function(t,r){t=e(t,r),r=this.isInfinite();let n=!(isFinite(t.re)&&isFinite(t.im)),i=0===this.re&&0===this.im,o=0===t.re&&0===t.im;return i&&o||r&&n?a.NAN:o||r?a.INFINITY:i||n?a.ZERO:0===t.im?new a(this.re/t.re,this.im/t.re):Math.abs(t.re)<Math.abs(t.im)?(r=t.re/t.im,t=t.re*r+t.im,new a((this.re*r+this.im)/t,(this.im*r-this.re)/t)):(r=t.im/t.re,t=t.im*r+t.re,new a((this.re+this.im*r)/t,(this.im-this.re*r)/t))},pow:function(t,r){if(t=e(t,r),r=0===this.re&&0===this.im,0===t.re&&0===t.im)return a.ONE;if(0===t.im){if(0===this.im&&0<this.re)return new a(Math.pow(this.re,t.re),0);if(0===this.re)switch((t.re%4+4)%4){case 0:return new a(Math.pow(this.im,t.re),0);case 1:return new a(0,Math.pow(this.im,t.re));case 2:return new a(-Math.pow(this.im,t.re),0);case 3:return new a(0,-Math.pow(this.im,t.re))}}if(r&&0<t.re)return a.ZERO;let n=Math.atan2(this.im,this.re),o=i(this.re,this.im);return new a((r=Math.exp(t.re*o-t.im*n))*Math.cos(t=t.im*o+t.re*n),r*Math.sin(t))},sqrt:function(){let t=this.re,e=this.im;if(0===e)return 0<=t?new a(Math.sqrt(t),0):new a(0,Math.sqrt(-t));var r=n(t,e);let i=Math.abs(e)/(2*(r=Math.sqrt(.5*(r+Math.abs(t)))));return 0<=t?new a(r,0>e?-i:i):new a(i,0>e?-r:r)},exp:function(){let t=Math.exp(this.re);return 0===this.im?new a(t,0):new a(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){let t=this.re,e=this.im;var r=Math.expm1(t)*Math.cos(e),n=Math.PI/4;return-n>e||e>n?n=Math.cos(e)-1:(n=e*e,n*=n*(n*(n*(n*(n*(n*(n/20922789888e3-1/0x144c3b2800)+1/0x1c8cfc00)-1/3628800)+1/40320)-1/720)+1/24)-.5),new a(r+n,Math.exp(t)*Math.sin(e))},log:function(){let t=this.re,e=this.im;return 0===e&&0<t?new a(Math.log(t),0):new a(i(t,e),Math.atan2(e,t))},abs:function(){return n(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){let t=this.re,e=this.im;return new a(Math.sin(t)*o(e),Math.cos(t)*s(e))},cos:function(){let t=this.re,e=this.im;return new a(Math.cos(t)*o(e),-Math.sin(t)*s(e))},tan:function(){let t=2*this.re,e=2*this.im,r=Math.cos(t)+o(e);return new a(Math.sin(t)/r,s(e)/r)},cot:function(){let t=2*this.re,e=2*this.im,r=Math.cos(t)-o(e);return new a(-Math.sin(t)/r,s(e)/r)},sec:function(){let t=this.re,e=this.im,r=.5*o(2*e)+.5*Math.cos(2*t);return new a(Math.cos(t)*o(e)/r,Math.sin(t)*s(e)/r)},csc:function(){let t=this.re,e=this.im,r=.5*o(2*e)-.5*Math.cos(2*t);return new a(Math.sin(t)*o(e)/r,-Math.cos(t)*s(e)/r)},asin:function(){var t=this.re;let e=this.im,r=new a(e*e-t*t+1,-2*t*e).sqrt();return t=new a(r.re-e,r.im+t).log(),new a(t.im,-t.re)},acos:function(){var t=this.re;let e=this.im,r=new a(e*e-t*t+1,-2*t*e).sqrt();return t=new a(r.re-e,r.im+t).log(),new a(Math.PI/2-t.im,t.re)},atan:function(){var t=this.re;let e=this.im;if(0===t){if(1===e)return new a(0,1/0);if(-1===e)return new a(0,-1/0)}let r=t*t+(1-e)*(1-e);return t=new a((1-e*e-t*t)/r,-2*t/r).log(),new a(-.5*t.im,.5*t.re)},acot:function(){let t=this.re,e=this.im;if(0===e)return new a(Math.atan2(1,t),0);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).atan():new a(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){let t=this.re,e=this.im;if(0===t&&0===e)return new a(0,1/0);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).acos():new a(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){let t=this.re,e=this.im;if(0===t&&0===e)return new a(Math.PI/2,1/0);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).asin():new a(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){let t=this.re,e=this.im;return new a(s(t)*Math.cos(e),o(t)*Math.sin(e))},cosh:function(){let t=this.re,e=this.im;return new a(o(t)*Math.cos(e),s(t)*Math.sin(e))},tanh:function(){let t=2*this.re,e=2*this.im,r=o(t)+Math.cos(e);return new a(s(t)/r,Math.sin(e)/r)},coth:function(){let t=2*this.re,e=2*this.im,r=o(t)-Math.cos(e);return new a(s(t)/r,-Math.sin(e)/r)},csch:function(){let t=this.re,e=this.im,r=Math.cos(2*e)-o(2*t);return new a(-2*s(t)*Math.cos(e)/r,2*o(t)*Math.sin(e)/r)},sech:function(){let t=this.re,e=this.im,r=Math.cos(2*e)+o(2*t);return new a(2*o(t)*Math.cos(e)/r,-2*s(t)*Math.sin(e)/r)},asinh:function(){let t=this.im;this.im=-this.re,this.re=t;let e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){let t=this.acos();if(0>=t.im){var e=t.re;t.re=-t.im,t.im=e}else e=t.im,t.im=-t.re,t.re=e;return t},atanh:function(){var t=this.re,e=this.im;let r=1<t&&0===e,n=1-t,o=1+t,s=n*n+e*e;return e=(t=0!==s?new a((o*n-e*e)/s,(e*n+o*e)/s):new a(-1!==t?t/0:0,0!==e?e/0:0)).re,t.re=i(t.re,t.im)/2,t.im=Math.atan2(t.im,e)/2,r&&(t.im=-t.im),t},acoth:function(){let t=this.re,e=this.im;if(0===t&&0===e)return new a(0,Math.PI/2);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).atanh():new a(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){let t=this.re,e=this.im;if(0===e)return new a(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).asinh():new a(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){let t=this.re,e=this.im;if(this.isZero())return a.INFINITY;let r=t*t+e*e;return 0!==r?new a(t/r,-e/r).acosh():new a(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return a.INFINITY;if(this.isInfinite())return a.ZERO;let t=this.re,e=this.im,r=t*t+e*e;return new a(t/r,-e/r)},conjugate:function(){return new a(this.re,-this.im)},neg:function(){return new a(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new a(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new a(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new a(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,r){return Math.abs((t=e(t,r)).re-this.re)<=a.EPSILON&&Math.abs(t.im-this.im)<=a.EPSILON},clone:function(){return new a(this.re,this.im)},toString:function(){let t=this.re,e=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(t)<a.EPSILON&&(t=0),Math.abs(e)<a.EPSILON&&(e=0),0===e)?r+t:(0!==t?(r=r+t+" ",0>e?(e=-e,r+="-"):r+="+",r+=" "):0>e&&(e=-e,r+="-"),1!==e&&(r+=e),r+"i")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!this.isFinite()}},a.ZERO=new a(0,0),a.ONE=new a(1,0),a.I=new a(0,1),a.PI=new a(Math.PI,0),a.E=new a(Math.E,0),a.INFINITY=new a(1/0,1/0),a.NAN=new a(NaN,NaN),a.EPSILON=1e-15,"function"==typeof define&&define.amd?define([],function(){return a}):(Object.defineProperty(a,"__esModule",{value:!0}),a.default=a,a.Complex=a,nA=a)}(0);var nM=Math.sign||function(t){return t>0?1:t<0?-1:0},nT=Math.log2||function(t){return Math.log(t)/Math.LN2},nB=Math.cbrt||function(t){if(0===t)return t;var e,r=t<0;return r&&(t=-t),isFinite(t)?(e=Math.exp(Math.log(t)/3),e=(t/(e*e)+2*e)/3):e=t,r?-e:e},nO=Math.expm1||function(t){return t>=2e-4||t<=-2e-4?Math.exp(t)-1:t+t*t/2+t*t*t/6};function nk(t,e,r){var n="";if(r){if(r<1)throw Error("size must be in greater than 0");if(!nF(r))throw Error("size must be an integer");if(t>2**(r-1)-1||t<-(2**(r-1)))throw Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!nF(t))throw Error("Value must be an integer");t<0&&(t+=2**r),n="i".concat(r)}var i="";return t<0&&(t=-t,i="-"),"".concat(i).concat({2:"0b",8:"0o",16:"0x"}[e]).concat(t.toString(e)).concat(n)}function nP(t,e){if("function"==typeof e)return e(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var{notation:r,precision:n,wordSize:i}=nR(e);switch(r){case"fixed":return nz(t,n);case"exponential":return nU(t,n);case"engineering":return function(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=nL(nI(t),e),n=r.exponent,i=r.coefficients,a=n%3==0?n:n<0?n-3-n%3:n-n%3;if(rG(e))for(;e>i.length||n-a+1>i.length;)i.push(0);else for(var o=Math.abs(n-a)-(i.length-1),s=0;s<o;s++)i.push(0);for(var u=Math.abs(n-a),l=1;u>0;)l++,u--;var h=i.slice(l).join(""),c=rG(e)&&h.length||h.match(/[1-9]/)?"."+h:"",f=i.slice(0,l).join("")+c+"e"+(n>=0?"+":"")+a.toString();return r.sign+f}(t,n);case"bin":return nk(t,2,i);case"oct":return nk(t,8,i);case"hex":return nk(t,16,i);case"auto":return(function(t,e,r){if(isNaN(t)||!isFinite(t))return String(t);var n=nY(null==r?void 0:r.lowerExp,-3),i=nY(null==r?void 0:r.upperExp,5),a=nI(t),o=e?nL(a,e):a;if(o.exponent<n||o.exponent>=i)return nU(t,e);var s=o.coefficients,u=o.exponent;s.length<e&&(s=s.concat(nG(e-s.length))),s=s.concat(nG(u-s.length+1+(s.length<e?e-s.length:0))),s=nG(-u).concat(s);var l=u>0?u:0;return l<s.length-1&&s.splice(l+1,0,"."),o.sign+s.join("")})(t,n,e).replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw Error('Unknown notation "'+r+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function nR(t){var e,r,n="auto";if(void 0!==t){if(rG(t))e=t;else if(rq(t))e=t.toNumber();else if(r6(t))void 0!==t.precision&&(e=nH(t.precision,()=>{throw Error('Option "precision" must be a number or BigNumber')})),void 0!==t.wordSize&&(r=nH(t.wordSize,()=>{throw Error('Option "wordSize" must be a number or BigNumber')})),t.notation&&(n=t.notation);else throw Error("Unsupported type of options, number, BigNumber, or object expected")}return{notation:n,precision:e,wordSize:r}}function nI(t){var e=String(t).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw SyntaxError("Invalid number "+t);var r=e[1],n=e[2],i=parseFloat(e[4]||"0"),a=n.indexOf(".");i+=-1!==a?a-1:n.length-1;var o=n.replace(".","").replace(/^0*/,function(t){return i-=t.length,""}).replace(/0*$/,"").split("").map(function(t){return parseInt(t)});return 0===o.length&&(o.push(0),i++),{sign:r,coefficients:o,exponent:i}}function nz(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=nI(t),n="number"==typeof e?nL(r,r.exponent+1+e):r,i=n.coefficients,a=n.exponent+1,o=a+(e||0);return i.length<o&&(i=i.concat(nG(o-i.length))),a<0&&(i=nG(-a+1).concat(i),a=1),a<i.length&&i.splice(a,0,0===a?"0.":"."),n.sign+i.join("")}function nU(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=nI(t),n=e?nL(r,e):r,i=n.coefficients,a=n.exponent;i.length<e&&(i=i.concat(nG(e-i.length)));var o=i.shift();return n.sign+o+(i.length>0?"."+i.join(""):"")+"e"+(a>=0?"+":"")+a}function nL(t,e){for(var r={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},n=r.coefficients;e<=0;)n.unshift(0),r.exponent++,e++;if(n.length>e&&n.splice(e,n.length-e)[0]>=5){var i=e-1;for(n[i]++;10===n[i];)n.pop(),0===i&&(n.unshift(0),r.exponent++,i++),i--,n[i]++}return r}function nG(t){for(var e=[],r=0;r<t;r++)e.push(0);return e}function nq(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-8,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(r<=0)throw Error("Relative tolerance must be greater than 0");if(n<0)throw Error("Absolute tolerance must be at least 0");return!(isNaN(t)||isNaN(e))&&(isFinite(t)&&isFinite(e)?t===e||Math.abs(t-e)<=Math.max(r*Math.max(Math.abs(t),Math.abs(e)),n):t===e)}var nj=Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},nV=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2};function nH(t,e){return rG(t)?t:rq(t)?t.toNumber():void e()}function nY(t,e){return rG(t)?t:rq(t)?t.toNumber():e}var nW=/* #__PURE__ */nE("Complex",[],()=>(Object.defineProperty(/*@__PURE__*/n(nA),"name",{value:"Complex"}),/*@__PURE__*/n(nA).prototype.constructor=/*@__PURE__*/n(nA),/*@__PURE__*/n(nA).prototype.type="Complex",/*@__PURE__*/n(nA).prototype.isComplex=!0,/*@__PURE__*/n(nA).prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},/*@__PURE__*/n(nA).prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},/*@__PURE__*/n(nA).prototype.format=function(t){var e=this.im,r=this.re,n=nP(this.re,t),i=nP(this.im,t),a=rG(t)?t:t?t.precision:null;if(null!==a){var o=Math.pow(10,-a);Math.abs(r/e)<o&&(r=0),Math.abs(e/r)<o&&(e=0)}return 0===e?n:0===r?1===e?"i":-1===e?"-i":i+"i":e<0?-1===e?n+" - i":n+" - "+i.substring(1)+"i":1===e?n+" + i":n+" + "+i+"i"},/*@__PURE__*/n(nA).fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return /*@__PURE__*/n(nA)(e);throw TypeError("Input has to be an object with r and phi keys.");case 2:var r=arguments[0],i=arguments[1];if(rG(r)){if(rY(i)&&i.hasBase("ANGLE")&&(i=i.toNumber("rad")),rG(i))return new/*@__PURE__*/(n(nA))({r:r,phi:i});throw TypeError("Phi is not a number nor an angle unit.")}throw TypeError("Radius r is not a number.");default:throw SyntaxError("Wrong number of arguments in function fromPolar")}},/*@__PURE__*/n(nA).prototype.valueOf=/*@__PURE__*/n(nA).prototype.toString,/*@__PURE__*/n(nA).fromJSON=function(t){return new/*@__PURE__*/(n(nA))(t)},/*@__PURE__*/n(nA).compare=function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0},/*@__PURE__*/n(nA)),{isClass:!0});function n$(t){var{hasher:e,limit:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=null==r?Number.POSITIVE_INFINITY:r,e=null==e?JSON.stringify:e,function n(){if("object"!=typeof n.cache){var i,a,o,s,u,l,h;n.cache={values:new Map,lru:(i=r||Number.POSITIVE_INFINITY,a=0,o=1,s=Object.create(null),u=Object.create(null),l=0,h=function(t){var e=u[t];if(e&&(delete s[e],delete u[t],--a,o===e)){if(!a){l=0,o=1;return}for(;!Object.prototype.hasOwnProperty.call(s,++o););}},i=Math.abs(i),{hit:function(t){var e=u[t],r=++l;if(s[r]=t,u[t]=r,!e){if(++a<=i)return;return h(t=s[o]),t}if(delete s[e],o===e)for(;!Object.prototype.hasOwnProperty.call(s,++o););},delete:h,clear:function(){a=l=0,o=1,s=Object.create(null),u=Object.create(null)}})}}for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var d=e(c);if(n.cache.values.has(d))return n.cache.lru.hit(d),n.cache.values.get(d);var p=t.apply(t,c);return n.cache.values.set(d,p),n.cache.values.delete(n.cache.lru.hit(d)),p}}n$(function(t){return new t(1).exp()},{hasher:nZ}),n$(function(t){return new t(1).plus(new t(5).sqrt()).div(2)},{hasher:nZ});var nK=n$(function(t){return t.acos(-1)},{hasher:nZ}),nX=n$(function(t){return nK(t).times(2)},{hasher:nZ});function nZ(t){return t[0].precision}var nJ=Math.PI,nQ=2*Math.PI;function n0(t,e,r){return nE(t,e,r,{recreateOnConfigChange:!0})}function n1(t,e){return nE(t,["config","BigNumber"],t=>{var{config:r,BigNumber:n}=t;return"BigNumber"===r.number?new n(e):e})}n1("fineStructure",.0072973525693),n1("weakMixingAngle",.2229),n1("efimovFactor",22.7),n1("sackurTetrode",-1.16487052358);var n2={};!function(t){function e(){return Error("Parameters must be integer")}function r(){return Error("Invalid argument")}function n(){return Error("Division by Zero")}function i(t,i){var o=c,s=f;let u=f;if(null!=t){if(void 0!==i){if("bigint"==typeof t)o=t;else{if(isNaN(t))throw r();if(0!=t%1)throw e();o=BigInt(t)}if("bigint"==typeof i)s=i;else{if(isNaN(i))throw r();if(0!=i%1)throw e();s=BigInt(i)}u=o*s}else if("object"==typeof t){if("d"in t&&"n"in t)o=BigInt(t.n),s=BigInt(t.d),"s"in t&&(o*=BigInt(t.s));else if(0 in t)o=BigInt(t[0]),1 in t&&(s=BigInt(t[1]));else if("bigint"==typeof t)o=t;else throw r();u=o*s}else if("number"==typeof t){if(isNaN(t))throw r();if(0>t&&(u=-f,t=-t),0==t%1)o=BigInt(t);else if(0<t){i=1;var l=0,h=1,d=1;let e=1;for(1<=t&&(i=10**Math.floor(1+Math.log10(t)),t/=i);1e7>=h&&1e7>=e;)if(t===(s=(l+d)/(h+e))){1e7>=h+e?(o=l+d,s=h+e):e>h?(o=d,s=e):(o=l,s=h);break}else t>s?(l+=d,h+=e):(d+=l,e+=h),1e7<h?(o=d,s=e):(o=l,s=h);o=BigInt(o)*BigInt(i),s=BigInt(s)}}else if("string"==typeof t){if(s=0,l=i=o=c,h=d=f,null===(t=t.replace(/_/g,"").match(/\d+|./g)))throw r();if("-"===t[s]?(u=-f,s++):"+"===t[s]&&s++,t.length===s+1?i=a(t[s++],u):"."===t[s+1]||"."===t[s]?("."!==t[s]&&(o=a(t[s++],u)),(++s+1===t.length||"("===t[s+1]&&")"===t[s+3]||"'"===t[s+1]&&"'"===t[s+3])&&(i=a(t[s],u),d=g**BigInt(t[s].length),s++),("("===t[s]&&")"===t[s+2]||"'"===t[s]&&"'"===t[s+2])&&(l=a(t[s+1],u),h=g**BigInt(t[s+1].length)-f,s+=3)):"/"===t[s+1]||":"===t[s+1]?(i=a(t[s],u),d=a(t[s+2],f),s+=3):"/"===t[s+3]&&" "===t[s+1]&&(o=a(t[s],u),i=a(t[s+2],u),d=a(t[s+4],f),s+=5),t.length<=s)u=o=l+(s=d*h)*o+h*i;else throw r()}else if("bigint"==typeof t)u=o=t,s=f;else throw r()}if(s===c)throw n();m.s=u<c?-f:f,m.n=o<c?-o:o,m.d=s<c?-s:s}function a(t,e){try{t=BigInt(t)}catch(t){throw r()}return t*e}function o(t){return"bigint"==typeof t?t:Math.floor(t)}function s(t,e){if(e===c)throw n();let r=Object.create(h.prototype);r.s=t<c?-f:f;let i=l(t=t<c?-t:t,e);return r.n=t/i,r.d=e/i,r}function u(t){let e={},r=t,n=d,i=p-f;for(;i<=r;){for(;r%n===c;)r/=n,e[n]=(e[n]||c)+f;i+=f+d*n++}return r!==t?1<r&&(e[r]=(e[r]||c)+f):e[t]=(e[t]||c)+f,e}function l(t,e){if(!t)return e;if(!e)return t;for(;;){if(!(t%=e))return e;if(!(e%=t))return t}}function h(t,e){if(i(t,e),!(this instanceof h))return s(m.s*m.n,m.d);t=l(m.d,m.n),this.s=m.s,this.n=m.n/t,this.d=m.d/t}"undefined"==typeof BigInt&&(BigInt=function(t){if(isNaN(t))throw Error("");return t});let c=BigInt(0),f=BigInt(1),d=BigInt(2),p=BigInt(5),g=BigInt(10),m={s:f,n:c,d:f};h.prototype={s:f,n:c,d:f,abs:function(){return s(this.n,this.d)},neg:function(){return s(-this.s*this.n,this.d)},add:function(t,e){return i(t,e),s(this.s*this.n*m.d+m.s*this.d*m.n,this.d*m.d)},sub:function(t,e){return i(t,e),s(this.s*this.n*m.d-m.s*this.d*m.n,this.d*m.d)},mul:function(t,e){return i(t,e),s(this.s*m.s*this.n*m.n,this.d*m.d)},div:function(t,e){return i(t,e),s(this.s*m.s*this.n*m.d,this.d*m.n)},clone:function(){return s(this.s*this.n,this.d)},mod:function(t,e){if(void 0===t)return s(this.s*this.n%this.d,f);if(i(t,e),c===m.n*this.d)throw n();return s(this.s*m.d*this.n%(m.n*this.d),m.d*this.d)},gcd:function(t,e){return i(t,e),s(l(m.n,this.n)*l(m.d,this.d),m.d*this.d)},lcm:function(t,e){return i(t,e),m.n===c&&this.n===c?s(c,f):s(m.n*this.n,l(m.n,this.n)*l(m.d,this.d))},inverse:function(){return s(this.s*this.d,this.n)},pow:function(t,e){if(i(t,e),m.d===f)return m.s<c?s((this.s*this.d)**m.n,this.n**m.n):s((this.s*this.n)**m.n,this.d**m.n);if(this.s<c)return null;t=u(this.n),e=u(this.d);let r=f,n=f;for(let e in t)if("1"!==e){if("0"===e){r=c;break}if(t[e]*=m.n,t[e]%m.d!==c)return null;t[e]/=m.d,r*=BigInt(e)**t[e]}for(let t in e)if("1"!==t){if(e[t]*=m.n,e[t]%m.d!==c)return null;e[t]/=m.d,n*=BigInt(t)**e[t]}return m.s<c?s(n,r):s(r,n)},log:function(t,e){if(i(t,e),this.s<=c||m.s<=c)return null;var r={};t=u(m.n);let n=u(m.d);e=u(this.n);let a=u(this.d);for(var o in n)t[o]=(t[o]||c)-n[o];for(var h in a)e[h]=(e[h]||c)-a[h];for(var f in t)"1"!==f&&(r[f]=!0);for(var d in e)"1"!==d&&(r[d]=!0);for(let n in h=o=null,r)if(f=t[n]||c,r=e[n]||c,f===c){if(r!==c)return null}else if(d=l(r,f),r/=d,f/=d,null===o&&null===h)o=r,h=f;else if(r*h!=o*f)return null;return null!==o&&null!==h?s(o,h):null},equals:function(t,e){return i(t,e),this.s*this.n*m.d==m.s*m.n*this.d},lt:function(t,e){return i(t,e),this.s*this.n*m.d<m.s*m.n*this.d},lte:function(t,e){return i(t,e),this.s*this.n*m.d<=m.s*m.n*this.d},gt:function(t,e){return i(t,e),this.s*this.n*m.d>m.s*m.n*this.d},gte:function(t,e){return i(t,e),this.s*this.n*m.d>=m.s*m.n*this.d},compare:function(t,e){return i(t,e),(c<(t=this.s*this.n*m.d-m.s*m.n*this.d))-(t<c)},ceil:function(t){return t=g**BigInt(t||0),s(o(this.s*t*this.n/this.d)+(t*this.n%this.d>c&&this.s>=c?f:c),t)},floor:function(t){return t=g**BigInt(t||0),s(o(this.s*t*this.n/this.d)-(t*this.n%this.d>c&&this.s<c?f:c),t)},round:function(t){return t=g**BigInt(t||0),s(o(this.s*t*this.n/this.d)+this.s*((this.s>=c?f:c)+t*this.n%this.d*d>this.d?f:c),t)},roundTo:function(t,e){i(t,e);var r=this.n*m.d;return e=r%(t=this.d*m.n),r=o(r/t),e+e>=t&&r++,s(this.s*r*m.n,m.d)},divisible:function(t,e){return i(t,e),!(!(m.n*this.d)||this.n*m.d%(m.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let e=this.n,r=this.d;t=t||15;e:{for(n=r;n%d===c;n/=d);for(;n%p===c;n/=p);if(n===f)n=c;else{for(var n,i=g%n,a=1;i!==f;a++)if(i=i*g%n,2e3<a){n=c;break e}n=BigInt(a)}}e:{i=f,a=g;var s=n;let t=f;for(;s>c;a=a*a%r,s>>=f)s&f&&(t=t*a%r);for(s=0,a=t;300>s;s++){if(i===a){i=BigInt(s);break e}i=i*g%r,a=a*g%r}i=0}if(a=i,i=(this.s<c?"-":"")+o(e/r),(e=e%r*g)&&(i+="."),n){for(t=a;t--;)i+=o(e/r),e%=r,e*=g;for(i+="(",t=n;t--;)i+=o(e/r),e%=r,e*=g;i+=")"}else for(;e&&t--;)i+=o(e/r),e%=r,e*=g;return i},toFraction:function(t){let e=this.n,r=this.d,n=this.s<c?"-":"";if(r===f)n+=e;else{let i=o(e/r);t&&i>c&&(n+=i,n+=" ",e%=r),n=n+e+"/"+r}return n},toLatex:function(t){let e=this.n,r=this.d,n=this.s<c?"-":"";if(r===f)n+=e;else{let i=o(e/r);t&&i>c&&(n+=i,e%=r),n=n+"\\frac{"+e+"}{"+r+"}"}return n},toContinued:function(){let t=this.n,e=this.d,r=[];do{r.push(o(t/e));let n=t%e;t=e,e=n}while(t!==f)return r},simplify:function(t){t=BigInt(1/(t||.001)|0);let e=this.abs(),r=e.toContinued();for(let i=1;i<r.length;i++){let a=s(r[i-1],f);for(var n=i-2;0<=n;n--)a=a.inverse().add(r[n]);if((n=a.sub(e)).n*t<n.d)return a.mul(this.s)}return this}},"function"==typeof define&&define.amd?define([],function(){return h}):(Object.defineProperty(h,"__esModule",{value:!0}),h.default=h,h.Fraction=h,n2=h)}(0);var n5=/* #__PURE__ */nE("Fraction",[],()=>(Object.defineProperty(/*@__PURE__*/n(n2),"name",{value:"Fraction"}),/*@__PURE__*/n(n2).prototype.constructor=/*@__PURE__*/n(n2),/*@__PURE__*/n(n2).prototype.type="Fraction",/*@__PURE__*/n(n2).prototype.isFraction=!0,/*@__PURE__*/n(n2).prototype.toJSON=function(){return{mathjs:"Fraction",n:String(this.s*this.n),d:String(this.d)}},/*@__PURE__*/n(n2).fromJSON=function(t){return new/*@__PURE__*/(n(n2))(t)},/*@__PURE__*/n(n2)),{isClass:!0}),n3=/* #__PURE__ */nE("Matrix",[],()=>{function t(){if(!(this instanceof t))throw SyntaxError("Constructor must be called with the new operator")}return t.prototype.type="Matrix",t.prototype.isMatrix=!0,t.prototype.storage=function(){throw Error("Cannot invoke storage on a Matrix interface")},t.prototype.datatype=function(){throw Error("Cannot invoke datatype on a Matrix interface")},t.prototype.create=function(t,e){throw Error("Cannot invoke create on a Matrix interface")},t.prototype.subset=function(t,e,r){throw Error("Cannot invoke subset on a Matrix interface")},t.prototype.get=function(t){throw Error("Cannot invoke get on a Matrix interface")},t.prototype.set=function(t,e,r){throw Error("Cannot invoke set on a Matrix interface")},t.prototype.resize=function(t,e){throw Error("Cannot invoke resize on a Matrix interface")},t.prototype.reshape=function(t,e){throw Error("Cannot invoke reshape on a Matrix interface")},t.prototype.clone=function(){throw Error("Cannot invoke clone on a Matrix interface")},t.prototype.size=function(){throw Error("Cannot invoke size on a Matrix interface")},t.prototype.map=function(t,e){throw Error("Cannot invoke map on a Matrix interface")},t.prototype.forEach=function(t){throw Error("Cannot invoke forEach on a Matrix interface")},t.prototype[Symbol.iterator]=function(){throw Error("Cannot iterate a Matrix interface")},t.prototype.toArray=function(){throw Error("Cannot invoke toArray on a Matrix interface")},t.prototype.valueOf=function(){throw Error("Cannot invoke valueOf on a Matrix interface")},t.prototype.format=function(t){throw Error("Cannot invoke format on a Matrix interface")},t.prototype.toString=function(){throw Error("Cannot invoke toString on a Matrix interface")},t},{isClass:!0});function n4(t,e,r){var n=new t.constructor(2),i="";if(r){if(r<1)throw Error("size must be in greater than 0");if(!nF(r))throw Error("size must be an integer");if(t.greaterThan(n.pow(r-1).sub(1))||t.lessThan(n.pow(r-1).mul(-1)))throw Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!t.isInteger())throw Error("Value must be an integer");t.lessThan(0)&&(t=t.add(n.pow(r))),i="i".concat(r)}switch(e){case 2:return"".concat(t.toBinary()).concat(i);case 8:return"".concat(t.toOctal()).concat(i);case 16:return"".concat(t.toHexadecimal()).concat(i);default:throw Error("Base ".concat(e," not supported "))}}function n8(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()}function n6(t,e){return rG(t)?t:rq(t)?t.toNumber():e}function n9(t,e){var r=function(t,e){return"number"==typeof t?nP(t,e):rq(t)?function(t,e){if("function"==typeof e)return e(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var{notation:r,precision:n,wordSize:i}=nR(e);switch(r){case"fixed":return t.toFixed(n);case"exponential":return n8(t,n);case"engineering":return o=(a=t.e)%3==0?a:a<0?a-3-a%3:a-a%3,(s=t.mul(Math.pow(10,-o)).toPrecision(n)).includes("e")&&(s=new t.constructor(s).toFixed()),s+"e"+(a>=0?"+":"")+o.toString();case"bin":return n4(t,2,i);case"oct":return n4(t,8,i);case"hex":return n4(t,16,i);case"auto":var a,o,s,u=n6(null==e?void 0:e.lowerExp,-3),l=n6(null==e?void 0:e.upperExp,5);if(t.isZero())return"0";var h=t.toSignificantDigits(n),c=h.e;return(c>=u&&c<l?h.toFixed():n8(t,n)).replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw Error('Unknown notation "'+r+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}(t,e):t&&"object"==typeof t&&"bigint"==typeof t.s&&"bigint"==typeof t.n&&"bigint"==typeof t.d?e&&"decimal"===e.fraction?t.toString():"".concat(t.s*t.n,"/").concat(t.d):Array.isArray(t)?function t(e,r){if(!Array.isArray(e))return n9(e,r);for(var n="[",i=e.length,a=0;a<i;a++)0!==a&&(n+=", "),n+=t(e[a],r);return n+"]"}(t,e):rW(t)?n7(t):"function"==typeof t?t.syntax?String(t.syntax):"function":t&&"object"==typeof t?"function"==typeof t.format?t.format(e):t&&t.toString(e)!==({}).toString()?t.toString(e):"{"+Object.keys(t).map(r=>n7(r)+": "+n9(t[r],e)).join(", ")+"}":String(t)}(t,e);return e&&"object"==typeof e&&"truncate"in e&&r.length>e.truncate?r.substring(0,e.truncate-3)+"...":r}function n7(t){for(var e=String(t),r="",n=0;n<e.length;){var i=e.charAt(n);r+=i in it?it[i]:i,n++}return'"'+r+'"'}var it={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function ie(t,e){if(!rW(t))throw TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+ny(t)+", index: 0)");if(!rW(e))throw TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+ny(e)+", index: 1)");return t===e?0:t>e?1:-1}function ir(t,e,r){if(!(this instanceof ir))throw SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=r,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=Error().stack}function ii(t,e,r){if(!(this instanceof ii))throw SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=r),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=Error().stack}function ia(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e}function io(t,e){if(0===e.length){if(Array.isArray(t))throw new ir(t.length,0)}else!function t(e,r,n){var i,a=e.length;if(a!==r[n])throw new ir(a,r[n]);if(n<r.length-1){var o=n+1;for(i=0;i<a;i++){if(!Array.isArray(e[i]))throw new ir(r.length-1,r.length,"<");t(e[i],r,o)}}else for(i=0;i<a;i++)if(Array.isArray(e[i]))throw new ir(r.length+1,r.length,">")}(t,e,0)}function is(t,e){var r=t.isMatrix?t._size:ia(t);e._sourceSize.forEach((t,e)=>{if(null!==t&&t!==r[e])throw new ir(t,r[e])})}function iu(t,e){if(void 0!==t){if(!rG(t)||!nF(t))throw TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"==typeof e&&t>=e)throw new ii(t,e)}}function il(t){for(var e=0;e<t._dimensions.length;++e){var r=t._dimensions[e];if(r._data&&r$(r._data)){if(0===r._size[0])return!0}else if(r.isRange){if(r.start===r.end)return!0}else if(rW(r)&&0===r.length)return!0}return!1}function ih(t,e,r){if(!Array.isArray(e))throw TypeError("Array expected");if(0===e.length)throw Error("Resizing to scalar is not supported");return e.forEach(function(t){if(!rG(t)||!nF(t)||t<0)throw TypeError("Invalid size, must contain positive integers (size: "+n9(e)+")")}),(rG(t)||rq(t))&&(t=[t]),function t(e,r,n,i){var a,o,s=e.length,u=r[n],l=Math.min(s,u);if(e.length=u,n<r.length-1){var h=n+1;for(a=0;a<l;a++)Array.isArray(o=e[a])||(o=[o],e[a]=o),t(o,r,h,i);for(a=l;a<u;a++)o=[],e[a]=o,t(o,r,h,i)}else{for(a=0;a<l;a++)for(;Array.isArray(e[a]);)e[a]=e[a][0];for(a=l;a<u;a++)e[a]=i}}(t,e,0,void 0!==r?r:0),t}function ic(t,e){var r=im(t),n=r.length;if(!Array.isArray(t)||!Array.isArray(e))throw TypeError("Array expected");if(0===e.length)throw new ir(0,n,"!=");var i=ip(e=id(e,n));if(n!==i)throw new ir(i,n,"!=");try{return function(t,e){for(var r,n=t,i=e.length-1;i>0;i--){var a=e[i];r=[];for(var o=n.length/a,s=0;s<o;s++)r.push(n.slice(s*a,(s+1)*a));n=r}return n}(r,e)}catch(t){if(t instanceof ir)throw new ir(i,n,"!=");throw t}}function id(t,e){var r=ip(t),n=t.slice(),i=t.indexOf(-1);if(t.indexOf(-1,i+1)>=0)throw Error("More than one wildcard in sizes");if(i>=0){if(e%r==0)n[i]=-e/r;else throw Error("Could not replace wildcard, since "+e+" is no multiple of "+-r)}return n}function ip(t){return t.reduce((t,e)=>t*e,1)}function ig(t,e,r,n){var i=n||ia(t);if(r)for(var a=0;a<r;a++)t=[t],i.unshift(1);for(t=function t(e,r,n){var i,a;if(Array.isArray(e)){var o=n+1;for(i=0,a=e.length;i<a;i++)e[i]=t(e[i],r,o)}else for(var s=n;s<r;s++)e=[e];return e}(t,e,0);i.length<e;)i.push(1);return t}function im(t){if(!Array.isArray(t))return t;var e=[];return t.forEach(function t(r){Array.isArray(r)?r.forEach(t):e.push(r)}),e}function iv(t){if(!Array.isArray(t))throw TypeError("Array input expected");if(0===t.length)return t;var e=[],r=0;e[0]={value:t[0],identifier:0};for(var n=1;n<t.length;n++)t[n]===t[n-1]?r++:r=0,e.push({value:t[n],identifier:r});return e}function iy(t){if(!Array.isArray(t))throw TypeError("Array input expected");if(0===t.length)return t;for(var e=[],r=0;r<t.length;r++)e.push(t[r].value);return e}function ix(t,e){for(var r,n=0,i=0;i<t.length;i++){var a=t[i],o=Array.isArray(a);if(0===i&&o&&(n=a.length),o&&a.length!==n)return;var s=o?ix(a,e):e(a);if(void 0===r)r=s;else if(r!==s)return"mixed"}return r}function ib(){var t=Array.prototype.slice.call(arguments,0,-1),e=Array.prototype.slice.call(arguments,-1);if(1===t.length)return t[0];if(t.length>1)return t.slice(1).reduce(function(t,r){return function t(e,r,n,i){if(!(i<n))return e.concat(r);if(e.length!==r.length)throw new ir(e.length,r.length);for(var a=[],o=0;o<e.length;o++)a[o]=t(e[o],r[o],n,i+1);return a}(t,r,e,0)},t[0]);throw Error("Wrong number of arguments in function concat")}function iD(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=e.map(t=>t.length),i=Math.max(...n),a=Array(i).fill(null),o=0;o<e.length;o++)for(var s=e[o],u=n[o],l=0;l<u;l++){var h=i-u+l;s[l]>a[h]&&(a[h]=s[l])}for(var c=0;c<e.length;c++)i_(e[c],a);return a}function i_(t,e){for(var r=e.length,n=t.length,i=0;i<n;i++){var a=r-n+i;if(t[i]<e[a]&&t[i]>1||t[i]>e[a])throw Error("shape missmatch: missmatch is found in arg with shape (".concat(t,") not possible to broadcast dimension ").concat(n," with size ").concat(t[i]," to size ").concat(e[a]))}}function iw(t,e){var r,i,a,o=ia(t);if(rO(o,e))return t;i_(o,e);var s=iD(o,e),u=s.length,l=[...Array(u-o.length).fill(1),...o],h=/*@__PURE__*/n(nx)([],t);o.length<u&&(o=ia(h=ic(h,l)));for(var c=0;c<u;c++)o[c]<s[c]&&(o=ia((r=h,i=s[c],a=c,h=ib(...Array(i).fill(r),a))));return h}function iE(t,e){if(!Array.isArray(t))throw Error("Array expected");var r=ia(t);if(e.length!==r.length)throw new ir(e.length,r.length);for(var n=0;n<e.length;n++)iu(e[n],r[n]);return e.reduce((t,e)=>t[e],t)}function iC(t,e,r,n){return Array.isArray(t)?t.map(function(t,i){return iC(t,e.concat(i),r,n)}):n(t,e,r)}ir.prototype=RangeError(),ir.prototype.constructor=RangeError,ir.prototype.name="DimensionError",ir.prototype.isDimensionError=!0,ii.prototype=RangeError(),ii.prototype.constructor=RangeError,ii.prototype.name="IndexError",ii.prototype.isIndexError=!0;var iS={};function iA(t,e,r){if(/*@__PURE__*/n(iS).isTypedFunction(t)){var i=(e.isMatrix?e.size():ia(e)).map(()=>0),a=e.isMatrix?e.get(i):iE(e,i),o=1===Object.keys(t.signatures).length,s=function(t,e,r,i){for(var a=[e,r,i],o=3;o>0;o--){var s=a.slice(0,o);if(null!==/*@__PURE__*/n(iS).resolve(t,s))return o}}(t,a,i,e),u=o?Object.values(t.signatures)[0]:t;return s>=1&&s<=3?function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return iF(u,n.slice(0,s),r,t.name)}:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return iF(u,n,r,t.name)}}return t}function iF(t,e,r,n){try{return t(...e)}catch(t){!function(t,e,r,n){var i;if(t instanceof TypeError&&(null===(i=t.data)||void 0===i?void 0:i.category)==="wrongType"){var a=[];throw a.push("value: ".concat(ny(e[0]))),e.length>=2&&a.push("index: ".concat(ny(e[1]))),e.length>=3&&a.push("array: ".concat(ny(e[2]))),TypeError("Function ".concat(r," cannot apply callback arguments ")+"".concat(n,"(").concat(a.join(", "),") at index ").concat(JSON.stringify(e[1])))}throw TypeError("Function ".concat(r," cannot apply callback arguments ")+"to function ".concat(n,": ").concat(t.message))}(t,e,r,n)}}iS=function(){function t(){return!0}function e(){return!1}function r(){}let n="Argument is not a typed-function.";return function i(){let a,o;function s(t){return"object"==typeof t&&null!==t&&t.constructor===Object}let u=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:s},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],l={name:"any",test:t,isAny:!0},h=0,c={createCount:0};function f(t){let e;let r=a.get(t);if(r)return r;let n='Unknown type "'+t+'"',i=t.toLowerCase();for(e of o)if(e.toLowerCase()===i){n+='. Did you mean "'+e+'" ?';break}throw TypeError(n)}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any",r=e?f(e).index:o.length,n=[];for(let e=0;e<t.length;++e){if(!t[e]||"string"!=typeof t[e].name||"function"!=typeof t[e].test)throw TypeError("Object with properties {name: string, test: function} expected");let i=t[e].name;if(a.has(i))throw TypeError('Duplicate type name "'+i+'"');n.push(i),a.set(i,{name:i,test:t[e].test,isAny:t[e].isAny,index:r+e,conversionsTo:[]})}let i=o.slice(r);o=o.slice(0,r).concat(n).concat(i);for(let t=r+n.length;t<o.length;++t)a.get(o[t]).index=t}function p(){a=new Map,o=[],h=0,d([l],!1)}function g(t){let e=o.filter(e=>{let r=a.get(e);return!r.isAny&&r.test(t)});return e.length?e:["any"]}function m(t){return t&&"function"==typeof t&&"_typedFunctionData"in t}function v(t,e,r){let i,a;if(!m(t))throw TypeError(n);let o=r&&r.exact,s=D(Array.isArray(e)?e.join(","):e),u=y(s);if(!o||u in t.signatures){let e=t._typedFunctionData.signatureMap.get(u);if(e)return e}let l=s.length;if(o){let e;for(e in i=[],t.signatures)i.push(t._typedFunctionData.signatureMap.get(e))}else i=t._typedFunctionData.signatures;for(let t=0;t<l;++t){let e;let r=s[t],n=[];for(e of i){let i=E(e.params,t);if(i&&(!r.restParam||i.restParam)){if(!i.hasAny){let t=b(i);if(r.types.some(e=>!t.has(e.name)))continue}n.push(e)}}if(0===(i=n).length)break}for(a of i)if(a.params.length<=l)return a;throw TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+y(s,", ")+"))")}function y(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return t.map(t=>t.name).join(e)}function x(t){let e=function(t){if(0===t.length)return[];let e=t.map(f);t.length>1&&e.sort((t,e)=>t.index-e.index);let r=e[0].conversionsTo;if(1===t.length)return r;r=r.concat([]);let n=new Set(t);for(let t=1;t<e.length;++t){let i;for(i of e[t].conversionsTo)n.has(i.from)||(r.push(i),n.add(i.from))}return r}(t.types.map(t=>t.name)),r=t.hasAny,n=t.name,i=e.map(function(t){let e=f(t.from);return r=e.isAny||r,n+="|"+t.from,{name:t.from,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:t,conversionIndex:t.index}});return{types:t.types.concat(i),name:n,hasAny:r,hasConversion:i.length>0,restParam:t.restParam}}function b(t){return t.typeSet||(t.typeSet=new Set,t.types.forEach(e=>t.typeSet.add(e.name))),t.typeSet}function D(t){let e=[];if("string"!=typeof t)throw TypeError("Signatures must be strings");let r=t.trim();if(""===r)return e;let n=r.split(",");for(let t=0;t<n.length;++t){let r=function(t){let e=0===t.indexOf("..."),r=(e?t.length>3?t.slice(3):"any":t).split("|").map(t=>f(t.trim())),n=!1,i=e?"...":"";return{types:r.map(function(t){return n=t.isAny||n,i+=t.name+"|",{name:t.name,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:null,conversionIndex:-1}}),name:i.slice(0,-1),hasAny:n,hasConversion:!1,restParam:e}}(n[t].trim());if(r.restParam&&t!==n.length-1)throw SyntaxError('Unexpected rest parameter "'+n[t]+'": only allowed for the last parameter');if(0===r.types.length)return null;e.push(r)}return e}function _(t){let e=P(t);return!!e&&e.restParam}function w(e){if(!e||0===e.types.length)return t;if(1===e.types.length)return f(e.types[0].name).test;if(2===e.types.length){let t=f(e.types[0].name).test,r=f(e.types[1].name).test;return function(e){return t(e)||r(e)}}{let t=e.types.map(function(t){return f(t.name).test});return function(e){for(let r=0;r<t.length;r++)if(t[r](e))return!0;return!1}}}function E(t,e){return e<t.length?t[e]:_(t)?P(t):null}function C(t,e){let r=E(t,e);return r?b(r):new Set}function S(t){return null===t.conversion||void 0===t.conversion}function A(t,e){let r=new Set;return t.forEach(t=>{let n;for(n of C(t.params,e))r.add(n)}),r.has("any")?["any"]:Array.from(r)}function F(t,e,r){let n,i,a;let o=t||"unnamed",s=r;for(a=0;a<e.length;a++){let t=[];if(s.forEach(r=>{let n=w(E(r.params,a));(a<r.params.length||_(r.params))&&n(e[a])&&t.push(r)}),0===t.length){if((i=A(s,a)).length>0){let t=g(e[a]);return(n=TypeError("Unexpected type of argument in function "+o+" (expected: "+i.join(" or ")+", actual: "+t.join(" | ")+", index: "+a+")")).data={category:"wrongType",fn:o,index:a,actual:t,expected:i},n}}else s=t}let u=s.map(function(t){return _(t.params)?1/0:t.params.length});if(e.length<Math.min.apply(null,u))return(n=TypeError("Too few arguments in function "+o+" (expected: "+(i=A(s,a)).join(" or ")+", index: "+e.length+")")).data={category:"tooFewArgs",fn:o,index:e.length,expected:i},n;let l=Math.max.apply(null,u);if(e.length>l)return(n=TypeError("Too many arguments in function "+o+" (expected: "+l+", actual: "+e.length+")")).data={category:"tooManyArgs",fn:o,index:e.length,expectedLength:l},n;let h=[];for(let t=0;t<e.length;++t)h.push(g(e[t]).join("|"));return(n=TypeError('Arguments of type "'+h.join(", ")+'" do not match any of the defined signatures of function '+o+".")).data={category:"mismatch",actual:h},n}function N(t){let e=o.length+1;for(let r=0;r<t.types.length;r++)S(t.types[r])&&(e=Math.min(e,t.types[r].typeIndex));return e}function M(t){let e=h+1;for(let r=0;r<t.types.length;r++)S(t.types[r])||(e=Math.min(e,t.types[r].conversionIndex));return e}function T(t,e){let r,n;let i=t.params,a=e.params,o=P(i),s=P(a),u=_(i),l=_(a);if(u&&o.hasAny){if(!l||!s.hasAny)return 1}else if(l&&s.hasAny)return -1;let h=0,c=0;for(r of i)r.hasAny&&++h,r.hasConversion&&++c;let f=0,d=0;for(r of a)r.hasAny&&++f,r.hasConversion&&++d;if(h!==f)return h-f;if(u&&o.hasConversion){if(!l||!s.hasConversion)return 1}else if(l&&s.hasConversion)return -1;if(c!==d)return c-d;if(u){if(!l)return 1}else if(l)return -1;let p=(i.length-a.length)*(u?-1:1);if(0!==p)return p;let g=[],m=0;for(let t=0;t<i.length;++t){let e=function(t,e){if(t.hasAny){if(!e.hasAny)return 1}else if(e.hasAny)return -1;if(t.restParam){if(!e.restParam)return 1}else if(e.restParam)return -1;if(t.hasConversion){if(!e.hasConversion)return 1}else if(e.hasConversion)return -1;let r=N(t)-N(e);if(r<0)return -1;if(r>0)return 1;let n=M(t)-M(e);return n<0?-1:n>0?1:0}(i[t],a[t]);g.push(e),m+=e}if(0!==m)return m;for(n of g)if(0!==n)return n;return 0}function B(t){let e,r,n,i;let a=[],o=[];switch(t.types.forEach(function(t){t.conversion&&(a.push(f(t.conversion.from).test),o.push(t.conversion.convert))}),o.length){case 0:return function(t){return t};case 1:return e=a[0],n=o[0],function(t){return e(t)?n(t):t};case 2:return e=a[0],r=a[1],n=o[0],i=o[1],function(t){return e(t)?n(t):r(t)?i(t):t};default:return function(t){for(let e=0;e<o.length;e++)if(a[e](t))return o[e](t);return t}}}function O(t,e,r){throw F(t,e,r)}function k(t){return R(t,0,t.length-1)}function P(t){return t[t.length-1]}function R(t,e,r){return Array.prototype.slice.call(t,e,r)}function I(t,e){return{referTo:{references:t,callback:e}}}function z(t){if("function"!=typeof t)throw TypeError("Callback function expected as first argument");return{referToSelf:{callback:t}}}function U(t){return t&&"object"==typeof t.referTo&&Array.isArray(t.referTo.references)&&"function"==typeof t.referTo.callback}function L(t){return t&&"object"==typeof t.referToSelf&&"function"==typeof t.referToSelf.callback}function G(t,e){if(!t)return e;if(e&&e!==t){let r=Error("Function names do not match (expected: "+t+", actual: "+e+")");throw r.data={actual:e,expected:t},r}return t}p(),d(u);let q=c;function j(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw TypeError("Object with properties {from: string, to: string, convert: function} expected");if(t.to===t.from)throw SyntaxError('Illegal to define conversion from "'+t.from+'" to itself.')}return(c=function(t){let n="string"==typeof t,i=n?1:0,a=n?t:"",o={};for(let t=i;t<arguments.length;++t){let e;let r=arguments[t],i={};if("function"==typeof r?(e=r.name,"string"==typeof r.signature?i[r.signature]=r:m(r)&&(i=r.signatures)):s(r)&&(i=r,n||(e=function(t){let e;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(m(t[r])||"string"==typeof t[r].signature)&&(e=G(e,t[r].name));return e}(r))),0===Object.keys(i).length){let e=TypeError("Argument to 'typed' at index "+t+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw e.data={index:t,argument:r},e}n||(a=G(a,e)),function(t,e){let r;for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(r in t&&e[r]!==t[r]){let n=Error('Signature "'+r+'" is defined twice');throw n.data={signature:r,sourceFunction:e[r],destFunction:t[r]},n}t[r]=e[r]}}(o,i)}return function(t,n){let i,a;if(c.createCount++,0===Object.keys(n).length)throw SyntaxError("No signatures provided");c.warnAgainstDeprecatedThis&&function(t){let e=/\bthis(\(|\.signatures\b)/;Object.keys(t).forEach(r=>{let n=t[r];if(e.test(n.toString()))throw SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}(n);let o=[],s=[],u={},l=[];for(i in n){let t;if(!Object.prototype.hasOwnProperty.call(n,i))continue;let e=D(i);if(!e)continue;o.forEach(function(t){if(function(t,e){let r=Math.max(t.length,e.length);for(let n=0;n<r;n++){let r;let i=C(t,n),a=C(e,n),o=!1;for(r of a)if(i.has(r)){o=!0;break}if(!o)return!1}let n=t.length,i=e.length,a=_(t),o=_(e);return a?o?n===i:i>=n:o?n>=i:n===i}(t,e))throw TypeError('Conflicting signatures "'+y(t)+'" and "'+y(e)+'".')}),o.push(e);let r=s.length;for(t of(s.push(n[i]),function t(e,r,n){if(!(r<e.length))return[n];{var i,a;let o=e[r],s=[];if(o.restParam){let t=o.types.filter(S);t.length<o.types.length&&s.push({types:t,name:"..."+t.map(t=>t.name).join("|"),hasAny:t.some(t=>t.isAny),hasConversion:!1,restParam:!0}),s.push(o)}else s=o.types.map(function(t){return{types:[t],name:t.name,hasAny:t.isAny,hasConversion:t.conversion,restParam:!1}});return i=s,a=function(i){return t(e,r+1,n.concat([i]))},Array.prototype.concat.apply([],i.map(a))}}(e.map(x),0,[]))){let e=y(t);l.push({params:t,name:e,fn:r}),t.every(t=>!t.hasConversion)&&(u[e]=r)}}l.sort(T);let h=function(t,e,r){let n=t.map(t=>L(t)?z(t.referToSelf.callback):U(t)?I(t.referTo.references,t.referTo.callback):t),i=Array(n.length).fill(!1),a=!0;for(;a;){a=!1;let t=!0;for(let o=0;o<n.length;++o){if(i[o])continue;let s=n[o];if(L(s))n[o]=s.referToSelf.callback(r),n[o].referToSelf=s.referToSelf,i[o]=!0,t=!1;else if(U(s)){let r=function(t,e,r){let n;let i=[];for(n of t){let t=r[n];if("number"!=typeof t)throw TypeError('No definition for referenced signature "'+n+'"');if("function"!=typeof(t=e[t]))return!1;i.push(t)}return i}(s.referTo.references,n,e);r?(n[o]=s.referTo.callback.apply(this,r),n[o].referTo=s.referTo,i[o]=!0,t=!1):a=!0}}if(t&&a)throw SyntaxError("Circular reference detected in resolving typed.referTo")}return n}(s,u,tc);for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(u[a]=h[u[a]]);let f=[],d=new Map;for(a of l)d.has(a.name)||(a.fn=h[a.fn],f.push(a),d.set(a.name,a));let p=f[0]&&f[0].params.length<=2&&!_(f[0].params),g=f[1]&&f[1].params.length<=2&&!_(f[1].params),m=f[2]&&f[2].params.length<=2&&!_(f[2].params),v=f[3]&&f[3].params.length<=2&&!_(f[3].params),b=f[4]&&f[4].params.length<=2&&!_(f[4].params),E=f[5]&&f[5].params.length<=2&&!_(f[5].params);for(let t=0;t<f.length;++t)f[t].test=function(t){let e,r,n;if(_(t)){let r=(e=k(t).map(w)).length,n=w(P(t)),i=function(t){for(let e=r;e<t.length;e++)if(!n(t[e]))return!1;return!0};return function(t){for(let r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return i(t)&&t.length>=r+1}}return 0===t.length?function(t){return 0===t.length}:1===t.length?(r=w(t[0]),function(t){return r(t[0])&&1===t.length}):2===t.length?(r=w(t[0]),n=w(t[1]),function(t){return r(t[0])&&n(t[1])&&2===t.length}):(e=t.map(w),function(t){for(let r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return t.length===e.length})}(f[t].params);let A=p?w(f[0].params[0]):e,F=g?w(f[1].params[0]):e,N=m?w(f[2].params[0]):e,M=v?w(f[3].params[0]):e,O=b?w(f[4].params[0]):e,G=E?w(f[5].params[0]):e,q=p?w(f[0].params[1]):e,j=g?w(f[1].params[1]):e,V=m?w(f[2].params[1]):e,H=v?w(f[3].params[1]):e,Y=b?w(f[4].params[1]):e,W=E?w(f[5].params[1]):e;for(let t=0;t<f.length;++t)f[t].implementation=function(t,e){let r=e;if(t.some(t=>t.hasConversion)){let n=_(t),i=t.map(B);r=function(){let t=[],r=n?arguments.length-1:arguments.length;for(let e=0;e<r;e++)t[e]=i[e](arguments[e]);return n&&(t[r]=arguments[r].map(i[r])),e.apply(this,t)}}let n=r;if(_(t)){let e=t.length-1;n=function(){return r.apply(this,R(arguments,0,e).concat([R(arguments,e)]))}}return n}(f[t].params,f[t].fn);let $=p?f[0].implementation:r,K=g?f[1].implementation:r,X=m?f[2].implementation:r,Z=v?f[3].implementation:r,J=b?f[4].implementation:r,Q=E?f[5].implementation:r,tt=p?f[0].params.length:-1,te=g?f[1].params.length:-1,tr=m?f[2].params.length:-1,tn=v?f[3].params.length:-1,ti=b?f[4].params.length:-1,ta=E?f[5].params.length:-1,to=p&&g&&m&&v&&b&&E?6:0,ts=f.length,tu=f.map(t=>t.test),tl=f.map(t=>t.implementation),th=function(){for(let t=to;t<ts;t++)if(tu[t](arguments))return tl[t].apply(this,arguments);return c.onMismatch(t,arguments,f)};function tc(t,e){return arguments.length===tt&&A(t)&&q(e)?$.apply(this,arguments):arguments.length===te&&F(t)&&j(e)?K.apply(this,arguments):arguments.length===tr&&N(t)&&V(e)?X.apply(this,arguments):arguments.length===tn&&M(t)&&H(e)?Z.apply(this,arguments):arguments.length===ti&&O(t)&&Y(e)?J.apply(this,arguments):arguments.length===ta&&G(t)&&W(e)?Q.apply(this,arguments):th.apply(this,arguments)}try{Object.defineProperty(tc,"name",{value:t})}catch(t){}return tc.signatures=u,tc._typedFunctionData={signatures:f,signatureMap:d},tc}(a||"",o)}).create=i,c.createCount=q.createCount,c.onMismatch=O,c.throwMismatchError=O,c.createError=F,c.clear=p,c.clearConversions=function(){let t;for(t of o)a.get(t).conversionsTo=[];h=0},c.addTypes=d,c._findType=f,c.referTo=function(){let t=k(arguments).map(t=>y(D(t))),e=P(arguments);if("function"!=typeof e)throw TypeError("Callback function expected as last argument");return I(t,e)},c.referToSelf=z,c.convert=function(t,e){let r=f(e);if(r.test(t))return t;let n=r.conversionsTo;if(0===n.length)throw Error("There are no conversions to "+e+" defined.");for(let e=0;e<n.length;e++)if(f(n[e].from).test(t))return n[e].convert(t);throw Error("Cannot convert "+t+" to "+e)},c.findSignature=v,c.find=function(t,e,r){return v(t,e,r).implementation},c.isTypedFunction=m,c.warnAgainstDeprecatedThis=!0,c.addType=function(t,e){let r="any";!1!==e&&a.has("Object")&&(r="Object"),c.addTypes([t],r)},c.addConversion=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{override:!1};j(t);let r=f(t.to),n=r.conversionsTo.find(e=>e.from===t.from);if(n){if(e&&e.override)c.removeConversion({from:n.from,to:t.to,convert:n.convert});else throw Error('There is already a conversion from "'+t.from+'" to "'+r.name+'"')}r.conversionsTo.push({from:t.from,convert:t.convert,index:h++})},c.addConversions=function(t,e){t.forEach(t=>c.addConversion(t,e))},c.removeConversion=function(t){j(t);let e=f(t.to),r=function(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return t[r]}(e.conversionsTo,e=>e.from===t.from);if(!r)throw Error("Attempt to remove nonexistent conversion from "+t.from+" to "+t.to);if(r.convert!==t.convert)throw Error("Conversion to remove does not match existing conversion");let n=e.conversionsTo.indexOf(r);e.conversionsTo.splice(n,1)},c.resolve=function(t,e){if(!m(t))throw TypeError(n);let r=t._typedFunctionData.signatures;for(let t=0;t<r.length;++t)if(r[t].test(e))return r[t];return null},c}()}();var iN=/* #__PURE__ */nE("DenseMatrix",["Matrix"],t=>{var{Matrix:e}=t;function r(t,e){if(!(this instanceof r))throw SyntaxError("Constructor must be called with the new operator");if(e&&!rW(e))throw Error("Invalid datatype: "+e);if(rK(t))"DenseMatrix"===t.type?(this._data=rT(t._data),this._size=rT(t._size)):(this._data=t.toArray(),this._size=t.size()),this._datatype=e||t._datatype;else if(t&&r$(t.data)&&r$(t.size))this._data=t.data,this._size=t.size,io(this._data,this._size),this._datatype=e||t.datatype;else if(r$(t))this._data=function t(e){return rK(e)?t(e.valueOf()):r$(e)?e.map(t):e}(t),this._size=ia(this._data),io(this._data,this._size),this._datatype=e;else if(t)throw TypeError("Unsupported type of data ("+ny(t)+")");else this._data=[],this._size=[0],this._datatype=e}function n(t,e,r){if(0===e.length){for(var n=t._data;r$(n);)n=n[0];return n}return t._size=e.slice(0),t._data=ih(t._data,t._size,r),t}function i(t,e,r){for(var i=t._size.slice(0),a=!1;i.length<e.length;)i.push(0),a=!0;for(var o=0,s=e.length;o<s;o++)e[o]>i[o]&&(i[o]=e[o],a=!0);a&&n(t,i,r)}return r.prototype=new e,r.prototype.createDenseMatrix=function(t,e){return new r(t,e)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return ix(this._data,ny)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(t,e){return new r(t,e)},r.prototype.subset=function(t,e,n){switch(arguments.length){case 1:return function(t,e){if(!r0(e))throw TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var n=e.size();if(n.length!==t._size.length)throw new ir(n.length,t._size.length);for(var i=e.min(),a=e.max(),o=0,s=t._size.length;o<s;o++)iu(i[o],t._size[o]),iu(a[o],t._size[o]);return new r(function t(e,r,n,i){var a=i===n-1,o=r.dimension(i);return a?o.map(function(t){return iu(t,e.length),e[t]}).valueOf():o.map(function(a){return iu(a,e.length),t(e[a],r,n,i+1)}).valueOf()}(t._data,e,n.length,0),t._datatype)}(this,t);case 2:case 3:return function(t,e,r,n){if(!e||!0!==e.isIndex)throw TypeError("Invalid index");var a,o=e.size(),s=e.isScalar();if(rK(r)?(a=r.size(),r=r.valueOf()):a=ia(r),s){if(0!==a.length)throw TypeError("Scalar expected");t.set(e.min(),r,n)}else{if(!rO(a,o))try{r=0===a.length?iw([r],o):iw(r,o),a=ia(r)}catch(t){}if(o.length<t._size.length)throw new ir(o.length,t._size.length,"<");if(a.length<o.length){for(var u=0,l=0;1===o[u]&&1===a[u];)u++;for(;1===o[u];)l++,u++;r=ig(r,o.length,l,a)}if(!rO(o,a))throw new ir(o,a,">");i(t,e.max().map(function(t){return t+1}),n);var h=o.length;(function t(e,r,n,i,a){var o=a===i-1,s=r.dimension(a);o?s.forEach(function(t,r){iu(t),e[t]=n[r[0]]}):s.forEach(function(o,s){iu(o),t(e[o],r,n[s[0]],i,a+1)})})(t._data,e,r,h,0)}return t}(this,t,e,n);default:throw SyntaxError("Wrong number of arguments")}},r.prototype.get=function(t){return iE(this._data,t)},r.prototype.set=function(t,e,r){if(!r$(t))throw TypeError("Array expected");if(t.length<this._size.length)throw new ir(t.length,this._size.length,"<");i(this,t.map(function(t){return t+1}),r);var n,a,o,s=this._data;for(n=0,a=t.length-1;n<a;n++)iu(o=t[n],s.length),s=s[o];return iu(o=t[t.length-1],s.length),s[o]=e,this},r.prototype.resize=function(t,e,r){if(!rX(t))throw TypeError("Array or Matrix expected");var i=t.valueOf().map(t=>Array.isArray(t)&&1===t.length?t[0]:t);return n(r?this.clone():this,i,e)},r.prototype.reshape=function(t,e){var r=e?this.clone():this;r._data=ic(r._data,t);var n=r._size.reduce((t,e)=>t*e);return r._size=id(t,n),r},r.prototype.clone=function(){return new r({data:rT(this._data),size:rT(this._size),datatype:this._datatype})},r.prototype.size=function(){return this._size.slice(0)},r.prototype._forEach=function(t){var e=this.size();if(1===e.length){for(var r=0;r<e[0];r++)t(this._data,r,[r]);return}var n=Array(e.length).fill(0),i=Array(e.length-1),a=i.length-1;i[0]=this._data[0];for(var o=0;o<a;o++)i[o+1]=i[o][0];for(n[a]=-1;;){var s=void 0;for(s=a;s>=0;s--){if(n[s]++,n[s]===e[s]){n[s]=0;continue}i[s]=0===s?this._data[n[s]]:i[s-1][n[s]];for(var u=s;u<a;u++)i[u+1]=i[u][0];for(var l=0;l<e[i.length];l++)n[i.length]=l,t(i[a],l,n.slice(0));break}if(-1===s)break}},r.prototype.map=function(t){var e=this,n=new r(e),i=iA(t,e._data,"map");return n._forEach(function(t,r,n){t[r]=i(t[r],n,e)}),n},r.prototype.forEach=function(t){var e=this,r=iA(t,e._data,"map");e._forEach(function(t,n,i){r(t[n],i,e)})},r.prototype[Symbol.iterator]=function*(){var t=function*(e,r){if(r$(e))for(var n=0;n<e.length;n++)yield*t(e[n],r.concat(n));else yield{value:e,index:r}};yield*t(this._data,[])},r.prototype.rows=function(){var t=[];if(2!==this.size().length)throw TypeError("Rows can only be returned for a 2D matrix.");for(var e of this._data)t.push(new r([e],this._datatype));return t},r.prototype.columns=function(){var t=this,e=[],n=this.size();if(2!==n.length)throw TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,a=function(n){var a=i.map(t=>[t[n]]);e.push(new r(a,t._datatype))},o=0;o<n[1];o++)a(o);return e},r.prototype.toArray=function(){return rT(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(t){return n9(this._data,t)},r.prototype.toString=function(){return n9(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(t){if(t){if(rq(t)&&(t=t.toNumber()),!rG(t)||!nF(t))throw TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,n=t<0?-t:0,i=Math.min(this._size[0]-n,this._size[1]-e),a=[],o=0;o<i;o++)a[o]=this._data[o+n][o+e];return new r({data:a,size:[i],datatype:this._datatype})},r.diagonal=function(t,e,n,i){if(!r$(t))throw TypeError("Array expected, size parameter");if(2!==t.length)throw Error("Only two dimensions matrix are supported");if(t=t.map(function(t){if(rq(t)&&(t=t.toNumber()),!rG(t)||!nF(t)||t<1)throw Error("Size values must be positive integers");return t}),n){if(rq(n)&&(n=n.toNumber()),!rG(n)||!nF(n))throw TypeError("The parameter k must be an integer number")}else n=0;var a,o=n>0?n:0,s=n<0?-n:0,u=t[0],l=t[1],h=Math.min(u-s,l-o);if(r$(e)){if(e.length!==h)throw Error("Invalid value array length");a=function(t){return e[t]}}else if(rK(e)){var c=e.size();if(1!==c.length||c[0]!==h)throw Error("Invalid matrix length");a=function(t){return e.get([t])}}else a=function(){return e};i||(i=rq(a(0))?a(0).mul(0):0);var f=[];if(t.length>0){f=ih(f,t,i);for(var d=0;d<h;d++)f[d+s][d+o]=a(d)}return new r({data:f,size:[u,l]})},r.fromJSON=function(t){return new r(t)},r.prototype.swapRows=function(t,e){if(!rG(t)||!nF(t)||!rG(e)||!nF(e))throw Error("Row index must be positive integers");if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");return iu(t,this._size[0]),iu(e,this._size[0]),r._swapRows(t,e,this._data),this},r._swapRows=function(t,e,r){var n=r[t];r[t]=r[e],r[e]=n},r},{isClass:!0}),iM=function(){return iM=/*@__PURE__*/n(iS).create,/*@__PURE__*/n(iS)},iT=/* #__PURE__ */nE("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],function(t){var{BigNumber:e,Complex:r,DenseMatrix:n,Fraction:i}=t,a=iM();return a.clear(),a.addTypes([{name:"number",test:rG},{name:"Complex",test:rV},{name:"BigNumber",test:rq},{name:"bigint",test:rj},{name:"Fraction",test:rH},{name:"Unit",test:rY},{name:"identifier",test:t=>rW&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(t)},{name:"string",test:rW},{name:"Chain",test:nv},{name:"Array",test:r$},{name:"Matrix",test:rK},{name:"DenseMatrix",test:rZ},{name:"SparseMatrix",test:rJ},{name:"Range",test:rQ},{name:"Index",test:r0},{name:"boolean",test:r1},{name:"ResultSet",test:r2},{name:"Help",test:r5},{name:"function",test:r3},{name:"Date",test:r4},{name:"RegExp",test:r8},{name:"null",test:r7},{name:"undefined",test:nt},{name:"AccessorNode",test:ne},{name:"ArrayNode",test:nr},{name:"AssignmentNode",test:nn},{name:"BlockNode",test:ni},{name:"ConditionalNode",test:na},{name:"ConstantNode",test:no},{name:"FunctionNode",test:nu},{name:"FunctionAssignmentNode",test:ns},{name:"IndexNode",test:nl},{name:"Node",test:nh},{name:"ObjectNode",test:nc},{name:"OperatorNode",test:nf},{name:"ParenthesisNode",test:nd},{name:"RangeNode",test:np},{name:"RelationalNode",test:ng},{name:"SymbolNode",test:nm},{name:"Map",test:r9},{name:"Object",test:r6}]),a.addConversions([{from:"number",to:"BigNumber",convert:function(t){if(e||iB(t),t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e(t)}},{from:"number",to:"Complex",convert:function(t){return r||iO(t),new r(t,0)}},{from:"BigNumber",to:"Complex",convert:function(t){return r||iO(t),new r(t.toNumber(),0)}},{from:"bigint",to:"number",convert:function(t){if(t>Number.MAX_SAFE_INTEGER)throw TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+t+")");return Number(t)}},{from:"bigint",to:"BigNumber",convert:function(t){return e||iB(t),new e(t.toString())}},{from:"bigint",to:"Fraction",convert:function(t){return i||ik(t),new i(t)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return r||iO(t),new r(t.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(t){i||ik(t);var e=new i(t);if(e.valueOf()!==t)throw TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw Error('Cannot convert "'+t+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(t){e||iB(t);try{return new e(t)}catch(e){throw Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(t){try{return BigInt(t)}catch(e){throw Error('Cannot convert "'+t+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(t){i||ik(t);try{return new i(t)}catch(e){throw Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){r||iO(t);try{return new r(t)}catch(e){throw Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(t){return e||iB(t),new e(+t)}},{from:"boolean",to:"bigint",convert:function(t){return BigInt(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return i||ik(t),new i(+t)}},{from:"boolean",to:"string",convert:function(t){return String(t)}},{from:"Array",to:"Matrix",convert:function(t){return n||function(){throw Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new n(t)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}]),a.onMismatch=(t,e,r)=>{var n=a.createError(t,e,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&rX(e[0])&&r.some(t=>!t.params.includes(","))){var i=TypeError("Function '".concat(t,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(t,")'."));throw i.data=n.data,i}throw n},a.onMismatch=(t,e,r)=>{var n=a.createError(t,e,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&rX(e[0])&&r.some(t=>!t.params.includes(","))){var i=TypeError("Function '".concat(t,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(t,")'."));throw i.data=n.data,i}throw n},a});function iB(t){throw Error("Cannot convert value ".concat(t," into a BigNumber: no class 'BigNumber' provided"))}function iO(t){throw Error("Cannot convert value ".concat(t," into a Complex number: no class 'Complex' provided"))}function ik(t){throw Error("Cannot convert value ".concat(t," into a Fraction, no class 'Fraction' provided."))}function iP(t){for(var e=0;e<t.length;e++)if(rX(t[e]))return!0;return!1}function iR(t,e){rK(t)&&(t=t.valueOf());for(var r=0,n=t.length;r<n;r++){var i=t[r];Array.isArray(i)?iR(i,e):e(i)}}function iI(t,e,r){return t&&"function"==typeof t.map?t.map(function(t){return iI(t,e,r)}):e(t)}function iz(t,e,r){var n=Array.isArray(t)?ia(t):t.size();if(e<0||e>=n.length)throw new ii(e,n.length);return rK(t)?t.create(iU(t.valueOf(),e,r),t.datatype()):iU(t,e,r)}function iU(t,e,r){var n,i,a,o;if(e<=0){if(Array.isArray(t[0])){for(n=0,o=function(t){var e,r,n=t.length,i=t[0].length,a=[];for(r=0;r<i;r++){var o=[];for(e=0;e<n;e++)o.push(t[e][r]);a.push(o)}return a}(t),i=[];n<o.length;n++)i[n]=iU(o[n],e-1,r);return i}for(n=1,a=t[0];n<t.length;n++)a=r(a,t[n]);return a}for(n=0,i=[];n<t.length;n++)i[n]=iU(t[n],e-1,r);return i}function iL(t,e,r,n,i,a,o,s,u,l,h){var c,f,d,p,g=t._values,m=t._index,v=t._ptr;if(n)for(f=v[e],d=v[e+1],c=f;c<d;c++)r[p=m[c]]!==a?(r[p]=a,o.push(p),l?(n[p]=u?s(g[c],h):s(h,g[c]),i[p]=a):n[p]=g[c]):(n[p]=u?s(g[c],n[p]):s(n[p],g[c]),i[p]=a);else for(f=v[e],d=v[e+1],c=f;c<d;c++)r[p=m[c]]!==a?(r[p]=a,o.push(p)):i[p]=a}var iG="number",iq="number, number";function ij(t){return Math.abs(t)}function iV(t,e){return t+e}function iH(t,e){return t-e}function iY(t,e){return t*e}function iW(t){return-t}function i$(t){return t}function iK(t){return nB(t)}function iX(t){return Math.exp(t)}ij.signature=iG,iV.signature=iq,iH.signature=iq,iY.signature=iq,iW.signature=iG,i$.signature=iG,iK.signature=iG,iX.signature=iG;function iZ(t){return nM(t)}function iJ(t,e){var r,n,i,a=0,o=1,s=1,u=0;if(!nF(t)||!nF(e))throw Error("Parameters in function xgcd must be integer numbers");for(;e;)n=Math.floor(t/e),i=t-n*e,r=a,a=o-n*a,o=r,r=s,s=u-n*s,u=r,t=e,e=i;return t<0?[-t,-o,-u]:[t,t?o:0,u]}function iQ(t,e){return t*t<1&&e===1/0||t*t>1&&e===-1/0?0:Math.pow(t,e)}function i0(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!nF(e)||e<0||e>15)throw Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(nz(t,e))}iZ.signature=iG,iJ.signature=iq,iQ.signature=iq;var i1=/* #__PURE__ */nE("abs",["typed"],t=>{var{typed:e}=t;return e("abs",{number:ij,"Complex | BigNumber | Fraction | Unit":t=>t.abs(),bigint:t=>t<0n?-t:t,"Array | Matrix":e.referToSelf(t=>e=>iI(e,t,!0))})}),i2="number",i5="addScalar",i3=/* #__PURE__ */nE(i5,["typed"],t=>{var{typed:e}=t;return e(i5,{"number, number":iV,"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"bigint, bigint":function(t,e){return t+e},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":e.referToSelf(t=>(r,n)=>{if(null===r.value||void 0===r.value)throw Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw Error("Units do not match");var i=r.clone();return i.value=e.find(t,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i})})}),i4=/* #__PURE__ */nE("atan",["typed"],t=>{var{typed:e}=t;return e("atan",{number:function(t){return Math.atan(t)},Complex:function(t){return t.atan()},BigNumber:function(t){return t.atan()}})});function i8(t){if(t.isFinite()&&!t.isInteger())throw Error("Integer expected in function bitNot");var e=t.constructor,r=e.precision;e.config({precision:1e9});var n=t.plus(new e(1));return n.s=-n.s||null,e.config({precision:r}),n}function i6(t,e,r){var n,i,a,o,s,u=t.constructor,l=+(t.s<0),h=+(e.s<0);if(l){n=i9(i8(t));for(var c=0;c<n.length;++c)n[c]^=1}else n=i9(t);if(h){i=i9(i8(e));for(var f=0;f<i.length;++f)i[f]^=1}else i=i9(e);n.length<=i.length?(a=n,o=i,s=l):(a=i,o=n,s=h);var d=a.length,p=o.length,g=1^r(l,h),m=new u(1^g),v=new u(1),y=new u(2),x=u.precision;for(u.config({precision:1e9});d>0;)r(a[--d],o[--p])===g&&(m=m.plus(v)),v=v.times(y);for(;p>0;)r(s,o[--p])===g&&(m=m.plus(v)),v=v.times(y);return u.config({precision:x}),0===g&&(m.s=-m.s),m}function i9(t){for(var e=t.d,r=e[0]+"",n=1;n<e.length;++n){for(var i=e[n]+"",a=7-i.length;a--;)i="0"+i;r+=i}for(var o=r.length;"0"===r.charAt(o);)o--;var s=t.e,u=r.slice(0,o+1||1),l=u.length;if(s>0){if(++s>l)for(s-=l;s--;)u+="0";else s<l&&(u=u.slice(0,s)+"."+u.slice(s))}for(var h=[0],c=0;c<u.length;){for(var f=h.length;f--;)h[f]*=10;h[0]+=parseInt(u.charAt(c++));for(var d=0;d<h.length;++d)h[d]>1&&((null===h[d+1]||void 0===h[d+1])&&(h[d+1]=0),h[d+1]+=h[d]>>1,h[d]&=1)}return h.reverse()}var i7="number, number";function at(t,e){if(e<t)return 1;if(e===t)return e;var r=e+t>>1;return at(t,r)*at(r+1,e)}function ae(t,e){if(!nF(t)||t<0||!nF(e)||e<0)throw TypeError("Positive integer value expected in function combinations");if(e>t)throw TypeError("k must be less than or equal to n");for(var r=t-e,n=1,i=e<r?r+1:e+1,a=2,o=e<r?e:r,s=i;s<=t;++s)for(n*=s;a<=o&&n%a==0;)n/=a,++a;return a<=o&&(n/=at(a,o)),n}t=>{var{typed:e}=t;return e("clone",{any:rT})},ae.signature="number, number";var ar="combinations";function an(t){return t.isInteger()&&t.gte(0)}t=>{var{typed:e}=t;return e(ar,{"number, number":ae,"BigNumber, BigNumber":function(t,e){var r,n,i=t.constructor,a=t.minus(e),o=new i(1);if(!an(t)||!an(e))throw TypeError("Positive integer value expected in function combinations");if(e.gt(t))throw TypeError("k must be less than n in function combinations");if(r=o,e.lt(a))for(n=o;n.lte(a);n=n.plus(o))r=r.times(e.plus(n)).dividedBy(n);else for(n=o;n.lte(e);n=n.plus(o))r=r.times(a.plus(n)).dividedBy(n);return r}})};var ai=/* #__PURE__ */nE("complex",["typed","Complex"],t=>{var{typed:e,Complex:r}=t;return e("complex",{"":function(){return r.ZERO},number:function(t){return new r(t,0)},"number, number":function(t,e){return new r(t,e)},"BigNumber, BigNumber":function(t,e){return new r(t.toNumber(),e.toNumber())},Fraction:function(t){return new r(t.valueOf(),0)},Complex:function(t){return t.clone()},string:function(t){return r(t)},null:function(t){return r(0)},Object:function(t){if("re"in t&&"im"in t)return new r(t.re,t.im);if("r"in t&&"phi"in t||"abs"in t&&"arg"in t)return new r(t);throw Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})}),aa="conj",ao=/* #__PURE__ */nE(aa,["typed"],t=>{var{typed:e}=t;return e(aa,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.conjugate(),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})}),as=/* #__PURE__ */nE("trigUnit",["typed"],t=>{var{typed:e}=t;return{Unit:e.referToSelf(t=>r=>{if(!r.hasBase(r.constructor.BASE_UNITS.ANGLE))throw TypeError("Unit in function cot is no angle");return e.find(t,r.valueType())(r.value)})}}),au=/* #__PURE__ */nE("cos",["typed"],t=>{var{typed:e}=t,r=as({typed:e});return e("cos",{number:Math.cos,"Complex | BigNumber":t=>t.cos()},r)});function al(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-9,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(r<=0)throw Error("Relative tolerance must be greater than 0");if(n<0)throw Error("Absolute tolerance must be at least 0");return!(t.isNaN()||e.isNaN())&&(t.isFinite()&&e.isFinite()?!!t.eq(e)||t.minus(e).abs().lte(t.constructor.max(t.constructor.max(t.abs(),e.abs()).mul(r),n)):t.eq(e))}var ah=/* #__PURE__ */nE("compareUnits",["typed"],t=>{var{typed:e}=t;return{"Unit, Unit":e.referToSelf(t=>(r,n)=>{if(!r.equalBase(n))throw Error("Cannot compare units with different base");return e.find(t,[r.valueType(),n.valueType()])(r.value,n.value)})}}),ac="equalScalar",af=/* #__PURE__ */nE(ac,["typed","config"],t=>{var{typed:e,config:r}=t,n=ah({typed:e});return e(ac,{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,e){return nq(t,e,r.relTol,r.absTol)},"BigNumber, BigNumber":function(t,e){return t.eq(e)||al(t,e,r.relTol,r.absTol)},"bigint, bigint":function(t,e){return t===e},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){var n,i;return n=r.relTol,i=r.absTol,nq(t.re,e.re,n,i)&&nq(t.im,e.im,n,i)}},n)});nE(ac,["typed","config"],t=>{var{typed:e,config:r}=t;return e(ac,{"number, number":function(t,e){return nq(t,e,r.relTol,r.absTol)}})}),t=>{var{typed:e}=t;return e("exp",{number:iX,Complex:function(t){return t.exp()},BigNumber:function(t){return t.exp()}})};var ad="flatten",ap=/* #__PURE__ */nE(ad,["typed"],t=>{var{typed:e}=t;return e(ad,{Array:function(t){return im(t)},Matrix:function(t){return t.create(im(t.toArray()),t.datatype())}})}),ag="format",am=(t=>{var{typed:e}=t;return e(ag,{any:n9,"any, Object | function | number | BigNumber":n9})},"getMatrixDataType"),av=/* #__PURE__ */nE(am,["typed"],t=>{var{typed:e}=t;return e(am,{Array:function(t){return ix(t,ny)},Matrix:function(t){return t.getDataType()}})});nE("hex",["typed","format"],t=>{var{typed:e,format:r}=t;return e("hex",{"number | BigNumber":function(t){return r(t,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(t,e){return r(t,{notation:"hex",wordSize:e})}})});var ay=/* #__PURE__ */nE("im",["typed"],t=>{var{typed:e}=t;return e("im",{number:()=>0,"BigNumber | Fraction":t=>t.mul(0),Complex:t=>t.im,"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})}),ax="isInteger",ab=/* #__PURE__ */nE(ax,["typed"],t=>{var{typed:e}=t;return e(ax,{number:nF,BigNumber:function(t){return t.isInt()},bigint:function(t){return!0},Fraction:function(t){return 1n===t.d},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})});function aD(t){return Number.isNaN(t)}aD.signature="number";var a_="isNegative",aw=(t=>{var{typed:e,config:r}=t;return e(a_,{number:t=>!nq(t,0,r.relTol,r.absTol)&&t<0,BigNumber:t=>!al(t,new t.constructor(0),r.relTol,r.absTol)&&t.isNeg()&&!t.isZero()&&!t.isNaN(),bigint:t=>t<0n,Fraction:t=>t.s<0n,Unit:e.referToSelf(t=>r=>e.find(t,r.valueType())(r.value)),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})},"isPositive"),aE=/* #__PURE__ */nE(aw,["typed","config"],t=>{var{typed:e,config:r}=t;return e(aw,{number:t=>!nq(t,0,r.relTol,r.absTol)&&t>0,BigNumber:t=>!al(t,new t.constructor(0),r.relTol,r.absTol)&&!t.isNeg()&&!t.isZero()&&!t.isNaN(),bigint:t=>t>0n,Fraction:t=>t.s>0n&&t.n>0n,Unit:e.referToSelf(t=>r=>e.find(t,r.valueType())(r.value)),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})}),aC="isZero",aS=/* #__PURE__ */nE(aC,["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return e(aC,{"number | BigNumber | Complex | Fraction":t=>r(t,0),bigint:t=>0n===t,Unit:e.referToSelf(t=>r=>e.find(t,r.valueType())(r.value)),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})});function aA(t){if(nF(t))return t<=0?isFinite(t)?1/0:NaN:t>171?1/0:at(1,t-1);if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*aA(1-t));if(t>=171.35)return 1/0;if(t>85){var e,r=t*t,n=r*t,i=n*t,a=i*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*r)-139/(51840*n)-571/(2488320*i)+163879/(0xc756000*a)+5246819/(0x11850f0000*a*t))}--t,e=aN[0];for(var o=1;o<aN.length;++o)e+=aN[o]/(t+o);var s=t+aF+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,t+.5)*Math.exp(-s)*e}aA.signature="number";var aF=4.7421875,aN=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,1580887032249125e-19,-21026444172410488e-20,21743961811521265e-20,-1643181065367639e-19,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],aM=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],aT="log2",aB=(t=>{var{typed:e,config:r,Complex:n}=t;return e(aT,{number:function(t){return t>=0||r.predictable?nT(t):i(new n(t,0))},Complex:i,BigNumber:function(t){return!t.isNegative()||r.predictable?t.log(2):i(new n(t.toNumber(),0))},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))});function i(t){var e=Math.sqrt(t.re*t.re+t.im*t.im);return new n(Math.log2?Math.log2(e):Math.log(e)/Math.LN2,Math.atan2(t.im,t.re)/Math.LN2)}},/* #__PURE__ */nE("multiplyScalar",["typed"],t=>{var{typed:e}=t;return e("multiplyScalar",{"number, number":iY,"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"bigint, bigint":function(t,e){return t*e},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":(t,e)=>e.multiply(t),"Unit, number | Fraction | BigNumber | Complex | Unit":(t,e)=>t.multiply(e)})})),aO="number, number";function ak(t){return!t}ak.signature="number",t=>{var{typed:e}=t;return e("not",{"null | undefined":()=>!0,number:ak,Complex:function(t){return 0===t.re&&0===t.im},BigNumber:function(t){return t.isZero()||t.isNaN()},bigint:t=>!t,Unit:e.referToSelf(t=>r=>e.find(t,r.valueType())(r.value)),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})};var aP=/* #__PURE__ */nE("number",["typed"],t=>{var{typed:e}=t,r=e("number",{"":function(){return 0},number:function(t){return t},string:function(t){if("NaN"===t)return NaN;var e,r,n=(r=(e=t).match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/))?{input:e,radix:({"0b":2,"0o":8,"0x":16})[r[1]],integerPart:r[2],fractionalPart:r[3]}:null;if(n)return function(t){for(var e=parseInt(t.integerPart,t.radix),r=0,n=0;n<t.fractionalPart.length;n++)r+=parseInt(t.fractionalPart[n],t.radix)/Math.pow(t.radix,n+1);var i=e+r;if(isNaN(i))throw SyntaxError('String "'+t.input+'" is not a valid number');return i}(n);var i=0,a=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);a&&(i=Number(a[2]),t=a[1]);var o=Number(t);if(isNaN(o))throw SyntaxError('String "'+t+'" is not a valid number');if(a){if(o>2**i-1)throw SyntaxError('String "'.concat(t,'" is out of range'));o>=2**(i-1)&&(o-=2**i)}return o},BigNumber:function(t){return t.toNumber()},bigint:function(t){return Number(t)},Fraction:function(t){return t.valueOf()},Unit:e.referToSelf(t=>e=>{var r=e.clone();return r.value=t(e.value),r}),null:function(t){return 0},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))});return r.fromJSON=function(t){return parseFloat(t.value)},r});nE("oct",["typed","format"],t=>{var{typed:e,format:r}=t;return e("oct",{"number | BigNumber":function(t){return r(t,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(t,e){return r(t,{notation:"oct",wordSize:e})}})});var aR={},aI=s("cmoHh"),az=s("euRi5"),aU=s("hDsEw"),aL=s("3J2Zm"),aG=s("6Px8M"),aq=s("lDm0S"),aj={};!function(t,e,r){var n,i="random",a=r.pow(256,6),o=r.pow(2,52),u=2*o;function l(s,l,p){var g=[],m=f(function t(e,r){var n,i=[],a=typeof e;if(r&&"object"==a)for(n in e)try{i.push(t(e[n],r-1))}catch(t){}return i.length?i:"string"==a?e:e+"\0"}((l=!0==l?{entropy:!0}:l||{}).entropy?[s,d(e)]:null==s?function(){try{var r;return n&&(r=n.randomBytes)?r=r(256):(r=new Uint8Array(256),(t.crypto||t.msCrypto).getRandomValues(r)),d(r)}catch(r){var i=t.navigator,a=i&&i.plugins;return[+new Date,t,a,t.screen,d(e)]}}():s,3),g),v=new h(g),y=function(){for(var t=v.g(6),e=a,r=0;t<o;)t=(t+r)*256,e*=256,r=v.g(1);for(;t>=u;)t/=2,e/=2,r>>>=1;return(t+r)/e};return y.int32=function(){return 0|v.g(4)},y.quick=function(){return v.g(4)/0x100000000},y.double=y,f(d(v.S),e),(l.pass||p||function(t,e,n,a){return(a&&(a.S&&c(a,v),t.state=function(){return c(v,{})}),n)?(r[i]=t,e):t})(y,m,"global"in l?l.global:this==r,l.state)}function h(t){var e,r=t.length,n=this,i=0,a=n.i=n.j=0,o=n.S=[];for(r||(t=[r++]);i<256;)o[i]=i++;for(i=0;i<256;i++)o[i]=o[a=255&a+t[i%r]+(e=o[i])],o[a]=e;(n.g=function(t){for(var e,r=0,i=n.i,a=n.j,o=n.S;t--;)e=o[i=255&i+1],r=256*r+o[255&(o[i]=o[a=255&a+e])+(o[a]=e)];return n.i=i,n.j=a,r})(256)}function c(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function f(t,e){for(var r,n=t+"",i=0;i<n.length;)e[255&i]=255&(r^=19*e[255&i])+n.charCodeAt(i++);return d(e)}function d(t){return String.fromCharCode.apply(0,t)}if(f(r.random(),e),aj){aj=l;try{n=s("bx1Nf")}catch(t){}}else"function"==typeof define&&define.amd?define(function(){return l}):r["seed"+i]=l}("undefined"!=typeof self?self:aj,[],Math),aj.alea=aI,aj.xor128=az,aj.xorwow=aU,aj.xorshift7=aL,aj.xor4096=aG,aj.tychei=aq;var aV=/* #__PURE__ *//*@__PURE__*/n(aR=aj)(Date.now()),aH=/\$([\w.]+)/g,aY=/* #__PURE__ */nE("re",["typed"],t=>{var{typed:e}=t;return e("re",{"number | BigNumber | Fraction":t=>t,Complex:t=>t.re,"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})}),aW="sign",a$=/* #__PURE__ */nE(aW,["typed","BigNumber","Fraction","complex"],t=>{var{typed:e,BigNumber:r,complex:n,Fraction:i}=t;return e(aW,{number:iZ,Complex:function(t){return 0===t.im?n(iZ(t.re)):t.sign()},BigNumber:function(t){return new r(t.cmp(0))},bigint:function(t){return t>0n?1n:t<0n?-1n:0n},Fraction:function(t){return new i(t.s)},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t,!0)),Unit:e.referToSelf(t=>r=>{if(!r._isDerived()&&0!==r.units[0].unit.offset)throw TypeError("sign is ambiguous for units with offset");return e.find(t,r.valueType())(r.value)})})}),aK=/* #__PURE__ */nE("sin",["typed"],t=>{var{typed:e}=t,r=as({typed:e});return e("sin",{number:Math.sin,"Complex | BigNumber":t=>t.sin()},r)}),aX=/* #__PURE__ */nE("SparseMatrix",["typed","equalScalar","Matrix"],t=>{var{typed:e,equalScalar:r,Matrix:n}=t;function i(t,e){if(!(this instanceof i))throw SyntaxError("Constructor must be called with the new operator");if(e&&!rW(e))throw Error("Invalid datatype: "+e);if(rK(t))"SparseMatrix"===t.type?(this._values=t._values?rT(t._values):void 0,this._index=rT(t._index),this._ptr=rT(t._ptr),this._size=rT(t._size),this._datatype=e||t._datatype):a(this,t.valueOf(),e||t._datatype);else if(t&&r$(t.index)&&r$(t.ptr)&&r$(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(r$(t))a(this,t,e);else if(t)throw TypeError("Unsupported type of data ("+ny(t)+")");else this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}function a(t,n,i){t._values=[],t._index=[],t._ptr=[],t._datatype=i;var a=n.length,o=0,s=r,u=0;if(rW(i)&&(s=e.find(r,[i,i])||r,u=e.convert(0,i)),a>0){var l=0;do{t._ptr.push(t._index.length);for(var h=0;h<a;h++){var c=n[h];if(r$(c)){if(0===l&&o<c.length&&(o=c.length),l<c.length){var f=c[l];s(f,u)||(t._values.push(f),t._index.push(h))}}else 0===l&&o<1&&(o=1),s(c,u)||(t._values.push(c),t._index.push(h))}l++}while(l<o)}t._ptr.push(t._index.length),t._size=[a,o]}function o(t,e,r,n){if(r-e==0)return r;for(var i=e;i<r;i++)if(n[i]===t)return i;return e}function s(t,e,r,n,i,a,o){i.splice(t,0,n),a.splice(t,0,e);for(var s=r+1;s<o.length;s++)o[s]++}function u(t,n,i,a){var o,s,u,l=a||0,h=r,c=0;rW(t._datatype)&&(h=e.find(r,[t._datatype,t._datatype])||r,c=e.convert(0,t._datatype),l=e.convert(l,t._datatype));var f=!h(l,c),d=t._size[0],p=t._size[1];if(i>p){for(s=p;s<i;s++)if(t._ptr[s]=t._values.length,f)for(o=0;o<d;o++)t._values.push(l),t._index.push(o);t._ptr[i]=t._values.length}else i<p&&(t._ptr.splice(i+1,p-i),t._values.splice(t._ptr[i],t._values.length),t._index.splice(t._ptr[i],t._index.length));if(p=i,n>d){if(f){var g=0;for(s=0;s<p;s++){t._ptr[s]=t._ptr[s]+g,u=t._ptr[s+1]+g;var m=0;for(o=d;o<n;o++,m++)t._values.splice(u+m,0,l),t._index.splice(u+m,0,o),g++}t._ptr[p]=t._values.length}}else if(n<d){var v=0;for(s=0;s<p;s++){t._ptr[s]=t._ptr[s]-v;var y=t._ptr[s],x=t._ptr[s+1]-v;for(u=y;u<x;u++)(o=t._index[u])>n-1&&(t._values.splice(u,1),t._index.splice(u,1),v++)}t._ptr[s]=t._values.length}return t._size[0]=n,t._size[1]=i,t}function l(t,e,r,n,i){var a,o,s=n[0],u=n[1],l=[];for(a=0;a<s;a++)for(o=0,l[a]=[];o<u;o++)l[a][o]=0;for(o=0;o<u;o++)for(var h=r[o],c=r[o+1],f=h;f<c;f++)l[a=e[f]][o]=t?i?rT(t[f]):t[f]:1;return l}return i.prototype=new n,i.prototype.createSparseMatrix=function(t,e){return new i(t,e)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return ix(this._values,ny)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(t,e){return new i(t,e)},i.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},i.prototype.subset=function(t,e,r){if(!this._values)throw Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(t,e){if(!r0(e))throw TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var r,n,a,o,s=e.size();if(s.length!==t._size.length)throw new ir(s.length,t._size.length);var u=e.min(),l=e.max();for(r=0,n=t._size.length;r<n;r++)iu(u[r],t._size[r]),iu(l[r],t._size[r]);var h=t._values,c=t._index,f=t._ptr,d=e.dimension(0),p=e.dimension(1),g=[],m=[];d.forEach(function(t,e){m[t]=e[0],g[t]=!0});var v=h?[]:void 0,y=[],x=[];return p.forEach(function(t){for(x.push(y.length),a=f[t],o=f[t+1];a<o;a++)!0===g[r=c[a]]&&(y.push(m[r]),v&&v.push(h[a]))}),x.push(y.length),new i({values:v,index:y,ptr:x,size:s,datatype:t._datatype})}(this,t);case 2:case 3:return function(t,e,r,n){if(!e||!0!==e.isIndex)throw TypeError("Invalid index");var i,a=e.size(),o=e.isScalar();if(rK(r)?(i=r.size(),r=r.toArray()):i=ia(r),o){if(0!==i.length)throw TypeError("Scalar expected");t.set(e.min(),r,n)}else{if(1!==a.length&&2!==a.length)throw new ir(a.length,t._size.length,"<");if(i.length<a.length){for(var s=0,u=0;1===a[s]&&1===i[s];)s++;for(;1===a[s];)u++,s++;r=ig(r,a.length,u,i)}if(!rO(a,i))throw new ir(a,i,">");if(1===a.length)e.dimension(0).forEach(function(e,i){iu(e),t.set([e,0],r[i[0]],n)});else{var l=e.dimension(0),h=e.dimension(1);l.forEach(function(e,i){iu(e),h.forEach(function(a,o){iu(a),t.set([e,a],r[i[0]][o[0]],n)})})}}return t}(this,t,e,r);default:throw SyntaxError("Wrong number of arguments")}},i.prototype.get=function(t){if(!r$(t))throw TypeError("Array expected");if(t.length!==this._size.length)throw new ir(t.length,this._size.length);if(!this._values)throw Error("Cannot invoke get on a Pattern only matrix");var e=t[0],r=t[1];iu(e,this._size[0]),iu(r,this._size[1]);var n=o(e,this._ptr[r],this._ptr[r+1],this._index);return n<this._ptr[r+1]&&this._index[n]===e?this._values[n]:0},i.prototype.set=function(t,n,i){if(!r$(t))throw TypeError("Array expected");if(t.length!==this._size.length)throw new ir(t.length,this._size.length);if(!this._values)throw Error("Cannot invoke set on a Pattern only matrix");var a=t[0],l=t[1],h=this._size[0],c=this._size[1],f=r,d=0;rW(this._datatype)&&(f=e.find(r,[this._datatype,this._datatype])||r,d=e.convert(0,this._datatype)),(a>h-1||l>c-1)&&(u(this,Math.max(a+1,h),Math.max(l+1,c),i),h=this._size[0],c=this._size[1]),iu(a,h),iu(l,c);var p=o(a,this._ptr[l],this._ptr[l+1],this._index);return p<this._ptr[l+1]&&this._index[p]===a?f(n,d)?function(t,e,r,n,i){r.splice(t,1),n.splice(t,1);for(var a=e+1;a<i.length;a++)i[a]--}(p,l,this._values,this._index,this._ptr):this._values[p]=n:f(n,d)||s(p,a,l,n,this._values,this._index,this._ptr),this},i.prototype.resize=function(t,e,r){if(!rX(t))throw TypeError("Array or Matrix expected");var n=t.valueOf().map(t=>Array.isArray(t)&&1===t.length?t[0]:t);if(2!==n.length)throw Error("Only two dimensions matrix are supported");return n.forEach(function(t){if(!rG(t)||!nF(t)||t<0)throw TypeError("Invalid size, must contain positive integers (size: "+n9(n)+")")}),u(r?this.clone():this,n[0],n[1],e)},i.prototype.reshape=function(t,e){if(!r$(t))throw TypeError("Array expected");if(2!==t.length)throw Error("Sparse matrices can only be reshaped in two dimensions");t.forEach(function(e){if(!rG(e)||!nF(e)||e<=-2||0===e)throw TypeError("Invalid size, must contain positive integers or -1 (size: "+n9(t)+")")});var r=this._size[0]*this._size[1],n=(t=id(t,r))[0]*t[1];if(r!==n)throw Error("Reshaping sparse matrix will result in the wrong number of elements");var i=e?this.clone():this;if(this._size[0]===t[0]&&this._size[1]===t[1])return i;for(var a=[],u=0;u<i._ptr.length;u++)for(var l=0;l<i._ptr[u+1]-i._ptr[u];l++)a.push(u);for(var h=i._values.slice(),c=i._index.slice(),f=0;f<i._index.length;f++){var d=c[f],p=a[f],g=d*i._size[1]+p;a[f]=g%t[1],c[f]=Math.floor(g/t[1])}i._values.length=0,i._index.length=0,i._ptr.length=t[1]+1,i._size=t.slice();for(var m=0;m<i._ptr.length;m++)i._ptr[m]=0;for(var v=0;v<h.length;v++){var y=c[v],x=a[v],b=h[v];s(o(y,i._ptr[x],i._ptr[x+1],i._index),y,x,b,i._values,i._index,i._ptr)}return i},i.prototype.clone=function(){return new i({values:this._values?rT(this._values):void 0,index:rT(this._index),ptr:rT(this._ptr),size:rT(this._size),datatype:this._datatype})},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(t,n){if(!this._values)throw Error("Cannot invoke map on a Pattern only matrix");var a=this,o=this._size[0],s=this._size[1],u=iA(t,a,"map");return function(t,n,a,o,s,u,l){var h=[],c=[],f=[],d=r,p=0;rW(t._datatype)&&(d=e.find(r,[t._datatype,t._datatype])||r,p=e.convert(0,t._datatype));for(var g=function(t,e,r){var n=u(t,e,r);d(n,p)||(h.push(n),c.push(e))},m=0;m<=s;m++){f.push(h.length);var v=t._ptr[m],y=t._ptr[m+1];if(l)for(var x=v;x<y;x++){var b=t._index[x];b>=0&&b<=a&&g(t._values[x],b-0,m-0)}else{for(var D={},_=v;_<y;_++)D[t._index[_]]=t._values[_];for(var w=n;w<=a;w++)g(w in D?D[w]:0,w-n,m-o)}}return f.push(h.length),new i({values:h,index:c,ptr:f,size:[a-n+1,s-o+1]})}(this,0,o-1,0,s-1,function(t,e,r){return u(t,[e,r],a)},n)},i.prototype.forEach=function(t,e){if(!this._values)throw Error("Cannot invoke forEach on a Pattern only matrix");for(var r=this._size[0],n=this._size[1],i=iA(t,this,"forEach"),a=0;a<n;a++){var o=this._ptr[a],s=this._ptr[a+1];if(e)for(var u=o;u<s;u++){var l=this._index[u];i(this._values[u],[l,a],this)}else{for(var h={},c=o;c<s;c++)h[this._index[c]]=this._values[c];for(var f=0;f<r;f++)i(f in h?h[f]:0,[f,a],this)}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw Error("Cannot iterate a Pattern only matrix");for(var t=this._size[1],e=0;e<t;e++)for(var r=this._ptr[e],n=this._ptr[e+1],i=r;i<n;i++){var a=this._index[i];yield{value:this._values[i],index:[a,e]}}},i.prototype.toArray=function(){return l(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return l(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(t){for(var e=this._size[0],r=this._size[1],n=this.density(),i="Sparse Matrix ["+n9(e,t)+" x "+n9(r,t)+"] density: "+n9(n,t)+"\n",a=0;a<r;a++)for(var o=this._ptr[a],s=this._ptr[a+1],u=o;u<s;u++)i+="\n    ("+n9(this._index[u],t)+", "+n9(a,t)+") ==> "+(this._values?n9(this._values[u],t):"X");return i},i.prototype.toString=function(){return n9(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(t){if(t){if(rq(t)&&(t=t.toNumber()),!rG(t)||!nF(t))throw TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,r=t<0?-t:0,n=this._size[0],a=this._size[1],o=Math.min(n-r,a-e),s=[],u=[],l=[];l[0]=0;for(var h=e;h<a&&s.length<o;h++)for(var c=this._ptr[h],f=this._ptr[h+1],d=c;d<f;d++){var p=this._index[d];if(p===h-e+r){s.push(this._values[d]),u[s.length-1]=p-r;break}}return l.push(s.length),new i({values:s,index:u,ptr:l,size:[o,1]})},i.fromJSON=function(t){return new i(t)},i.diagonal=function(t,n,a,o,s){if(!r$(t))throw TypeError("Array expected, size parameter");if(2!==t.length)throw Error("Only two dimensions matrix are supported");if(t=t.map(function(t){if(rq(t)&&(t=t.toNumber()),!rG(t)||!nF(t)||t<1)throw Error("Size values must be positive integers");return t}),a){if(rq(a)&&(a=a.toNumber()),!rG(a)||!nF(a))throw TypeError("The parameter k must be an integer number")}else a=0;var u,l=r,h=0;rW(s)&&(l=e.find(r,[s,s])||r,h=e.convert(0,s));var c=a>0?a:0,f=a<0?-a:0,d=t[0],p=t[1],g=Math.min(d-f,p-c);if(r$(n)){if(n.length!==g)throw Error("Invalid value array length");u=function(t){return n[t]}}else if(rK(n)){var m=n.size();if(1!==m.length||m[0]!==g)throw Error("Invalid matrix length");u=function(t){return n.get([t])}}else u=function(){return n};for(var v=[],y=[],x=[],b=0;b<p;b++){x.push(v.length);var D=b-c;if(D>=0&&D<g){var _=u(D);l(_,h)||(y.push(D+f),v.push(_))}}return x.push(v.length),new i({values:v,index:y,ptr:x,size:[d,p]})},i.prototype.swapRows=function(t,e){if(!rG(t)||!nF(t)||!rG(e)||!nF(e))throw Error("Row index must be positive integers");if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");return iu(t,this._size[0]),iu(e,this._size[0]),i._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(t,e,r,n,i){for(var a=n[t],o=n[t+1],s=a;s<o;s++)i(r[s],e[s])},i._swapRows=function(t,e,r,n,i,a){for(var s=0;s<r;s++){var u=a[s],l=a[s+1],h=o(t,u,l,i),c=o(e,u,l,i);if(h<l&&c<l&&i[h]===t&&i[c]===e){if(n){var f=n[h];n[h]=n[c],n[c]=f}continue}if(h<l&&i[h]===t&&(c>=l||i[c]!==e)){var d=n?n[h]:void 0;i.splice(c,0,e),n&&n.splice(c,0,d),i.splice(c<=h?h+1:h,1),n&&n.splice(c<=h?h+1:h,1);continue}if(c<l&&i[c]===e&&(h>=l||i[h]!==t)){var p=n?n[c]:void 0;i.splice(h,0,t),n&&n.splice(h,0,p),i.splice(h<=c?c+1:c,1),n&&n.splice(h<=c?c+1:c,1)}}},i},{isClass:!0}),aZ="subtractScalar",aJ=/* #__PURE__ */nE(aZ,["typed"],t=>{var{typed:e}=t;return e(aZ,{"number, number":iH,"Complex, Complex":function(t,e){return t.sub(e)},"BigNumber, BigNumber":function(t,e){return t.minus(e)},"bigint, bigint":function(t,e){return t-e},"Fraction, Fraction":function(t,e){return t.sub(e)},"Unit, Unit":e.referToSelf(t=>(r,n)=>{if(null===r.value||void 0===r.value)throw Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw Error("Units do not match");var i=r.clone();return i.value=e.find(t,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i})})}),aQ="typeOf",a0=(t=>{var{typed:e}=t;return e(aQ,{any:ny})},"apply");function a1(t,e,r){var n,i,a;if(e<=0){if(!Array.isArray(t[0]))return r(t);for(n=0,a=function(t){var e,r,n=t.length,i=t[0].length,a=[];for(r=0;r<i;r++){var o=[];for(e=0;e<n;e++)o.push(t[e][r]);a.push(o)}return a}(t),i=[];n<a.length;n++)i[n]=a1(a[n],e-1,r);return i}for(n=0,i=[];n<t.length;n++)i[n]=a1(t[n],e-1,r);return i}t=>{var{typed:e,isInteger:r}=t;return e(a0,{"Array | Matrix, number | BigNumber, function":function(t,e,n){if(!r(e))throw TypeError("Integer number expected for dimension");var i=Array.isArray(t)?ia(t):t.size();if(e<0||e>=i.length)throw new ii(e,i.length);return rK(t)?t.create(a1(t.valueOf(),e,n),t.datatype()):a1(t,e,n)}})};var a2=/* #__PURE__ */nE("bignumber",["typed","BigNumber"],t=>{var{typed:e,BigNumber:r}=t;return e("bignumber",{"":function(){return new r(0)},number:function(t){return new r(t+"")},string:function(t){var e=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(e){var n=e[2],i=r(e[1]),a=new r(2).pow(Number(n));if(i.gt(a.sub(1)))throw SyntaxError('String "'.concat(t,'" is out of range'));var o=new r(2).pow(Number(n)-1);return i.gte(o)?i.sub(a):i}return new r(t)},BigNumber:function(t){return t},bigint:function(t){return new r(t.toString())},Unit:e.referToSelf(t=>e=>{var r=e.clone();return r.value=t(e.value),r}),Fraction:function(t){return new r(String(t.n)).div(String(t.d)).times(String(t.s))},null:function(t){return new r(0)},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})}),a5="isNaN",a3=/* #__PURE__ */nE(a5,["typed"],t=>{var{typed:e}=t;return e(a5,{number:aD,BigNumber:function(t){return t.isNaN()},bigint:function(t){return!1},Fraction:function(t){return!1},Complex:function(t){return t.isNaN()},Unit:function(t){return Number.isNaN(t.value)},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})}),a4=/* #__PURE__ */nE("sqrt",["config","typed","Complex"],t=>{var{config:e,typed:r,Complex:n}=t;return r("sqrt",{number:i,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():i(t.toNumber())},Unit:function(t){return t.pow(.5)}});function i(t){return isNaN(t)?NaN:t>=0||e.predictable?Math.sqrt(t):new n(t,0).sqrt()}}),a8="unaryMinus",a6=/* #__PURE__ */nE(a8,["typed"],t=>{var{typed:e}=t;return e(a8,{number:iW,"Complex | BigNumber | Fraction":t=>t.neg(),bigint:t=>-t,Unit:e.referToSelf(t=>r=>{var n=r.clone();return n.value=e.find(t,n.valueType())(r.value),n}),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t,!0))})});nE("bin",["typed","format"],t=>{var{typed:e,format:r}=t;return e("bin",{"number | BigNumber":function(t){return r(t,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(t,e){return r(t,{notation:"bin",wordSize:e})}})});var a9=/* #__PURE__ */nE("fraction",["typed","Fraction"],t=>{var{typed:e,Fraction:r}=t;return e("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw Error(t+" cannot be represented as a fraction");return new r(t)},string:function(t){return new r(t)},"number, number":function(t,e){return new r(t,e)},"bigint, bigint":function(t,e){return new r(t,e)},null:function(t){return new r(0)},BigNumber:function(t){return new r(t.toString())},bigint:function(t){return new r(t.toString())},Fraction:function(t){return t},Unit:e.referToSelf(t=>e=>{var r=e.clone();return r.value=t(e.value),r}),Object:function(t){return new r(t)},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})}),a7="isNumeric",ot=/* #__PURE__ */nE(a7,["typed"],t=>{var{typed:e}=t;return e(a7,{"number | BigNumber | bigint | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})}),oe="matrix",or=/* #__PURE__ */nE(oe,["typed","Matrix","DenseMatrix","SparseMatrix"],t=>{var{typed:e,Matrix:r,DenseMatrix:n,SparseMatrix:i}=t;return e(oe,{"":function(){return a([])},string:function(t){return a([],t)},"string, string":function(t,e){return a([],t,e)},Array:function(t){return a(t)},Matrix:function(t){return a(t,t.storage())},"Array | Matrix, string":a,"Array | Matrix, string, string":a});function a(t,e,r){if("dense"===e||"default"===e||void 0===e)return new n(t,r);if("sparse"===e)return new i(t,r);throw TypeError("Unknown matrix type "+JSON.stringify(e)+".")}});function on(){throw Error('No "bignumber" implementation available')}function oi(){throw Error('No "fraction" implementation available')}function oa(){throw Error('No "matrix" implementation available')}var oo=/* #__PURE__ */nE("numeric",["number","?bignumber","?fraction"],t=>{var{number:e,bignumber:r,fraction:n}=t,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:t=>e(t),BigNumber:r?t=>r(t):on,bigint:t=>BigInt(t),Fraction:n?t=>n(t):oi};return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number",r=arguments.length>2?arguments[2]:void 0;if(void 0!==r)throw SyntaxError("numeric() takes one or two arguments");var n=ny(t);if(!(n in i))throw TypeError("Cannot convert "+t+' of type "'+n+'"; valid input types are '+Object.keys(i).join(", "));if(!(e in a))throw TypeError("Cannot convert "+t+' to type "'+e+'"; valid output types are '+Object.keys(a).join(", "));return e===n?t:a[e](t)}});function os(t,e,r){var n;return String(t).includes("Unexpected type")?(n=arguments.length>2?" (type: "+ny(r)+", value: "+JSON.stringify(r)+")":" (type: "+t.data.actual+")",TypeError("Cannot calculate "+e+", unexpected type of argument"+n)):String(t).includes("complex numbers")?(n=arguments.length>2?" (type: "+ny(r)+", value: "+JSON.stringify(r)+")":"",TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+n)):t}var ou=(t=>{var{typed:e,config:r,multiplyScalar:n,numeric:i}=t;return e("prod",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(t,e){throw Error("prod(A, dim) is not yet supported")},"...":function(t){return a(t)}});function a(t){var e;if(iR(t,function(t){try{e=void 0===e?t:n(e,t)}catch(e){throw os(e,"prod",t)}}),"string"==typeof e&&(e=i(e,nN(e,r))),void 0===e)throw Error("Cannot calculate prod of an empty array");return e}},"reshape"),ol=/* #__PURE__ */nE(ou,["typed","isInteger","matrix"],t=>{var{typed:e,isInteger:r}=t;return e(ou,{"Matrix, Array":function(t,e){return t.reshape(e,!0)},"Array, Array":function(t,e){return e.forEach(function(t){if(!r(t))throw TypeError("Invalid size for dimension: "+t)}),ic(t,e)}})}),oh="size",oc=/* #__PURE__ */nE(oh,["typed","config","?matrix"],t=>{var{typed:e,config:r,matrix:n}=t;return e(oh,{Matrix:function(t){return t.create(t.size(),"number")},Array:ia,string:function(t){return"Array"===r.matrix?[t.length]:n([t.length],"dense","number")},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===r.matrix?[]:n?n([],"dense","number"):oa()}})}),of="transpose",od=/* #__PURE__ */nE(of,["typed","matrix"],t=>{var{typed:e,matrix:r}=t;return e(of,{Array:t=>n(r(t)).valueOf(),Matrix:n,any:rT});function n(t){var e,r=t.size();switch(r.length){case 1:e=t.clone();break;case 2:var n=r[0],i=r[1];if(0===i)throw RangeError("Cannot transpose a 2D matrix with no columns (size: "+n9(r)+")");switch(t.storage()){case"dense":e=function(t,e,r){for(var n,i=t._data,a=[],o=0;o<r;o++){n=a[o]=[];for(var s=0;s<e;s++)n[s]=rT(i[s][o])}return t.createDenseMatrix({data:a,size:[r,e],datatype:t._datatype})}(t,n,i);break;case"sparse":e=function(t,e,r){for(var n,i,a,o=t._values,s=t._index,u=t._ptr,l=o?[]:void 0,h=[],c=[],f=[],d=0;d<e;d++)f[d]=0;for(n=0,i=s.length;n<i;n++)f[s[n]]++;for(var p=0,g=0;g<e;g++)c.push(p),p+=f[g],f[g]=c[g];for(c.push(p),a=0;a<r;a++)for(var m=u[a],v=u[a+1],y=m;y<v;y++){var x=f[s[y]]++;h[x]=a,o&&(l[x]=rT(o[y]))}return t.createSparseMatrix({values:l,index:h,ptr:c,size:[r,e],datatype:t._datatype})}(t,n,i)}break;default:throw RangeError("Matrix must be a vector or two dimensional (size: "+n9(r)+")")}return e}}),op=(t=>{var{typed:e,config:r,matrix:n,BigNumber:i}=t;return e("xgcd",{"number, number":function(t,e){var i=iJ(t,e);return"Array"===r.matrix?i:n(i)},"BigNumber, BigNumber":function(t,e){var a,o,s,u,l=new i(0),h=new i(1),c=l,f=h,d=h,p=l;if(!t.isInt()||!e.isInt())throw Error("Parameters in function xgcd must be integer numbers");for(;!e.isZero();)o=t.div(e).floor(),s=t.mod(e),a=c,c=f.minus(o.times(c)),f=a,a=d,d=p.minus(o.times(d)),p=a,t=e,e=s;return u=t.lt(l)?[t.neg(),f.neg(),p.neg()]:[t,t.isZero()?0:f,p],"Array"===r.matrix?u:n(u)}})},"zeros"),og=/* #__PURE__ */nE(op,["typed","config","matrix","BigNumber"],t=>{var{typed:e,config:r,matrix:n,BigNumber:i}=t;return e(op,{"":function(){return"Array"===r.matrix?a([]):a([],"default")},"...number | BigNumber | string":function(t){if("string"==typeof t[t.length-1]){var e=t.pop();return a(t,e)}return"Array"===r.matrix?a(t):a(t,"default")},Array:a,Matrix:function(t){var e=t.storage();return a(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return a(t.valueOf(),e)}});function a(t,e){var r,a=(r=!1,t.forEach(function(t,e,n){rq(t)&&(r=!0,n[e]=t.toNumber())}),r)?new i(0):0;if(function(t){t.forEach(function(t){if("number"!=typeof t||!nF(t)||t<0)throw Error("Parameters in function zeros must be positive integers")})}(t),e){var o=n(e);return t.length>0?o.resize(t,a):o}var s=[];return t.length>0?ih(s,t,a):s}}),om=(t=>{var{config:e,typed:r,isNegative:n,unaryMinus:i,matrix:a,Complex:o,BigNumber:s,Fraction:u}=t;return r("cbrt",{number:iK,Complex:l,"Complex, boolean":l,BigNumber:function(t){return t.cbrt()},Unit:function(t){if(t.value&&rV(t.value)){var e=t.clone();return e.value=1,(e=e.pow(1/3)).value=l(t.value),e}var r,a=n(t.value);a&&(t.value=i(t.value)),r=rq(t.value)?new s(1).div(3):rH(t.value)?new u(1,3):1/3;var o=t.pow(r);return a&&(o.value=i(o.value)),o}});function l(t,r){var n=t.arg()/3,i=t.abs(),s=new o(iK(i),0).mul(new o(0,n).exp());if(!r)return s;var u=[s,new o(iK(i),0).mul(new o(0,n+2*Math.PI/3).exp()),new o(iK(i),0).mul(new o(0,n-2*Math.PI/3).exp())];return"Array"===e.matrix?u:a(u)}},"concat"),ov=/* #__PURE__ */nE(om,["typed","matrix","isInteger"],t=>{var{typed:e,matrix:r,isInteger:n}=t;return e(om,{"...Array | Matrix | number | BigNumber":function(t){var e,i,a=t.length,o=-1,s=!1,u=[];for(e=0;e<a;e++){var l=t[e];if(rK(l)&&(s=!0),rG(l)||rq(l)){if(e!==a-1)throw Error("Dimension must be specified as last argument");if(i=o,!n(o=l.valueOf()))throw TypeError("Integer number expected for dimension");if(o<0||e>0&&o>i)throw new ii(o,i+1)}else{var h=rT(l).valueOf(),c=ia(h);if(u[e]=h,i=o,o=c.length-1,e>0&&o!==i)throw new ir(i+1,o+1)}}if(0===u.length)throw SyntaxError("At least one matrix expected");for(var f=u.shift();u.length;)f=ib(f,u.shift(),o);return s?r(f):f},"...string":function(t){return t.join("")}})}),oy="ctranspose",ox=/* #__PURE__ */nE(oy,["typed","transpose","conj"],t=>{var{typed:e,transpose:r,conj:n}=t;return e(oy,{any:function(t){return n(r(t))}})}),ob="diag",oD=/* #__PURE__ */nE(ob,["typed","matrix","DenseMatrix","SparseMatrix"],t=>{var{typed:e,matrix:r,DenseMatrix:n,SparseMatrix:i}=t;return e(ob,{Array:function(t){return a(t,0,ia(t),null)},"Array, number":function(t,e){return a(t,e,ia(t),null)},"Array, BigNumber":function(t,e){return a(t,e.toNumber(),ia(t),null)},"Array, string":function(t,e){return a(t,0,ia(t),e)},"Array, number, string":function(t,e,r){return a(t,e,ia(t),r)},"Array, BigNumber, string":function(t,e,r){return a(t,e.toNumber(),ia(t),r)},Matrix:function(t){return a(t,0,t.size(),t.storage())},"Matrix, number":function(t,e){return a(t,e,t.size(),t.storage())},"Matrix, BigNumber":function(t,e){return a(t,e.toNumber(),t.size(),t.storage())},"Matrix, string":function(t,e){return a(t,0,t.size(),e)},"Matrix, number, string":function(t,e,r){return a(t,e,t.size(),r)},"Matrix, BigNumber, string":function(t,e,r){return a(t,e.toNumber(),t.size(),r)}});function a(t,e,a,o){if(!nF(e))throw TypeError("Second parameter in function diag must be an integer");var s=e>0?e:0,u=e<0?-e:0;switch(a.length){case 1:return function(t,e,r,a,o,s){var u=[a+o,a+s];if(r&&"sparse"!==r&&"dense"!==r)throw TypeError("Unknown matrix type ".concat(r,'"'));var l="sparse"===r?i.diagonal(u,t,e):n.diagonal(u,t,e);return null!==r?l:l.valueOf()}(t,e,o,a[0],u,s);case 2:return function(t,e,n,i,a,o){if(rK(t)){var s=t.diagonal(e);return null!==n?n!==s.storage()?r(s,n):s:s.valueOf()}for(var u=Math.min(i[0]-a,i[1]-o),l=[],h=0;h<u;h++)l[h]=t[h+a][h+o];return null!==n?r(l):l}(t,e,o,a,u,s)}throw RangeError("Matrix for function diag must be 2 dimensional")}}),o_="divideScalar",ow=/* #__PURE__ */nE(o_,["typed","numeric"],t=>{var{typed:e,numeric:r}=t;return e(o_,{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"bigint, bigint":function(t,e){return t/e},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Complex | Fraction | BigNumber | Unit":(t,e)=>t.divide(e),"number | Fraction | Complex | BigNumber, Unit":(t,e)=>e.divideInto(t)})}),oE=/* #__PURE__ */nE("matAlgo02xDS0",["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i,a){var o,s=t._data,u=t._size,l=t._datatype||t.getDataType(),h=n._values,c=n._index,f=n._ptr,d=n._size,p=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(u.length!==d.length)throw new ir(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");if(!h)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=u[0],m=u[1],v=r,y=0,x=i;"string"==typeof l&&l===p&&"mixed"!==l&&(o=l,v=e.find(r,[o,o]),y=e.convert(0,o),x=e.find(i,[o,o]));for(var b=[],D=[],_=[],w=0;w<m;w++){_[w]=D.length;for(var E=f[w],C=f[w+1],S=E;S<C;S++){var A=c[S],F=a?x(h[S],s[A][w]):x(s[A][w],h[S]);v(F,y)||(D.push(A),b.push(F))}}return _[m]=D.length,n.createSparseMatrix({values:b,index:D,ptr:_,size:[g,m],datatype:l===t._datatype&&p===n._datatype?o:void 0})}}),oC=/* #__PURE__ */nE("matAlgo03xDSf",["typed"],t=>{var{typed:e}=t;return function(t,r,n,i){var a,o=t._data,s=t._size,u=t._datatype||t.getDataType(),l=r._values,h=r._index,c=r._ptr,f=r._size,d=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(s.length!==f.length)throw new ir(s.length,f.length);if(s[0]!==f[0]||s[1]!==f[1])throw RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+f+")");if(!l)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p=s[0],g=s[1],m=0,v=n;"string"==typeof u&&u===d&&"mixed"!==u&&(a=u,m=e.convert(0,a),v=e.find(n,[a,a]));for(var y=[],x=0;x<p;x++)y[x]=[];for(var b=[],D=[],_=0;_<g;_++){for(var w=_+1,E=c[_],C=c[_+1],S=E;S<C;S++){var A=h[S];b[A]=i?v(l[S],o[A][_]):v(o[A][_],l[S]),D[A]=w}for(var F=0;F<p;F++)D[F]===w?y[F][_]=b[F]:y[F][_]=i?v(m,o[F][_]):v(o[F][_],m)}return t.createDenseMatrix({data:y,size:[p,g],datatype:u===t._datatype&&d===r._datatype?a:void 0})}}),oS=/* #__PURE__ */nE("matAlgo07xSSf",["typed","SparseMatrix"],t=>{var{typed:e,SparseMatrix:r}=t;return function(t,i,a){var o,s=t._size,u=t._datatype||void 0===t._data?t._datatype:t.getDataType(),l=i._size,h=i._datatype||void 0===i._data?i._datatype:i.getDataType();if(s.length!==l.length)throw new ir(s.length,l.length);if(s[0]!==l[0]||s[1]!==l[1])throw RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+l+")");var c=s[0],f=s[1],d=0,p=a;"string"==typeof u&&u===h&&"mixed"!==u&&(o=u,d=e.convert(0,o),p=e.find(a,[o,o]));for(var g=[],m=[],v=Array(f+1).fill(0),y=[],x=[],b=[],D=[],_=0;_<f;_++){var w=_+1,E=0;n(t,_,b,y,w),n(i,_,D,x,w);for(var C=0;C<c;C++){var S=p(b[C]===w?y[C]:d,D[C]===w?x[C]:d);0!==S&&!1!==S&&(m.push(C),g.push(S),E++)}v[_+1]=v[_]+E}return new r({values:g,index:m,ptr:v,size:[c,f],datatype:u===t._datatype&&h===i._datatype?o:void 0})};function n(t,e,r,n,i){for(var a=t._values,o=t._index,s=t._ptr,u=s[e],l=s[e+1];u<l;u++){var h=o[u];r[h]=i,n[h]=a[u]}}}),oA=/* #__PURE__ */nE("matAlgo11xS0s",["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i,a){var o,s=t._values,u=t._index,l=t._ptr,h=t._size,c=t._datatype;if(!s)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],d=h[1],p=r,g=0,m=i;"string"==typeof c&&(o=c,p=e.find(r,[o,o]),g=e.convert(0,o),n=e.convert(n,o),m=e.find(i,[o,o]));for(var v=[],y=[],x=[],b=0;b<d;b++){x[b]=y.length;for(var D=l[b],_=l[b+1],w=D;w<_;w++){var E=u[w],C=a?m(n,s[w]):m(s[w],n);p(C,g)||(y.push(E),v.push(C))}}return x[d]=y.length,t.createSparseMatrix({values:v,index:y,ptr:x,size:[f,d],datatype:o})}}),oF=/* #__PURE__ */nE("matAlgo12xSfs",["typed","DenseMatrix"],t=>{var{typed:e,DenseMatrix:r}=t;return function(t,n,i,a){var o,s=t._values,u=t._index,l=t._ptr,h=t._size,c=t._datatype;if(!s)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],d=h[1],p=i;"string"==typeof c&&(o=c,n=e.convert(n,o),p=e.find(i,[o,o]));for(var g=[],m=[],v=[],y=0;y<d;y++){for(var x=y+1,b=l[y],D=l[y+1],_=b;_<D;_++){var w=u[_];m[w]=s[_],v[w]=x}for(var E=0;E<f;E++)0===y&&(g[E]=[]),v[E]===x?g[E][y]=a?p(n,m[E]):p(m[E],n):g[E][y]=a?p(n,0):p(0,n)}return new r({data:g,size:[f,d],datatype:o})}}),oN=/* #__PURE__ */nE("matAlgo13xDD",["typed"],t=>{var{typed:e}=t;return function(t,r,n){var i,a=t._data,o=t._size,s=t._datatype,u=r._data,l=r._size,h=r._datatype,c=[];if(o.length!==l.length)throw new ir(o.length,l.length);for(var f=0;f<o.length;f++){if(o[f]!==l[f])throw RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+l+")");c[f]=o[f]}var d=n;"string"==typeof s&&s===h&&(i=s,d=e.find(n,[i,i]));var p=c.length>0?function t(e,r,n,i,a,o){var s=[];if(r===n.length-1)for(var u=0;u<i;u++)s[u]=e(a[u],o[u]);else for(var l=0;l<i;l++)s[l]=t(e,r+1,n,n[r+1],a[l],o[l]);return s}(d,0,c,c[0],a,u):[];return t.createDenseMatrix({data:p,size:c,datatype:i})}}),oM=/* #__PURE__ */nE("matAlgo14xDs",["typed"],t=>{var{typed:e}=t;return function(t,r,n,i){var a,o=t._data,s=t._size,u=t._datatype,l=n;"string"==typeof u&&(a=u,r=e.convert(r,a),l=e.find(n,[a,a]));var h=s.length>0?function t(e,r,n,i,a,o,s){var u=[];if(r===n.length-1)for(var l=0;l<i;l++)u[l]=s?e(o,a[l]):e(a[l],o);else for(var h=0;h<i;h++)u[h]=t(e,r+1,n,n[r+1],a[h],o,s);return u}(l,0,s,s[0],o,r,i):[];return t.createDenseMatrix({data:h,size:rT(s),datatype:a})}});function oT(t,e){if(rO(t.size(),e.size()))return[t,e];var r=iD(t.size(),e.size());return[t,e].map(t=>rO(t.size(),r)?t:t.create(iw(t.valueOf(),r),t.datatype()))}var oB=/* #__PURE__ */nE("matrixAlgorithmSuite",["typed","matrix"],t=>{var{typed:e,matrix:r}=t,n=oN({typed:e}),i=oM({typed:e});return function(t){var a,o=t.elop,s=t.SD||t.DS;o?(a={"DenseMatrix, DenseMatrix":(t,e)=>n(...oT(t,e),o),"Array, Array":(t,e)=>n(...oT(r(t),r(e)),o).valueOf(),"Array, DenseMatrix":(t,e)=>n(...oT(r(t),e),o),"DenseMatrix, Array":(t,e)=>n(...oT(t,r(e)),o)},t.SS&&(a["SparseMatrix, SparseMatrix"]=(e,r)=>t.SS(...oT(e,r),o,!1)),t.DS&&(a["DenseMatrix, SparseMatrix"]=(e,r)=>t.DS(...oT(e,r),o,!1),a["Array, SparseMatrix"]=(e,n)=>t.DS(...oT(r(e),n),o,!1)),s&&(a["SparseMatrix, DenseMatrix"]=(t,e)=>s(...oT(e,t),o,!0),a["SparseMatrix, Array"]=(t,e)=>s(...oT(r(e),t),o,!0))):(a={"DenseMatrix, DenseMatrix":e.referToSelf(t=>(e,r)=>n(...oT(e,r),t)),"Array, Array":e.referToSelf(t=>(e,i)=>n(...oT(r(e),r(i)),t).valueOf()),"Array, DenseMatrix":e.referToSelf(t=>(e,i)=>n(...oT(r(e),i),t)),"DenseMatrix, Array":e.referToSelf(t=>(e,i)=>n(...oT(e,r(i)),t))},t.SS&&(a["SparseMatrix, SparseMatrix"]=e.referToSelf(e=>(r,n)=>t.SS(...oT(r,n),e,!1))),t.DS&&(a["DenseMatrix, SparseMatrix"]=e.referToSelf(e=>(r,n)=>t.DS(...oT(r,n),e,!1)),a["Array, SparseMatrix"]=e.referToSelf(e=>(n,i)=>t.DS(...oT(r(n),i),e,!1))),s&&(a["SparseMatrix, DenseMatrix"]=e.referToSelf(t=>(e,r)=>s(...oT(r,e),t,!0)),a["SparseMatrix, Array"]=e.referToSelf(t=>(e,n)=>s(...oT(r(n),e),t,!0))));var u=t.scalar||"any";(t.Ds||t.Ss)&&(o?(a["DenseMatrix,"+u]=(t,e)=>i(t,e,o,!1),a[u+", DenseMatrix"]=(t,e)=>i(e,t,o,!0),a["Array,"+u]=(t,e)=>i(r(t),e,o,!1).valueOf(),a[u+", Array"]=(t,e)=>i(r(e),t,o,!0).valueOf()):(a["DenseMatrix,"+u]=e.referToSelf(t=>(e,r)=>i(e,r,t,!1)),a[u+", DenseMatrix"]=e.referToSelf(t=>(e,r)=>i(r,e,t,!0)),a["Array,"+u]=e.referToSelf(t=>(e,n)=>i(r(e),n,t,!1).valueOf()),a[u+", Array"]=e.referToSelf(t=>(e,n)=>i(r(n),e,t,!0).valueOf())));var l=void 0!==t.sS?t.sS:t.Ss;return o?(t.Ss&&(a["SparseMatrix,"+u]=(e,r)=>t.Ss(e,r,o,!1)),l&&(a[u+", SparseMatrix"]=(t,e)=>l(e,t,o,!0))):(t.Ss&&(a["SparseMatrix,"+u]=e.referToSelf(e=>(r,n)=>t.Ss(r,n,e,!1))),l&&(a[u+", SparseMatrix"]=e.referToSelf(t=>(e,r)=>l(r,e,t,!0)))),o&&o.signatures&&rB(a,o.signatures),a}}),oO="dotDivide",ok=(t=>{var{typed:e,matrix:r,equalScalar:n,divideScalar:i,DenseMatrix:a,concat:o,SparseMatrix:s}=t,u=oE({typed:e,equalScalar:n}),l=oC({typed:e}),h=oS({typed:e,SparseMatrix:s}),c=oA({typed:e,equalScalar:n}),f=oF({typed:e,DenseMatrix:a}),d=oB({typed:e,matrix:r,concat:o});return e(oO,d({elop:i,SS:h,DS:l,SD:u,Ss:c,sS:f}))},"equal"),oP=/* #__PURE__ */nE(ok,["typed","matrix","equalScalar","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=oC({typed:e}),u=oS({typed:e,SparseMatrix:o}),l=oF({typed:e,DenseMatrix:i}),h=oB({typed:e,matrix:r,concat:a});return e(ok,oR({typed:e,equalScalar:n}),h({elop:n,SS:u,DS:s,Ss:l}))}),oR=nE(ok,["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return e(ok,{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:r(t,e)}})}),oI="identity",oz=/* #__PURE__ */nE(oI,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,BigNumber:i,DenseMatrix:a,SparseMatrix:o}=t;return e(oI,{"":function(){return"Matrix"===r.matrix?n([]):[]},string:function(t){return n(t)},"number | BigNumber":function(t){return u(t,t,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, string":function(t,e){return u(t,t,e)},"number | BigNumber, number | BigNumber":function(t,e){return u(t,e,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,r){return u(t,e,r)},Array:function(t){return s(t)},"Array, string":function(t,e){return s(t,e)},Matrix:function(t){return s(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return s(t.valueOf(),e)}});function s(t,e){switch(t.length){case 0:return e?n(e):[];case 1:return u(t[0],t[0],e);case 2:return u(t[0],t[1],e);default:throw Error("Vector containing two values expected")}}function u(t,e,r){var n=rq(t)||rq(e)?i:null;if(rq(t)&&(t=t.toNumber()),rq(e)&&(e=e.toNumber()),!nF(t)||t<1||!nF(e)||e<1)throw Error("Parameters in function identity must be positive integers");var s=n?new i(1):1,u=n?new n(0):0,l=[t,e];if(r){if("sparse"===r)return o.diagonal(l,s,0,u);if("dense"===r)return a.diagonal(l,s,0,u);throw TypeError('Unknown matrix type "'.concat(r,'"'))}for(var h=ih([],l,u),c=t<e?t:e,f=0;f<c;f++)h[f][f]=s;return h}}),oU="largerEq",oL=/* #__PURE__ */nE(oU,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=oC({typed:e}),u=oS({typed:e,SparseMatrix:o}),l=oF({typed:e,DenseMatrix:i}),h=oB({typed:e,matrix:n,concat:a}),c=ah({typed:e});return e(oU,oG({typed:e,config:r}),{"boolean, boolean":(t,e)=>t>=e,"BigNumber, BigNumber":function(t,e){return t.gte(e)||al(t,e,r.relTol,r.absTol)},"bigint, bigint":function(t,e){return t>=e},"Fraction, Fraction":(t,e)=>-1!==t.compare(e),"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},c,h({SS:u,DS:s,Ss:l}))}),oG=/* #__PURE__ */nE(oU,["typed","config"],t=>{var{typed:e,config:r}=t;return e(oU,{"number, number":function(t,e){return t>=e||nq(t,e,r.relTol,r.absTol)}})}),oq=/* #__PURE__ */nE("matAlgo01xDSid",["typed"],t=>{var{typed:e}=t;return function(t,r,n,i){var a,o,s=t._data,u=t._size,l=t._datatype||t.getDataType(),h=r._values,c=r._index,f=r._ptr,d=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(u.length!==d.length)throw new ir(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");if(!h)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=u[0],m=u[1],v="string"==typeof l&&"mixed"!==l&&l===p?l:void 0,y=v?e.find(n,[v,v]):n,x=[];for(a=0;a<g;a++)x[a]=[];var b=[],D=[];for(o=0;o<m;o++){for(var _=o+1,w=f[o],E=f[o+1],C=w;C<E;C++)b[a=c[C]]=i?y(h[C],s[a][o]):y(s[a][o],h[C]),D[a]=_;for(a=0;a<g;a++)D[a]===_?x[a][o]=b[a]:x[a][o]=s[a][o]}return t.createDenseMatrix({data:x,size:[g,m],datatype:l===t._datatype&&p===r._datatype?v:void 0})}}),oj=/* #__PURE__ */nE("matAlgo10xSids",["typed","DenseMatrix"],t=>{var{typed:e,DenseMatrix:r}=t;return function(t,n,i,a){var o,s=t._values,u=t._index,l=t._ptr,h=t._size,c=t._datatype;if(!s)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],d=h[1],p=i;"string"==typeof c&&(o=c,n=e.convert(n,o),p=e.find(i,[o,o]));for(var g=[],m=[],v=[],y=0;y<d;y++){for(var x=y+1,b=l[y],D=l[y+1],_=b;_<D;_++){var w=u[_];m[w]=s[_],v[w]=x}for(var E=0;E<f;E++)0===y&&(g[E]=[]),v[E]===x?g[E][y]=a?p(n,m[E]):p(m[E],n):g[E][y]=n}return new r({data:g,size:[f,d],datatype:o})}});function oV(t){var{DenseMatrix:e}=t;return function(t,r,n){var i=t.size();if(2!==i.length)throw RangeError("Matrix must be two dimensional (size: "+n9(i)+")");var a=i[0];if(a!==i[1])throw RangeError("Matrix must be square (size: "+n9(i)+")");var o=[];if(rK(r)){var s=r.size(),u=r._data;if(1===s.length){if(s[0]!==a)throw RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var l=0;l<a;l++)o[l]=[u[l]];return new e({data:o,size:[a,1],datatype:r._datatype})}if(2===s.length){if(s[0]!==a||1!==s[1])throw RangeError("Dimension mismatch. Matrix columns must match vector length.");if(rZ(r)){if(n){o=[];for(var h=0;h<a;h++)o[h]=[u[h][0]];return new e({data:o,size:[a,1],datatype:r._datatype})}return r}if(rJ(r)){for(var c=0;c<a;c++)o[c]=[0];for(var f=r._values,d=r._index,p=r._ptr,g=p[1],m=p[0];m<g;m++)o[d[m]][0]=f[m];return new e({data:o,size:[a,1],datatype:r._datatype})}}throw RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(r$(r)){var v=ia(r);if(1===v.length){if(v[0]!==a)throw RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var y=0;y<a;y++)o[y]=[r[y]];return new e({data:o,size:[a,1]})}if(2===v.length){if(v[0]!==a||1!==v[1])throw RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var x=0;x<a;x++)o[x]=[r[x][0]];return new e({data:o,size:[a,1]})}throw RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o,s,u,l,h=t._values,c=t._index,f=t._ptr,d=t._size,p=t._datatype||void 0===t._data?t._datatype:t.getDataType(),g=n._values,m=n._index,v=n._ptr,y=n._size,x=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(d.length!==y.length)throw new ir(d.length,y.length);if(d[0]!==y[0]||d[1]!==y[1])throw RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+y+")");if(!h||!g)throw Error("Cannot perform operation on Pattern Sparse Matrices");var b=d[0],D=d[1],_=r,w=0,E=i;"string"==typeof p&&p===x&&"mixed"!==p&&(a=p,_=e.find(r,[a,a]),w=e.convert(0,a),E=e.find(i,[a,a]));for(var C=[],S=[],A=[],F=[],N=[],M=0;M<D;M++){A[M]=S.length;var T=M+1;for(s=f[M],u=f[M+1],o=s;o<u;o++)N[l=c[o]]=T,F[l]=h[o],S.push(l);for(s=v[M],u=v[M+1],o=s;o<u;o++)N[l=m[o]]===T&&(F[l]=E(F[l],g[o]));for(o=A[M];o<S.length;){var B=F[l=S[o]];_(B,w)?S.splice(o,1):(C.push(B),o++)}}return A[D]=S.length,t.createSparseMatrix({values:C,index:S,ptr:A,size:[b,D],datatype:p===t._datatype&&x===n._datatype?a:void 0})}},t=>{var{typed:e,matrix:r}=t;return{"Array, number":e.referTo("DenseMatrix, number",t=>(e,n)=>t(r(e),n).valueOf()),"Array, BigNumber":e.referTo("DenseMatrix, BigNumber",t=>(e,n)=>t(r(e),n).valueOf()),"number, Array":e.referTo("number, DenseMatrix",t=>(e,n)=>t(e,r(n)).valueOf()),"BigNumber, Array":e.referTo("BigNumber, DenseMatrix",t=>(e,n)=>t(e,r(n)).valueOf())}};var oH="lsolve",oY=/* #__PURE__ */nE(oH,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=t,u=oV({DenseMatrix:s});return e(oH,{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var r=(e=u(t,e,!0))._data,l=t._size[0],h=t._size[1],c=t._values,f=t._index,d=t._ptr,p=[],g=0;g<h;g++){var m=r[g][0]||0;if(o(m,0))p[g]=[0];else{for(var v=0,y=[],x=[],b=d[g],D=d[g+1],_=b;_<D;_++){var w=f[_];w===g?v=c[_]:w>g&&(y.push(c[_]),x.push(w))}if(o(v,0))throw Error("Linear system cannot be solved since matrix is singular");for(var E=n(m,v),C=0,S=x.length;C<S;C++){var A=x[C];r[A]=[a(r[A][0]||0,i(E,y[C]))]}p[g]=[E]}}return new s({data:p,size:[l,1]})}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return l(t,e)},"Array, Array | Matrix":function(t,e){return l(r(t),e).valueOf()}});function l(t,e){for(var r=(e=u(t,e,!0))._data,l=t._size[0],h=t._size[1],c=[],f=t._data,d=0;d<h;d++){var p=r[d][0]||0,g=void 0;if(o(p,0))g=0;else{var m=f[d][d];if(o(m,0))throw Error("Linear system cannot be solved since matrix is singular");g=n(p,m);for(var v=d+1;v<l;v++)r[v]=[a(r[v][0]||0,i(g,f[v][d]))]}c[d]=[g]}return new s({data:c,size:[l,1]})}}),oW="matrixFromColumns",o$=/* #__PURE__ */nE(oW,["typed","matrix","flatten","size"],t=>{var{typed:e,matrix:r,flatten:n,size:i}=t;return e(oW,{"...Array":function(t){return a(t)},"...Matrix":function(t){return r(a(t.map(t=>t.toArray())))}});function a(t){if(0===t.length)throw TypeError("At least one column is needed to construct a matrix.");for(var e=o(t[0]),r=[],i=0;i<e;i++)r[i]=[];for(var a of t){var s=o(a);if(s!==e)throw TypeError("The vectors had different length: "+(0|e)+" ≠ "+(0|s));for(var u=n(a),l=0;l<e;l++)r[l].push(u[l])}return r}function o(t){var e=i(t);if(1===e.length)return e[0];if(2===e.length){if(1===e[0])return e[1];if(1===e[1])return e[0];throw TypeError("At least one of the arguments is not a vector.")}throw TypeError("Only one- or two-dimensional vectors are supported.")}}),oK=(t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o=t._values,s=t._size,u=t._datatype||void 0===t._data?t._datatype:t.getDataType(),l=n._values,h=n._size,c=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(s.length!==h.length)throw new ir(s.length,h.length);if(s[0]!==h[0]||s[1]!==h[1])throw RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+h+")");var f=s[0],d=s[1],p=r,g=0,m=i;"string"==typeof u&&u===c&&"mixed"!==u&&(a=u,p=e.find(r,[a,a]),g=e.convert(0,a),m=e.find(i,[a,a]));for(var v=o&&l?[]:void 0,y=[],x=[],b=v?[]:void 0,D=[],_=[],w=0;w<d;w++){x[w]=y.length;var E=w+1;if(iL(t,w,D,b,_,E,y,m),iL(n,w,D,b,_,E,y,m),b)for(var C=x[w];C<y.length;){var S=y[C];if(_[S]===E){var A=b[S];p(A,g)?y.splice(C,1):(v.push(A),C++)}else y.splice(C,1)}else for(var F=x[w];F<y.length;)_[y[F]]!==E?y.splice(F,1):F++}return x[d]=y.length,t.createSparseMatrix({values:v,index:y,ptr:x,size:[f,d],datatype:u===t._datatype&&c===n._datatype?a:void 0})}},/* #__PURE__ */nE("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],t=>{var{typed:e,matrix:r,zeros:i,identity:a,isZero:o,equal:s,sign:u,sqrt:l,conj:h,unaryMinus:c,addScalar:f,divideScalar:d,multiplyScalar:p,subtractScalar:g,complex:m}=t;return /*@__PURE__*/n(nx)(e("qr",{DenseMatrix:function(t){return y(t)},SparseMatrix:function(t){return function(t){throw Error("qr not implemented for sparse matrices yet")}(0)},Array:function(t){var e=y(r(t));return{Q:e.Q.valueOf(),R:e.R.valueOf()}}}),{_denseQRimpl:v});function v(t){var e,r,n,m=t._size[0],v=t._size[1],y=a([m],"dense"),x=y._data,b=t.clone(),D=b._data,_=i([m],"");for(n=0;n<Math.min(v,m);++n){var w=D[n][n],E=c(s(w,0)?1:u(w)),C=h(E),S=0;for(e=n;e<m;e++)S=f(S,p(D[e][n],h(D[e][n])));var A=p(E,l(S));if(!o(A)){var F=g(w,A);for(_[n]=1,e=n+1;e<m;e++)_[e]=d(D[e][n],F);var N=c(h(d(F,A))),M=void 0;for(r=n;r<v;r++){for(M=0,e=n;e<m;e++)M=f(M,p(h(_[e]),D[e][r]));for(M=p(M,N),e=n;e<m;e++)D[e][r]=p(g(D[e][r],p(_[e],M)),C)}for(e=0;e<m;e++){for(M=0,r=n;r<m;r++)M=f(M,p(x[e][r],_[r]));for(M=p(M,N),r=n;r<m;++r)x[e][r]=d(g(x[e][r],p(M,h(_[r]))),C)}}}return{Q:y,R:b,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function y(t){var e=v(t),r=e.R._data;if(t._data.length>0)for(var n="Complex"===r[0][0].type?m(0):0,i=0;i<r.length;++i)for(var a=0;a<i&&a<(r[0]||[]).length;++a)r[i][a]=n;return e}}));function oX(t,e,r,n){if(!(this instanceof oX))throw SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=r,this.max=n,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+r+(null!=n?"-"+n:"")+" expected)",this.stack=Error().stack}oX.prototype=Error(),oX.prototype.constructor=Error,oX.prototype.name="ArgumentsError",oX.prototype.isArgumentsError=!0;var oZ="Number of decimals in function round must be an integer",oJ="round",oQ=/* #__PURE__ */nE(oJ,["typed","config","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],t=>{var{typed:e,config:r,matrix:n,equalScalar:i,zeros:a,BigNumber:o,DenseMatrix:s}=t,u=oA({typed:e,equalScalar:i}),l=oF({typed:e,DenseMatrix:s}),h=oM({typed:e});function c(t){return Math.abs(nI(t).exponent)}return e(oJ,{number:function(t){var e=i0(t,c(r.relTol));return i0(nq(t,e,r.relTol,r.absTol)?e:t)},"number, number":function(t,e){var n=c(r.relTol);if(e>=n)return i0(t,e);var i=i0(t,n);return i0(nq(t,i,r.relTol,r.absTol)?i:t,e)},"number, BigNumber":function(t,e){if(!e.isInteger())throw TypeError(oZ);return new o(t).toDecimalPlaces(e.toNumber())},Complex:function(t){return t.round()},"Complex, number":function(t,e){if(e%1)throw TypeError(oZ);return t.round(e)},"Complex, BigNumber":function(t,e){if(!e.isInteger())throw TypeError(oZ);var r=e.toNumber();return t.round(r)},BigNumber:function(t){var e=new o(t).toDecimalPlaces(c(r.relTol));return(al(t,e,r.relTol,r.absTol)?e:t).toDecimalPlaces(0)},"BigNumber, BigNumber":function(t,e){if(!e.isInteger())throw TypeError(oZ);var n=c(r.relTol);if(e>=n)return t.toDecimalPlaces(e.toNumber());var i=t.toDecimalPlaces(n);return(al(t,i,r.relTol,r.absTol)?i:t).toDecimalPlaces(e.toNumber())},Fraction:function(t){return t.round()},"Fraction, number":function(t,e){if(e%1)throw TypeError(oZ);return t.round(e)},"Fraction, BigNumber":function(t,e){if(!e.isInteger())throw TypeError(oZ);return t.round(e.toNumber())},"Unit, number, Unit":e.referToSelf(t=>function(e,r,n){var i=e.toNumeric(n);return n.multiply(t(i,r))}),"Unit, BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>t(e,r.toNumber(),n)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>iI(e,e=>t(e,r,n),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(t=>(e,r)=>t(e,0,r)),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t,!0)),"SparseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>u(e,r,t,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>h(e,r,t,!1)),"Array, number | BigNumber":e.referToSelf(t=>(e,r)=>h(n(e),r,t,!1).valueOf()),"number | Complex | BigNumber | Fraction, SparseMatrix":e.referToSelf(t=>(e,r)=>i(e,0)?a(r.size(),r.storage()):l(r,e,t,!0)),"number | Complex | BigNumber | Fraction, DenseMatrix":e.referToSelf(t=>(e,r)=>i(e,0)?a(r.size(),r.storage()):h(r,e,t,!0)),"number | Complex | BigNumber | Fraction, Array":e.referToSelf(t=>(e,r)=>h(n(r),e,t,!0).valueOf())})}),o0="smaller",o1=/* #__PURE__ */nE(o0,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=oC({typed:e}),u=oS({typed:e,SparseMatrix:o}),l=oF({typed:e,DenseMatrix:i}),h=oB({typed:e,matrix:n,concat:a}),c=ah({typed:e});return e(o0,o2({typed:e,config:r}),{"boolean, boolean":(t,e)=>t<e,"BigNumber, BigNumber":function(t,e){return t.lt(e)&&!al(t,e,r.relTol,r.absTol)},"bigint, bigint":(t,e)=>t<e,"Fraction, Fraction":(t,e)=>-1===t.compare(e),"Complex, Complex":function(t,e){throw TypeError("No ordering relation is defined for complex numbers")}},c,h({SS:u,DS:s,Ss:l}))}),o2=/* #__PURE__ */nE(o0,["typed","config"],t=>{var{typed:e,config:r}=t;return e(o0,{"number, number":function(t,e){return t<e&&!nq(t,e,r.relTol,r.absTol)}})}),o5=/* #__PURE__ */nE("matAlgo05xSfSf",["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o,s,u,l,h=t._values,c=t._index,f=t._ptr,d=t._size,p=t._datatype||void 0===t._data?t._datatype:t.getDataType(),g=n._values,m=n._index,v=n._ptr,y=n._size,x=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(d.length!==y.length)throw new ir(d.length,y.length);if(d[0]!==y[0]||d[1]!==y[1])throw RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+y+")");var b=d[0],D=d[1],_=r,w=0,E=i;"string"==typeof p&&p===x&&"mixed"!==p&&(a=p,_=e.find(r,[a,a]),w=e.convert(0,a),E=e.find(i,[a,a]));var C=h&&g?[]:void 0,S=[],A=[],F=C?[]:void 0,N=C?[]:void 0,M=[],T=[];for(s=0;s<D;s++){A[s]=S.length;var B=s+1;for(u=f[s],l=f[s+1];u<l;u++)o=c[u],S.push(o),M[o]=B,F&&(F[o]=h[u]);for(u=v[s],l=v[s+1];u<l;u++)M[o=m[u]]!==B&&S.push(o),T[o]=B,N&&(N[o]=g[u]);if(C)for(u=A[s];u<S.length;){var O=M[o=S[u]],k=T[o];if(O===B||k===B){var P=E(O===B?F[o]:w,k===B?N[o]:w);_(P,w)?S.splice(u,1):(C.push(P),u++)}}}return A[D]=S.length,t.createSparseMatrix({values:C,index:S,ptr:A,size:[b,D],datatype:p===t._datatype&&x===n._datatype?a:void 0})}}),o3="subtract",o4=/* #__PURE__ */nE(o3,["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],t=>{var{typed:e,matrix:r,equalScalar:n,subtractScalar:i,unaryMinus:a,DenseMatrix:o,concat:s}=t,u=oq({typed:e}),l=oC({typed:e}),h=o5({typed:e,equalScalar:n}),c=oj({typed:e,DenseMatrix:o}),f=oF({typed:e,DenseMatrix:o}),d=oB({typed:e,matrix:r,concat:s});return e(o3,{"any, any":i},d({elop:i,SS:h,DS:u,SD:l,Ss:f,sS:c}))}),o8=(t=>{var{typed:e,config:r,numeric:n}=t;return e("unaryPlus",{number:i$,Complex:function(t){return t},BigNumber:function(t){return t},bigint:function(t){return t},Fraction:function(t){return t},Unit:function(t){return t.clone()},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t,!0)),boolean:function(t){return n(t?1:0,r.number)},string:function(t){return n(t,nN(t,r))}})},"usolve"),o6=/* #__PURE__ */nE(o8,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=t,u=oV({DenseMatrix:s});return e(o8,{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var r=(e=u(t,e,!0))._data,l=t._size[0],h=t._size[1],c=t._values,f=t._index,d=t._ptr,p=[],g=h-1;g>=0;g--){var m=r[g][0]||0;if(o(m,0))p[g]=[0];else{for(var v=0,y=[],x=[],b=d[g],D=d[g+1],_=D-1;_>=b;_--){var w=f[_];w===g?v=c[_]:w<g&&(y.push(c[_]),x.push(w))}if(o(v,0))throw Error("Linear system cannot be solved since matrix is singular");for(var E=n(m,v),C=0,S=x.length;C<S;C++){var A=x[C];r[A]=[a(r[A][0],i(E,y[C]))]}p[g]=[E]}}return new s({data:p,size:[l,1]})}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return l(t,e)},"Array, Array | Matrix":function(t,e){return l(r(t),e).valueOf()}});function l(t,e){for(var r=(e=u(t,e,!0))._data,l=t._size[0],h=t._size[1],c=[],f=t._data,d=h-1;d>=0;d--){var p=r[d][0]||0,g=void 0;if(o(p,0))g=0;else{var m=f[d][d];if(o(m,0))throw Error("Linear system cannot be solved since matrix is singular");g=n(p,m);for(var v=d-1;v>=0;v--)r[v]=[a(r[v][0]||0,i(g,f[v][d]))]}c[d]=[g]}return new s({data:c,size:[l,1]})}}),o9=/* #__PURE__ */nE("matAlgo04xSidSid",["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o,s,u,l,h,c=t._values,f=t._index,d=t._ptr,p=t._size,g=t._datatype||void 0===t._data?t._datatype:t.getDataType(),m=n._values,v=n._index,y=n._ptr,x=n._size,b=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(p.length!==x.length)throw new ir(p.length,x.length);if(p[0]!==x[0]||p[1]!==x[1])throw RangeError("Dimension mismatch. Matrix A ("+p+") must match Matrix B ("+x+")");var D=p[0],_=p[1],w=r,E=0,C=i;"string"==typeof g&&g===b&&"mixed"!==g&&(a=g,w=e.find(r,[a,a]),E=e.convert(0,a),C=e.find(i,[a,a]));var S=c&&m?[]:void 0,A=[],F=[],N=c&&m?[]:void 0,M=c&&m?[]:void 0,T=[],B=[];for(s=0;s<_;s++){F[s]=A.length;var O=s+1;for(l=d[s],h=d[s+1],u=l;u<h;u++)o=f[u],A.push(o),T[o]=O,N&&(N[o]=c[u]);for(l=y[s],h=y[s+1],u=l;u<h;u++)if(T[o=v[u]]===O){if(N){var k=C(N[o],m[u]);w(k,E)?T[o]=null:N[o]=k}}else A.push(o),B[o]=O,M&&(M[o]=m[u]);if(N&&M)for(u=F[s];u<A.length;)T[o=A[u]]===O?(S[u]=N[o],u++):B[o]===O?(S[u]=M[o],u++):A.splice(u,1)}return F[_]=A.length,t.createSparseMatrix({values:S,index:A,ptr:F,size:[D,_],datatype:g===t._datatype&&b===n._datatype?a:void 0})}}),o7=/* #__PURE__ */nE("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],t=>{var{typed:e,matrix:r,addScalar:n,equalScalar:i,DenseMatrix:a,SparseMatrix:o,concat:s}=t,u=oq({typed:e}),l=o9({typed:e,equalScalar:i}),h=oj({typed:e,DenseMatrix:a}),c=oB({typed:e,matrix:r,concat:s});return e("add",{"any, any":n,"any, any, ...any":e.referToSelf(t=>(e,r,n)=>{for(var i=t(e,r),a=0;a<n.length;a++)i=t(i,n[a]);return i})},c({elop:n,DS:u,SS:l,Ss:h}))}),st=(t=>{var{typed:e,equalScalar:r}=t;return function(t,n,i){var a,o,s,u,l,h,c=t._values,f=t._index,d=t._ptr,p=t._size,g=t._datatype||void 0===t._data?t._datatype:t.getDataType(),m=n._values,v=n._index,y=n._ptr,x=n._size,b=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(p.length!==x.length)throw new ir(p.length,x.length);if(p[0]!==x[0]||p[1]!==x[1])throw RangeError("Dimension mismatch. Matrix A ("+p+") must match Matrix B ("+x+")");var D=p[0],_=p[1],w=r,E=0,C=i;"string"==typeof g&&g===b&&"mixed"!==g&&(a=g,w=e.find(r,[a,a]),E=e.convert(0,a),C=e.find(i,[a,a]));var S=c&&m?[]:void 0,A=[],F=[],N=S?[]:void 0,M=[];for(s=0;s<_;s++){F[s]=A.length;var T=s+1;if(N)for(l=y[s],h=y[s+1],u=l;u<h;u++)M[o=v[u]]=T,N[o]=m[u];for(l=d[s],h=d[s+1],u=l;u<h;u++)if(o=f[u],N){var B=M[o]===T?N[o]:E,O=C(c[u],B);w(O,E)||(A.push(o),S.push(O))}else A.push(o)}return F[_]=A.length,t.createSparseMatrix({values:S,index:A,ptr:F,size:[D,_],datatype:g===t._datatype&&b===n._datatype?a:void 0})}},"compare"),se=/* #__PURE__ */nE(st,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],t=>{var{typed:e,config:r,equalScalar:n,matrix:i,BigNumber:a,Fraction:o,DenseMatrix:s,concat:u}=t,l=oC({typed:e}),h=o5({typed:e,equalScalar:n}),c=oF({typed:e,DenseMatrix:s}),f=oB({typed:e,matrix:i,concat:u}),d=ah({typed:e});return e(st,sr({typed:e,config:r}),{"boolean, boolean":function(t,e){return t===e?0:t>e?1:-1},"BigNumber, BigNumber":function(t,e){return new a(al(t,e,r.relTol,r.absTol)?0:t.cmp(e))},"bigint, bigint":function(t,e){return t===e?0n:t>e?1n:-1n},"Fraction, Fraction":function(t,e){return new o(t.compare(e))},"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},d,f({SS:h,DS:l,Ss:c}))}),sr=/* #__PURE__ */nE(st,["typed","config"],t=>{var{typed:e,config:r}=t;return e(st,{"number, number":function(t,e){return nq(t,e,r.relTol,r.absTol)?0:t>e?1:-1}})});ie.signature="any, any",t=>{var{typed:e,matrix:r,concat:n}=t,i=oB({typed:e,matrix:r,concat:n});return e("compareText",ie,i({elop:ie,Ds:!0}))};var sn=/* #__PURE__ */nE("dot",["typed","addScalar","multiplyScalar","conj","size"],t=>{var{typed:e,addScalar:r,multiplyScalar:n,conj:i,size:a}=t;return e("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(t,a){var u=o(t,a),l=rK(t)?t._data:t,h=rK(t)?t._datatype||t.getDataType():void 0,c=rK(a)?a._data:a,f=rK(a)?a._datatype||a.getDataType():void 0,d=2===s(t).length,p=2===s(a).length,g=r,m=n;if(h&&f&&h===f&&"string"==typeof h&&"mixed"!==h&&(g=e.find(r,[h,h]),m=e.find(n,[h,h])),!d&&!p){for(var v=m(i(l[0]),c[0]),y=1;y<u;y++)v=g(v,m(i(l[y]),c[y]));return v}if(!d&&p){for(var x=m(i(l[0]),c[0][0]),b=1;b<u;b++)x=g(x,m(i(l[b]),c[b][0]));return x}if(d&&!p){for(var D=m(i(l[0][0]),c[0]),_=1;_<u;_++)D=g(D,m(i(l[_][0]),c[_]));return D}if(d&&p){for(var w=m(i(l[0][0]),c[0][0]),E=1;E<u;E++)w=g(w,m(i(l[E][0]),c[E][0]));return w}},"SparseMatrix, SparseMatrix":function(t,e){o(t,e);for(var i=t._index,a=t._values,s=e._index,u=e._values,l=0,h=0,c=0;h<i.length&&c<s.length;){var f=i[h],d=s[c];if(f<d){h++;continue}if(f>d){c++;continue}f===d&&(l=r(l,n(a[h],u[c])),h++,c++)}return l}});function o(t,e){var r,n,i=s(t),a=s(e);if(1===i.length)r=i[0];else if(2===i.length&&1===i[1])r=i[0];else throw RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");if(1===a.length)n=a[0];else if(2===a.length&&1===a[1])n=a[0];else throw RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");if(r!==n)throw RangeError("Vectors must have equal length ("+r+" != "+n+")");if(0===r)throw RangeError("Cannot calculate the dot product of empty vectors");return r}function s(t){return rK(t)?t.size():a(t)}}),si="floor",sa=/* #__PURE__ */nE(si,["typed","config","round"],t=>{var{typed:e,config:r,round:n}=t;return e(si,{number:function(t){return nq(t,n(t),r.relTol,r.absTol)?n(t):Math.floor(t)},"number, number":function(t,e){if(nq(t,n(t,e),r.relTol,r.absTol))return n(t,e);var[i,a]="".concat(t,"e").split("e"),o=Math.floor(Number("".concat(i,"e").concat(Number(a)+e)));return[i,a]="".concat(o,"e").split("e"),Number("".concat(i,"e").concat(Number(a)-e))}})}),so=/* #__PURE__ */nE(si,["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],t=>{var{typed:e,config:r,round:i,matrix:a,equalScalar:o,zeros:s,DenseMatrix:u}=t,l=oA({typed:e,equalScalar:o}),h=oF({typed:e,DenseMatrix:u}),c=oM({typed:e}),f=sa({typed:e,config:r,round:i});return e("floor",{number:f.signatures.number,"number,number":f.signatures["number,number"],Complex:function(t){return t.floor()},"Complex, number":function(t,e){return t.floor(e)},"Complex, BigNumber":function(t,e){return t.floor(e.toNumber())},BigNumber:function(t){return al(t,i(t),r.relTol,r.absTol)?i(t):t.floor()},"BigNumber, BigNumber":function(t,e){return al(t,i(t,e),r.relTol,r.absTol)?i(t,e):t.toDecimalPlaces(e.toNumber(),/*@__PURE__*/n(nw).ROUND_FLOOR)},Fraction:function(t){return t.floor()},"Fraction, number":function(t,e){return t.floor(e)},"Fraction, BigNumber":function(t,e){return t.floor(e.toNumber())},"Unit, number, Unit":e.referToSelf(t=>function(e,r,n){var i=e.toNumeric(n);return n.multiply(t(i,r))}),"Unit, BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>t(e,r.toNumber(),n)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>iI(e,e=>t(e,r,n),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(t=>(e,r)=>t(e,0,r)),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t,!0)),"Array, number | BigNumber":e.referToSelf(t=>(e,r)=>iI(e,e=>t(e,r),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>l(e,r,t,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>c(e,r,t,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(t=>(e,r)=>c(a(r),e,t,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(t=>(e,r)=>o(e,0)?s(r.size(),r.storage()):"dense"===r.storage()?c(r,e,t,!0):h(r,e,t,!0))})}),ss=(t=>{var{typed:e,config:r,round:n,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s,concat:u}=t,l=so({typed:e,config:r,round:n,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s}),h=oE({typed:e,equalScalar:a}),c=oC({typed:e}),f=o5({typed:e,equalScalar:a}),d=oA({typed:e,equalScalar:a}),p=oF({typed:e,DenseMatrix:s}),g=oB({typed:e,matrix:i,concat:u});return e("mod",{"number, number":function(t,e){return 0===e?t:t-e*l(t/e)},"BigNumber, BigNumber":function(t,e){return e.isZero()?t:t.sub(e.mul(l(t.div(e))))},"bigint, bigint":function(t,e){if(0n===e)return t;if(t<0){var r=t%e;return 0n===r?r:r+e}return t%e},"Fraction, Fraction":function(t,e){return e.equals(0)?t:t.sub(e.mul(l(t.div(e))))}},g({SS:f,DS:c,SD:h,Ss:d,sS:p}))},"number | BigNumber | Fraction | Matrix | Array");"".concat(ss,", ").concat(ss,", ...").concat(ss);var su=/* #__PURE__ */nE("ImmutableDenseMatrix",["smaller","DenseMatrix"],t=>{var{smaller:e,DenseMatrix:r}=t;function n(t,e){if(!(this instanceof n))throw SyntaxError("Constructor must be called with the new operator");if(e&&!rW(e))throw Error("Invalid datatype: "+e);if(rK(t)||r$(t)){var i=new r(t,e);this._data=i._data,this._size=i._size,this._datatype=i._datatype,this._min=null,this._max=null}else if(t&&r$(t.data)&&r$(t.size))this._data=t.data,this._size=t.size,this._datatype=t.datatype,this._min=void 0!==t.min?t.min:null,this._max=void 0!==t.max?t.max:null;else if(t)throw TypeError("Unsupported type of data ("+ny(t)+")");else this._data=[],this._size=[0],this._datatype=e,this._min=null,this._max=null}return n.prototype=new r,n.prototype.type="ImmutableDenseMatrix",n.prototype.isImmutableDenseMatrix=!0,n.prototype.subset=function(t){switch(arguments.length){case 1:var e=r.prototype.subset.call(this,t);if(rK(e))return new n({data:e._data,size:e._size,datatype:e._datatype});return e;case 2:case 3:throw Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw SyntaxError("Wrong number of arguments")}},n.prototype.set=function(){throw Error("Cannot invoke set on an Immutable Matrix instance")},n.prototype.resize=function(){throw Error("Cannot invoke resize on an Immutable Matrix instance")},n.prototype.reshape=function(){throw Error("Cannot invoke reshape on an Immutable Matrix instance")},n.prototype.clone=function(){return new n({data:rT(this._data),size:rT(this._size),datatype:this._datatype})},n.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.fromJSON=function(t){return new n(t)},n.prototype.swapRows=function(){throw Error("Cannot invoke swapRows on an Immutable Matrix instance")},n.prototype.min=function(){if(null===this._min){var t=null;this.forEach(function(r){(null===t||e(r,t))&&(t=r)}),this._min=null!==t?t:void 0}return this._min},n.prototype.max=function(){if(null===this._max){var t=null;this.forEach(function(r){(null===t||e(t,r))&&(t=r)}),this._max=null!==t?t:void 0}return this._max},n},{isClass:!0}),sl=/* #__PURE__ */nE("Index",["ImmutableDenseMatrix","getMatrixDataType"],t=>{var{ImmutableDenseMatrix:e,getMatrixDataType:r}=t;function n(t){if(!(this instanceof n))throw SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var e=0,a=arguments.length;e<a;e++){var o=arguments[e],s=r$(o),u=rK(o),l=null;if(rQ(o))this._dimensions.push(o),this._isScalar=!1;else if(s||u){var h=void 0;"boolean"===r(o)?(s&&(h=i(sh(o).valueOf())),u&&(h=i(sh(o._data).valueOf())),l=o.valueOf().length):h=i(o.valueOf()),this._dimensions.push(h);var c=h.size();(1!==c.length||1!==c[0]||null!==l)&&(this._isScalar=!1)}else if("number"==typeof o)this._dimensions.push(i([o]));else if("string"==typeof o)this._dimensions.push(o);else throw TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._sourceSize.push(l)}}function i(t){for(var r=0,n=t.length;r<n;r++)if("number"!=typeof t[r]||!nF(t[r]))throw TypeError("Index parameters must be positive integer numbers");return new e(t)}return n.prototype.type="Index",n.prototype.isIndex=!0,n.prototype.clone=function(){var t=new n;return t._dimensions=rT(this._dimensions),t._isScalar=this._isScalar,t._sourceSize=this._sourceSize,t},n.create=function(t){var e=new n;return n.apply(e,t),e},n.prototype.size=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];t[e]="string"==typeof n?1:n.size()[0]}return t},n.prototype.max=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];t[e]="string"==typeof n?n:n.max()}return t},n.prototype.min=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];t[e]="string"==typeof n?n:n.min()}return t},n.prototype.forEach=function(t){for(var e=0,r=this._dimensions.length;e<r;e++)t(this._dimensions[e],e,this)},n.prototype.dimension=function(t){return"number"!=typeof t?null:this._dimensions[t]||null},n.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},n.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},n.prototype.isScalar=function(){return this._isScalar},n.prototype.toArray=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];t.push("string"==typeof n?n:n.toArray())}return t},n.prototype.valueOf=n.prototype.toArray,n.prototype.toString=function(){for(var t=[],e=0,r=this._dimensions.length;e<r;e++){var n=this._dimensions[e];"string"==typeof n?t.push(JSON.stringify(n)):t.push(n.toString())}return"["+t.join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},n.fromJSON=function(t){return n.create(t.dimensions)},n},{isClass:!0});function sh(t){var e=[];return t.forEach((t,r)=>{t&&e.push(r)}),e}var sc="larger",sf=/* #__PURE__ */nE(sc,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=oC({typed:e}),u=oS({typed:e,SparseMatrix:o}),l=oF({typed:e,DenseMatrix:i}),h=oB({typed:e,matrix:n,concat:a}),c=ah({typed:e});return e(sc,sd({typed:e,config:r}),{"boolean, boolean":(t,e)=>t>e,"BigNumber, BigNumber":function(t,e){return t.gt(e)&&!al(t,e,r.relTol,r.absTol)},"bigint, bigint":(t,e)=>t>e,"Fraction, Fraction":(t,e)=>1===t.compare(e),"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},c,h({SS:u,DS:s,Ss:l}))}),sd=/* #__PURE__ */nE(sc,["typed","config"],t=>{var{typed:e,config:r}=t;return e(sc,{"number, number":function(t,e){return t>e&&!nq(t,e,r.relTol,r.absTol)}})}),sp="multiply",sg=/* #__PURE__ */nE(sp,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],t=>{var{typed:e,matrix:r,addScalar:n,multiplyScalar:i,equalScalar:a,dot:o}=t,s=oA({typed:e,equalScalar:a}),u=oM({typed:e});function l(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}}var h=e("_multiplyMatrixVector",{"DenseMatrix, any":function(t,r){var a,o=t._data,s=t._size,u=t._datatype||t.getDataType(),l=r._data,h=r._datatype||r.getDataType(),c=s[0],f=s[1],d=n,p=i;u&&h&&u===h&&"string"==typeof u&&"mixed"!==u&&(a=u,d=e.find(n,[a,a]),p=e.find(i,[a,a]));for(var g=[],m=0;m<c;m++){for(var v=o[m],y=p(v[0],l[0]),x=1;x<f;x++)y=d(y,p(v[x],l[x]));g[m]=y}return t.createDenseMatrix({data:g,size:[c],datatype:u===t._datatype&&h===r._datatype?a:void 0})},"SparseMatrix, any":function(t,r){var o,s=t._values,u=t._index,l=t._ptr,h=t._datatype||void 0===t._data?t._datatype:t.getDataType();if(!s)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c=r._data,f=r._datatype||r.getDataType(),d=t._size[0],p=r._size[0],g=[],m=[],v=[],y=n,x=i,b=a,D=0;h&&f&&h===f&&"string"==typeof h&&"mixed"!==h&&(o=h,y=e.find(n,[o,o]),x=e.find(i,[o,o]),b=e.find(a,[o,o]),D=e.convert(0,o));var _=[],w=[];v[0]=0;for(var E=0;E<p;E++){var C=c[E];if(!b(C,D))for(var S=l[E],A=l[E+1],F=S;F<A;F++){var N=u[F];w[N]?_[N]=y(_[N],x(C,s[F])):(w[N]=!0,m.push(N),_[N]=x(C,s[F]))}}for(var M=m.length,T=0;T<M;T++){var B=m[T];g[T]=_[B]}return v[1]=m.length,t.createSparseMatrix({values:g,index:m,ptr:v,size:[d,1],datatype:h===t._datatype&&f===r._datatype?o:void 0})}}),c=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(t,r){var a,o=t._data,s=t._size,u=t._datatype||t.getDataType(),l=r._data,h=r._size,c=r._datatype||r.getDataType(),f=s[0],d=s[1],p=h[1],g=n,m=i;u&&c&&u===c&&"string"==typeof u&&"mixed"!==u&&"mixed"!==u&&(a=u,g=e.find(n,[a,a]),m=e.find(i,[a,a]));for(var v=[],y=0;y<f;y++){var x=o[y];v[y]=[];for(var b=0;b<p;b++){for(var D=m(x[0],l[0][b]),_=1;_<d;_++)D=g(D,m(x[_],l[_][b]));v[y][b]=D}}return t.createDenseMatrix({data:v,size:[f,p],datatype:u===t._datatype&&c===r._datatype?a:void 0})},"DenseMatrix, SparseMatrix":function(t,r){var o,s=t._data,u=t._size,l=t._datatype||t.getDataType(),h=r._values,c=r._index,f=r._ptr,d=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(!h)throw Error("Cannot multiply Dense Matrix times Pattern only Matrix");var g=u[0],m=d[1],v=n,y=i,x=a,b=0;l&&p&&l===p&&"string"==typeof l&&"mixed"!==l&&(o=l,v=e.find(n,[o,o]),y=e.find(i,[o,o]),x=e.find(a,[o,o]),b=e.convert(0,o));for(var D=[],_=[],w=[],E=r.createSparseMatrix({values:D,index:_,ptr:w,size:[g,m],datatype:l===t._datatype&&p===r._datatype?o:void 0}),C=0;C<m;C++){w[C]=_.length;var S=f[C],A=f[C+1];if(A>S)for(var F=0,N=0;N<g;N++){for(var M=N+1,T=void 0,B=S;B<A;B++){var O=c[B];F!==M?(T=y(s[N][O],h[B]),F=M):T=v(T,y(s[N][O],h[B]))}F!==M||x(T,b)||(_.push(N),D.push(T))}}return w[m]=_.length,E},"SparseMatrix, DenseMatrix":function(t,r){var o,s=t._values,u=t._index,l=t._ptr,h=t._datatype||void 0===t._data?t._datatype:t.getDataType();if(!s)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c=r._data,f=r._datatype||r.getDataType(),d=t._size[0],p=r._size[0],g=r._size[1],m=n,v=i,y=a,x=0;h&&f&&h===f&&"string"==typeof h&&"mixed"!==h&&(o=h,m=e.find(n,[o,o]),v=e.find(i,[o,o]),y=e.find(a,[o,o]),x=e.convert(0,o));for(var b=[],D=[],_=[],w=t.createSparseMatrix({values:b,index:D,ptr:_,size:[d,g],datatype:h===t._datatype&&f===r._datatype?o:void 0}),E=[],C=[],S=0;S<g;S++){_[S]=D.length;for(var A=S+1,F=0;F<p;F++){var N=c[F][S];if(!y(N,x))for(var M=l[F],T=l[F+1],B=M;B<T;B++){var O=u[B];C[O]!==A?(C[O]=A,D.push(O),E[O]=v(N,s[B])):E[O]=m(E[O],v(N,s[B]))}}for(var k=_[S],P=D.length,R=k;R<P;R++){var I=D[R];b[R]=E[I]}}return _[g]=D.length,w},"SparseMatrix, SparseMatrix":function(t,r){var a,o,s,u,l,h,c,f,d,p=t._values,g=t._index,m=t._ptr,v=t._datatype||void 0===t._data?t._datatype:t.getDataType(),y=r._values,x=r._index,b=r._ptr,D=r._datatype||void 0===r._data?r._datatype:r.getDataType(),_=t._size[0],w=r._size[1],E=p&&y,C=n,S=i;v&&D&&v===D&&"string"==typeof v&&"mixed"!==v&&(a=v,C=e.find(n,[a,a]),S=e.find(i,[a,a]));for(var A=E?[]:void 0,F=[],N=[],M=t.createSparseMatrix({values:A,index:F,ptr:N,size:[_,w],datatype:v===t._datatype&&D===r._datatype?a:void 0}),T=E?[]:void 0,B=[],O=0;O<w;O++){N[O]=F.length;var k=O+1;for(h=b[O],c=b[O+1],l=h;l<c;l++)if(d=x[l],E)for(s=m[d],u=m[d+1],o=s;o<u;o++)B[f=g[o]]!==k?(B[f]=k,F.push(f),T[f]=S(y[l],p[o])):T[f]=C(T[f],S(y[l],p[o]));else for(s=m[d],u=m[d+1],o=s;o<u;o++)B[f=g[o]]!==k&&(B[f]=k,F.push(f));if(E)for(var P=N[O],R=F.length,I=P;I<R;I++){var z=F[I];A[I]=T[z]}}return N[w]=F.length,M}});return e(sp,i,{"Array, Array":e.referTo("Matrix, Matrix",t=>(e,n)=>{l(ia(e),ia(n));var i=t(r(e),r(n));return rK(i)?i.valueOf():i}),"Matrix, Matrix":function(t,r){var a=t.size(),s=r.size();return(l(a,s),1===a.length)?1===s.length?function(t,e,r){if(0===r)throw Error("Cannot multiply two empty vectors");return o(t,e)}(t,r,a[0]):function(t,r){if("dense"!==r.storage())throw Error("Support for SparseMatrix not implemented");return function(t,r){var a,o=t._data,s=t._size,u=t._datatype||t.getDataType(),l=r._data,h=r._size,c=r._datatype||r.getDataType(),f=s[0],d=h[1],p=n,g=i;u&&c&&u===c&&"string"==typeof u&&"mixed"!==u&&(a=u,p=e.find(n,[a,a]),g=e.find(i,[a,a]));for(var m=[],v=0;v<d;v++){for(var y=g(o[0],l[0][v]),x=1;x<f;x++)y=p(y,g(o[x],l[x][v]));m[v]=y}return t.createDenseMatrix({data:m,size:[d],datatype:u===t._datatype&&c===r._datatype?a:void 0})}(t,r)}(t,r):1===s.length?h(t,r):c(t,r)},"Matrix, Array":e.referTo("Matrix,Matrix",t=>(e,n)=>t(e,r(n))),"Array, Matrix":e.referToSelf(t=>(e,n)=>t(r(e,n.storage()),n)),"SparseMatrix, any":function(t,e){return s(t,e,i,!1)},"DenseMatrix, any":function(t,e){return u(t,e,i,!1)},"any, SparseMatrix":function(t,e){return s(e,t,i,!0)},"any, DenseMatrix":function(t,e){return u(e,t,i,!0)},"Array, any":function(t,e){return u(r(t),e,i,!1).valueOf()},"any, Array":function(t,e){return u(r(e),t,i,!0).valueOf()},"any, any":i,"any, any, ...any":e.referToSelf(t=>(e,r,n)=>{for(var i=t(e,r),a=0;a<n.length;a++)i=t(i,n[a]);return i})})}),sm="partitionSelect";function sv(t,e,r,n,i,a,o){var s=0;for(r[o]=t;s>=0;){var u=r[o+s],l=r[n+u];-1===l?(s--,a[e++]=u):(r[n+u]=r[i+l],r[o+ ++s]=l)}return e}t=>{var{typed:e,isNumeric:r,isNaN:n,compare:i}=t,a=(t,e)=>-i(t,e);return e(sm,{"Array | Matrix, number":function(t,e){return o(t,e,i)},"Array | Matrix, number, string":function(t,e,r){if("asc"===r)return o(t,e,i);if("desc"===r)return o(t,e,a);throw Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":o});function o(t,e,r){if(!nF(e)||e<0)throw Error("k must be a non-negative integer");if(rK(t)){if(t.size().length>1)throw Error("Only one dimensional matrices supported");return s(t.valueOf(),e,r)}if(Array.isArray(t))return s(t,e,r)}function s(t,e,i){if(e>=t.length)throw Error("k out of bounds");for(var a=0;a<t.length;a++)if(r(t[a])&&n(t[a]))return t[a];for(var o=0,s=t.length-1;o<s;){for(var u=o,l=s,h=t[Math.floor(Math.random()*(s-o+1))+o];u<l;)if(i(t[u],h)>=0){var c=t[l];t[l]=t[u],t[u]=c,--l}else++u;i(t[u],h)>0&&--u,e<=u?s=u:o=u+1}return t[e]}};var sy=/* #__PURE__ */nE("csAmd",["add","multiply","transpose"],t=>{var{add:e,multiply:r,transpose:n}=t;return function(t,o){if(!o||t<=0||t>3)return null;var s,u,l,h,c,f,d,p,g,m,v,y,x,b,D,_,w=o._size,E=w[0],C=w[1],S=0,A=Math.max(16,10*Math.sqrt(C));A=Math.min(C-2,A);var F=function(t,i,a,o,s){var u=n(i);if(1===t&&o===a)return e(i,u);if(2===t){for(var l=u._index,h=u._ptr,c=0,f=0;f<a;f++){var d=h[f];if(h[f]=c,!(h[f+1]-d>s))for(var p=h[f+1];d<p;d++)l[c++]=l[d]}h[a]=c,i=n(u)}return r(u,i)}(t,o,E,C,A);!function(t,e,r){for(var n=t._values,i=t._index,a=t._ptr,o=t._size[1],s=0,u=0;u<o;u++){var l=a[u];for(a[u]=s;l<a[u+1];l++)e(i[l],u,n?n[l]:1,null)&&(i[s]=i[l],n&&(n[s]=n[l]),s++)}a[o]=s,i.splice(s,i.length-s),n&&n.splice(s,n.length-s)}(F,a,0);for(var N=F._index,M=F._ptr,T=M[C],B=[],O=[],k=C+1,P=2*(C+1),R=3*(C+1),I=4*(C+1),z=5*(C+1),U=6*(C+1),L=7*(C+1),G=function(t,e,r,n,a,o,s,u,l,h,c,f){for(var d=0;d<t;d++)r[0+d]=e[d+1]-e[d];r[0+t]=0;for(var p=0;p<=t;p++)r[a+p]=-1,o[p]=-1,r[s+p]=-1,r[u+p]=-1,r[l+p]=1,r[h+p]=1,r[c+p]=0,r[f+p]=r[n+p];var g=i(0,0,r,h,t);return r[c+t]=-2,e[t]=-1,r[h+t]=0,g}(C,M,O,0,R,B,P,L,k,U,I,z),q=function(t,e,r,n,i,a,o,s,u,l,h){for(var c=0,f=0;f<t;f++){var d=r[n+f];if(0===d)r[i+f]=-2,c++,e[f]=-1,r[a+f]=0;else if(d>o)r[s+f]=0,r[i+f]=-1,c++,e[f]=-t-2,r[s+t]++;else{var p=r[u+d];-1!==p&&(l[p]=f),r[h+f]=r[u+d],r[u+d]=f}}return c}(C,M,O,z,I,U,A,k,R,B,P),j=0;q<C;){for(l=-1;j<C&&-1===(l=O[R+j]);j++);-1!==O[P+l]&&(B[O[P+l]]=-1),O[R+j]=O[P+l];var V=O[I+l],H=O[k+l];q+=H;var Y=0;O[k+l]=-H;var W=M[l],$=0===V?W:T,K=$;for(h=1;h<=V+1;h++){for(h>V?(f=l,d=W,p=O[0+l]-V):(d=M[f=N[W++]],p=O[0+f]),c=1;c<=p;c++)(g=O[k+(s=N[d++])])<=0||(Y+=g,O[k+s]=-g,N[K++]=s,-1!==O[P+s]&&(B[O[P+s]]=B[s]),-1!==B[s]?O[P+B[s]]=O[P+s]:O[R+O[z+s]]=O[P+s]);f!==l&&(M[f]=-l-2,O[U+f]=0)}for(0!==V&&(T=K),O[z+l]=Y,M[l]=$,O[0+l]=K-$,O[I+l]=-2,G=i(G,S,O,U,C),m=$;m<K;m++)if(!((v=O[I+(s=N[m])])<=0)){var X=G-(g=-O[k+s]);for(W=M[s],y=M[s]+v-1;W<=y;W++)O[U+(f=N[W])]>=G?O[U+f]-=g:0!==O[U+f]&&(O[U+f]=O[z+f]+X)}for(m=$;m<K;m++){for(D=0,x=(y=M[s=N[m]])+O[I+s]-1,b=y,_=0,W=y;W<=x;W++)if(0!==O[U+(f=N[W])]){var Z=O[U+f]-G;Z>0?(_+=Z,N[b++]=f,D+=f):(M[f]=-l-2,O[U+f]=0)}O[I+s]=b-y+1;var J=b,Q=y+O[0+s];for(W=x+1;W<Q;W++){var tt=O[k+(u=N[W])];tt<=0||(_+=tt,N[b++]=u,D+=u)}0===_?(M[s]=-l-2,Y-=g=-O[k+s],H+=g,q+=g,O[k+s]=0,O[I+s]=-1):(O[z+s]=Math.min(O[z+s],_),N[b]=N[J],N[J]=N[y],N[y]=l,O[0+s]=b-y+1,D=(D<0?-D:D)%C,O[P+s]=O[L+D],O[L+D]=s,B[s]=D)}for(O[z+l]=Y,G=i(G+(S=Math.max(S,Y)),S,O,U,C),m=$;m<K;m++)if(!(O[k+(s=N[m])]>=0))for(s=O[L+(D=B[s])],O[L+D]=-1;-1!==s&&-1!==O[P+s];s=O[P+s],G++){for(p=O[0+s],v=O[I+s],W=M[s]+1;W<=M[s]+p-1;W++)O[U+N[W]]=G;var te=s;for(u=O[P+s];-1!==u;){var tr=O[0+u]===p&&O[I+u]===v;for(W=M[u]+1;tr&&W<=M[u]+p-1;W++)O[U+N[W]]!==G&&(tr=0);tr?(M[u]=-s-2,O[k+s]+=O[k+u],O[k+u]=0,O[I+u]=-1,u=O[P+u],O[P+te]=u):(te=u,u=O[P+u])}}for(W=$,m=$;m<K;m++)(g=-O[k+(s=N[m])])<=0||(O[k+s]=g,_=Math.min(_=O[z+s]+Y-g,C-q-g),-1!==O[R+_]&&(B[O[R+_]]=s),O[P+s]=O[R+_],B[s]=-1,O[R+_]=s,j=Math.min(j,_),O[z+s]=_,N[W++]=s);O[k+l]=H,0==(O[0+l]=W-$)&&(M[l]=-1,O[U+l]=0),0!==V&&(T=W)}for(s=0;s<C;s++)M[s]=-M[s]-2;for(u=0;u<=C;u++)O[R+u]=-1;for(u=C;u>=0;u--)O[k+u]>0||(O[P+u]=O[R+M[u]],O[R+M[u]]=u);for(f=C;f>=0;f--)O[k+f]<=0||-1===M[f]||(O[P+f]=O[R+M[f]],O[R+M[f]]=f);for(l=0,s=0;s<=C;s++)-1===M[s]&&(l=sv(s,l,O,R,P,B,U));return B.splice(B.length-1,1),B};function i(t,e,r,n,i){if(t<2||t+e<0){for(var a=0;a<i;a++)0!==r[n+a]&&(r[n+a]=1);t=2}return t}function a(t,e){return t!==e}}),sx=/* #__PURE__ */nE("csCounts",["transpose"],t=>{var{transpose:e}=t;return function(t,r,n,i){if(!t||!r||!n)return null;var a,o,s,u,l,h,c,f=t._size,d=f[0],p=f[1],g=4*p+(i?p+d+1:0),m=[],v=2*p,y=3*p,x=4*p,b=5*p+1;for(s=0;s<g;s++)m[s]=-1;var D=[],_=e(t),w=_._index,E=_._ptr;for(s=0;s<p;s++)for(D[o=n[s]]=-1===m[y+o]?1:0;-1!==o&&-1===m[y+o];o=r[o])m[y+o]=s;if(i){for(s=0;s<p;s++)m[n[s]]=s;for(a=0;a<d;a++){for(s=p,h=E[a],c=E[a+1],l=h;l<c;l++)s=Math.min(s,m[w[l]]);m[b+a]=m[x+s],m[x+s]=a}}for(a=0;a<p;a++)m[0+a]=a;for(s=0;s<p;s++){for(-1!==r[o=n[s]]&&D[r[o]]--,u=i?m[x+s]:o;-1!==u;u=i?m[b+u]:-1)for(l=E[u];l<E[u+1];l++){var C=function(t,e,r,n,i,a,o){var s,u,l,h=0;if(t<=e||r[n+e]<=r[i+t])return -1;r[i+t]=r[n+e];var c=r[a+t];if(r[a+t]=e,-1===c)h=1,l=t;else{for(h=2,l=c;l!==r[0+l];l=r[0+l]);for(s=c;s!==l;s=u)u=r[0+s],r[o+s]=l}return{jleaf:h,q:l}}(a=w[l],o,m,y,p,v,0);C.jleaf>=1&&D[o]++,2===C.jleaf&&D[C.q]--}-1!==r[o]&&(m[0+o]=r[o])}for(o=0;o<p;o++)-1!==r[o]&&(D[r[o]]+=D[o]);return D}}),sb=/* #__PURE__ */nE("csSqr",["add","multiply","transpose"],t=>{var{add:e,multiply:r,transpose:n}=t,i=sy({add:e,multiply:r,transpose:n}),a=sx({transpose:n});return function(t,e,r){var n,o=e._ptr,s=e._size[1],u={};if(u.q=i(t,e),t&&!u.q)return null;if(r){var l=t?function(t,e,r,n){t._values;for(var i=t._index,a=t._ptr,o=t._size,s=t._datatype,u=o[0],l=o[1],h=[],c=[],f=0,d=0;d<l;d++){c[d]=f;for(var p=r?r[d]:d,g=a[p],m=a[p+1],v=g;v<m;v++){var y=i[v];h[f]=y,f++}}return c[l]=f,t.createSparseMatrix({values:null,index:h,ptr:c,size:[u,l],datatype:s})}(e,0,u.q,0):e;u.parent=function(t,e){if(!t)return null;var r,n,i=t._index,a=t._ptr,o=t._size,s=o[0],u=o[1],l=[],h=[];for(r=0;r<s;r++)h[u+r]=-1;for(var c=0;c<u;c++){l[c]=-1,h[0+c]=-1;for(var f=a[c],d=a[c+1],p=f;p<d;p++){var g=i[p];for(r=h[u+g];-1!==r&&r<c;r=n)n=h[0+r],h[0+r]=c,-1===n&&(l[r]=c);h[u+g]=c}}return l}(l,1);var h=function(t,e){if(!t)return null;var r,n=0,i=[],a=[],o=2*e;for(r=0;r<e;r++)a[0+r]=-1;for(r=e-1;r>=0;r--)-1!==t[r]&&(a[e+r]=a[0+t[r]],a[0+t[r]]=r);for(r=0;r<e;r++)-1===t[r]&&(n=sv(r,n,a,0,e,i,o));return i}(u.parent,s);if(u.cp=a(l,u.parent,h,1),l&&u.parent&&u.cp&&function(t,e){var r,n,i,a,o,s=t._ptr,u=t._index,l=t._size,h=l[0],c=l[1];e.pinv=[],e.leftmost=[];var f=e.parent,d=e.pinv,p=e.leftmost,g=[],m=h+c,v=h+2*c;for(n=0;n<c;n++)g[h+n]=-1,g[m+n]=-1,g[v+n]=0;for(r=0;r<h;r++)p[r]=-1;for(n=c-1;n>=0;n--)for(a=s[n],o=s[n+1],i=a;i<o;i++)p[u[i]]=n;for(r=h-1;r>=0;r--)d[r]=-1,-1!==(n=p[r])&&(0==g[v+n]++&&(g[m+n]=r),g[0+r]=g[h+n],g[h+n]=r);for(n=0,e.lnz=0,e.m2=h;n<c;n++)if(r=g[h+n],e.lnz++,r<0&&(r=e.m2++),d[r]=n,!(--v[n]<=0)){e.lnz+=g[v+n];var y=f[n];-1!==y&&(0===g[v+y]&&(g[m+y]=g[m+n]),g[0+g[m+n]]=g[h+y],g[h+y]=g[0+r],g[v+y]+=g[v+n])}for(r=0;r<h;r++)d[r]<0&&(d[r]=n++);return!0}(l,u))for(u.unz=0,n=0;n<s;n++)u.unz+=u.cp[n]}else u.unz=4*o[s]+s,u.lnz=u.unz;return u}});function sD(t,e){t[e]=-t[e]-2}function s_(t){return t<0?-t-2:t}var sw=/* #__PURE__ */nE("csSpsolve",["divideScalar","multiply","subtract"],t=>{var{divideScalar:e,multiply:r,subtract:n}=t;return function(t,i,a,o,s,u,l){var h,c,f,d,p=t._values,g=t._index,m=t._ptr,v=t._size[1],y=i._values,x=i._index,b=i._ptr,D=function(t,e,r,n,i){var a,o,s,u=t._ptr,l=t._size,h=e._index,c=e._ptr,f=l[1],d=f;for(o=c[r],s=c[r+1],a=o;a<s;a++){var p=h[a];u[p]<0||(d=function(t,e,r,n,i){var a,o,s,u=e._index,l=e._ptr,h=e._size[1],c=0;for(n[0]=t;c>=0;){t=n[c];var f=i?i[t]:t;l[t]<0||(sD(l,t),n[h+c]=f<0?0:s_(l[f]));var d=1;for(o=n[h+c],s=f<0?0:s_(l[f+1]);o<s;o++)if(!(l[a=u[o]]<0)){n[h+c]=o,n[++c]=a,d=0;break}d&&(c--,n[--r]=t)}return r}(p,t,d,n,i))}for(a=d;a<f;a++)sD(u,n[a]);return d}(t,i,a,o,u);for(h=D;h<v;h++)s[o[h]]=0;for(c=b[a],f=b[a+1],h=c;h<f;h++)s[x[h]]=y[h];for(var _=D;_<v;_++){var w=o[_],E=u?u[w]:w;if(!(E<0))for(c=m[E],f=m[E+1],s[w]=e(s[w],p[l?c:f-1]),h=l?c+1:c,d=l?f:f-1;h<d;h++){var C=g[h];s[C]=n(s[C],r(p[h],s[w]))}}return D}}),sE=/* #__PURE__ */nE("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],t=>{var{abs:e,divideScalar:r,multiply:n,subtract:i,larger:a,largerEq:o,SparseMatrix:s}=t,u=sw({divideScalar:r,multiply:n,subtract:i});return function(t,i,l){if(!t)return null;var h,c,f,d=t._size[1],p=100,g=100;i&&(h=i.q,p=i.lnz||p,g=i.unz||g);var m=[],v=[],y=[],x=new s({values:m,index:v,ptr:y,size:[d,d]}),b=[],D=[],_=[],w=new s({values:b,index:D,ptr:_,size:[d,d]}),E=[],C=[],S=[];for(c=0;c<d;c++)C[c]=0,E[c]=-1,y[c+1]=0;p=0,g=0;for(var A=0;A<d;A++){y[A]=p,_[A]=g;var F=h?h[A]:A,N=u(x,t,F,S,C,E,1),M=-1,T=-1;for(f=N;f<d;f++)if(E[c=S[f]]<0){var B=e(C[c]);a(B,T)&&(T=B,M=c)}else D[g]=E[c],b[g++]=C[c];if(-1===M||T<=0)return null;E[F]<0&&o(e(C[F]),n(T,l))&&(M=F);var O=C[M];for(D[g]=A,b[g++]=O,E[M]=A,v[p]=M,m[p++]=1,f=N;f<d;f++)E[c=S[f]]<0&&(v[p]=c,m[p++]=r(C[c],O)),C[c]=0}for(f=0,y[d]=p,_[d]=g;f<p;f++)v[f]=E[v[f]];return m.splice(p,m.length-p),v.splice(p,v.length-p),b.splice(g,b.length-g),D.splice(g,D.length-g),{L:x,U:w,pinv:E}}}),sC=/* #__PURE__ */nE("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],t=>{var{typed:e,abs:r,add:n,multiply:i,transpose:a,divideScalar:o,subtract:s,larger:u,largerEq:l,SparseMatrix:h}=t,c=sb({add:n,multiply:i,transpose:a}),f=sE({abs:r,divideScalar:o,multiply:i,subtract:s,larger:u,largerEq:l,SparseMatrix:h});return e("slu",{"SparseMatrix, number, number":function(t,e,r){if(!nF(e)||e<0||e>3)throw Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(r<0||r>1)throw Error("Partial pivoting threshold must be a number from 0 to 1");var n=c(e,t,!1),i=f(t,n,r);return{L:i.L,U:i.U,p:i.pinv,q:n.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})}),sS="subset",sA=/* #__PURE__ */nE(sS,["typed","matrix","zeros","add"],t=>{var{typed:e,matrix:r,zeros:n,add:i}=t;return e(sS,{"Matrix, Index":function(t,e){return il(e)?r():(is(t,e),t.subset(e))},"Array, Index":e.referTo("Matrix, Index",function(t){return function(e,n){var i=t(r(e),n);return n.isScalar()?i:i.valueOf()}}),"Object, Index":sM,"string, Index":sF,"Matrix, Index, any, any":function(t,e,r,a){return il(e)?t:(is(t,e),t.clone().subset(e,function(t,e){if("string"==typeof t)throw Error("can't boradcast a string");if(e._isScalar)return t;var r=e.size();if(!r.every(t=>t>0))return t;try{return i(t,n(r))}catch(e){return t}}(r,e),a))},"Array, Index, any, any":e.referTo("Matrix, Index, any, any",function(t){return function(e,n,i,a){var o=t(r(e),n,i,a);return o.isMatrix?o.valueOf():o}}),"Array, Index, any":e.referTo("Matrix, Index, any, any",function(t){return function(e,n,i){return t(r(e),n,i,void 0).valueOf()}}),"Matrix, Index, any":e.referTo("Matrix, Index, any, any",function(t){return function(e,r,n){return t(e,r,n,void 0)}}),"string, Index, string":sN,"string, Index, string, string":sN,"Object, Index, any":sT})});function sF(t,e){if(!r0(e))throw TypeError("Index expected");if(il(e))return"";if(is(Array.from(t),e),1!==e.size().length)throw new ir(e.size().length,1);var r=t.length;iu(e.min()[0],r),iu(e.max()[0],r);var n=e.dimension(0),i="";return n.forEach(function(e){i+=t.charAt(e)}),i}function sN(t,e,r,n){if(!e||!0!==e.isIndex)throw TypeError("Index expected");if(il(e))return t;if(is(Array.from(t),e),1!==e.size().length)throw new ir(e.size().length,1);if(void 0!==n){if("string"!=typeof n||1!==n.length)throw TypeError("Single character expected as defaultValue")}else n=" ";var i=e.dimension(0);if(i.size()[0]!==r.length)throw new ir(i.size()[0],r.length);var a=t.length;iu(e.min()[0]),iu(e.max()[0]);for(var o=[],s=0;s<a;s++)o[s]=t.charAt(s);if(i.forEach(function(t,e){o[t]=r.charAt(e[0])}),o.length>a)for(var u=a-1,l=o.length;u<l;u++)o[u]||(o[u]=n);return o.join("")}function sM(t,e){if(!il(e)){if(1!==e.size().length)throw new ir(e.size(),1);var r=e.dimension(0);if("string"!=typeof r)throw TypeError("String expected as index to retrieve an object property");return rP(t,r)}}function sT(t,e,r){if(il(e))return t;if(1!==e.size().length)throw new ir(e.size(),1);var n=e.dimension(0);if("string"!=typeof n)throw TypeError("String expected as index to retrieve an object property");var i=rT(t);return rR(i,n,r),i}var sB="usolveAll",sO=/* #__PURE__ */nE(sB,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=t,u=oV({DenseMatrix:s});return e(sB,{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var r=[u(t,e,!0)._data.map(t=>t[0])],l=t._size[0],h=t._size[1],c=t._values,f=t._index,d=t._ptr,p=h-1;p>=0;p--)for(var g=r.length,m=0;m<g;m++){for(var v=r[m],y=[],x=[],b=d[p],D=d[p+1],_=0,w=D-1;w>=b;w--){var E=f[w];E===p?_=c[w]:E<p&&(y.push(c[w]),x.push(E))}if(o(_,0)){if(o(v[p],0)){if(0===m){var C=[...v];C[p]=1;for(var S=0,A=x.length;S<A;S++){var F=x[S];C[F]=a(C[F],y[S])}r.push(C)}}else{if(0===m)return[];r.splice(m,1),m-=1,g-=1}}else{v[p]=n(v[p],_);for(var N=0,M=x.length;N<M;N++){var T=x[N];v[T]=a(v[T],i(v[p],y[N]))}}}return r.map(t=>new s({data:t.map(t=>[t]),size:[l,1]}))}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return l(t,e)},"Array, Array | Matrix":function(t,e){return l(r(t),e).map(t=>t.valueOf())}});function l(t,e){for(var r=[u(t,e,!0)._data.map(t=>t[0])],l=t._data,h=t._size[0],c=t._size[1],f=c-1;f>=0;f--)for(var d=r.length,p=0;p<d;p++){var g=r[p];if(o(l[f][f],0)){if(o(g[f],0)){if(0===p){var m=[...g];m[f]=1;for(var v=f-1;v>=0;v--)m[v]=a(m[v],l[v][f]);r.push(m)}}else{if(0===p)return[];r.splice(p,1),p-=1,d-=1}}else{g[f]=n(g[f],l[f][f]);for(var y=f-1;y>=0;y--)g[y]=a(g[y],i(g[f],l[y][f]))}}return r.map(t=>new s({data:t.map(t=>[t]),size:[h,1]}))}}),sk="ceil",sP=/* #__PURE__ */nE(sk,["typed","config","round"],t=>{var{typed:e,config:r,round:n}=t;return e(sk,{number:function(t){return nq(t,n(t),r.relTol,r.absTol)?n(t):Math.ceil(t)},"number, number":function(t,e){if(nq(t,n(t,e),r.relTol,r.absTol))return n(t,e);var[i,a]="".concat(t,"e").split("e"),o=Math.ceil(Number("".concat(i,"e").concat(Number(a)+e)));return[i,a]="".concat(o,"e").split("e"),Number("".concat(i,"e").concat(Number(a)-e))}})}),sR=/* #__PURE__ */nE(sk,["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],t=>{var{typed:e,config:r,round:i,matrix:a,equalScalar:o,zeros:s,DenseMatrix:u}=t,l=oA({typed:e,equalScalar:o}),h=oF({typed:e,DenseMatrix:u}),c=oM({typed:e}),f=sP({typed:e,config:r,round:i});return e("ceil",{number:f.signatures.number,"number,number":f.signatures["number,number"],Complex:function(t){return t.ceil()},"Complex, number":function(t,e){return t.ceil(e)},"Complex, BigNumber":function(t,e){return t.ceil(e.toNumber())},BigNumber:function(t){return al(t,i(t),r.relTol,r.absTol)?i(t):t.ceil()},"BigNumber, BigNumber":function(t,e){return al(t,i(t,e),r.relTol,r.absTol)?i(t,e):t.toDecimalPlaces(e.toNumber(),/*@__PURE__*/n(nw).ROUND_CEIL)},Fraction:function(t){return t.ceil()},"Fraction, number":function(t,e){return t.ceil(e)},"Fraction, BigNumber":function(t,e){return t.ceil(e.toNumber())},"Unit, number, Unit":e.referToSelf(t=>function(e,r,n){var i=e.toNumeric(n);return n.multiply(t(i,r))}),"Unit, BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>t(e,r.toNumber(),n)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>iI(e,e=>t(e,r,n),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(t=>(e,r)=>t(e,0,r)),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t,!0)),"Array, number | BigNumber":e.referToSelf(t=>(e,r)=>iI(e,e=>t(e,r),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>l(e,r,t,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(t=>(e,r)=>c(e,r,t,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(t=>(e,r)=>c(a(r),e,t,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(t=>(e,r)=>o(e,0)?s(r.size(),r.storage()):"dense"===r.storage()?c(r,e,t,!0):h(r,e,t,!0))})}),sI={};sI=function t(e,r){var n,i,a=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,u=/^0x[0-9a-f]+$/i,l=/^0/,h=function(e){return t.insensitive&&(""+e).toLowerCase()||""+e},c=h(e).replace(o,"")||"",f=h(r).replace(o,"")||"",d=c.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=f.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=parseInt(c.match(u),16)||1!==d.length&&c.match(s)&&Date.parse(c),m=parseInt(f.match(u),16)||g&&f.match(s)&&Date.parse(f)||null;if(m){if(g<m)return -1;if(g>m)return 1}for(var v=0,y=Math.max(d.length,p.length);v<y;v++){if(n=!(d[v]||"").match(l)&&parseFloat(d[v])||d[v]||0,i=!(p[v]||"").match(l)&&parseFloat(p[v])||p[v]||0,isNaN(n)!==isNaN(i))return isNaN(n)?1:-1;if(typeof n!=typeof i&&(n+="",i+=""),n<i)return -1;if(n>i)return 1}return 0};var sz="compareNatural",sU=/* #__PURE__ */nE(sz,["typed","compare"],t=>{var{typed:e,compare:r}=t,i=r.signatures["boolean,boolean"];return e(sz,{"any, any":function t(e,o){var s,u=ny(e),l=ny(o);if(("number"===u||"BigNumber"===u||"Fraction"===u)&&("number"===l||"BigNumber"===l||"Fraction"===l))return"0"!==(s=r(e,o)).toString()?s>0?1:-1:/*@__PURE__*/n(sI)(u,l);var h=["Array","DenseMatrix","SparseMatrix"];if(h.includes(u)||h.includes(l))return 0!==(s=function t(e,r,n){return rJ(r)&&rJ(n)?a(e,r.toJSON().values,n.toJSON().values):rJ(r)?t(e,r.toArray(),n):rJ(n)?t(e,r,n.toArray()):rZ(r)?t(e,r.toJSON().data,n):rZ(n)?t(e,r,n.toJSON().data):Array.isArray(r)?Array.isArray(n)?a(e,r,n):t(e,r,[n]):t(e,[r],n)}(t,e,o))?s:/*@__PURE__*/n(sI)(u,l);if(u!==l)return /*@__PURE__*/n(sI)(u,l);if("Complex"===u)return e.re>o.re?1:e.re<o.re?-1:e.im>o.im?1:e.im<o.im?-1:0;if("Unit"===u)return e.equalBase(o)?t(e.value,o.value):a(t,e.formatUnits(),o.formatUnits());if("boolean"===u)return i(e,o);if("string"===u)return /*@__PURE__*/n(sI)(e,o);if("Object"===u)return function(t,e,r){var i=Object.keys(e),o=Object.keys(r);i.sort(/*@__PURE__*/n(sI)),o.sort(/*@__PURE__*/n(sI));var s=a(t,i,o);if(0!==s)return s;for(var u=0;u<i.length;u++){var l=t(e[i[u]],r[o[u]]);if(0!==l)return l}return 0}(t,e,o);if("null"===u||"undefined"===u)return 0;throw TypeError('Unsupported type of value "'+u+'"')}});function a(t,e,r){for(var n=0,i=Math.min(e.length,r.length);n<i;n++){var a=t(e[n],r[n]);if(0!==a)return a}return e.length>r.length?1:e.length<r.length?-1:0}}),sL=/* #__PURE__ */nE("det",["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],t=>{var{typed:e,matrix:r,subtractScalar:n,multiply:i,divideScalar:a,isZero:o,unaryMinus:s}=t;return e("det",{any:function(t){return rT(t)},"Array | Matrix":function(t){var e;switch((e=rK(t)?t.size():Array.isArray(t)?(t=r(t)).size():[]).length){case 0:return rT(t);case 1:if(1===e[0])return rT(t.valueOf()[0]);if(0===e[0])return 1;throw RangeError("Matrix must be square (size: "+n9(e)+")");case 2:var u=e[0],l=e[1];if(u===l)return function(t,e,r){if(1===e)return rT(t[0][0]);if(2===e)return n(i(t[0][0],t[1][1]),i(t[1][0],t[0][1]));for(var u=!1,l=Array(e).fill(0).map((t,e)=>e),h=0;h<e;h++){var c=l[h];if(o(t[c][h])){var f=void 0;for(f=h+1;f<e;f++)if(!o(t[l[f]][h])){c=l[f],l[f]=l[h],l[h]=c,u=!u;break}if(f===e)return t[c][h]}for(var d=t[c][h],p=0===h?1:t[l[h-1]][h-1],g=h+1;g<e;g++)for(var m=l[g],v=h+1;v<e;v++)t[m][v]=a(n(i(t[m][v],d),i(t[m][h],t[c][v])),p)}var y=t[l[e-1]][e-1];return u?s(y):y}(t.clone().valueOf(),u,0);if(0===l)return 1;throw RangeError("Matrix must be square (size: "+n9(e)+")");default:throw RangeError("Matrix must be two dimensional (size: "+n9(e)+")")}}})}),sG=/* #__PURE__ */nE("FibonacciHeap",["smaller","larger"],t=>{var{smaller:e,larger:r}=t,n=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function a(t,e,r){e.left.right=e.right,e.right.left=e.left,r.degree--,r.child===e&&(r.child=e.right),0===r.degree&&(r.child=null),e.left=t,e.right=t.right,t.right=e,e.right.left=e,e.parent=null,e.mark=!1}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(t,r){var n={key:t,value:r,degree:0};if(this._minimum){var i=this._minimum;n.left=i,n.right=i.right,i.right=n,n.right.left=n,e(t,i.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var t=this._minimum;if(null===t)return t;for(var i=this._minimum,a=t.degree,s=t.child;a>0;){var u=s.right;s.left.right=s.right,s.right.left=s.left,s.left=i,s.right=i.right,i.right=s,s.right.left=s,s.parent=null,s=u,a--}return t.left.right=t.right,t.right.left=t.left,i=t===t.right?null:function(t,i){var a,s=Math.floor(Math.log(i)*n)+1,u=Array(s),l=0,h=t;if(h)for(l++,h=h.right;h!==t;)l++,h=h.right;for(;l>0;){for(var c=h.degree,f=h.right;a=u[c];){if(r(h.key,a.key)){var d=a;a=h,h=d}o(a,h),u[c]=null,c++}u[c]=h,h=f,l--}t=null;for(var p=0;p<s;p++)(a=u[p])&&(t?(a.left.right=a.right,a.right.left=a.left,a.left=t,a.right=t.right,t.right=a,a.right.left=a,e(a.key,t.key)&&(t=a)):t=a);return t}(i=t.right,this._size),this._size--,this._minimum=i,t},i.prototype.remove=function(t){var r,n;this._minimum=(r=this._minimum,t.key=-1,(n=t.parent)&&e(t.key,n.key)&&(a(r,t,n),function t(e,r){var n=r.parent;n&&(r.mark?(a(e,r,n),t(n)):r.mark=!0)}(r,n)),e(t.key,r.key)&&(r=t),r),this.extractMinimum()};var o=function(t,e){t.left.right=t.right,t.right.left=t.left,t.parent=e,e.child?(t.left=e.child,t.right=e.child.right,e.child.right=t,t.right.left=t):(e.child=t,t.right=t,t.left=t),e.degree++,t.mark=!1};return i},{isClass:!0}),sq=/* #__PURE__ */nE("fix",["typed","ceil","floor"],t=>{var{typed:e,ceil:r,floor:n}=t;return e("fix",{number:function(t){return t>0?n(t):r(t)},"number, number":function(t,e){return t>0?n(t,e):r(t,e)}})}),sj=(t=>{var{typed:e,Complex:r,matrix:n,ceil:i,floor:a,equalScalar:o,zeros:s,DenseMatrix:u}=t,l=oF({typed:e,DenseMatrix:u}),h=oM({typed:e}),c=sq({typed:e,ceil:i,floor:a});return e("fix",{number:c.signatures.number,"number, number | BigNumber":c.signatures["number,number"],Complex:function(t){return new r(t.re>0?Math.floor(t.re):Math.ceil(t.re),t.im>0?Math.floor(t.im):Math.ceil(t.im))},"Complex, number":function(t,e){return new r(t.re>0?a(t.re,e):i(t.re,e),t.im>0?a(t.im,e):i(t.im,e))},"Complex, BigNumber":function(t,e){var n=e.toNumber();return new r(t.re>0?a(t.re,n):i(t.re,n),t.im>0?a(t.im,n):i(t.im,n))},BigNumber:function(t){return t.isNegative()?i(t):a(t)},"BigNumber, number | BigNumber":function(t,e){return t.isNegative()?i(t,e):a(t,e)},Fraction:function(t){return t.s<0n?t.ceil():t.floor()},"Fraction, number | BigNumber":function(t,e){return t.s<0n?i(t,e):a(t,e)},"Unit, number, Unit":e.referToSelf(t=>function(e,r,n){var i=e.toNumeric(n);return n.multiply(t(i,r))}),"Unit, BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>t(e,r.toNumber(),n)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(t=>(e,r,n)=>iI(e,e=>t(e,r,n),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(t=>(e,r)=>t(e,0,r)),"Array | Matrix":e.referToSelf(t=>e=>iI(e,t,!0)),"Array | Matrix, number | BigNumber":e.referToSelf(t=>(e,r)=>iI(e,e=>t(e,r),!0)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(t=>(e,r)=>h(n(r),e,t,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(t=>(e,r)=>o(e,0)?s(r.size(),r.storage()):"dense"===r.storage()?h(r,e,t,!0):l(r,e,t,!0))})},"index");t=>{var{typed:e,Index:r}=t;return e(sj,{"...number | string | BigNumber | Range | Array | Matrix":function(t){var e=t.map(function(t){return rq(t)?t.toNumber():r$(t)||rK(t)?t.map(function(t){return rq(t)?t.toNumber():t}):t}),n=new r;return r.apply(n,e),n}})};var sV="smallerEq",sH=/* #__PURE__ */nE(sV,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=t,s=oC({typed:e}),u=oS({typed:e,SparseMatrix:o}),l=oF({typed:e,DenseMatrix:i}),h=oB({typed:e,matrix:n,concat:a}),c=ah({typed:e});return e(sV,sY({typed:e,config:r}),{"boolean, boolean":(t,e)=>t<=e,"BigNumber, BigNumber":function(t,e){return t.lte(e)||al(t,e,r.relTol,r.absTol)},"bigint, bigint":(t,e)=>t<=e,"Fraction, Fraction":(t,e)=>1!==t.compare(e),"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},c,h({SS:u,DS:s,Ss:l}))}),sY=/* #__PURE__ */nE(sV,["typed","config"],t=>{var{typed:e,config:r}=t;return e(sV,{"number, number":function(t,e){return t<=e||nq(t,e,r.relTol,r.absTol)}})}),sW="unequal",s$=(nE(sW,["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return e(sW,{"any, any":function(t,e){return null===t?null!==e:null===e?null!==t:void 0===t?void 0!==e:void 0===e?void 0!==t:!r(t,e)}})}),"range"),sK=/* #__PURE__ */nE(s$,["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],t=>{var{typed:e,config:r,matrix:n,bignumber:i,smaller:a,smallerEq:o,larger:s,largerEq:u,add:l,isPositive:h}=t;return e(s$,{string:f,"string, boolean":f,"number, number":function(t,e){return c(d(t,e,1,!1))},"number, number, number":function(t,e,r){return c(d(t,e,r,!1))},"number, number, boolean":function(t,e,r){return c(d(t,e,1,r))},"number, number, number, boolean":function(t,e,r,n){return c(d(t,e,r,n))},"BigNumber, BigNumber":function(t,e){var r=t.constructor;return c(d(t,e,new r(1),!1))},"BigNumber, BigNumber, BigNumber":function(t,e,r){return c(d(t,e,r,!1))},"BigNumber, BigNumber, boolean":function(t,e,r){var n=t.constructor;return c(d(t,e,new n(1),r))},"BigNumber, BigNumber, BigNumber, boolean":function(t,e,r,n){return c(d(t,e,r,n))},"Unit, Unit, Unit":function(t,e,r){return c(d(t,e,r,!1))},"Unit, Unit, Unit, boolean":function(t,e,r,n){return c(d(t,e,r,n))}});function c(t){return"Matrix"===r.matrix?n?n(t):oa():t}function f(t,e){var n=function(t){var e=t.split(":").map(function(t){return Number(t)});if(e.some(function(t){return isNaN(t)}))return null;switch(e.length){case 2:return{start:e[0],end:e[1],step:1};case 3:return{start:e[0],end:e[2],step:e[1]};default:return null}}(t);if(!n)throw SyntaxError('String "'+t+'" is no valid range');return"BigNumber"===r.number?(void 0===i&&on(),c(d(i(n.start),i(n.end),i(n.step)),e)):c(d(n.start,n.end,n.step,e))}function d(t,e,r,n){for(var i=[],c=h(r)?n?o:a:n?u:s,f=t;c(f,e);)i.push(f),f=l(f,r);return i}}),sX="setDifference",sZ=(t=>{var{typed:e,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:o}=t;return e(sX,{"Array | Matrix, Array | Matrix":function(t,e){var s;if(0===n(r(t),new a(0)))s=[];else{if(0===n(r(e),new a(0)))return im(t.toArray());var u,l=iv(im(Array.isArray(t)?t:t.toArray()).sort(i)),h=iv(im(Array.isArray(e)?e:e.toArray()).sort(i));s=[];for(var c=0;c<l.length;c++){u=!1;for(var f=0;f<h.length;f++)if(0===i(l[c].value,h[f].value)&&l[c].identifier===h[f].identifier){u=!0;break}u||s.push(l[c])}}return Array.isArray(t)&&Array.isArray(e)?iy(s):new o(iy(s))}})},/* #__PURE__ */nE("Spa",["addScalar","equalScalar","FibonacciHeap"],t=>{var{addScalar:e,equalScalar:r,FibonacciHeap:n}=t;function i(){if(!(this instanceof i))throw SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new n}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(t,e){if(this._values[t])this._values[t].value=e;else{var r=this._heap.insert(t,e);this._values[t]=r}},i.prototype.get=function(t){var e=this._values[t];return e?e.value:0},i.prototype.accumulate=function(t,r){var n=this._values[t];n?n.value=e(n.value,r):(n=this._heap.insert(t,r),this._values[t]=n)},i.prototype.forEach=function(t,e,n){var i=this._heap,a=this._values,o=[],s=i.extractMinimum();for(s&&o.push(s);s&&s.key<=e;)s.key>=t&&!r(s.value,0)&&n(s.key,s.value,this),(s=i.extractMinimum())&&o.push(s);for(var u=0;u<o.length;u++){var l=o[u];a[(s=i.insert(l.key,l.value)).key]=s}},i.prototype.swap=function(t,e){var r=this._values[t],n=this._values[e];if(!r&&n)r=this._heap.insert(t,n.value),this._heap.remove(n),this._values[t]=r,this._values[e]=void 0;else if(r&&!n)n=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=n,this._values[t]=void 0;else if(r&&n){var i=r.value;r.value=n.value,n.value=i}},i},{isClass:!0})),sJ="column",sQ=/* #__PURE__ */nE(sJ,["typed","Index","matrix","range"],t=>{var{typed:e,Index:r,matrix:n,range:i}=t;return e(sJ,{"Matrix, number":a,"Array, number":function(t,e){return a(n(rT(t)),e).valueOf()}});function a(t,e){if(2!==t.size().length)throw Error("Only two dimensional matrix is supported");iu(e,t.size()[1]);var a=new r(i(0,t.size()[0]),e),o=t.subset(a);return rK(o)?o:n([[o]])}}),s0=/* #__PURE__ */nE("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],t=>{var{typed:e,matrix:r,divideScalar:n,addScalar:i,multiply:a,unaryMinus:o,det:s,identity:u,abs:l}=t;return e("inv",{"Array | Matrix":function(t){var e=rK(t)?t.size():ia(t);switch(e.length){case 1:if(1===e[0]){if(rK(t))return r([n(1,t.valueOf()[0])]);return[n(1,t[0])]}throw RangeError("Matrix must be square (size: "+n9(e)+")");case 2:var i=e[0],a=e[1];if(i===a){if(rK(t))return r(h(t.valueOf(),i,a),t.storage());return h(t,i,a)}throw RangeError("Matrix must be square (size: "+n9(e)+")");default:throw RangeError("Matrix must be two dimensional (size: "+n9(e)+")")}},any:function(t){return n(1,t)}});function h(t,e,r){if(1===e){if(0===(d=t[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,d)]]}if(2===e){var h,c,f,d,p,g=s(t);if(0===g)throw Error("Cannot calculate inverse, determinant is zero");return[[n(t[1][1],g),n(o(t[0][1]),g)],[n(o(t[1][0]),g),n(t[0][0],g)]]}var m=t.concat();for(h=0;h<e;h++)m[h]=m[h].concat();for(var v=u(e).valueOf(),y=0;y<r;y++){var x=l(m[y][y]),b=y;for(h=y+1;h<e;)l(m[h][y])>x&&(x=l(m[h][y]),b=h),h++;if(0===x)throw Error("Cannot calculate inverse, determinant is zero");(h=b)!==y&&(p=m[y],m[y]=m[h],m[h]=p,p=v[y],v[y]=v[h],v[h]=p);var D=m[y],_=v[y];for(h=0;h<e;h++){var w=m[h],E=v[h];if(h!==y){if(0!==w[y]){for(f=n(o(w[y]),D[y]),c=y;c<r;c++)w[c]=i(w[c],a(f,D[c]));for(c=0;c<r;c++)E[c]=i(E[c],a(f,_[c]))}}else{for(f=D[y],c=y;c<r;c++)w[c]=n(w[c],f);for(c=0;c<r;c++)E[c]=n(E[c],f)}}}return v}}),s1=/* #__PURE__ */nE("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],t=>{var{typed:e,matrix:r,abs:n,addScalar:i,divideScalar:a,multiplyScalar:o,subtractScalar:s,larger:u,equalScalar:l,unaryMinus:h,DenseMatrix:c,SparseMatrix:f,Spa:d}=t;return e("lup",{DenseMatrix:function(t){return p(t)},SparseMatrix:function(t){return function(t){var e,r,i,s=t._size[0],c=t._size[1],p=Math.min(s,c),g=t._values,m=t._index,v=t._ptr,y=[],x=[],b=[],D=[s,p],_=[],w=[],E=[],C=[p,c],S=[],A=[];for(e=0;e<s;e++)S[e]=e,A[e]=e;var F=function(t,e){var r=A[t],n=A[e];S[r]=e,S[n]=t,A[t]=n,A[e]=r};for(r=0;r<c;r++)!function(){var t=new d;r<s&&(b.push(y.length),y.push(1),x.push(r)),E.push(_.length);var c=v[r],p=v[r+1];for(i=c;i<p;i++)e=m[i],t.set(S[e],g[i]);r>0&&t.forEach(0,r-1,function(e,r){f._forEachRow(e,y,x,b,function(n,i){n>e&&t.accumulate(n,h(o(i,r)))})});var A=r,N=t.get(r),M=n(N);t.forEach(r+1,s-1,function(t,e){var r=n(e);u(r,M)&&(A=t,M=r,N=e)}),r!==A&&(f._swapRows(r,A,D[1],y,x,b),f._swapRows(r,A,C[1],_,w,E),t.swap(r,A),F(r,A)),t.forEach(0,s-1,function(t,e){t<=r?(_.push(e),w.push(t)):l(e=a(e,N),0)||(y.push(e),x.push(t))})}();return E.push(_.length),b.push(y.length),{L:new f({values:y,index:x,ptr:b,size:D}),U:new f({values:_,index:w,ptr:E,size:C}),p:S,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}(t)},Array:function(t){var e=p(r(t));return{L:e.L.valueOf(),U:e.U.valueOf(),p:e.p}}});function p(t){var e,r,h,f=t._size[0],d=t._size[1],p=Math.min(f,d),g=rT(t._data),m=[],v=[f,p],y=[],x=[p,d],b=[];for(e=0;e<f;e++)b[e]=e;for(r=0;r<d;r++){if(r>0)for(e=0;e<f;e++){var D=Math.min(e,r),_=0;for(h=0;h<D;h++)_=i(_,o(g[e][h],g[h][r]));g[e][r]=s(g[e][r],_)}var w=r,E=0,C=0;for(e=r;e<f;e++){var S=g[e][r],A=n(S);u(A,E)&&(w=e,E=A,C=S)}if(r!==w&&(b[r]=[b[w],b[w]=b[r]][0],c._swapRows(r,w,g)),r<f)for(e=r+1;e<f;e++)l(g[e][r],0)||(g[e][r]=a(g[e][r],C))}for(r=0;r<d;r++)for(e=0;e<f;e++){if(0===r&&(e<d&&(y[e]=[]),m[e]=[]),e<r){e<d&&(y[e][r]=g[e][r]),r<f&&(m[e][r]=0);continue}if(e===r){e<d&&(y[e][r]=g[e][r]),r<f&&(m[e][r]=1);continue}e<d&&(y[e][r]=0),r<f&&(m[e][r]=g[e][r])}var F=new c({data:m,size:v}),N=new c({data:y,size:x}),M=[];for(e=0,p=b.length;e<p;e++)M[b[e]]=e;return{L:F,U:N,p:M,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}}),s2=/* #__PURE__ */nE("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],t=>{var{typed:e,config:r,identity:n,multiply:i,matrix:a,inv:o,number:s,fraction:u,Complex:l}=t;return e("pow",{"number, number":h,"Complex, Complex":function(t,e){return t.pow(e)},"BigNumber, BigNumber":function(t,e){return e.isInteger()||t>=0||r.predictable?t.pow(e):new l(t.toNumber(),0).pow(e.toNumber(),0)},"bigint, bigint":(t,e)=>t**e,"Fraction, Fraction":function(t,e){var n=t.pow(e);if(null!=n)return n;if(!r.predictable)return h(t.valueOf(),e.valueOf());throw Error("Result of pow is non-rational and cannot be expressed as a fraction")},"Array, number":c,"Array, BigNumber":function(t,e){return c(t,e.toNumber())},"Matrix, number":f,"Matrix, BigNumber":function(t,e){return f(t,e.toNumber())},"Unit, number | BigNumber":function(t,e){return t.pow(e)}});function h(t,e){if(r.predictable&&!nF(e)&&t<0)try{var n=u(e),i=s(n);if((e===i||1e-14>Math.abs((e-i)/e))&&n.d%2n===1n)return(n.n%2n===0n?1:-1)*Math.pow(-t,e)}catch(t){}return r.predictable&&(t<-1&&e===1/0||t>-1&&t<0&&e===-1/0)?NaN:nF(e)||t>=0||r.predictable?iQ(t,e):t*t<1&&e===1/0||t*t>1&&e===-1/0?0:new l(t,0).pow(e,0)}function c(t,e){if(!nF(e))throw TypeError("For A^b, b must be an integer (value is "+e+")");var r=ia(t);if(2!==r.length)throw Error("For A^b, A must be 2 dimensional (A has "+r.length+" dimensions)");if(r[0]!==r[1])throw Error("For A^b, A must be square (size is "+r[0]+"x"+r[1]+")");if(e<0)try{return c(o(t),-e)}catch(t){if("Cannot calculate inverse, determinant is zero"===t.message)throw TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+e+")");throw t}for(var a=n(r[0]).valueOf(),s=t;e>=1;)(1&e)==1&&(a=i(s,a)),e>>=1,s=i(s,s);return a}function f(t,e){return a(c(t.valueOf(),e))}}),s5={},s3={},s4={};function s8(t){return(s4=s8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}).__esModule=!0,s4.default=s4,s8(t)}(s4=s8).__esModule=!0,s4.default=s4;var s6=s4.default,s9={},s7=s4.default;function ut(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function ue(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(r),!0).forEach(function(e){/*@__PURE__*/n(s5)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}(s9=function(t,e){if("object"!=s7(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=s7(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}).__esModule=!0,s9.default=s9,(s3=function(t){var e=s9(t,"string");return"symbol"==s6(e)?e:e+""}).__esModule=!0,s3.default=s3,(s5=function(t,e,r){return(e=s3(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}).__esModule=!0,s5.default=s5,t=>{var e,r,i,{on:a,config:o,addScalar:s,subtractScalar:u,multiplyScalar:l,divideScalar:h,pow:c,abs:f,fix:d,round:p,equal:g,isNumeric:m,format:v,number:y,Complex:x,BigNumber:b,Fraction:D}=t;function _(t,e){if(!(this instanceof _))throw Error("Constructor must be called with the new operator");if(!(null==t||m(t)||rV(t)))throw TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=!1,this.skipAutomaticSimplification=!0,void 0===e)this.units=[],this.dimensions=B.map(t=>0);else if("string"==typeof e){var r=_.parse(e);this.units=r.units,this.dimensions=r.dimensions}else if(rY(e)&&null===e.value)this.fixPrefix=e.fixPrefix,this.skipAutomaticSimplification=e.skipAutomaticSimplification,this.dimensions=e.dimensions.slice(0),this.units=e.units.map(t=>/*@__PURE__*/n(nx)({},t));else throw TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.value=this._normalize(t)}function w(){for(;" "===i||"	"===i;)C()}function E(t){return t>="0"&&t<="9"}function C(){r++,i=e.charAt(r)}function S(t){r=t,i=e.charAt(r)}function A(){var t,e="",n=r;if("+"===i?C():"-"===i&&(e+=i,C()),!((t=i)>="0"&&t<="9"||"."===t))return S(n),null;if("."===i){if(e+=i,C(),!E(i))return S(n),null}else{for(;E(i);)e+=i,C();"."===i&&(e+=i,C())}for(;E(i);)e+=i,C();if("E"===i||"e"===i){var a="",o=r;if(a+=i,C(),("+"===i||"-"===i)&&(a+=i,C()),!E(i))return S(o),e;for(e+=a;E(i);)e+=i,C()}return e}function F(t){return i===t?(C(),t):null}Object.defineProperty(_,"name",{value:"Unit"}),_.prototype.constructor=_,_.prototype.type="Unit",_.prototype.isUnit=!0,_.parse=function(t,n){if(n=n||{},r=-1,i="","string"!=typeof(e=t))throw TypeError("Invalid argument in Unit.parse, string expected");var a=new _;a.units=[];var s=1,u=!1;C(),w();var l=A(),h=null;if(l){if("BigNumber"===o.number)h=new b(l);else if("Fraction"===o.number)try{h=new D(l)}catch(t){h=parseFloat(l)}else h=parseFloat(l);w(),F("*")?(s=1,u=!0):F("/")&&(s=-1,u=!0)}for(var c=[],f=1;;){for(w();"("===i;)c.push(s),f*=s,s=1,C(),w();var d=void 0;if(i){var p=i;if(null===(d=function(){for(var t="";E(i)||_.isValidAlpha(i);)t+=i,C();var e=t.charAt(0);return _.isValidAlpha(e)?t:null}()))throw SyntaxError('Unexpected "'+p+'" in "'+e+'" at index '+r.toString())}else break;var g=N(d);if(null===g)throw SyntaxError('Unit "'+d+'" not found.');var m=s*f;if(w(),F("^")){w();var v=A();if(null===v)throw SyntaxError('In "'+t+'", "^" must be followed by a floating-point number');m*=v}a.units.push({unit:g.unit,prefix:g.prefix,power:m});for(var y=0;y<B.length;y++)a.dimensions[y]+=(g.unit.dimensions[y]||0)*m;for(w();")"===i;){if(0===c.length)throw SyntaxError('Unmatched ")" in "'+e+'" at index '+r.toString());f/=c.pop(),C(),w()}if(u=!1,F("*")?(s=1,u=!0):F("/")?(s=-1,u=!0):s=1,g.unit.base){var x=g.unit.base.key;U.auto[x]={unit:g.unit,prefix:g.prefix}}}if(w(),i)throw SyntaxError('Could not parse: "'+t+'"');if(u)throw SyntaxError('Trailing characters: "'+t+'"');if(0!==c.length)throw SyntaxError('Unmatched "(" in "'+e+'"');if(0===a.units.length&&!n.allowNoUnits)throw SyntaxError('"'+t+'" contains no units');return a.value=void 0!==h?a._normalize(h):null,a},_.prototype.clone=function(){var t=new _;t.fixPrefix=this.fixPrefix,t.skipAutomaticSimplification=this.skipAutomaticSimplification,t.value=rT(this.value),t.dimensions=this.dimensions.slice(0),t.units=[];for(var e=0;e<this.units.length;e++)for(var r in t.units[e]={},this.units[e])rk(this.units[e],r)&&(t.units[e][r]=this.units[e][r]);return t},_.prototype.valueType=function(){return ny(this.value)},_.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},_.prototype._normalize=function(t){if(null==t||0===this.units.length)return t;for(var e=t,r=_._getNumberConverter(ny(t)),n=0;n<this.units.length;n++){var i=r(this.units[n].unit.value),a=r(this.units[n].prefix.value),o=r(this.units[n].power);e=l(e,c(l(i,a),o))}return e},_.prototype._denormalize=function(t,e){if(null==t||0===this.units.length)return t;for(var r=t,n=_._getNumberConverter(ny(t)),i=0;i<this.units.length;i++){var a=n(this.units[i].unit.value),o=n(this.units[i].prefix.value),s=n(this.units[i].power);r=h(r,c(l(a,o),s))}return r};var N=n$(t=>{if(rk(R,t)){var e=R[t],r=e.prefixes[""];return{unit:e,prefix:r}}for(var n in R)if(rk(R,n)&&function(t,e){var r=t.length-e.length,n=t.length;return t.substring(r,n)===e}(t,n)){var i=R[n],a=t.length-n.length,o=t.substring(0,a),s=rk(i.prefixes,o)?i.prefixes[o]:void 0;if(void 0!==s)return{unit:i,prefix:s}}return null},{hasher:t=>t[0],limit:100});function M(t){return t.equalBase(O.NONE)&&null!==t.value&&!o.predictable?t.value:t}_.isValuelessUnit=function(t){return null!==N(t)},_.prototype.hasBase=function(t){if("string"==typeof t&&(t=O[t]),!t)return!1;for(var e=0;e<B.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},_.prototype.equalBase=function(t){for(var e=0;e<B.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},_.prototype.equals=function(t){return this.equalBase(t)&&g(this.value,t.value)},_.prototype.multiply=function(t){for(var e=this.clone(),r=rY(t)?t:new _(t),n=0;n<B.length;n++)e.dimensions[n]=(this.dimensions[n]||0)+(r.dimensions[n]||0);for(var i=0;i<r.units.length;i++){var a=ue({},r.units[i]);e.units.push(a)}if(null!==this.value||null!==r.value){var o=null===this.value?this._normalize(1):this.value,s=null===r.value?r._normalize(1):r.value;e.value=l(o,s)}else e.value=null;return rY(t)&&(e.skipAutomaticSimplification=!1),M(e)},_.prototype.divideInto=function(t){return new _(t).divide(this)},_.prototype.divide=function(t){for(var e=this.clone(),r=rY(t)?t:new _(t),n=0;n<B.length;n++)e.dimensions[n]=(this.dimensions[n]||0)-(r.dimensions[n]||0);for(var i=0;i<r.units.length;i++){var a=ue(ue({},r.units[i]),{},{power:-r.units[i].power});e.units.push(a)}if(null!==this.value||null!==r.value){var o=null===this.value?this._normalize(1):this.value,s=null===r.value?r._normalize(1):r.value;e.value=h(o,s)}else e.value=null;return rY(t)&&(e.skipAutomaticSimplification=!1),M(e)},_.prototype.pow=function(t){for(var e=this.clone(),r=0;r<B.length;r++)e.dimensions[r]=(this.dimensions[r]||0)*t;for(var n=0;n<e.units.length;n++)e.units[n].power*=t;return null!==e.value?e.value=c(e.value,t):e.value=null,e.skipAutomaticSimplification=!1,M(e)},_.prototype.abs=function(){var t=this.clone();if(null!==t.value){if(t._isDerived()||0===t.units.length||0===t.units[0].unit.offset)t.value=f(t.value);else{var e=t._numberConverter(),r=l(e(t.units[0].unit.value),e(t.units[0].unit.offset));t.value=u(f(s(t.value,r)),r)}}for(var n in t.units)("VA"===t.units[n].unit.name||"VAR"===t.units[n].unit.name)&&(t.units[n].unit=R.W);return t},_.prototype.to=function(t){var e,r=null===this.value?this._normalize(1):this.value;if("string"==typeof t)e=_.parse(t);else if(rY(t))e=t.clone();else throw Error("String or Unit expected as parameter");if(!this.equalBase(e))throw Error("Units do not match ('".concat(e.toString(),"' != '").concat(this.toString(),"')"));if(null!==e.value)throw Error("Cannot convert to a unit with a value");if(null===this.value||this._isDerived()||0===this.units.length||0===e.units.length||this.units[0].unit.offset===e.units[0].unit.offset)e.value=rT(r);else{var n=_._getNumberConverter(ny(r)),i=l(this.units[0].unit.value,this.units[0].unit.offset),a=l(e.units[0].unit.value,e.units[0].unit.offset);e.value=s(r,n(u(i,a)))}return e.fixPrefix=!0,e.skipAutomaticSimplification=!0,e},_.prototype.toNumber=function(t){return y(this.toNumeric(t))},_.prototype.toNumeric=function(t){var e;return(e=t?this.to(t):this.clone())._isDerived()||0===e.units.length?e._denormalize(e.value):e._denormalize(e.value,e.units[0].prefix.value)},_.prototype.toString=function(){return this.format()},_.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.units.length>0?this.formatUnits():null,fixPrefix:this.fixPrefix}},_.fromJSON=function(t){var e,r=new _(t.value,null!==(e=t.unit)&&void 0!==e?e:void 0);return r.fixPrefix=t.fixPrefix||!1,r},_.prototype.valueOf=_.prototype.toString,_.prototype.simplify=function(){var t,e,r=this.clone(),n=[];for(var i in L)if(rk(L,i)&&r.hasBase(O[i])){t=i;break}if("NONE"===t)r.units=[];else if(t&&rk(L,t)&&(e=L[t]),e)r.units=[{unit:e.unit,prefix:e.prefix,power:1}];else{for(var a=!1,o=0;o<B.length;o++){var s=B[o];Math.abs(r.dimensions[o]||0)>1e-12&&(rk(L,s)?n.push({unit:L[s].unit,prefix:L[s].prefix,power:r.dimensions[o]||0}):a=!0)}n.length<r.units.length&&!a&&(r.units=n)}return r},_.prototype.toSI=function(){for(var t=this.clone(),e=[],r=0;r<B.length;r++){var n=B[r];if(Math.abs(t.dimensions[r]||0)>1e-12){if(rk(U.si,n))e.push({unit:U.si[n].unit,prefix:U.si[n].prefix,power:t.dimensions[r]||0});else throw Error("Cannot express custom unit "+n+" in SI units")}}return(t.units=e,t.fixPrefix=!0,t.skipAutomaticSimplification=!0,null!==this.value)?(t.value=null,this.to(t)):t},_.prototype.formatUnits=function(){for(var t="",e="",r=0,n=0,i=0;i<this.units.length;i++)this.units[i].power>0?(r++,t+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power-1)>1e-15&&(t+="^"+this.units[i].power)):this.units[i].power<0&&n++;if(n>0)for(var a=0;a<this.units.length;a++)this.units[a].power<0&&(r>0?(e+=" "+this.units[a].prefix.name+this.units[a].unit.name,Math.abs(this.units[a].power+1)>1e-15&&(e+="^"+-this.units[a].power)):(e+=" "+this.units[a].prefix.name+this.units[a].unit.name,e+="^"+this.units[a].power));t=t.substr(1),e=e.substr(1),r>1&&n>0&&(t="("+t+")"),n>1&&r>0&&(e="("+e+")");var o=t;return r>0&&n>0&&(o+=" / "),o+=e},_.prototype.format=function(t){var e=this.skipAutomaticSimplification||null===this.value?this.clone():this.simplify(),r=!1;for(var n in void 0!==e.value&&null!==e.value&&rV(e.value)&&(r=1e-14>Math.abs(e.value.re)),e.units)rk(e.units,n)&&e.units[n].unit&&("VA"===e.units[n].unit.name&&r?e.units[n].unit=R.VAR:"VAR"!==e.units[n].unit.name||r||(e.units[n].unit=R.VA));1===e.units.length&&!e.fixPrefix&&1e-14>Math.abs(e.units[0].power-Math.round(e.units[0].power))&&(e.units[0].prefix=e._bestPrefix());var i=e._denormalize(e.value),a=null!==e.value?v(i,t||{}):"",o=e.formatUnits();return e.value&&rV(e.value)&&(a="("+a+")"),o.length>0&&a.length>0&&(a+=" "),a+=o},_.prototype._bestPrefix=function(){if(1!==this.units.length||Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var t=null!==this.value?f(this.value):0,e=f(this.units[0].unit.value),r=this.units[0].prefix;if(0===t)return r;var n=this.units[0].power,i=Math.log(t/Math.pow(r.value*e,n))/Math.LN10-1.2;if(i>-2.200001&&i<1.800001)return r;i=Math.abs(i);var a=this.units[0].unit.prefixes;for(var o in a)if(rk(a,o)){var s=a[o];if(s.scientific){var u=Math.abs(Math.log(t/Math.pow(s.value*e,n))/Math.LN10-1.2);(u<i||u===i&&s.name.length<r.name.length)&&(r=s,i=u)}}return r},_.prototype.splitUnit=function(t){for(var e=this.clone(),r=[],n=0;n<t.length&&(e=e.to(t[n]),n!==t.length-1);n++){var i=e.toNumeric(),a=p(i),o=new _(g(a,i)?a:d(e.toNumeric()),t[n].toString());r.push(o),e=u(e,o)}for(var l=0,h=0;h<r.length;h++)l=s(l,r[h].value);return g(l,this.value)&&(e.value=0),r.push(e),r};var T={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},R:{name:"R",value:1e27,scientific:!0},Q:{name:"Q",value:1e30,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0},r:{name:"r",value:1e-27,scientific:!0},q:{name:"q",value:1e-30,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},ronna:{name:"ronna",value:1e27,scientific:!0},quetta:{name:"quetta",value:1e30,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0},ronto:{name:"ronto",value:1e-27,scientific:!0},quecto:{name:"quecto",value:1e-30,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},R:{name:"R",value:1e54,scientific:!0},Q:{name:"Q",value:1e60,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0},r:{name:"r",value:1e-54,scientific:!0},q:{name:"q",value:1e-60,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},R:{name:"R",value:1e81,scientific:!0},Q:{name:"Q",value:1e90,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0},r:{name:"r",value:1e-81,scientific:!0},q:{name:"q",value:1e-90,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:1048576,scientific:!0},Gi:{name:"Gi",value:0x40000000,scientific:!0},Ti:{name:"Ti",value:0x10000000000,scientific:!0},Pi:{name:"Pi",value:0x4000000000000,scientific:!0},Ei:{name:"Ei",value:0x1000000000000000,scientific:!0},Zi:{name:"Zi",value:11805916207174113e5,scientific:!0},Yi:{name:"Yi",value:12089258196146292e8,scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:1048576,scientific:!0},gibi:{name:"gibi",value:0x40000000,scientific:!0},tebi:{name:"tebi",value:0x10000000000,scientific:!0},pebi:{name:"pebi",value:0x4000000000000,scientific:!0},exi:{name:"exi",value:0x1000000000000000,scientific:!0},zebi:{name:"zebi",value:11805916207174113e5,scientific:!0},yobi:{name:"yobi",value:12089258196146292e8,scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};T.SHORTLONG=/*@__PURE__*/n(nx)({},T.SHORT,T.LONG),T.BINARY_SHORT=/*@__PURE__*/n(nx)({},T.BINARY_SHORT_SI,T.BINARY_SHORT_IEC),T.BINARY_LONG=/*@__PURE__*/n(nx)({},T.BINARY_LONG_SI,T.BINARY_LONG_IEC);var B=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],O={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var k in O)rk(O,k)&&(O[k].key=k);var P={name:"",base:{},value:1,offset:0,dimensions:B.map(t=>0)},R={meter:{name:"meter",base:O.LENGTH,prefixes:T.LONG,value:1,offset:0},inch:{name:"inch",base:O.LENGTH,prefixes:T.NONE,value:.0254,offset:0},foot:{name:"foot",base:O.LENGTH,prefixes:T.NONE,value:.3048,offset:0},yard:{name:"yard",base:O.LENGTH,prefixes:T.NONE,value:.9144,offset:0},mile:{name:"mile",base:O.LENGTH,prefixes:T.NONE,value:1609.344,offset:0},link:{name:"link",base:O.LENGTH,prefixes:T.NONE,value:.201168,offset:0},rod:{name:"rod",base:O.LENGTH,prefixes:T.NONE,value:5.0292,offset:0},chain:{name:"chain",base:O.LENGTH,prefixes:T.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:O.LENGTH,prefixes:T.NONE,value:1e-10,offset:0},m:{name:"m",base:O.LENGTH,prefixes:T.SHORT,value:1,offset:0},in:{name:"in",base:O.LENGTH,prefixes:T.NONE,value:.0254,offset:0},ft:{name:"ft",base:O.LENGTH,prefixes:T.NONE,value:.3048,offset:0},yd:{name:"yd",base:O.LENGTH,prefixes:T.NONE,value:.9144,offset:0},mi:{name:"mi",base:O.LENGTH,prefixes:T.NONE,value:1609.344,offset:0},li:{name:"li",base:O.LENGTH,prefixes:T.NONE,value:.201168,offset:0},rd:{name:"rd",base:O.LENGTH,prefixes:T.NONE,value:5.02921,offset:0},ch:{name:"ch",base:O.LENGTH,prefixes:T.NONE,value:20.1168,offset:0},mil:{name:"mil",base:O.LENGTH,prefixes:T.NONE,value:254e-7,offset:0},m2:{name:"m2",base:O.SURFACE,prefixes:T.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:O.SURFACE,prefixes:T.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:O.SURFACE,prefixes:T.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:O.SURFACE,prefixes:T.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:O.SURFACE,prefixes:T.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:O.SURFACE,prefixes:T.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:O.SURFACE,prefixes:T.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:O.SURFACE,prefixes:T.NONE,value:64516e-14,offset:0},acre:{name:"acre",base:O.SURFACE,prefixes:T.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:O.SURFACE,prefixes:T.NONE,value:1e4,offset:0},m3:{name:"m3",base:O.VOLUME,prefixes:T.CUBIC,value:1,offset:0},L:{name:"L",base:O.VOLUME,prefixes:T.SHORT,value:.001,offset:0},l:{name:"l",base:O.VOLUME,prefixes:T.SHORT,value:.001,offset:0},litre:{name:"litre",base:O.VOLUME,prefixes:T.LONG,value:.001,offset:0},cuin:{name:"cuin",base:O.VOLUME,prefixes:T.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:O.VOLUME,prefixes:T.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:O.VOLUME,prefixes:T.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:O.VOLUME,prefixes:T.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:O.VOLUME,prefixes:T.NONE,value:15e-6,offset:0},drop:{name:"drop",base:O.VOLUME,prefixes:T.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:O.VOLUME,prefixes:T.NONE,value:5e-8,offset:0},minim:{name:"minim",base:O.VOLUME,prefixes:T.NONE,value:61611519921875e-21,offset:0},fluiddram:{name:"fluiddram",base:O.VOLUME,prefixes:T.NONE,value:36966911953125e-19,offset:0},fluidounce:{name:"fluidounce",base:O.VOLUME,prefixes:T.NONE,value:295735295625e-16,offset:0},gill:{name:"gill",base:O.VOLUME,prefixes:T.NONE,value:11829411825e-14,offset:0},cc:{name:"cc",base:O.VOLUME,prefixes:T.NONE,value:1e-6,offset:0},cup:{name:"cup",base:O.VOLUME,prefixes:T.NONE,value:2365882365e-13,offset:0},pint:{name:"pint",base:O.VOLUME,prefixes:T.NONE,value:473176473e-12,offset:0},quart:{name:"quart",base:O.VOLUME,prefixes:T.NONE,value:946352946e-12,offset:0},gallon:{name:"gallon",base:O.VOLUME,prefixes:T.NONE,value:.003785411784,offset:0},beerbarrel:{name:"beerbarrel",base:O.VOLUME,prefixes:T.NONE,value:.117347765304,offset:0},oilbarrel:{name:"oilbarrel",base:O.VOLUME,prefixes:T.NONE,value:.158987294928,offset:0},hogshead:{name:"hogshead",base:O.VOLUME,prefixes:T.NONE,value:.238480942392,offset:0},g:{name:"g",base:O.MASS,prefixes:T.SHORT,value:.001,offset:0},gram:{name:"gram",base:O.MASS,prefixes:T.LONG,value:.001,offset:0},ton:{name:"ton",base:O.MASS,prefixes:T.SHORT,value:907.18474,offset:0},t:{name:"t",base:O.MASS,prefixes:T.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:O.MASS,prefixes:T.LONG,value:1e3,offset:0},grain:{name:"grain",base:O.MASS,prefixes:T.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:O.MASS,prefixes:T.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:O.MASS,prefixes:T.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:O.MASS,prefixes:T.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:O.MASS,prefixes:T.NONE,value:45.359237,offset:0},stick:{name:"stick",base:O.MASS,prefixes:T.NONE,value:.115,offset:0},stone:{name:"stone",base:O.MASS,prefixes:T.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:O.MASS,prefixes:T.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:O.MASS,prefixes:T.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:O.MASS,prefixes:T.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:O.MASS,prefixes:T.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:O.MASS,prefixes:T.NONE,value:45.359237,offset:0},s:{name:"s",base:O.TIME,prefixes:T.SHORT,value:1,offset:0},min:{name:"min",base:O.TIME,prefixes:T.NONE,value:60,offset:0},h:{name:"h",base:O.TIME,prefixes:T.NONE,value:3600,offset:0},second:{name:"second",base:O.TIME,prefixes:T.LONG,value:1,offset:0},sec:{name:"sec",base:O.TIME,prefixes:T.LONG,value:1,offset:0},minute:{name:"minute",base:O.TIME,prefixes:T.NONE,value:60,offset:0},hour:{name:"hour",base:O.TIME,prefixes:T.NONE,value:3600,offset:0},day:{name:"day",base:O.TIME,prefixes:T.NONE,value:86400,offset:0},week:{name:"week",base:O.TIME,prefixes:T.NONE,value:604800,offset:0},month:{name:"month",base:O.TIME,prefixes:T.NONE,value:2629800,offset:0},year:{name:"year",base:O.TIME,prefixes:T.NONE,value:0x1e187e0,offset:0},decade:{name:"decade",base:O.TIME,prefixes:T.NONE,value:315576e3,offset:0},century:{name:"century",base:O.TIME,prefixes:T.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:O.TIME,prefixes:T.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:O.FREQUENCY,prefixes:T.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:O.FREQUENCY,prefixes:T.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:O.ANGLE,prefixes:T.SHORT,value:1,offset:0},radian:{name:"radian",base:O.ANGLE,prefixes:T.LONG,value:1,offset:0},deg:{name:"deg",base:O.ANGLE,prefixes:T.SHORT,value:null,offset:0},degree:{name:"degree",base:O.ANGLE,prefixes:T.LONG,value:null,offset:0},grad:{name:"grad",base:O.ANGLE,prefixes:T.SHORT,value:null,offset:0},gradian:{name:"gradian",base:O.ANGLE,prefixes:T.LONG,value:null,offset:0},cycle:{name:"cycle",base:O.ANGLE,prefixes:T.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:O.ANGLE,prefixes:T.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:O.ANGLE,prefixes:T.NONE,value:null,offset:0},A:{name:"A",base:O.CURRENT,prefixes:T.SHORT,value:1,offset:0},ampere:{name:"ampere",base:O.CURRENT,prefixes:T.LONG,value:1,offset:0},K:{name:"K",base:O.TEMPERATURE,prefixes:T.SHORT,value:1,offset:0},degC:{name:"degC",base:O.TEMPERATURE,prefixes:T.SHORT,value:1,offset:273.15},degF:{name:"degF",base:O.TEMPERATURE,prefixes:T.SHORT,value:new D(5,9),offset:459.67},degR:{name:"degR",base:O.TEMPERATURE,prefixes:T.SHORT,value:new D(5,9),offset:0},kelvin:{name:"kelvin",base:O.TEMPERATURE,prefixes:T.LONG,value:1,offset:0},celsius:{name:"celsius",base:O.TEMPERATURE,prefixes:T.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:O.TEMPERATURE,prefixes:T.LONG,value:new D(5,9),offset:459.67},rankine:{name:"rankine",base:O.TEMPERATURE,prefixes:T.LONG,value:new D(5,9),offset:0},mol:{name:"mol",base:O.AMOUNT_OF_SUBSTANCE,prefixes:T.SHORT,value:1,offset:0},mole:{name:"mole",base:O.AMOUNT_OF_SUBSTANCE,prefixes:T.LONG,value:1,offset:0},cd:{name:"cd",base:O.LUMINOUS_INTENSITY,prefixes:T.SHORT,value:1,offset:0},candela:{name:"candela",base:O.LUMINOUS_INTENSITY,prefixes:T.LONG,value:1,offset:0},N:{name:"N",base:O.FORCE,prefixes:T.SHORT,value:1,offset:0},newton:{name:"newton",base:O.FORCE,prefixes:T.LONG,value:1,offset:0},dyn:{name:"dyn",base:O.FORCE,prefixes:T.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:O.FORCE,prefixes:T.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:O.FORCE,prefixes:T.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:O.FORCE,prefixes:T.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:O.FORCE,prefixes:T.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:O.FORCE,prefixes:T.NONE,value:9.80665,offset:0},J:{name:"J",base:O.ENERGY,prefixes:T.SHORT,value:1,offset:0},joule:{name:"joule",base:O.ENERGY,prefixes:T.LONG,value:1,offset:0},erg:{name:"erg",base:O.ENERGY,prefixes:T.SHORTLONG,value:1e-7,offset:0},Wh:{name:"Wh",base:O.ENERGY,prefixes:T.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:O.ENERGY,prefixes:T.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:O.ENERGY,prefixes:T.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:O.ENERGY,prefixes:T.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:O.POWER,prefixes:T.SHORT,value:1,offset:0},watt:{name:"watt",base:O.POWER,prefixes:T.LONG,value:1,offset:0},hp:{name:"hp",base:O.POWER,prefixes:T.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:O.POWER,prefixes:T.SHORT,value:x.I,offset:0},VA:{name:"VA",base:O.POWER,prefixes:T.SHORT,value:1,offset:0},Pa:{name:"Pa",base:O.PRESSURE,prefixes:T.SHORT,value:1,offset:0},psi:{name:"psi",base:O.PRESSURE,prefixes:T.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:O.PRESSURE,prefixes:T.NONE,value:101325,offset:0},bar:{name:"bar",base:O.PRESSURE,prefixes:T.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:O.PRESSURE,prefixes:T.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:O.PRESSURE,prefixes:T.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:O.PRESSURE,prefixes:T.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:O.PRESSURE,prefixes:T.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:O.ELECTRIC_CHARGE,prefixes:T.LONG,value:1,offset:0},C:{name:"C",base:O.ELECTRIC_CHARGE,prefixes:T.SHORT,value:1,offset:0},farad:{name:"farad",base:O.ELECTRIC_CAPACITANCE,prefixes:T.LONG,value:1,offset:0},F:{name:"F",base:O.ELECTRIC_CAPACITANCE,prefixes:T.SHORT,value:1,offset:0},volt:{name:"volt",base:O.ELECTRIC_POTENTIAL,prefixes:T.LONG,value:1,offset:0},V:{name:"V",base:O.ELECTRIC_POTENTIAL,prefixes:T.SHORT,value:1,offset:0},ohm:{name:"ohm",base:O.ELECTRIC_RESISTANCE,prefixes:T.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:O.ELECTRIC_INDUCTANCE,prefixes:T.LONG,value:1,offset:0},H:{name:"H",base:O.ELECTRIC_INDUCTANCE,prefixes:T.SHORT,value:1,offset:0},siemens:{name:"siemens",base:O.ELECTRIC_CONDUCTANCE,prefixes:T.LONG,value:1,offset:0},S:{name:"S",base:O.ELECTRIC_CONDUCTANCE,prefixes:T.SHORT,value:1,offset:0},weber:{name:"weber",base:O.MAGNETIC_FLUX,prefixes:T.LONG,value:1,offset:0},Wb:{name:"Wb",base:O.MAGNETIC_FLUX,prefixes:T.SHORT,value:1,offset:0},tesla:{name:"tesla",base:O.MAGNETIC_FLUX_DENSITY,prefixes:T.LONG,value:1,offset:0},T:{name:"T",base:O.MAGNETIC_FLUX_DENSITY,prefixes:T.SHORT,value:1,offset:0},b:{name:"b",base:O.BIT,prefixes:T.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:O.BIT,prefixes:T.BINARY_LONG,value:1,offset:0},B:{name:"B",base:O.BIT,prefixes:T.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:O.BIT,prefixes:T.BINARY_LONG,value:8,offset:0}},I={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fldr:"fluiddram",fluiddrams:"fluiddram",floz:"fluidounce",fluidounces:"fluidounce",gi:"gill",gills:"gill",cp:"cup",cups:"cup",pt:"pint",pints:"pint",qt:"quart",quarts:"quart",gal:"gallon",gallons:"gallon",bbl:"beerbarrel",beerbarrels:"beerbarrel",obl:"oilbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function z(t){if("BigNumber"===t.number){var e=nK(b);R.rad.value=new b(1),R.deg.value=e.div(180),R.grad.value=e.div(200),R.cycle.value=e.times(2),R.arcsec.value=e.div(648e3),R.arcmin.value=e.div(10800)}else R.rad.value=1,R.deg.value=Math.PI/180,R.grad.value=Math.PI/200,R.cycle.value=2*Math.PI,R.arcsec.value=Math.PI/648e3,R.arcmin.value=Math.PI/10800;R.radian.value=R.rad.value,R.degree.value=R.deg.value,R.gradian.value=R.grad.value}z(o),a&&a("config",function(t,e){t.number!==e.number&&z(t)});var U={si:{NONE:{unit:P,prefix:T.NONE[""]},LENGTH:{unit:R.m,prefix:T.SHORT[""]},MASS:{unit:R.g,prefix:T.SHORT.k},TIME:{unit:R.s,prefix:T.SHORT[""]},CURRENT:{unit:R.A,prefix:T.SHORT[""]},TEMPERATURE:{unit:R.K,prefix:T.SHORT[""]},LUMINOUS_INTENSITY:{unit:R.cd,prefix:T.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:R.mol,prefix:T.SHORT[""]},ANGLE:{unit:R.rad,prefix:T.SHORT[""]},BIT:{unit:R.bits,prefix:T.SHORT[""]},FORCE:{unit:R.N,prefix:T.SHORT[""]},ENERGY:{unit:R.J,prefix:T.SHORT[""]},POWER:{unit:R.W,prefix:T.SHORT[""]},PRESSURE:{unit:R.Pa,prefix:T.SHORT[""]},ELECTRIC_CHARGE:{unit:R.C,prefix:T.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:R.F,prefix:T.SHORT[""]},ELECTRIC_POTENTIAL:{unit:R.V,prefix:T.SHORT[""]},ELECTRIC_RESISTANCE:{unit:R.ohm,prefix:T.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:R.H,prefix:T.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:R.S,prefix:T.SHORT[""]},MAGNETIC_FLUX:{unit:R.Wb,prefix:T.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:R.T,prefix:T.SHORT[""]},FREQUENCY:{unit:R.Hz,prefix:T.SHORT[""]}}};U.cgs=JSON.parse(JSON.stringify(U.si)),U.cgs.LENGTH={unit:R.m,prefix:T.SHORT.c},U.cgs.MASS={unit:R.g,prefix:T.SHORT[""]},U.cgs.FORCE={unit:R.dyn,prefix:T.SHORT[""]},U.cgs.ENERGY={unit:R.erg,prefix:T.NONE[""]},U.us=JSON.parse(JSON.stringify(U.si)),U.us.LENGTH={unit:R.ft,prefix:T.NONE[""]},U.us.MASS={unit:R.lbm,prefix:T.NONE[""]},U.us.TEMPERATURE={unit:R.degF,prefix:T.NONE[""]},U.us.FORCE={unit:R.lbf,prefix:T.NONE[""]},U.us.ENERGY={unit:R.BTU,prefix:T.BTU[""]},U.us.POWER={unit:R.hp,prefix:T.NONE[""]},U.us.PRESSURE={unit:R.psi,prefix:T.NONE[""]},U.auto=JSON.parse(JSON.stringify(U.si));var L=U.auto;for(var G in _.setUnitSystem=function(t){if(rk(U,t))L=U[t];else throw Error("Unit system "+t+" does not exist. Choices are: "+Object.keys(U).join(", "))},_.getUnitSystem=function(){for(var t in U)if(rk(U,t)&&U[t]===L)return t},_.typeConverters={BigNumber:function(t){return null!=t&&t.isFraction?new b(String(t.n)).div(String(t.d)).times(String(t.s)):new b(t+"")},Fraction:function(t){return new D(t)},Complex:function(t){return t},number:function(t){return null!=t&&t.isFraction?y(t):t}},_.prototype._numberConverter=function(){var t=_.typeConverters[this.valueType()];if(t)return t;throw TypeError('Unsupported Unit value type "'+this.valueType()+'"')},_._getNumberConverter=function(t){if(!_.typeConverters[t])throw TypeError('Unsupported type "'+t+'"');return _.typeConverters[t]},R)if(rk(R,G)){var q=R[G];q.dimensions=q.base.dimensions}for(var j in I)if(rk(I,j)){var V=R[I[j]],H={};for(var Y in V)rk(V,Y)&&(H[Y]=V[Y]);H.name=j,R[j]=H}return _.isValidAlpha=function(t){return/^[a-zA-Z]$/.test(t)},_.createUnit=function(t,e){if("object"!=typeof t)throw TypeError("createUnit expects first parameter to be of type 'Object'");if(e&&e.override){for(var r in t)if(rk(t,r)&&_.deleteUnit(r),t[r].aliases)for(var n,i=0;i<t[r].aliases.length;i++)_.deleteUnit(t[r].aliases[i])}for(var a in t)rk(t,a)&&(n=_.createUnitSingle(a,t[a]));return n},_.createUnitSingle=function(t,e){if(null==e&&(e={}),"string"!=typeof t)throw TypeError("createUnitSingle expects first parameter to be of type 'string'");if(rk(R,t))throw Error('Cannot create unit "'+t+'": a unit with that name already exists');!function(t){for(var e=0;e<t.length;e++){if(i=t.charAt(e),0===e&&!_.isValidAlpha(i))throw Error('Invalid unit name (must begin with alpha character): "'+t+'"');if(e>0&&!(_.isValidAlpha(i)||E(i)))throw Error('Invalid unit name (only alphanumeric characters are allowed): "'+t+'"')}}(t);var r,n,a,o=null,s=[],u=0;if(e&&"Unit"===e.type)o=e.clone();else if("string"==typeof e)""!==e&&(r=e);else if("object"==typeof e)r=e.definition,n=e.prefixes,u=e.offset,a=e.baseName,e.aliases&&(s=e.aliases.valueOf());else throw TypeError('Cannot create unit "'+t+'" from "'+e.toString()+'": expecting "string" or "Unit" or "Object"');if(s){for(var l=0;l<s.length;l++)if(rk(R,s[l]))throw Error('Cannot create alias "'+s[l]+'": a unit with that name already exists')}if(r&&"string"==typeof r&&!o)try{o=_.parse(r,{allowNoUnits:!0})}catch(e){throw e.message='Could not create unit "'+t+'" from "'+r+'": '+e.message,e}else r&&"Unit"===r.type&&(o=r.clone());s=s||[],u=u||0,n=n&&n.toUpperCase&&T[n.toUpperCase()]||T.NONE;var h={};if(o){h={name:t,value:o.value,dimensions:o.dimensions.slice(0),prefixes:n,offset:u};var c=!1;for(var f in O)if(rk(O,f)){for(var d=!0,p=0;p<B.length;p++)if(Math.abs((h.dimensions[p]||0)-(O[f].dimensions[p]||0))>1e-12){d=!1;break}if(d){c=!0,h.base=O[f];break}}if(!c){a=a||t+"_STUFF";var g={dimensions:o.dimensions.slice(0)};g.key=a,O[a]=g,L[a]={unit:h,prefix:T.NONE[""]},h.base=O[a]}}else{if(a=a||t+"_STUFF",B.indexOf(a)>=0)throw Error('Cannot create new base unit "'+t+'": a base unit with that name already exists (and cannot be overridden)');for(var m in B.push(a),O)rk(O,m)&&(O[m].dimensions[B.length-1]=0);for(var v={dimensions:[]},y=0;y<B.length;y++)v.dimensions[y]=0;v.dimensions[B.length-1]=1,v.key=a,O[a]=v,h={name:t,value:1,dimensions:O[a].dimensions.slice(0),prefixes:n,offset:u,base:O[a]},L[a]={unit:h,prefix:T.NONE[""]}}_.UNITS[t]=h;for(var x=0;x<s.length;x++){var b=s[x],D={};for(var w in h)rk(h,w)&&(D[w]=h[w]);D.name=b,_.UNITS[b]=D}return delete N.cache,new _(null,t)},_.deleteUnit=function(t){delete _.UNITS[t],delete N.cache},_.PREFIXES=T,_.BASE_DIMENSIONS=B,_.BASE_UNITS=O,_.UNIT_SYSTEMS=U,_.UNITS=R,_};var ur="gamma",un=/* #__PURE__ */nE(ur,["typed","config","multiplyScalar","pow","BigNumber","Complex"],t=>{var{typed:e,config:r,multiplyScalar:n,pow:i,BigNumber:a,Complex:o}=t;return e(ur,{number:aA,Complex:function t(e){if(0===e.im)return aA(e.re);if(e.re<.5){var r=new o(1-e.re,-e.im),n=new o(Math.PI*e.re,Math.PI*e.im);return new o(Math.PI).div(n.sin()).div(t(r))}e=new o(e.re-1,e.im);for(var i=new o(aN[0],0),a=1;a<aN.length;++a){var s=new o(aN[a],0);i=i.add(s.div(e.add(a)))}var u=new o(e.re+aF+.5,e.im),l=Math.sqrt(2*Math.PI),h=u.pow(e.add(.5)),c=u.neg().exp();return i.mul(l).mul(h).mul(c)},BigNumber:function(t){if(t.isInteger())return t.isNegative()||t.isZero()?new a(1/0):function t(e){if(e<8)return new a([1,1,2,6,24,120,720,5040][e]);var n=r.precision+(0|Math.log(e.toNumber())),i=a.clone({precision:n});if(e%2==1)return e.times(t(new a(e-1)));for(var o=e,s=new i(e),u=e.toNumber();o>2;)o-=2,u+=o,s=s.times(u);return new a(s.toPrecision(a.precision))}(t.minus(1));if(!t.isFinite())return new a(t.isNegative()?NaN:1/0);throw Error("Integer BigNumber expected")}})}),ui=(t=>{var{typed:e,matrix:r,multiply:n,equalScalar:i,divideScalar:a,inv:o}=t,s=oA({typed:e,equalScalar:i}),u=oM({typed:e});return e("divide",rB({"Array | Matrix, Array | Matrix":function(t,e){return n(t,o(e))},"DenseMatrix, any":function(t,e){return u(t,e,a,!1)},"SparseMatrix, any":function(t,e){return s(t,e,a,!1)},"Array, any":function(t,e){return u(r(t),e,a,!1).valueOf()},"any, Array | Matrix":function(t,e){return n(t,o(e))}},a.signatures))},"factorial");function ua(t,e){var r,n=e.length,i=[];if(t)for(r=0;r<n;r++)i[t[r]]=e[r];else for(r=0;r<n;r++)i[r]=e[r];return i}t=>{var{typed:e,gamma:r}=t;return e(ui,{number:function(t){if(t<0)throw Error("Value must be non-negative");return r(t+1)},BigNumber:function(t){if(t.isNegative())throw Error("Value must be non-negative");return r(t.plus(1))},"Array | Matrix":e.referToSelf(t=>e=>iI(e,t))})};var uo="lusolve",us=/* #__PURE__ */nE(uo,["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],t=>{var{typed:e,matrix:r,lup:n,slu:i,usolve:a,lsolve:o,DenseMatrix:s}=t,u=oV({DenseMatrix:s});return e(uo,{"Array, Array | Matrix":function(t,e){var i=n(t=r(t));return h(i.L,i.U,i.p,null,e).valueOf()},"DenseMatrix, Array | Matrix":function(t,e){var r=n(t);return h(r.L,r.U,r.p,null,e)},"SparseMatrix, Array | Matrix":function(t,e){var r=n(t);return h(r.L,r.U,r.p,null,e)},"SparseMatrix, Array | Matrix, number, number":function(t,e,r,n){var a=i(t,r,n);return h(a.L,a.U,a.p,a.q,e)},"Object, Array | Matrix":function(t,e){return h(t.L,t.U,t.p,t.q,e)}});function l(t){if(rK(t))return t;if(r$(t))return r(t);throw TypeError("Invalid Matrix LU decomposition")}function h(t,e,r,n,i){t=l(t),e=l(e),r&&((i=u(t,i,!0))._data=ua(r,i._data));var s=a(e,o(t,i));return n&&(s._data=ua(n,s._data)),s}}),uu=/* #__PURE__ */nE("eigs",["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],t=>{var{config:e,typed:r,matrix:i,addScalar:a,subtract:o,equal:s,abs:u,atan:l,cos:h,sin:c,multiplyScalar:f,divideScalar:d,inv:p,bignumber:g,multiply:m,add:v,larger:y,column:x,flatten:b,number:D,complex:_,sqrt:w,diag:E,size:C,reshape:S,qr:A,usolve:F,usolveAll:N,im:M,re:T,smaller:B,matrixFromColumns:O,dot:k}=t,P=function(t){var{config:e,addScalar:r,subtract:n,abs:i,atan:a,cos:o,sin:s,multiplyScalar:u,inv:l,bignumber:h,multiply:c,add:f}=t;function d(t){for(var e=t.length,r=0,n=[0,1],i=0;i<e;i++)for(var a=i+1;a<e;a++)Math.abs(r)<Math.abs(t[i][a])&&(r=Math.abs(t[i][a]),n=[i,a]);return[n,r]}function p(t){for(var e=t.length,r=0,n=[0,1],a=0;a<e;a++)for(var o=a+1;o<e;o++)i(r)<i(t[a][o])&&(r=i(t[a][o]),n=[a,o]);return[n,r]}function g(t,e,r){var n,a=t.length,o=Array(a);if(r){n=Array(a);for(var s=0;s<a;s++)n[s]=Array(a)}for(var u=0;u<a;u++){for(var l=0,h=t[0],c=0;c<t.length;c++)i(t[c])<i(h)&&(h=t[l=c]);if(o[u]=t.splice(l,1)[0],r)for(var f=0;f<a;f++)n[u][f]=e[f][l],e[f].splice(l,1)}if(!r)return{values:o};var d=n.map((t,e)=>({value:o[e],vector:t}));return{values:o,eigenvectors:d}}return function(t,m){var v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.relTol,y=arguments.length>3?arguments[3]:void 0,x=arguments.length>4?arguments[4]:void 0;if("number"===y)return function(t,r,n){var i,a,o=t.length,s=Math.abs(r/o);if(n){a=Array(o);for(var u=0;u<o;u++)a[u]=Array(o).fill(0),a[u][u]=1}for(var l=d(t);Math.abs(l[1])>=Math.abs(s);){var h,c,f,p=l[0][0],m=l[0][1];h=t[p][p],c=t[m][m],f=t[p][m],t=function(t,e,r,n){for(var i=t.length,a=Math.cos(e),o=Math.sin(e),s=a*a,u=o*o,l=Array(i).fill(0),h=Array(i).fill(0),c=s*t[r][r]-2*a*o*t[r][n]+u*t[n][n],f=u*t[r][r]+2*a*o*t[r][n]+s*t[n][n],d=0;d<i;d++)l[d]=a*t[r][d]-o*t[n][d],h[d]=o*t[r][d]+a*t[n][d];t[r][r]=c,t[n][n]=f,t[r][n]=0,t[n][r]=0;for(var p=0;p<i;p++)p!==r&&p!==n&&(t[r][p]=l[p],t[p][r]=l[p],t[n][p]=h[p],t[p][n]=h[p]);return t}(t,i=Math.abs(c-h)<=e.relTol?Math.PI/4:.5*Math.atan(2*f/(c-h)),p,m),n&&(a=function(t,e,r,n){for(var i=t.length,a=Math.cos(e),o=Math.sin(e),s=Array(i).fill(0),u=Array(i).fill(0),l=0;l<i;l++)s[l]=a*t[l][r]-o*t[l][n],u[l]=o*t[l][r]+a*t[l][n];for(var h=0;h<i;h++)t[h][r]=s[h],t[h][n]=u[h];return t}(a,i,p,m)),l=d(t)}for(var v=Array(o).fill(0),y=0;y<o;y++)v[y]=t[y][y];return g(rT(v),a,n)}(t,v,x);if("BigNumber"===y)return function(t,d,m){var v,y,x=t.length,b=i(d/x);if(m){y=Array(x);for(var D=0;D<x;D++)y[D]=Array(x).fill(0),y[D][D]=1}for(var _=p(t);i(_[1])>=i(b);){var w=_[0][0],E=_[0][1];v=function(t,r,o){var s=n(r,t);return i(s)<=e.relTol?h(-1).acos().div(4):u(.5,a(c(2,o,l(s))))}(t[w][w],t[E][E],t[w][E]),t=function(t,e,i,a){for(var l=t.length,d=h(o(e)),p=h(s(e)),g=u(d,d),m=u(p,p),v=Array(l).fill(h(0)),y=Array(l).fill(h(0)),x=c(h(2),d,p,t[i][a]),b=r(n(u(g,t[i][i]),x),u(m,t[a][a])),D=f(u(m,t[i][i]),x,u(g,t[a][a])),_=0;_<l;_++)v[_]=n(u(d,t[i][_]),u(p,t[a][_])),y[_]=r(u(p,t[i][_]),u(d,t[a][_]));t[i][i]=b,t[a][a]=D,t[i][a]=h(0),t[a][i]=h(0);for(var w=0;w<l;w++)w!==i&&w!==a&&(t[i][w]=v[w],t[w][i]=v[w],t[a][w]=y[w],t[w][a]=y[w]);return t}(t,v,w,E),m&&(y=function(t,e,i,a){for(var l=t.length,c=o(e),f=s(e),d=Array(l).fill(h(0)),p=Array(l).fill(h(0)),g=0;g<l;g++)d[g]=n(u(c,t[g][i]),u(f,t[g][a])),p[g]=r(u(f,t[g][i]),u(c,t[g][a]));for(var m=0;m<l;m++)t[m][i]=d[m],t[m][a]=p[m];return t}(y,v,w,E)),_=p(t)}for(var C=Array(x).fill(0),S=0;S<x;S++)C[S]=t[S][S];return g(rT(C),y,m)}(t,v,x);throw TypeError("Unsupported data type: "+y)}}({config:e,addScalar:a,subtract:o,column:x,flatten:b,equal:s,abs:u,atan:l,cos:h,sin:c,multiplyScalar:f,inv:p,bignumber:g,complex:_,multiply:m,add:v}),R=function(t){var{addScalar:e,subtract:r,flatten:n,multiply:i,multiplyScalar:a,divideScalar:o,sqrt:s,abs:u,bignumber:l,diag:h,size:c,reshape:f,inv:d,qr:p,usolve:g,usolveAll:m,equal:v,complex:y,larger:x,smaller:b,matrixFromColumns:D,dot:_}=t;function w(t,e){for(var r=0;r<t.length;r++)t[r].push(...Array(e-t[r].length).fill(0));for(var n=t.length;n<e;n++)t.push(Array(e).fill(0)),t[n][n]=1;return t}function E(t,e){var n=c(t);for(var a of e)t=r(t,i(o(_(a=f(a,n),t),_(a,a)),a));return t}function C(t){return u(s(_(t,t)))}function S(t,e){return i(o("BigNumber"===e?l(1):"Complex"===e?y(1):1,C(t)),t)}return function(t,c,f,D){var _=!(arguments.length>4)||void 0===arguments[4]||arguments[4],A=function(t,r,n,i,s){var c,f="BigNumber"===i,d=f?l(0):0,p=f?l(1):"Complex"===i?y(1):1,g=f?l(1):1,m=f?l(10):2,D=a(m,m);s&&(c=Array(r).fill(p));for(var _=!1;!_;){_=!0;for(var w=0;w<r;w++){for(var E=d,C=d,S=0;S<r;S++)w!==S&&(E=e(E,u(t[S][w])),C=e(C,u(t[w][S])));if(!v(E,0)&&!v(C,0)){for(var A=g,F=E,N=o(C,m),M=a(C,m);b(F,N);)F=a(F,D),A=a(A,m);for(;x(F,M);)F=o(F,D),A=o(A,m);if(b(o(e(F,C),A),a(e(E,C),.95))){_=!1;for(var T=o(1,A),B=0;B<r;B++)w!==B&&(t[w][B]=a(t[w][B],T),t[B][w]=a(t[B][w],A));s&&(c[w]=a(c[w],T))}}}}return s?h(c):null}(t,c,0,D,_);!function(t,n,i,s,h,c){var f="BigNumber"===s,d=f?l(0):"Complex"===s?y(0):0;f&&(i=l(i));for(var p=0;p<n-2;p++){for(var g=0,m=d,v=p+1;v<n;v++){var x=t[v][p];b(u(m),u(x))&&(m=x,g=v)}if(!b(u(m),i)){if(g!==p+1){var D=t[g];t[g]=t[p+1],t[p+1]=D;for(var _=0;_<n;_++){var w=t[_][g];t[_][g]=t[_][p+1],t[_][p+1]=w}if(h){var E=c[g];c[g]=c[p+1],c[p+1]=E}}for(var C=p+2;C<n;C++){var S=o(t[C][p],m);if(0!==S){for(var A=0;A<n;A++)t[C][A]=r(t[C][A],a(S,t[p+1][A]));for(var F=0;F<n;F++)t[F][p+1]=e(t[F][p+1],a(S,t[F][C]));if(h)for(var N=0;N<n;N++)c[C][N]=r(c[C][N],a(S,c[p+1][N]))}}}}}(t,c,f,D,_,A);var{values:F,C:N}=function(t,n,o,c,f){var d="BigNumber"===c,g="Complex"===c,m=d?l(1):g?y(1):1;d&&(o=l(o));for(var v=rT(t),D=[],_=n,E=[],C=f?h(Array(n).fill(m)):void 0,S=f?h(Array(_).fill(m)):void 0,A=0;A<=100;){A+=1;for(var F=v[_-1][_-1],N=0;N<_;N++)v[N][N]=r(v[N][N],F);var{Q:M,R:T}=p(v);v=i(T,M);for(var B=0;B<_;B++)v[B][B]=e(v[B][B],F);if(f&&(S=i(S,M)),1===_||b(u(v[_-1][_-2]),o)){A=0,D.push(v[_-1][_-1]),f&&(E.unshift([[1]]),w(S,n),C=i(C,S),_>1&&(S=h(Array(_-1).fill(m)))),_-=1,v.pop();for(var O=0;O<_;O++)v[O].pop()}else if(2===_||b(u(v[_-2][_-3]),o)){A=0;var k=function(t,n,i,o){var u=e(t,o),l=r(a(t,o),a(n,i)),h=a(u,.5),c=a(s(r(a(u,u),a(4,l))),.5);return[e(h,c),r(h,c)]}(v[_-2][_-2],v[_-2][_-1],v[_-1][_-2],v[_-1][_-1]);D.push(...k),f&&(E.unshift(function(t,e,n,i,a,o,s,h){var c="BigNumber"===h,f="Complex"===h,d=c?l(0):f?y(0):0,p=c?l(1):f?y(1):1;if(b(u(n),s))return[[p,d],[d,p]];if(x(u(r(a,o)),s))return[[r(a,i),r(o,i)],[n,n]];var g=r(t,a),m=r(i,a);return b(u(e),s)&&b(u(m),s)?[[g,p],[n,d]]:[[e,d],[m,p]]}(v[_-2][_-2],v[_-2][_-1],v[_-1][_-2],v[_-1][_-1],k[0],k[1],o,c)),w(S,n),C=i(C,S),_>2&&(S=h(Array(_-2).fill(m)))),_-=2,v.pop(),v.pop();for(var P=0;P<_;P++)v[P].pop(),v[P].pop()}if(0===_)break}if(D.sort((t,e)=>+r(u(t),u(e))),A>100){var R=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+D.join(", "));throw R.values=D,R.vectors=[],R}return{values:D,C:f?i(C,function(t,e){for(var r=[],n=0;n<e;n++)r[n]=Array(e).fill(0);var i=0;for(var a of t){for(var o=a.length,s=0;s<o;s++)for(var u=0;u<o;u++)r[i+s][i+u]=a[s][u];i+=o}return r}(E,n)):void 0}}(t,c,f,D,_);if(_){var M=function(t,e,a,o,s,u,c){var f=i(d(a),t,a),p="BigNumber"===c,D="Complex"===c,_=p?l(0):D?y(0):0,w=p?l(1):D?y(1):1,A=[],F=[];for(var N of s){var M=function(t,e,r){for(var n=0;n<t.length;n++)if(r(t[n],e))return n;return -1}(A,N,v);-1===M?(A.push(N),F.push(1)):F[M]+=1}for(var T=[],B=A.length,O=Array(e).fill(_),k=h(Array(e).fill(w)),P=0;P<B;P++)!function(){var t=A[P],s=r(f,i(t,k)),h=m(s,O);for(h.shift();h.length<F[P];){var p=function(t,e,r,n,i){for(var a,o="BigNumber"===i?l(1e3):1e3,s=0;s<5;++s){a=function(t,e,r){var n="BigNumber"===r,i="Complex"===r,a=Array(t).fill(0).map(t=>2*Math.random()-1);return n&&(a=a.map(t=>l(t))),i&&(a=a.map(t=>y(t))),S(a=E(a,e),r)}(e,r,i);try{a=g(t,a)}catch(t){continue}if(x(C(a),o))break}if(s>=5)return null;for(s=0;;){var u=g(t,a);if(b(C(E(a,[u])),n))break;if(++s>=10)return null;a=S(u)}return a}(s,e,h,u,c);if(null===p)break;h.push(p)}var v=i(d(o),a);h=h.map(t=>i(v,t)),T.push(...h.map(e=>({value:t,vector:n(e)})))}();return T}(t,c,N,A,F,f,D);return{values:F,eigenvectors:M}}return{values:F}}}({config:e,addScalar:a,subtract:o,multiply:m,multiplyScalar:f,flatten:b,divideScalar:d,sqrt:w,abs:u,bignumber:g,diag:E,size:C,reshape:S,qr:A,inv:p,usolve:F,usolveAll:N,equal:s,complex:_,larger:y,smaller:B,matrixFromColumns:O,dot:k});return r("eigs",{Array:function(t){return I(i(t))},"Array, number|BigNumber":function(t,e){return I(i(t),{precision:e})},"Array, Object":(t,e)=>I(i(t),e),Matrix:function(t){return I(t,{matricize:!0})},"Matrix, number|BigNumber":function(t,e){return I(t,{precision:e,matricize:!0})},"Matrix, Object":function(t,e){var r={matricize:!0};return /*@__PURE__*/n(nx)(r,e),I(t,r)}});function I(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=!("eigenvectors"in n)||n.eigenvectors,s=function(t,e,r){var n=t.toArray(),i=t.size();if(2!==i.length||i[0]!==i[1])throw RangeError("Matrix must be square (size: ".concat(n9(i),")"));var a=i[0];if(function(t,e,r){for(var n=0;n<e;n++)for(var i=0;i<e;i++)if(y(g(u(M(t[n][i]))),r))return!1;return!0}(n,a,e)&&(function(t,e){for(var r=0;r<e;r++)for(var n=0;n<e;n++)t[r][n]=T(t[r][n])}(n,a),function(t,e,r){for(var n=0;n<e;n++)for(var i=n;i<e;i++)if(y(g(u(o(t[n][i],t[i][n]))),r))return!1;return!0}(n,a,e))){var s=z(t,n,a);return P(n,a,e,s,r)}var l=z(t,n,a);return R(n,a,e,l,r)}(t,null!==(r=n.precision)&&void 0!==r?r:e.relTol,a);return n.matricize&&(s.values=i(s.values),a&&(s.eigenvectors=s.eigenvectors.map(t=>{var{value:e,vector:r}=t;return{value:e,vector:i(r)}}))),a&&Object.defineProperty(s,"vectors",{enumerable:!1,get:()=>{throw Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),s}function z(t,e,r){var n=t.datatype();if("number"===n||"BigNumber"===n||"Complex"===n)return n;for(var i=!1,a=!1,o=!1,s=0;s<r;s++)for(var u=0;u<r;u++){var l=e[s][u];if(rG(l)||rH(l))i=!0;else if(rq(l))a=!0;else if(rV(l))o=!0;else throw TypeError("Unsupported type in Matrix: "+ny(l))}if(a&&o&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),o){for(var h=0;h<r;h++)for(var c=0;c<r;c++)e[h][c]=_(e[h][c]);return"Complex"}if(a){for(var f=0;f<r;f++)for(var d=0;d<r;d++)e[f][d]=g(e[f][d]);return"BigNumber"}if(i){for(var p=0;p<r;p++)for(var m=0;m<r;m++)e[p][m]=D(e[p][m]);return"number"}throw TypeError("Matrix contains unsupported types only.")}}),ul="unbiased",uh=(t=>{var{typed:e,add:r,subtract:n,multiply:i,divide:a,apply:o,isNaN:s}=t;return e("variance",{"Array | Matrix":function(t){return u(t,ul)},"Array | Matrix, string":u,"Array | Matrix, number | BigNumber":function(t,e){return l(t,e,ul)},"Array | Matrix, number | BigNumber, string":l,"...":function(t){return u(t,ul)}});function u(t,e){var o,u=0;if(0===t.length)throw SyntaxError("Function variance requires one or more parameters (0 provided)");if(iR(t,function(t){try{o=void 0===o?t:r(o,t),u++}catch(e){throw os(e,"variance",t)}}),0===u)throw Error("Cannot calculate variance of an empty array");var l=a(o,u);if(o=void 0,iR(t,function(t){var e=n(t,l);o=void 0===o?i(e,e):r(o,i(e,e))}),s(o))return o;switch(e){case"uncorrected":return a(o,u);case"biased":return a(o,u+1);case"unbiased":var h=rq(o)?o.mul(0):0;return 1===u?h:a(o,u-1);default:throw Error('Unknown normalization "'+e+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function l(t,e,r){try{if(0===t.length)throw SyntaxError("Function variance requires one or more parameters (0 provided)");return o(t,e,t=>u(t,r))}catch(t){throw os(t,"variance")}}},"median"),uc="norm",uf=/* #__PURE__ */nE(uc,["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],t=>{var{typed:e,abs:r,add:n,pow:i,conj:a,sqrt:o,multiply:s,equalScalar:u,larger:l,smaller:h,matrix:c,ctranspose:f,eigs:d}=t;return e(uc,{number:Math.abs,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},boolean:function(t){return Math.abs(t)},Array:function(t){return p(c(t),2)},Matrix:function(t){return p(t,2)},"Array, number | BigNumber | string":function(t,e){return p(c(t),e)},"Matrix, number | BigNumber | string":function(t,e){return p(t,e)}});function p(t,e){var c=t.size();if(1===c.length)return function(t,e){if(e===Number.POSITIVE_INFINITY||"inf"===e)return a=0,t.forEach(function(t){var e=r(t);l(e,a)&&(a=e)},!0),a;if(e===Number.NEGATIVE_INFINITY||"-inf"===e)return t.forEach(function(t){var e=r(t);(!o||h(e,o))&&(o=e)},!0),o||0;if("fro"===e)return p(t,2);if("number"==typeof e&&!isNaN(e)){if(!u(e,0)){var a,o,s=0;return t.forEach(function(t){s=n(i(r(t),e),s)},!0),i(s,1/e)}return Number.POSITIVE_INFINITY}throw Error("Unsupported parameter value")}(t,e);if(2===c.length){if(c[0]&&c[1])return function(t,e){var i,u,h,c,p;if(1===e)return i=[],u=0,t.forEach(function(t,e){var a=e[1],o=n(i[a]||0,r(t));l(o,u)&&(u=o),i[a]=o},!0),u;if(e===Number.POSITIVE_INFINITY||"inf"===e)return h=[],c=0,t.forEach(function(t,e){var i=e[0],a=n(h[i]||0,r(t));l(a,c)&&(c=a),h[i]=a},!0),c;if("fro"===e)return p=0,t.forEach(function(t,e){p=n(p,s(t,a(t)))}),r(o(p));if(2===e)return function(t){var e=t.size();if(e[0]!==e[1])throw RangeError("Invalid matrix dimensions");var n=d(s(f(t),t)).values.toArray();return r(o(n[n.length-1]))}(t);throw Error("Unsupported parameter value "+e)}(t,e);throw RangeError("Invalid matrix dimensions")}}}),ud=(t=>{var{typed:e,config:r,multiplyScalar:n,addScalar:i,unaryMinus:a,norm:o,BigNumber:s,matrix:u,DenseMatrix:l,SparseMatrix:h,cos:c,sin:f}=t;return e("rotationMatrix",{"":function(){return"Matrix"===r.matrix?u([]):[]},string:function(t){return u(t)},"number | BigNumber | Complex | Unit":function(t){return d(t,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(t,e){return d(t,e)},"number | BigNumber | Complex | Unit, Array":function(t,e){var r=u(e);return p(r),v(t,r,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(t,e){p(e);var n=e.storage()||("Matrix"===r.matrix?"dense":void 0);return v(t,e,n)},"number | BigNumber | Complex | Unit, Array, string":function(t,e,r){var n=u(e);return p(n),v(t,n,r)},"number | BigNumber | Complex | Unit, Matrix, string":function(t,e,r){return p(e),v(t,e,r)}});function d(t,e){var r=rq(t)?new s(-1):-1,i=c(t),a=f(t);return m([[i,n(r,a)],[a,i]],e)}function p(t){var e=t.size();if(e.length<1||3!==e[0])throw RangeError("Vector must be of dimensions 1x3")}function g(t){return t.reduce((t,e)=>n(t,e))}function m(t,e){if(e){if("sparse"===e)return new h(t);if("dense"===e)return new l(t);throw TypeError('Unknown matrix type "'.concat(e,'"'))}return t}function v(t,e,r){var n=o(e);if(0===n)throw RangeError("Rotation around zero vector");var u=rq(t)?s:null,l=u?new u(1):1,h=u?new u(-1):-1,d=u?new u(e.get([0])/n):e.get([0])/n,p=u?new u(e.get([1])/n):e.get([1])/n,v=u?new u(e.get([2])/n):e.get([2])/n,y=c(t),x=i(l,a(y)),b=f(t);return m([[i(y,g([d,d,x])),i(g([d,p,x]),g([h,v,b])),i(g([d,v,x]),g([p,b]))],[i(g([d,p,x]),g([v,b])),i(y,g([p,p,x])),i(g([p,v,x]),g([h,d,b]))],[i(g([d,v,x]),g([h,p,b])),i(g([p,v,x]),g([d,b])),i(y,g([v,v,x]))]],r)}},"schur");t=>{var{typed:e,matrix:r,identity:n,multiply:i,qr:a,norm:o,subtract:s}=t;return e(ud,{Array:function(t){var e=u(r(t));return{U:e.U.valueOf(),T:e.T.valueOf()}},Matrix:function(t){return u(t)}});function u(t){var e,r=t.size()[0],u=t,l=n(r),h=0;do{e=u;var c=a(u),f=c.Q;if(u=i(c.R,f),l=i(l,f),h++>100)break}while(o(s(u,e))>1e-4)return{U:l,T:u}}};var up=/* #__PURE__ */nS({config:n_}),ug=/* #__PURE__ */nW({}),um=/* #__PURE__ */n5({}),uv=/* #__PURE__ */n3({}),uy=/* #__PURE__ */iN({Matrix:uv}),ux=/* #__PURE__ */iT({BigNumber:up,Complex:ug,DenseMatrix:uy,Fraction:um}),ub=/* #__PURE__ */i1({typed:ux}),uD=/* #__PURE__ */i3({typed:ux}),u_=/* #__PURE__ */i4({typed:ux}),uw=/* #__PURE__ */ai({Complex:ug,typed:ux}),uE=/* #__PURE__ */ao({typed:ux}),uC=/* #__PURE__ */au({typed:ux}),uS=/* #__PURE__ */af({config:n_,typed:ux}),uA=/* #__PURE__ */ap({typed:ux}),uF=/* #__PURE__ */av({typed:ux}),uN=/* #__PURE__ */ay({typed:ux}),uM=/* #__PURE__ */ab({typed:ux}),uT=/* #__PURE__ */aE({config:n_,typed:ux}),uB=/* #__PURE__ */aS({equalScalar:uS,typed:ux}),uO=/* #__PURE__ */aB({typed:ux}),uk=/* #__PURE__ */aP({typed:ux}),uP=/* #__PURE__ */aY({typed:ux}),uR=/* #__PURE__ */a$({BigNumber:up,Fraction:um,complex:uw,typed:ux}),uI=/* #__PURE__ */aK({typed:ux}),uz=/* #__PURE__ */aX({Matrix:uv,equalScalar:uS,typed:ux}),uU=/* #__PURE__ */aJ({typed:ux}),uL=/* #__PURE__ */a2({BigNumber:up,typed:ux}),uG=/* #__PURE__ */a4({Complex:ug,config:n_,typed:ux}),uq=/* #__PURE__ */a6({typed:ux}),uj=/* #__PURE__ */a9({Fraction:um,typed:ux}),uV=/* #__PURE__ */or({DenseMatrix:uy,Matrix:uv,SparseMatrix:uz,typed:ux}),uH=/* #__PURE__ */oo({bignumber:uL,fraction:uj,number:uk}),uY=/* #__PURE__ */ol({isInteger:uM,matrix:uV,typed:ux}),uW=/* #__PURE__ */oc({matrix:uV,config:n_,typed:ux}),u$=/* #__PURE__ */od({matrix:uV,typed:ux}),uK=/* #__PURE__ */og({BigNumber:up,config:n_,matrix:uV,typed:ux}),uX=/* #__PURE__ */ov({isInteger:uM,matrix:uV,typed:ux}),uZ=/* #__PURE__ */ox({conj:uE,transpose:u$,typed:ux}),uJ=/* #__PURE__ */oD({DenseMatrix:uy,SparseMatrix:uz,matrix:uV,typed:ux}),uQ=/* #__PURE__ */ow({numeric:uH,typed:ux}),u0=/* #__PURE__ */oP({DenseMatrix:uy,SparseMatrix:uz,concat:uX,equalScalar:uS,matrix:uV,typed:ux}),u1=/* #__PURE__ */oz({BigNumber:up,DenseMatrix:uy,SparseMatrix:uz,config:n_,matrix:uV,typed:ux}),u2=/* #__PURE__ */oL({DenseMatrix:uy,SparseMatrix:uz,concat:uX,config:n_,matrix:uV,typed:ux}),u5=/* #__PURE__ */oY({DenseMatrix:uy,divideScalar:uQ,equalScalar:uS,matrix:uV,multiplyScalar:uO,subtractScalar:uU,typed:ux}),u3=/* #__PURE__ */o$({flatten:uA,matrix:uV,size:uW,typed:ux}),u4=/* #__PURE__ */oK({addScalar:uD,complex:uw,conj:uE,divideScalar:uQ,equal:u0,identity:u1,isZero:uB,matrix:uV,multiplyScalar:uO,sign:uR,sqrt:uG,subtractScalar:uU,typed:ux,unaryMinus:uq,zeros:uK}),u8=/* #__PURE__ */oQ({BigNumber:up,DenseMatrix:uy,config:n_,equalScalar:uS,matrix:uV,typed:ux,zeros:uK}),u6=/* #__PURE__ */o1({DenseMatrix:uy,SparseMatrix:uz,concat:uX,config:n_,matrix:uV,typed:ux}),u9=/* #__PURE__ */o4({DenseMatrix:uy,concat:uX,equalScalar:uS,matrix:uV,subtractScalar:uU,typed:ux,unaryMinus:uq}),u7=/* #__PURE__ */o6({DenseMatrix:uy,divideScalar:uQ,equalScalar:uS,matrix:uV,multiplyScalar:uO,subtractScalar:uU,typed:ux}),lt=/* #__PURE__ */o7({DenseMatrix:uy,SparseMatrix:uz,addScalar:uD,concat:uX,equalScalar:uS,matrix:uV,typed:ux}),le=/* #__PURE__ */se({BigNumber:up,DenseMatrix:uy,Fraction:um,concat:uX,config:n_,equalScalar:uS,matrix:uV,typed:ux}),lr=/* #__PURE__ */sn({addScalar:uD,conj:uE,multiplyScalar:uO,size:uW,typed:ux}),ln=/* #__PURE__ */sl({ImmutableDenseMatrix:/* #__PURE__ */su({DenseMatrix:uy,smaller:u6}),getMatrixDataType:uF}),li=/* #__PURE__ */sf({DenseMatrix:uy,SparseMatrix:uz,concat:uX,config:n_,matrix:uV,typed:ux}),la=/* #__PURE__ */sg({addScalar:uD,dot:lr,equalScalar:uS,matrix:uV,multiplyScalar:uO,typed:ux}),lo=/* #__PURE__ */sC({SparseMatrix:uz,abs:ub,add:lt,divideScalar:uQ,larger:li,largerEq:u2,multiply:la,subtract:u9,transpose:u$,typed:ux}),ls=/* #__PURE__ */sO({DenseMatrix:uy,divideScalar:uQ,equalScalar:uS,matrix:uV,multiplyScalar:uO,subtractScalar:uU,typed:ux}),lu=/* #__PURE__ */sL({divideScalar:uQ,isZero:uB,matrix:uV,multiply:la,subtractScalar:uU,typed:ux,unaryMinus:uq}),ll=/* #__PURE__ */sG({larger:li,smaller:u6}),lh=/* #__PURE__ */sH({DenseMatrix:uy,SparseMatrix:uz,concat:uX,config:n_,matrix:uV,typed:ux}),lc=/* #__PURE__ */sK({bignumber:uL,matrix:uV,add:lt,config:n_,isPositive:uT,larger:li,largerEq:u2,smaller:u6,smallerEq:lh,typed:ux}),lf=/* #__PURE__ */sZ({FibonacciHeap:ll,addScalar:uD,equalScalar:uS}),ld=/* #__PURE__ */sQ({Index:ln,matrix:uV,range:lc,typed:ux}),lp=/* #__PURE__ */s0({abs:ub,addScalar:uD,det:lu,divideScalar:uQ,identity:u1,matrix:uV,multiply:la,typed:ux,unaryMinus:uq}),lg=/* #__PURE__ */s1({DenseMatrix:uy,Spa:lf,SparseMatrix:uz,abs:ub,addScalar:uD,divideScalar:uQ,equalScalar:uS,larger:li,matrix:uV,multiplyScalar:uO,subtractScalar:uU,typed:ux,unaryMinus:uq}),lm=/* #__PURE__ */s2({Complex:ug,config:n_,fraction:uj,identity:u1,inv:lp,matrix:uV,multiply:la,number:uk,typed:ux}),lv=/* #__PURE__ */us({DenseMatrix:uy,lsolve:u5,lup:lg,matrix:uV,slu:lo,typed:ux,usolve:u7}),ly=/* #__PURE__ */uu({abs:ub,add:lt,addScalar:uD,atan:u_,bignumber:uL,column:ld,complex:uw,config:n_,cos:uC,diag:uJ,divideScalar:uQ,dot:lr,equal:u0,flatten:uA,im:uN,inv:lp,larger:li,matrix:uV,matrixFromColumns:u3,multiply:la,multiplyScalar:uO,number:uk,qr:u4,re:uP,reshape:uY,sin:uI,size:uW,smaller:u6,sqrt:uG,subtract:u9,typed:ux,usolve:u7,usolveAll:ls});const lx=window.innerWidth,lb=window.innerHeight;var lD=new/*@__PURE__*/(n(l)).Stage({container:"container",width:lx,height:lb});let l_=new/*@__PURE__*/(n(l)).Layer;lD.add(l_);const lw=parseInt(lx/30);let lE=[],lC=null,lS=[],lA=[],lF=[],lN=!1,lM=[],lT={},lB=1;function lO(t){t.style.display="block",setTimeout(()=>{t.style.display="none"},2e3)}function lk(t,e){t.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(e)}`}function lP(t,e){return(e-30)/30*lw+(t-30)/30}function lR(t,e){if(e[0]<60||60>Math.abs(lx-e[0])||e[1]<60||60>Math.abs(lb-e[1]))return!0;if(t!==lC){let r=Math.abs(lC.x()-e[0]),n=lC.y()-e[1];if(t.horizontal&&r<=60&&(0===n||-30===n)||!t.horizontal&&r<=30&&(-75===n||60>=Math.abs(n)))return!0}for(let r of lE){if(null==r||t.ID==r.ID)continue;let n=r.x(),i=r.y(),a=Math.abs(n-e[0]),o=i-e[1],s=Math.abs(o);if(t==lC){if(r.horizontal&&a<=60&&(0===s||30===o)||!r.horizontal&&a<=30&&(75===o||s<=60))return!0}else if(t.horizontal&&r.horizontal){if(a<=90&&s<=30)return!0}else if(t.horizontal||r.horizontal){if(a<=90&&s<=90)return!0}else if(a<=30&&s<=90)return!0}return!1}function lI(t){for(let e of lE){if(null==e)continue;let r=e.x(),n=e.y(),i=Math.abs(r-t[0]),a=Math.abs(n-t[1]);if(e.horizontal){if(i<=90&&a<=30)return!0}else if(i<=90&&a<=90)return!0}return!1}function lz(t){return 30*Math.round(t/30)}function lU(t){0===t.rotation()&&(lF[t.node1.right.index].occupied=!0,lF[lF[t.node1.right.index].right.index].occupied=!0),90===t.rotation()&&(lF[t.node1.bottom.index].occupied=!0,lF[lF[t.node1.bottom.index].bottom.index].occupied=!0),180===t.rotation()&&(lF[t.node2.right.index].occupied=!0,lF[lF[t.node2.right.index].right.index].occupied=!0),270===t.rotation()&&(lF[t.node2.bottom.index].occupied=!0,lF[lF[t.node2.bottom.index].bottom.index].occupied=!0)}function lL(t){0===t.rotation()&&(lF[t.node1.right.index].occupied=!1,lF[lF[t.node1.right.index].right.index].occupied=!1),90===t.rotation()&&(lF[t.node1.bottom.index].occupied=!1,lF[lF[t.node1.bottom.index].bottom.index].occupied=!1),180===t.rotation()&&(lF[t.node2.right.index].occupied=!1,lF[lF[t.node2.right.index].right.index].occupied=!1),270===t.rotation()&&(lF[t.node2.bottom.index].occupied=!1,lF[lF[t.node2.bottom.index].bottom.index].occupied=!1)}function lG(t,e){t.width(90),t.height(90),t.offsetX(t.width()/2),t.offsetY(t.height()/2),t.x(75),t.y(90),t.image(e),t.draggable(!0),t.rotation(0);let r=lP(t.x()-t.width()/2,t.y()),n=lP(t.x()+t.width()/2,t.y());t.node1=lF[r],t.node2=lF[n],lU(t)}function lq(t){let e;e=t.dependent?`${t.name}`:`${t.name} ${t.getValue()}${t.unit}`;let r=new/*@__PURE__*/(n(l)).Text({x:t.x(),y:t.y()-40,text:e,fontSize:20,fontFamily:"Calibri",fill:"black",align:"center",weight:"bold",listening:!1});return r.offsetX(r.width()/2),r.offsetY(r.height()/2),r.x(t.x()),r.y(r.y()),r}function lj(t,e){t.text=e,l_.add(t),lE.push(t),l_.add(t.text),l_.draw(),t.on("mouseover",()=>{document.body.style.cursor="pointer"}),t.on("mouseout",()=>{document.body.style.cursor="default"});let r=[t.x(),t.y()];t.on("dragstart",()=>{t.text.hide()}),t.on("dragend",()=>{let e=[];e=t.horizontal?[lz(t.x())-15,lz(t.y())]:[lz(t.x()),lz(t.y())-15],function(t,e,r){if(lR(t,e)){t.position({x:r[0],y:r[1]}),lH(t,t.text);return}lL(t),r[0]=e[0],r[1]=e[1],t.position({x:r[0],y:r[1]}),lV(t),lU(t),lH(t)}(t,e,r),l_.batchDraw()}),t.on("dblclick",()=>{if(lN)return;!function(t){let e=`
    <div id="editProperties">
        <h2>${t.type}</h2>
        <label for="componentval">${t.type} ${t.dependent?"Gain":"Value"} = </label>
            <div class="direction">
                <input type="number" name="componentval" id="componentval" min="0" value=${t.dependent?t.gain:t.value}>
                <div class="datalist-container">
                    <select name="rotatesel" id="prefix">
                        <option value="p" ${"p"===t.prefix?"selected":""}>p</option>
                        <option value="n" ${"n"===t.prefix?"selected":""}>n</option>
                        <option value="\xb5" ${"µ"===t.prefix?"selected":""}>\xb5</option>
                        <option value="m" ${"m"===t.prefix?"selected":""}>m</option>
                        <option value="c" ${"c"===t.prefix?"selected":""}>c</option>
                        <option value=" " ${" "===t.prefix?"selected":""}>No Prefix</option>
                        <option value="k" ${"k"===t.prefix?"selected":""}>k</option>
                        <option value="M" ${"M"===t.prefix?"selected":""}>M</option>
                        <option value="G" ${"G"===t.prefix?"selected":""}>G</option>
                        <option value="T" ${"T"===t.prefix?"selected":""}>T</option>
                    </select>
                </div>
                ${t.dependent?"":`<span>${t.unit}</span>`}
        </div>
        <div class="rotation-labels">
            <label for="rotation">Rotation</label>
            <select name="rotatesel" id="rotation">
            <option value="0" ${0===t.rotation()?"selected":""}>0</option>
            <option value="90" ${90===t.rotation()?"selected":""}>90</option>
            <option value="180" ${180===t.rotation()?"selected":""}>180</option>
            <option value="270" ${270===t.rotation()?"selected":""}>270</option>
            </select>
        </div>
        ${function(t){if(!t.dependent)return"";t.controlsource;let e=`<div class="dependencyType" >
        <label for="dependenttype">Type: </label>
        <select name="dependencytypesel" id="dependenttype">
        <option value=${rS.CURRENT} ${rS.CURRENT===t.controlsource?"selected":""}>${rS.CURRENT}</option>
        <option value=${rS.VOLTAGE} ${rS.VOLTAGE===t.controlsource?"selected":""}>${rS.VOLTAGE}</option>
        </select>
        <span>controlled</span>
        </div>
        `;return e+=`<div class="dependency" >
        <label for="dependson">Depends on</label>
        <select name="dependencysel" id="dependson">`,lE.forEach((r,n)=>{if(null===r||r.dependent)return;let i=!1;t.dependency==n&&(i=!0),e+=`<option value=${n} ${i?"selected":""}>${r.name}</option>`}),e+=`</select>
    </div> `}(t)}
        <div class="checkbox-container">
            <label for="showtext">Show Value</label>
            <select name="showntext" id="showtext">
            <option value="true" ${!0===t.shownText?"selected":""}>On</option>
            <option value="false" ${!1===t.shownText?"selected":""}>Off</option>
            </select>
        </div>
         <button class="mybutton" id="deleteBtn">delete</button>
        <button class="button" id="submitBtn">submit</button>
    </div >
        `,r=document.createElement("div");r.id="popupDiv",r.innerHTML=e,document.body.appendChild(r)}(t);let n=t.rotation();document.getElementsByClassName("rotation").value=n;let i=document.getElementById("deleteBtn"),a=document.getElementById("submitBtn"),o=document.getElementById("popupDiv");window.addEventListener("keydown",t=>{"Escape"===t.key&&o.remove()}),i.addEventListener("click",()=>{let e;o.remove(),e=1,lE.forEach(r=>{null!==r&&r.type===t.type&&r!==t&&r.name!==`${r.getSymbol()}${e++} `&&(r.name=`${r.getSymbol()}${e-1} `,r.text.text(`${r.name} ${r.getValue()}${" "===r.prefix?"":r.prefix}${r.unit} `))}),t.decreaseCount(),lE[t.ID]=null,t.text.remove(),t.remove(),l_.batchDraw()}),a.addEventListener("click",()=>{let n=document.getElementById("componentval");if(t.dependent){let e=document.getElementById("dependson");t.dependency=e.value,t.setGain(n.value);let r=document.getElementById("dependenttype");console.log(r.value),t.setControlSource(r.value)}else t.setValue(n.value);let i=document.getElementById("prefix"),a=document.getElementById("rotation");t.setPrefix(i.value);let s=t.rotation();t.setRotationvalue(a.value),s===t.rotation()||180===Math.abs(s-t.rotation())||(0===t.rotation()||180===t.rotation()?(t.horizontal=!0,lR(t,[lz(t.x())-15,lz(t.y())])?(t.horizontal=!1,t.setRotationvalue(s),lO(document.getElementById("norotate"))):(t.position({x:lz(t.x())-15,y:lz(t.y())}),r=[t.x(),t.y()])):(t.horizontal=!1,lR(t,[lz(t.x()),lz(t.y())-15])?(t.horizontal=!0,t.setRotationvalue(s),lO(document.getElementById("norotate"))):(t.position({x:lz(t.x()),y:lz(t.y())-15}),r=[t.x(),t.y()]))),lL(t),lV(t),lU(t);let u=document.getElementById("showtext");"true"==u.value?t.shownText=!0:"false"==u.value&&(t.shownText=!1),o.remove(),lH(t,e),l_.batchDraw()})})}function lV(t){let e=t.rotation();if(0===e){let e=lP(t.x()-t.width()/2,t.y()),r=lP(t.x()+t.width()/2,t.y());t.node1=lF[e],t.node2=lF[r]}else if(90===e){let e=lP(t.x(),t.y()-t.height()/2),r=lP(t.x(),t.y()+t.height()/2);t.node1=lF[e],t.node2=lF[r]}else if(180===e){let e=lP(t.x()+t.width()/2,t.y()),r=lP(t.x()-t.width()/2,t.y());t.node1=lF[e],t.node2=lF[r]}else if(270===e){let e=lP(t.x(),t.y()+t.height()/2),r=lP(t.x(),t.y()-t.height()/2);t.node1=lF[e],t.node2=lF[r]}}function lH(t){t.dependent?t.text.text(`${t.name}`):t.text.text(`${t.name} ${t.getValue()}${" "===t.prefix?"":t.prefix}${t.unit} `),t.text.offsetX(t.text.width()/2),t.text.offsetY(t.text.height()/2),t.text.rotation(t.rotation()),0===t.rotation()?t.text.position({x:t.x(),y:t.y()-40}):90===t.rotation()?t.text.position({x:t.x()+40,y:t.y()}):180===t.rotation()?t.text.position({x:t.x(),y:t.y()+40}):270===t.rotation()&&t.text.position({x:t.x()-40,y:t.y()}),t.text.hide(),t.shownText&&t.text.show()}function lY(){lE.forEach(t=>{null!==t&&t.draggable(!0)}),lC.draggable(!0)}function lW(){lS.forEach(t=>{t.remove()}),lS=[],l_.batchDraw()}function l$(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function lK(t){switch(t){case"p":return 1e-12;case"n":return 1e-9;case"µ":return 1e-6;case"m":return .001;case"c":return .01;case" ":return 1;case"k":return 1e3;case"M":return 1e6;case"G":return 1e9;case"T":return 1e12;default:throw Error(`Unknown prefix: ${t} `)}}function lX(t){if(Math.abs(Number(t))>=1e12)return(Number(t)/1e12).toFixed(3)+" T";if(Math.abs(Number(t))>=1e9)return(Number(t)/1e9).toFixed(3)+" G";if(Math.abs(Number(t))>=1e6)return(Number(t)/1e6).toFixed(3)+" M";if(Math.abs(Number(t))>=1e3)return(Number(t)/1e3).toFixed(3)+" k";if(Math.abs(Number(t))>=1)return Number(t).toFixed(3);if(Math.abs(Number(t))>=.001)return(1e3*Number(t)).toFixed(3)+" m";if(Math.abs(Number(t))>=1e-6)return(1e6*Number(t)).toFixed(3)+" μ";else if(Math.abs(Number(t))>=1e-9)return(1e9*Number(t)).toFixed(3)+" n";else if(Math.abs(Number(t))>=1e-12)return(1e12*Number(t)).toFixed(3)+" p";else return"0.000"}!function(){var t;for(let t=0;t<=lx;t+=30){let e=new/*@__PURE__*/(n(l)).Line({points:[t,0,t,lb],stroke:"lightgray",strokeWidth:1,listening:!1});l_.add(e)}for(let t=0;t<=lb;t+=30){let e=new/*@__PURE__*/(n(l)).Line({points:[0,t,lx,t],stroke:"lightgray",strokeWidth:1,listening:!1});l_.add(e)}for(let t=0;t<=lb;t+=30)for(let e=0;e<=lx;e+=30){let r=new/*@__PURE__*/(n(l)).Circle({x:e,y:t,radius:1,fill:"darkgray",listening:!1});if(l_.add(r),e>0&&t>0){let r={};r.index=lP(e,t),r.occupied=!1,r.position={x:e,y:t},30!==e&&(r.left={index:r.index-1}),30!==t&&(r.top={index:r.index-lw}),e!==lx-30&&(r.right={index:r.index+1}),t!==lb-30&&(r.bottom={index:r.index+lw}),lF.push(r)}}console.log(lF),lk(t=new Image,`<svg xmlns="http://www.w3.org/2000/svg" width="60" height="30" viewBox="0 0 60 30">
  <!-- Vertical line coming from above -->
  <line x1="30" y1="0" x2="30" y2="15" stroke="black" stroke-width="2"/>
  <!-- Top horizontal line -->
  <line x1="14" y1="15" x2="46" y2="15" stroke="black" stroke-width="2"/>
  <!-- Middle horizontal line -->
  <line x1="20" y1="20" x2="40" y2="20" stroke="black" stroke-width="2"/>
  <!-- Bottom horizontal line -->
  <line x1="24" y1="25" x2="36" y2="25" stroke="black" stroke-width="2"/>
</svg>`),t.onload=function(){var e=new rw({});e.width(60),e.offsetX(e.width()/2),e.x(lz(lx-60)),e.y(60),e.image(t),e.draggable(!0),e.rotation(0);let r=lP(e.x(),e.y());e.node=lF[r],lF[e.node.bottom.index].occupied=!0,l_.add(e),lC=e,e.on("mouseover",()=>{document.body.style.cursor="pointer"}),e.on("mouseout",()=>{document.body.style.cursor="default"});let n=[e.x(),e.y()];e.on("dragend",()=>{let t=[lz(e.x()),lz(e.y())];if(lR(e,t))e.position({x:n[0],y:n[1]}),l_.batchDraw();else{lF[e.node.bottom.index].occupied=!1,n[0]=t[0],n[1]=t[1],e.position({x:n[0],y:n[1]});let r=lP(e.x(),e.y());e.node=lF[r],lF[e.node.bottom.index].occupied=!0}})},l_.draw()}();const lZ=new/*@__PURE__*/(n(l)).Text({x:10,y:10,text:"Components Hub",fontSize:20,fontFamily:"Arial",fill:"black"});l_.add(lZ),document.getElementById("resistance").addEventListener("click",()=>{if(console.log(lN),!lN){if(lI([75,90])){lO(document.getElementById("atOriginalert"));return}var t=new Image;lk(t,`
    <svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 90 30">
    <line x1="0" y1="15" x2="15" y2="15" stroke="black" stroke-width="2"/>
    <polyline points="15,15 20,5 30,25 40,5 50,25 60,5 70,25 75,15" fill="none" stroke="black" stroke-width="2"/>
    <line x1="75" y1="15" x2="90" y2="15" stroke="black" stroke-width="2"/>
    </svg>
    `),t.onload=function(){var e=new rE({});lG(e,t);let r=lq(e);lj(e,r)}}}),document.getElementById("dcBattery").addEventListener("click",()=>{if(!lN){if(lI([75,90])){lO(document.getElementById("atOriginalert"));return}var t=new Image;lk(t,`
    <svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 90 90">
    <!-- Outer Circle (radius 25) -->
    <circle cx="45" cy="45" r="25" stroke="black" stroke-width="2" fill="none"/>
    <!-- Left Terminal (outside the circle) -->
    <line x1="0" y1="45" x2="20" y2="45" stroke="black" stroke-width="2"/>
    <!-- Right Terminal (outside the circle) -->
    <line x1="70" y1="45" x2="90" y2="45" stroke="black" stroke-width="2"/>
    <!-- Positive Sign inside the circle -->
    <line x1="35" y1="45" x2="40" y2="45" stroke="black" stroke-width="2"/>
    <line x1="37.5" y1="40" x2="37.5" y2="50" stroke="black" stroke-width="2"/>
  <!-- Negative Sign inside the circle -->
  <line x1="50" y1="45" x2="55" y2="45" stroke="black" stroke-width="2"/>
  </svg>
  
  `),t.onload=function(){var e=new rC({});lG(e,t);let r=lq(e);lj(e,r)}}}),document.getElementById("DependentVoltageSource").addEventListener("click",()=>{if(!lN){if(lI([75,90])){lO(document.getElementById("atOriginalert"));return}var t=new Image;lk(t,`
<svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 90 90">
  <!-- Outer Rhombus -->
  <polygon points="45,20 70,45 45,70 20,45" stroke="black" stroke-width="2" fill="none"/>
  <!-- Left Terminal (outside the rhombus) -->
  <line x1="0" y1="45" x2="20" y2="45" stroke="black" stroke-width="2"/>
  <!-- Right Terminal (outside the rhombus) -->
  <line x1="70" y1="45" x2="90" y2="45" stroke="black" stroke-width="2"/>
  <!-- Positive Sign inside the rhombus -->
  <line x1="35" y1="45" x2="40" y2="45" stroke="black" stroke-width="2"/>
  <line x1="37.5" y1="40" x2="37.5" y2="50" stroke="black" stroke-width="2"/>
  <!-- Negative Sign inside the rhombus -->
  <line x1="50" y1="45" x2="55" y2="45" stroke="black" stroke-width="2"/>
</svg>

  `),t.onload=function(){var e=new rA({});lG(e,t);let r=lq(e);lj(e,r),console.log(lE)}}}),document.getElementById("dcCurrentSource").addEventListener("click",()=>{if(!lN){if(lI([75,90])){let t=document.getElementById("atOriginalert");t.style.display="block",setTimeout(()=>{t.style.display="none"},2e3);return}var t=new Image;lk(t,`<svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 90 90">
  <!-- Outer Circle (radius 25) -->
  <circle cx="45" cy="45" r="25" stroke="black" stroke-width="2" fill="none"/>
  <!-- Left Terminal (outside the circle) -->
  <line x1="0" y1="45" x2="20" y2="45" stroke="black" stroke-width="2"/>
  <!-- Right Terminal (outside the circle) -->
  <line x1="70" y1="45" x2="90" y2="45" stroke="black" stroke-width="2"/>
  <!-- Arrow inside the circle (pointing left) -->
  <line x1="55" y1="45" x2="35" y2="45" stroke="black" stroke-width="2"/>
  <polygon points="35,45 40,40 40,50" fill="black"/>
  </svg>
  
  `),t.onload=function(){var e=new rN({});lG(e,t);let r=lq(e);lj(e,r)}}}),document.getElementById("DependentCurrentSource").addEventListener("click",()=>{if(!lN){if(lI([75,90])){lO(document.getElementById("atOriginalert"));return}var t=new Image;lk(t,`
<svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 90 90">
  <!-- Outer Rhombus -->
  <polygon points="45,20 70,45 45,70 20,45" stroke="black" stroke-width="2" fill="none"/>
  <!-- Left Terminal (outside the rhombus) -->
  <line x1="0" y1="45" x2="20" y2="45" stroke="black" stroke-width="2"/>
  <!-- Right Terminal (outside the rhombus) -->
  <line x1="70" y1="45" x2="90" y2="45" stroke="black" stroke-width="2"/>
  <!-- Arrow inside the rhombus (pointing left) -->
  <line x1="55" y1="45" x2="35" y2="45" stroke="black" stroke-width="2"/>
  <polygon points="35,45 40,40 40,50" fill="black"/>
</svg>
  `),t.onload=function(){var e=new rF({});lG(e,t);let r=lq(e);lj(e,r)}}});let lJ=[];document.getElementById("wire").addEventListener("click",()=>{if(lN)return;lN=!0,lE.forEach(t=>{null!==t&&t.draggable(!1)}),lC.draggable(!1);let t=document.getElementById("wirealert");lO(t),function(){let t=new/*@__PURE__*/(n(l)).Circle({x:lC.node.position.x,y:lC.node.position.y,radius:4,fill:"#772F1A"});lS.push(t),lE.forEach(t=>{if(null==t)return;let e=new/*@__PURE__*/(n(l)).Circle({x:t.node1.position.x,y:t.node1.position.y,radius:4,fill:"#772F1A"});lS.push(e);let r=new/*@__PURE__*/(n(l)).Circle({x:t.node2.position.x,y:t.node2.position.y,radius:4,fill:"#772F1A"});lS.push(r)}),lA.forEach(t=>{null!=t&&t.gridPoints.forEach(t=>{let e=!0;if(lS.forEach(r=>{r.x()==t.position.x&&r.y()==t.position.y&&(e=!1)}),!e)return;let r=new/*@__PURE__*/(n(l)).Circle({x:t.position.x,y:t.position.y,radius:4,fill:"#772F1A"});lS.push(r)})}),lS.forEach(t=>{t.on("mouseover",()=>{document.body.style.cursor="pointer"}),t.on("mouseout",()=>{document.body.style.cursor="default"}),t.on("click",()=>{t.fill("green")}),l_.add(t)}),l_.batchDraw()}(),window.addEventListener("keydown",e=>{if("Escape"===e.key){t.style.display="none",lN=!1,lY(),lW(),lJ=[];return}})}),document.body.addEventListener("click",t=>{if(lN){let e=!1;lS.forEach(r=>{5>Math.abs(t.x-r.x())&&5>Math.abs(t.y-r.y())&&(e=!0)}),e||(t.preventDefault(),t.stopPropagation());let r=document.getElementById("differentnode");lS.forEach(e=>{4>Math.abs(t.x-e.x())&&4>Math.abs(t.y-e.y())&&(lJ.length<2&&(lJ.find(t=>t===e)?lO(r):lJ.push(e)),2===(lJ=[...new Set(lJ)]).length)&&(lN=!1,lY(),!function(t){let e=lP(t[0].x(),t[0].y()),r=lP(t[1].x(),t[1].y());lS.forEach(t=>{let n=lP(t.x(),t.y());n!=e&&n!=r&&(lF[n].occupied=!0)});let i=function(t,e){let r=[t],n=[];for(lF.forEach(t=>{t.g=1/0,t.h=0,t.f=t.g+t.h,t.parent=null}),t.g=0,t.h=l$(t.position,e.position),t.f=t.g+t.h;r.length>0;){let t=r.reduce((t,e)=>t.f<e.f?t:e);if(t===e)return function(t){let e=[];for(;t;)e.push(t),t=t.parent;return e.reverse()}(t);r=r.filter(e=>e!==t),n.push(t),["left","top","right","bottom"].forEach(i=>{if(!t[i])return;let a=lF[t[i].index];if(!a||a.occupied||n.includes(a))return;let o=t.g+1;if(r.includes(a)){if(o>=a.g)return}else r.push(a);a.g=o,a.h=l$(a.position,e.position),a.f=a.g+a.h,a.parent=t})}return null}(lF[e],lF[r]);if(!i)return!1;let a=new rM;a.gridPoints=i;for(let t=0;t<i.length-1;t++){let e=new/*@__PURE__*/(n(l)).Line({points:[i[t].position.x,i[t].position.y,i[t+1].position.x,i[t+1].position.y],stroke:"black",strokeWidth:2,listening:!0});l_.add(e),a.drawnLines.push(e)}return lA.push(a),lS.forEach(t=>{lF[lP(t.x(),t.y())].occupied=!1}),lW(),a.drawnLines.forEach(t=>{t.on("dblclick",()=>{console.log(lA),lN||(a.drawnLines.forEach(t=>{t.remove()}),lA[a.ID]=null)})}),!0}(lJ)&&alert("Can't draw a wire between those nodes"),lJ=[])})}}),document.getElementById("run").addEventListener("click",()=>{!function(){let t;!function(){lT={},lB=1,lA.forEach(t=>{if(null!=t){for(let e=1;e<lB;e++)for(let r=0;r<t.gridPoints.length;r++)if(lT[`N${e} `][`${t.gridPoints[r].index} `]){for(let r=0;r<t.gridPoints.length;r++)lT[`N${e} `][`${t.gridPoints[r].index} `]=!0;return}lT[`N${lB} `]||(lT[`N${lB} `]={});for(let e=0;e<t.gridPoints.length;e++)lT[`N${lB} `][`${t.gridPoints[e].index} `]=!0;lB++}});for(let t=1;t<lB;t++)for(let e=t+1;e<lB;e++)if(function(t,e){let r=Object.keys(t),n=Object.keys(e),i=new Set(r);for(let t of n)if(i.has(t))return!0;return!1}(lT[`N${t} `],lT[`N${e} `])){lT[`N${t} `]={...lT[`N${t} `],...lT[`N${e} `]};let r=e;for(lB--;r<lB;r++)lT[`N${r} `]=lT[`N${r+1} `];delete lT[`N${r} `]}lE.forEach(t=>{if(null==t)return;let e=!1,r=!1;for(let n=1;n<lB;n++)lT[`N${n} `][`${t.node1.index} `]&&(e=!0),lT[`N${n} `][`${t.node2.index} `]&&(r=!0);!e&&(lT[`N${lB} `]={},lT[`N${lB} `][`${t.node1.index} `]=!0,lB++),!r&&(lT[`N${lB} `]={},lT[`N${lB} `][`${t.node2.index} `]=!0,lB++)});for(let t=1;t<lB;t++)if(lT[`N${t} `][`${lC.node.index} `]){lT.GND=lT[`N${t} `];let e=t;for(;e<lB-1;e++)lT[`N${e} `]=lT[`N${e+1} `];delete lT[`N${e} `],lB--;break}lT.GND||(lT.GND={},lT.GND[`${lC.node.index} `]=!0)}();let e=[];lE.forEach(t=>{let r,n;if(null===t)return;for(let e of Object.keys(lT))lT[e][`${t.node1.index} `]&&(r=e);for(let e of Object.keys(lT))lT[e][`${t.node2.index} `]&&(n=e);let i={};if(t.dependent){let e=null,a="none",o="none";if(console.log(parseInt(t.dependency)),rG(parseInt(t.dependency))&&(e=lE[parseInt(t.dependency)]),console.log(e),e){for(let r of(gain=t.gain,Object.keys(lT)))lT[r][`${e.node1.index} `]&&(a=r);for(let t of Object.keys(lT))lT[t][`${e.node2.index} `]&&(o=t)}else gain=0;i={name:t.name,type:t.getSymbol(),Node1:r,Node2:n,Gain:gain,exponent:lK(t.prefix),dependent:!0,Dependnode1:a,Dependnode2:o,dependencyType:t.controlsource}}else i={name:t.name,type:t.getSymbol(),Node1:r,Node2:n,Value:t.value,exponent:lK(t.prefix),dependent:!1};e.push(i)});let r=Object.keys(lT).length-1,i=0,a=[],o=[];for(let t=0;t<e.length;t++)("Vs"===e[t].type||"DVs"===e[t].type)&&(i++,e[t].dependencyType===rS.CURRENT&&i++,a.push(t),o.push(e[t].name));let s=r+i,u=Array(s),h=Array(s);h.fill(0);for(let t=0;t<s;t++)u[t]=Array(s),u[t].fill(0);for(let t=0;t<e.length;t++)if("R"===e[t].type){let r=parseInt(e[t].Node1.slice(1)),n=parseInt(e[t].Node2.slice(1));Number.isNaN(r)||(u[r-1][r-1]+=1/(parseFloat(e[t].Value)*e[t].exponent)),Number.isNaN(n)||(u[n-1][n-1]+=1/(parseFloat(e[t].Value)*e[t].exponent)),Number.isNaN(r)||Number.isNaN(n)||(u[r-1][n-1]-=1/(parseFloat(e[t].Value)*e[t].exponent),u[n-1][r-1]-=1/(parseFloat(e[t].Value)*e[t].exponent))}else if("Cs"===e[t].type){let r=parseInt(e[t].Node1.slice(1)),n=parseInt(e[t].Node2.slice(1));Number.isNaN(r)||(h[r-1]+=parseFloat(e[t].Value*e[t].exponent)),Number.isNaN(n)||(h[n-1]-=parseFloat(e[t].Value*e[t].exponent))}else if("DCs"===e[t].type){let r=parseInt(e[t].Node1.slice(1)),n=parseInt(e[t].Node2.slice(1)),i=parseInt(e[t].Dependnode1.slice(1)),a=parseInt(e[t].Dependnode2.slice(1));Number.isNaN(r)||(Number.isNaN(i)||(u[r-1][i-1]-=parseFloat(e[t].Gain*e[t].exponent)),Number.isNaN(a)||(u[r-1][a-1]+=parseFloat(e[t].Gain*e[t].exponent))),Number.isNaN(n)||(Number.isNaN(i)||(u[n-1][i-1]+=parseFloat(e[t].Gain*e[t].exponent)),Number.isNaN(a)||(u[n-1][a-1]-=parseFloat(e[t].Gain*e[t].exponent)))}let c=[];for(let t=0;t<a.length;t++){let n=e[a[t]],i=parseInt(n.Node1.slice(1)),o=parseInt(n.Node2.slice(1));if(Number.isNaN(i)||(u[i-1][r+t+c.length]+=1,u[r+t+c.length][i-1]+=1),Number.isNaN(o)||(u[o-1][r+t+c.length]-=1,u[r+t+c.length][o-1]-=1),!0===n.dependent){if(n.dependencyType===rS.VOLTAGE){let e=parseInt(n.Dependnode1.slice(1)),i=parseInt(n.Dependnode2.slice(1));Number.isNaN(e)||(u[r+t+c.length][e-1]-=parseFloat(n.Gain*n.exponent)),Number.isNaN(i)||(u[r+t+c.length][i-1]+=parseFloat(n.Gain*n.exponent))}else{let e=parseInt(n.Dependnode1.slice(1)),i=parseInt(n.Dependnode2.slice(1));Number.isNaN(e)||(u[r+t+c.length+1][e-1]+=1,u[e-1][r+t+c.length+1]+=1),Number.isNaN(i)||(u[r+t+c.length+1][i-1]-=1,u[i-1][r+t+c.length+1]-=1),u[r+t+c.length][r+t+c.length+1]-=parseFloat(n.Gain*n.exponent),c.push(r+t+c.length+1)}}else h[r+t+c.length]+=parseFloat(n.Value*n.exponent)}console.log(u);try{t=lv(u,h)}catch(t){alert("current circuit can't be solved");return}let f=[];for(let e=0;e<t.length-i;e++){let t=lF[parseInt(Object.keys(lT[`N${e+1} `])[0])],r=function(t){let e;let r=()=>{let t=Math.floor(128*Math.random()),e=Math.floor(128*Math.random()),r=Math.floor(128*Math.random());return`#${t.toString(16).padStart(2,"0")}${e.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")} `};do e=r();while(t.includes(e))return e}(f),i=new/*@__PURE__*/(n(l)).Circle({x:t.position.x,y:t.position.y,radius:4,fill:r});l_.add(i),f.push(r),lM.push(i)}(function(t,e,r,i){console.log(e);let a=e.length,o=new/*@__PURE__*/(n(l)).Group({x:50,y:50,draggable:!0}),s=new/*@__PURE__*/(n(l)).Rect({x:50,y:50,width:150,height:40,fill:"lightgray",stroke:"black",strokeWidth:1});o.add(s);let u=new/*@__PURE__*/(n(l)).Text({x:60,y:60,text:"Circuit Parameters",fontSize:16,fontFamily:"Calibri",fill:"black"});o.add(u);let h=new/*@__PURE__*/(n(l)).Rect({x:200,y:50,width:100,height:40,fill:"lightgray",stroke:"black",strokeWidth:1});o.add(h);let c=new/*@__PURE__*/(n(l)).Text({x:210,y:60,text:"Value",fontSize:16,fontFamily:"Calibri",fill:"black"});o.add(c);for(let e=0;e<t.length-(a+i.length);e++){let i=new/*@__PURE__*/(n(l)).Rect({x:50,y:(e+1)*40+50,width:150,height:40,fill:"white",stroke:"black",strokeWidth:1});o.add(i);let a=new/*@__PURE__*/(n(l)).Text({x:60,y:(e+1)*40+60,text:`V${e+1} `,fontSize:16,fontFamily:"Calibri",fill:r[e]});o.add(a);let s=new/*@__PURE__*/(n(l)).Rect({x:200,y:50+(e+1)*40,width:100,height:40,fill:"white",stroke:"black",strokeWidth:1});o.add(s);let u=new/*@__PURE__*/(n(l)).Text({x:210,y:(e+1)*40+60,text:`${lX(t[e])} V`,fontSize:16,fontFamily:"Calibri",fill:"black"});o.add(u)}let f=0;for(let r=t.length-(a+i.length);r<t.length;r++){if(i.includes(r)){f++;continue}let s=new/*@__PURE__*/(n(l)).Rect({x:50,y:(r+1-f)*40+50,width:150,height:40,fill:"white",stroke:"black",strokeWidth:1});o.add(s);let u=new/*@__PURE__*/(n(l)).Text({x:60,y:(r+1-f)*40+60,text:`I through ${e[r-(t.length-(a+i.length))]} `,fontSize:16,fontFamily:"Calibri",fill:"black"});o.add(u);let h=new/*@__PURE__*/(n(l)).Rect({x:200,y:50+(r+1-f)*40,width:100,height:40,fill:"white",stroke:"black",strokeWidth:1});o.add(h);let c=new/*@__PURE__*/(n(l)).Text({x:210,y:(r+1-f)*40+60,text:`${lX(t[r])} A`,fontSize:16,fontFamily:"Calibri",fill:"black"});o.add(c)}l_.add(o),lD.on("click",t=>{let e=o.getClientRect(),r=t.evt.clientX,n=t.evt.clientY;r>=e.x&&r<=e.x+e.width&&n>=e.y&&n<=e.y+e.height||(lM.forEach(t=>t.remove()),o.remove(),lM=[])})})(t,o,f,c),l_.batchDraw()}()});
//# sourceMappingURL=index.f712f2be.js.map
